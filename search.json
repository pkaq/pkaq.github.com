[{"title":"Gradleç½®é¡¶å¸–","url":"https://pkaq.org/2099/12/13/index/","content":"<p>ä¸ºäº†æ–¹ä¾¿æŸ¥è¯¢ï¼Œåˆ›å»ºæ­¤ç¯‡ï¼›é¢„çŸ¥è¯¦æƒ…ï¼Œè¯·ç‚¹æ›´å¤šï¼›</p>\n<a id=\"more\"></a>\n<p>ä¸­æ–‡æ–‡æ¡£ç¿»è¯‘è¿›è¡Œæ—¶,æ¬¢è¿å‚ä¸<br><a href=\"https://github.com/pkaq/gradledoc\">https://github.com/pkaq/gradledoc</a>  </p>\n<p>æœ€è¿‘æ”’äº†ä¸€ä¸ªGradleçš„ç¤ºä¾‹å¤§å…¨ï¼Œæ¬¢è¿å‚ä¸<br><a href=\"https://github.com/pkaq/gradleside\">https://github.com/pkaq/gradleside</a>  </p>\n<p>å¹¿å‘Š:å¦‚æœä½ å¯¹gradleæœ‰æ‰€äº†è§£å¹¶ä¸”æ„Ÿå…´è¶£ é‚£ä¹ˆ æˆ‘ä»¬æœ‰ä¸ªå°ç¾¤ 109752483</p>\n","categories":["Build Tools"],"tags":["Gradle"]},{"title":"åŸºäºKeycloakçš„SSO","url":"https://pkaq.org/2021/07/07/keycloak/","content":"","categories":["SSO"],"tags":["Spring Boot","Spring","SSO","Keycloak","Spring Security"]},{"title":"ä½¿ç”¨Gradleå‘å¸ƒJaråŒ…åˆ°Maven Repository","url":"https://pkaq.org/2021/06/07/publish2maven/","content":"<h1><span id=\"gai-shu\">æ¦‚è¿°</span><a href=\"#gai-shu\" class=\"header-anchor\">#</a></h1><p>ç”±äºJcenterå·²ç»åœæ­¢äº†æœåŠ¡ï¼Œä¹‹å‰å‘å¸ƒåˆ°Jcenterçš„æ„ä»¶éœ€è¦è½¬ç§»åˆ°Mavenä»“åº“ä¸­ã€‚<br>åœ¨å¼€å§‹ä¹‹å‰ï¼Œå…ˆå¯¹OSSRHåšä¸‹äº†è§£æ˜¯å¾ˆå¿…è¦çš„ï¼Œå› ä¸ºä¸€å¼€å§‹ï¼Œæˆ‘å¹¶ä¸çŸ¥é“è¿™æ˜¯ä¸ªå•¥ç©å„¿æ„ã€‚æˆ‘æƒ³å’Œæˆ‘ä¸€æ ·çš„äººåº”è¯¥è¿˜æ˜¯æœ‰å¾ˆå¤šçš„ã€‚<br>OSSRHï¼šSonatype Open Source Software Repository Hosting Serviceï¼Œä¸ºå¼€æºè½¯ä»¶æä¾›mavenä»“åº“æ‰˜ç®¡æœåŠ¡ã€‚ä½ å¯ä»¥åœ¨ä¸Šé¢éƒ¨ç½²snapshotã€releaseç­‰ï¼Œæœ€åä½ å¯ä»¥ç”³è¯·æŠŠä½ çš„releaseåŒæ­¥åˆ°Maven Central Repositoryï¼ˆMavenä¸­å¤®ä»“åº“ï¼‰ã€‚</p>\n<p>ä¸ªäººçš„ç†è§£ï¼ŒOSSRHæ˜¯Mavenä¸­å¤®ä»“åº“çš„å‰ç½®å®¡æ‰¹ä»“åº“ï¼Œåªæœ‰ä½ å®Œå…¨ç¬¦åˆäº†å‘å¸ƒè¦æ±‚ï¼ŒæˆåŠŸçš„å°†ä½ çš„é¡¹ç›®å‘å¸ƒåˆ°äº†OSSRHï¼Œæ‰æœ‰æœºä¼šç”³è¯·åŒæ­¥åˆ°Mavenä¸­å¤®ä»“åº“ã€‚</p>\n<!--- more --->\n<h1><span id=\"yi-shen-qing-group-id\">ä¸€ã€ç”³è¯·group id</span><a href=\"#yi-shen-qing-group-id\" class=\"header-anchor\">#</a></h1><ol>\n<li><strong>æ³¨å†ŒSonatype JIRAè´¦å·</strong></li>\n</ol>\n<p>ç½‘å€ï¼š<a href=\"https://issues.sonatype.org/\">https://issues.sonatype.org/</a></p>\n<p>æ— éå°±æ˜¯å¡«å†™ä¸‹æ³¨å†Œä¿¡æ¯ï¼Œæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„</p>\n<ol start=\"2\">\n<li><strong>åˆ›å»ºä¸€ä¸ªIssue</strong><br>å¡«å†™èµ„æ–™<br>å¯ä»¥åœ¨å¤´éƒ¨çœ‹åˆ°ä¸€ä¸ªCreateçš„æŒ‰é’®<br><img src=\"1.png\" alt=\"1\"><br>sonatype-create-issue-button</li>\n</ol>\n<p>ä¼šå¼¹å‡ºCreate Issueè¡¨å•<br><img src=\"2.png\" alt=\"2\"><br>sonatype-create-issue-form</p>\n<ul>\n<li><p>Projectï¼šé€‰æ‹©Community Support - Open Source Project Repository Hosting (OSSRH)</p>\n</li>\n<li><p>Issue Typeï¼šé€‰æ‹©New Project</p>\n</li>\n<li><p>Summaryï¼šå†™ä¸ªæ ‡é¢˜åšä¸ªç®€å•æ¦‚è¿°ä½ è¦åšå•¥ã€‚çœŸä¸çŸ¥é“å†™ä»€ä¹ˆï¼Œç›´æ¥æŠŠé¡¹ç›®åç§°å†™ä¸Šå°±è¡Œï¼Œæˆ‘å°±è¿™ä¹ˆå¹²äº†å“ˆã€‚<br>  Group Idï¼š<br>  è‡ªå·±æœ‰åŸŸå<br>  å¯ä»¥ä½¿ç”¨å­åŸŸåä½œä¸ºGroup Id ã€‚ä¾‹ï¼šæˆ‘çš„é¡¹ç›®å«paladin2ï¼Œé‚£ä¹ˆå°±ç”¨org.pkaqä½œä¸ºGroup Id</p>\n<p>  æ³¨æ„ï¼šä¸èƒ½çç¼–ä¸€ä¸ªï¼Œå› ä¸ºåé¢å®¡æ ¸äººå‘˜ä¼šæ¥å®¡æ ¸ä½ æ˜¯å¦æ˜¯è¯¥åŸŸåçš„æ‹¥æœ‰è€…<br>  è‡ªå·±æ²¡åŸŸå<br>  å¯ä»¥å€ŸåŠ©githubï¼Œä¾‹ï¼šæˆ‘çš„ç”¨æˆ·åä¸ºmichaelzxï¼Œé‚£ä¹ˆå°±ç”¨com.github.pkaq.evaä½œä¸ºä½œä¸ºGroup Id<br>  Project URLï¼šè¦ä¸Group Idä¸€å®šå…³è”æ€§<br>  ä¾‹ï¼š<br>  Project URL=<a href=\"https://github.com/pkaq/eva\">https://github.com/pkaq/eva</a><br>  Group Id=com.github.pkaq.eva</p>\n</li>\n<li><p>SCM urlï¼šç‰ˆæœ¬ä»“åº“çš„æ‹‰å–åœ°å€</p>\n</li>\n</ul>\n<ol start=\"3\">\n<li><strong>ç­‰å¾…å›å¤</strong><br>å¦‚æœæœ‰é—®é¢˜ï¼Œè€å¤–åœ¨è¯„è®ºä¸­æŠŠé—®é¢˜ç»™ä½ æŒ‡å‡ºæ¥ï¼Œå¯ä»¥åœ¨åŸæœ‰çš„issueæŠŠèµ„æ–™æ”¹æ­£ç¡®</li>\n</ol>\n<p>å®¡æ ¸äººå‘˜è¦å¤„ç†çš„issueå¾ˆå¤šï¼Œä½ å¯èƒ½è¦è€å¿ƒç­‰å¾…ä¸€ä¼šï¼Œä¸è¦æ€¥<br>æˆ‘ä¹‹å‰æ€¥äº†ï¼Œå°±é‡æ–°æäº¤äº†2ä¸ªæ–°çš„issueï¼Œæœ€åç®¡ç†å‘˜è¿˜æ˜¯è€å¿ƒçš„æŠŠé‡å¤çš„issueå…³é—­<br>å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œé‚£ä¹ˆä½ ä¼šæ”¶åˆ°å®¡æ ¸äººå‘˜ï¼Œè¿™æ ·çš„ä¸€ä¸ªè¯„è®ºï¼š<br><img src=\"3.png\" alt=\"3\"></p>\n<p>è¿™é‡Œæˆ‘ä½¿ç”¨äº†è‡ªå·±çš„åŸŸåï¼Œå¦‚æœä½¿ç”¨è‡ªå·±çš„åŸŸåï¼Œéœ€è¦è§£æä¸€ä¸ªTXTè®°å½•åˆ°ä½ æäº¤çš„è¿™ä¸ªissueæ¥è¯æ˜ä½ æ˜¯è¿™ä¸ªåŸŸåçš„æŒæœ‰äººå³å¯ã€‚</p>\n<h1><span id=\"er-zhun-bei-gong-zuo\">äºŒã€å‡†å¤‡å·¥ä½œ</span><a href=\"#er-zhun-bei-gong-zuo\" class=\"header-anchor\">#</a></h1><p>ä¸ºäº†ç¡®ä¿ä¸­å¤®å­˜å‚¨åº“ä¸­å¯ç”¨ç»„ä»¶çš„è´¨é‡æ°´å¹³ï¼ŒOSSRHå¯¹æäº¤çš„æ–‡ä»¶æœ‰æ˜ç¡®çš„è¦æ±‚ã€‚</p>\n<p>ä¸€ä¸ªåŸºç¡€çš„æäº¤ï¼Œåº”è¯¥åŒ…å«ä¸€ä¸‹æ–‡ä»¶ï¼š</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">example</span>-application-<span class=\"number\">1</span>.<span class=\"number\">4</span>.<span class=\"number\">7</span>.pom</span><br><span class=\"line\"><span class=\"attribute\">example</span>-application-<span class=\"number\">1</span>.<span class=\"number\">4</span>.<span class=\"number\">7</span>.pom.asc</span><br><span class=\"line\"><span class=\"attribute\">example</span>-application-<span class=\"number\">1</span>.<span class=\"number\">4</span>.<span class=\"number\">7</span>.jar</span><br><span class=\"line\"><span class=\"attribute\">example</span>-application-<span class=\"number\">1</span>.<span class=\"number\">4</span>.<span class=\"number\">7</span>.jar.asc</span><br><span class=\"line\"><span class=\"attribute\">example</span>-application-<span class=\"number\">1</span>.<span class=\"number\">4</span>.<span class=\"number\">7</span>-sources.jar</span><br><span class=\"line\"><span class=\"attribute\">example</span>-application-<span class=\"number\">1</span>.<span class=\"number\">4</span>.<span class=\"number\">7</span>-sources.jar.asc</span><br><span class=\"line\"><span class=\"attribute\">example</span>-application-<span class=\"number\">1</span>.<span class=\"number\">4</span>.<span class=\"number\">7</span>-javadoc.jar</span><br><span class=\"line\"><span class=\"attribute\">example</span>-application-<span class=\"number\">1</span>.<span class=\"number\">4</span>.<span class=\"number\">7</span>-javadoc.jar.asc</span><br></pre></td></tr></table></figure>\n<p>é™¤äº†jaråŒ…å’Œpomæ–‡ä»¶ï¼ŒJavadocå’ŒSourcesæ˜¯å¿…é¡»çš„ï¼Œåé¢ä¼šè¯´åˆ°ç”¨Gradleçš„ä¸€äº›æ’ä»¶æ¥ç”Ÿæˆ<br>æ¯ä¸ªæ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„ascæ–‡ä»¶ï¼Œè¿™æ˜¯GPGç­¾åæ–‡ä»¶ï¼Œå¯ä»¥ç”¨äºæ ¡éªŒæ–‡ä»¶</p>\n<p><strong>GPG</strong><br>Windowsä¸‹å¦‚æœä½¿ç”¨äº†cmderé‚£ä¹ˆ,cmderå·²ç»é›†æˆäº†gpgå‘½ä»¤å·¥å…·</p>\n<p><strong>å…¬é’¥ã€ç§é’¥ã€ç­¾å</strong><br>GPGçš„é»˜è®¤ç§˜é’¥ç±»å‹æ˜¯RSAï¼Œè¿™é‡Œæ¶‰åŠæ¶‰åŠå‡ ä¸ªæ¦‚å¿µå…¬é’¥ï¼ˆpublic-keyï¼‰ã€ç§é’¥ï¼ˆsecret-keyï¼‰ã€ç­¾å(sign/signature)</p>\n<ul>\n<li>å…¬é’¥å’Œç§é’¥æ˜¯æˆå¯¹</li>\n<li>å…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯†ã€‚</li>\n<li>ç§é’¥ç­¾åï¼Œå…¬é’¥éªŒè¯ã€‚</li>\n</ul>\n<p><strong>æ–°å»ºä¸€ä¸ªå¯†é’¥</strong><br>ç”Ÿæˆäº†å¯†é’¥ä»¥åï¼Œæ‰èƒ½å¯¼å‡ºå…¬é’¥ã€ç§é’¥</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gpg --generate-key</span><br></pre></td></tr></table></figure>\n<p>åˆ›å»ºçš„æ—¶å€™ï¼Œä¼šè®©ä½ è¾“å…¥å¯†ç ï¼Œåˆ«è¾“äº†ä»¥åå¿˜è®°äº†ï¼Œåé¢gradleæ’ä»¶ä¸­ä¼šç”¨åˆ°ã€‚</p>\n<p><strong>æŸ¥çœ‹å·²ç»ç”Ÿæˆçš„å¯†é’¥</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gpg -k</span><br></pre></td></tr></table></figure>\n<p><img src=\"4.png\" alt=\"4\"></p>\n<ul>\n<li>pubä¸‹é¢ç¬¬äºŒè¡Œ, 936DDBCE5B649E51D37464283F199C01AE4240A5ï¼Œè¿™ä¸ªå«åšå¯†é’¥æŒ‡çº¹(åº”è¯¥æ˜¯ç”¨æ¥åšå”¯ä¸€è¯†åˆ«)</li>\n<li>åé¢8ä½DF855F85,å«åšæ ‡è¯†æˆ–KEY IDï¼Œåœ¨åé¢éœ€è¦åŠ åˆ°Gradleæ’ä»¶é…ç½®ä¸­</li>\n</ul>\n<p><strong>å¯¼å‡ºç§é’¥æ–‡ä»¶</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gpg --export-secret-keys [å¯†é’¥æŒ‡çº¹] &gt; secret.gpg</span><br></pre></td></tr></table></figure>\n<p>ä»¥ä¸Šå‘½ä»¤å°±å¯ä»¥ç”Ÿæˆä¸€ä¸ªäºŒè¿›åˆ¶çš„ç§é’¥æ–‡ä»¶ï¼Œåé¢éœ€è¦é…ç½®åˆ°gradleä¸­ï¼Œè®©æ’ä»¶å¸®æˆ‘ä»¬ç»™æ–‡ä»¶æ‰¹é‡ç­¾å</p>\n<p>åŠ ä¸Š-aä¼šç”Ÿæˆä¸€ä¸ªç”¨ASCII å­—ç¬¦å°è£…çš„æ–‡æœ¬æ–‡ä»¶ï¼Œæ–¹ä¾¿å¤åˆ¶,ä¸è¿‡æˆ‘ä»¬è¿™é‡Œä¸éœ€è¦</p>\n<p><strong>ä¸Šä¼ å…¬é’¥åˆ°å…¬é’¥æœåŠ¡å™¨</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gpg --keyserver keyserver.ubuntu.com --send-keys [å¯†é’¥æŒ‡çº¹]</span><br></pre></td></tr></table></figure>\n<p>åœ¨sonatypeçš„ä»“åº“æäº¤åï¼Œä¼šéœ€è¦ä¸€ä¸ªæ ¡éªŒæ­¥éª¤<br>ä¼šéœ€è¦ä»å¤šä¸ªå…¬é’¥æœåŠ¡å™¨ä¸Šä¸‹è½½åŒ¹é…çš„å…¬é’¥ï¼Œç„¶åæ¥æ ¡éªŒä½ ä¸Šä¼ çš„æ–‡ä»¶çš„ç­¾å</p>\n<p>ç®€å•çš„è¯´ï¼Œä½ ç”¨æ¥ç­¾åçš„ç§é’¥å’Œä½ ä¸Šä¼ çš„å…¬é’¥ï¼Œå¿…é¡»è¦ä¸€å¯¹ï¼Œè¿™æ ·æ‰èƒ½é€šè¿‡æ ¡éªŒ</p>\n<p>ä»¥ä¸‹æ˜¯sonatypeä¼šå»æ‹‰å–çš„å…¬é’¥æœåŠ¡å™¨åˆ—è¡¨</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">keys</span><span class=\"selector-class\">.gnupg</span><span class=\"selector-class\">.net</span></span><br><span class=\"line\"><span class=\"selector-tag\">pool</span><span class=\"selector-class\">.sks-keyservers</span><span class=\"selector-class\">.net</span></span><br><span class=\"line\"><span class=\"selector-tag\">keyserver</span><span class=\"selector-class\">.ubuntu</span><span class=\"selector-class\">.com</span></span><br></pre></td></tr></table></figure>\n<p>ä¸ºä»€ä¹ˆæˆ‘è¦ç‰¹æ„åˆ—å‡ºæ¥ï¼Ÿ<br>å› ä¸ºæœ‰äº›æ–‡ç« æˆ–æ•™ç¨‹é‡Œé¢ï¼Œéƒ½ä»…ç»™å‡ºäº†ä¸€ä¸ªæœåŠ¡å™¨ï¼Œå¦‚pool.sks-keyservers.net<br>ä½†æ˜¯ï¼Œæˆ‘åœ¨å®é™…æ“ä½œæœ‰æ—¶å€™å› ä¸ºç½‘ç»œåŸå› ï¼Œå¹¶ä¸æ˜¯æ€»èƒ½æˆåŠŸä¸Šä¼ ã€‚<br>æ‰€ä»¥ï¼Œå¦‚æœæŠŠå…¬é’¥ä¸Šä¼ åˆ°keyserver.ubuntu.comä¹Ÿæ˜¯OKçš„ã€‚</p>\n<p><strong>æ€»ç»“</strong></p>\n<ul>\n<li>å¯†é’¥çš„key id</li>\n<li>å¯†é’¥çš„password</li>\n<li>ç§é’¥çš„KeyRingFile</li>\n<li>å…¬é’¥ä¸Šä¼ åˆ°äº†å…¬é’¥æœåŠ¡å™¨<br>å‡†å¤‡å¥½äº†ä»¥ä¸Šå‡ é¡¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ’¸Gradleäº†</li>\n</ul>\n<h1><span id=\"san-bian-zhi-fa-bu-jiao-ben\">ä¸‰ã€ç¼–åˆ¶å‘å¸ƒè„šæœ¬</span><a href=\"#san-bian-zhi-fa-bu-jiao-ben\" class=\"header-anchor\">#</a></h1><p>ä¸»è¦ä¾èµ–äºä¸¤ä¸ªæ’ä»¶ï¼š</p>\n<ul>\n<li>signing</li>\n<li>maven-publish</li>\n</ul>\n<p>æ³¨: mavenæ’ä»¶å·²ç»è¿‡æ—¶</p>\n<p>ç¼–å†™å‘å¸ƒè„šæœ¬ï¼Œåœ¨å·¥ç¨‹ä¸‹æ–°å»ºã€‚<code>publish.gradle</code></p>\n<figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ext.<span class=\"string\">&#x27;signing.keyId&#x27;</span>=<span class=\"string\">&#x27;AE4240A5&#x27;</span></span><br><span class=\"line\">ext.<span class=\"string\">&#x27;signing.password&#x27;</span>=<span class=\"string\">&#x27;sai18109&#x27;</span></span><br><span class=\"line\">ext.<span class=\"string\">&#x27;signing.secretKeyRingFile&#x27;</span>=<span class=\"string\">&#x27;D:/keys/maven_publish_secret.gpg&#x27;</span></span><br><span class=\"line\">ext.ARTIFACTORY_USER=<span class=\"string\">&#x27;OSSRHç”¨æˆ·å&#x27;</span></span><br><span class=\"line\">ext.ARTIFACTORY_PASSWORD=<span class=\"string\">&#x27;OSSRHå¯†ç &#x27;</span></span><br><span class=\"line\">ext.ARTIFACTORY_CONTEXTURL=<span class=\"string\">&#x27;https://s01.oss.sonatype.org/service/local/staging/deploy/maven2/&#x27;</span></span><br><span class=\"line\">ext.LOCAL_ARTIFACTORY_USER=<span class=\"string\">&#x27;æœ¬åœ°ç§æœç”¨æˆ·å&#x27;</span></span><br><span class=\"line\">ext.LOCAL_ARTIFACTORY_PASSWORD=<span class=\"string\">&#x27;æœ¬åœ°ç§æœå¯†ç &#x27;</span></span><br><span class=\"line\">ext.LOCAL_ARTIFACTORY_CONTEXTURL=<span class=\"string\">&#x27;æœ¬åœ°åœ°å€&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//#GAV</span></span><br><span class=\"line\">ext.<span class=\"keyword\">GROUP</span>=<span class=\"string\">&#x27;org.pkaq&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//#é¡¹ç›®åœ°å€ç›¸å…³</span></span><br><span class=\"line\">ext.POM_URL=<span class=\"string\">&#x27;http://pkaq.org&#x27;</span></span><br><span class=\"line\">ext.POM_SCM_URL=<span class=\"string\">&#x27;é¡¹ç›®åœ°å€&#x27;</span></span><br><span class=\"line\">ext.POM_SCM_CONNECTION=<span class=\"string\">&#x27;é¡¹ç›®åœ°å€&#x27;</span></span><br><span class=\"line\">ext.POM_SCM_DEV_CONNECTION=<span class=\"string\">&#x27;é¡¹ç›®åœ°å€&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//#é¡¹ç›®ç›¸å…³ä¿¡æ¯</span></span><br><span class=\"line\">ext.GIT_URL=<span class=\"string\">&#x27;é¡¹ç›®gitåœ°å€&#x27;</span></span><br><span class=\"line\">ext.ISSUE_URL=<span class=\"string\">&#x27;issueæäº¤åœ°å€&#x27;</span></span><br><span class=\"line\">ext.POM_PACKAGING=<span class=\"string\">&#x27;jar&#x27;</span></span><br><span class=\"line\">ext.POM_DESCRIPTION=<span class=\"string\">&#x27;é¡¹ç›®æè¿°&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//#å¼€æºåè®®</span></span><br><span class=\"line\">ext.POM_LICENCE_NAME=<span class=\"string\">&#x27;The Apache Software License, Version 2.0&#x27;</span></span><br><span class=\"line\">ext.POM_LICENCE_URL=<span class=\"string\">&#x27;http://www.apache.org/licenses/LICENSE-2.0.txt&#x27;</span></span><br><span class=\"line\">ext.POM_LICENCE_DIST=<span class=\"string\">&#x27;repo&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//#å¼€å‘è€…ä¿¡æ¯</span></span><br><span class=\"line\">ext.POM_DEVELOPER_ID=<span class=\"string\">&#x27;PKAQ&#x27;</span></span><br><span class=\"line\">ext.POM_DEVELOPER_NAME=<span class=\"string\">&#x27;å¼€å‘è€…åç§°&#x27;</span></span><br><span class=\"line\">ext.POM_DEVELOPER_EMAIL=<span class=\"string\">&#x27;pkaq@msn.com&#x27;</span></span><br><span class=\"line\">ext.POM_DEVELOPER_URL=<span class=\"string\">&#x27;http://pkaq.org&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">task</span> sourcesJar(type: Jar) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">from</span> <span class=\"keyword\">sourceSets</span>.main.allJava</span><br><span class=\"line\">    archiveClassifier = <span class=\"string\">&#x27;sources&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">task</span> javadocJar(type: Jar) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">from</span> javadoc</span><br><span class=\"line\">    archiveClassifier = <span class=\"string\">&#x27;javadoc&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">javadoc &#123;</span><br><span class=\"line\">    <span class=\"keyword\">options</span> &#123;</span><br><span class=\"line\">        encoding <span class=\"string\">&quot;UTF-8&quot;</span></span><br><span class=\"line\">        charSet <span class=\"string\">&#x27;UTF-8&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(JavaVersion.current().isJava9Compatible()) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">options</span>.addBooleanOption(<span class=\"string\">&#x27;html5&#x27;</span>, <span class=\"keyword\">true</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">publishing &#123;</span><br><span class=\"line\">    publications &#123;</span><br><span class=\"line\">        mavenJava(MavenPublication) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">from</span> components.java</span><br><span class=\"line\">            <span class=\"comment\">// groupId,artifactId,versionï¼Œå¦‚æœä¸å®šä¹‰ï¼Œåˆ™ä¼šæŒ‰ç…§ä»¥ä¸Šé»˜è®¤å€¼æ‰§è¡Œ</span></span><br><span class=\"line\">            <span class=\"comment\">// groupId å¿…é¡»äºmaven repoç”³è¯·çš„group Idä¸€è‡´</span></span><br><span class=\"line\">            groupId <span class=\"keyword\">GROUP</span></span><br><span class=\"line\">\t\t\t</span><br><span class=\"line\">\t\t\tafterEvaluate &#123;</span><br><span class=\"line\">\t\t\t\tartifactId <span class=\"keyword\">project</span>.archivesBaseName</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\tartifact sourcesJar</span><br><span class=\"line\">            artifact javadocJar</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\tpom &#123;</span><br><span class=\"line\">                name = artifactId</span><br><span class=\"line\">                <span class=\"keyword\">description</span> = provider &#123; <span class=\"keyword\">project</span>.<span class=\"keyword\">description</span> &#125;</span><br><span class=\"line\">                url = POM_URL</span><br><span class=\"line\">                <span class=\"comment\">// è®¸å¯è¯</span></span><br><span class=\"line\">                licenses &#123;</span><br><span class=\"line\">                    license &#123;</span><br><span class=\"line\">                        name = POM_LICENCE_NAME</span><br><span class=\"line\">                        url = POM_LICENCE_URL</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">// å¼€å‘è€…ä¿¡æ¯</span></span><br><span class=\"line\">                developers &#123;</span><br><span class=\"line\">                    developer &#123;</span><br><span class=\"line\">                        id = POM_DEVELOPER_ID</span><br><span class=\"line\">                        name = POM_DEVELOPER_NAME</span><br><span class=\"line\">                        email = POM_DEVELOPER_EMAIL</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">// ç‰ˆæœ¬æ§åˆ¶ä»“åº“åœ°å€</span></span><br><span class=\"line\">                scm &#123;</span><br><span class=\"line\">                    connection = POM_SCM_CONNECTION</span><br><span class=\"line\">                    developerConnection = POM_SCM_DEV_CONNECTION</span><br><span class=\"line\">                    url = POM_SCM_URL</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;\t\t        \t\t</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// å®šä¹‰å‘å¸ƒåˆ°å“ªé‡Œ</span></span><br><span class=\"line\">\t<span class=\"keyword\">repositories</span> &#123;</span><br><span class=\"line\">        maven &#123;</span><br><span class=\"line\">           url = ARTIFACTORY_CONTEXTURL</span><br><span class=\"line\">            <span class=\"comment\">// è¿™é‡Œå°±æ˜¯ä¹‹å‰åœ¨issues.sonatype.orgæ³¨å†Œçš„è´¦å·</span></span><br><span class=\"line\">            credentials &#123;</span><br><span class=\"line\">                username ARTIFACTORY_USER</span><br><span class=\"line\">                password ARTIFACTORY_PASSWORD</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// æœ¬åœ°ç§æœ</span></span><br><span class=\"line\"><span class=\"comment\">//        maven &#123;</span></span><br><span class=\"line\"><span class=\"comment\">//            name &quot;local&quot;</span></span><br><span class=\"line\"><span class=\"comment\">//            url = LOCAL_ARTIFACTORY_CONTEXTURL</span></span><br><span class=\"line\"><span class=\"comment\">//            allowInsecureProtocol = true</span></span><br><span class=\"line\"><span class=\"comment\">//            credentials &#123;</span></span><br><span class=\"line\"><span class=\"comment\">//                username LOCAL_ARTIFACTORY_USER</span></span><br><span class=\"line\"><span class=\"comment\">//                password LOCAL_ARTIFACTORY_PASSWORD</span></span><br><span class=\"line\"><span class=\"comment\">//            &#125;</span></span><br><span class=\"line\"><span class=\"comment\">//        &#125;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">signing &#123;</span><br><span class=\"line\">    sign publishing.publications</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>åœ¨<code>build.gradle</code>ä¸­å¼•å…¥å‘å¸ƒè„šæœ¬</p>\n<figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># ç”±äºpublish.gradleä¸­æœ‰è¯¸å¤šæ•æ„Ÿä¿¡æ¯,ä¸å»ºè®®æäº¤æ­¤æ–‡ä»¶,ä¸ºäº†é˜²æ­¢å…¶ä»–äººæŠ¥é”™,è¿™é‡Œå¯ä»¥å†™ä¸€ä¸ªåˆ¤æ–­.</span><br><span class=\"line\"># å¦‚æœä¸€å®šè¦æäº¤ä¹Ÿå¯ä»¥å°†æ•æ„Ÿä¿¡æ¯å­˜å‚¨åˆ°ç¯å¢ƒå˜é‡ä¸­,ç”±ç¯å¢ƒå˜é‡è·å–</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">project</span>.<span class=\"keyword\">file</span>(<span class=\"string\">&#x27;publish.gradle&#x27;</span>).exists()) &#123;</span><br><span class=\"line\">    apply <span class=\"keyword\">from</span>: <span class=\"string\">&#x27;publish.gradle&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1><span id=\"si-gou-jian-shang-chuan\">å››ã€æ„ä»¶ä¸Šä¼ </span><a href=\"#si-gou-jian-shang-chuan\" class=\"header-anchor\">#</a></h1><p>é¦–å…ˆï¼Œç”¨Gradleæ‰§è¡ŒpublishToMavenLocalä»»åŠ¡ï¼Œå…ˆåœ¨æœ¬åœ°å‘å¸ƒä¸‹ï¼Œçœ‹çœ‹ç”Ÿæˆäº†å“ªäº›æ–‡ä»¶ï¼Œæˆ–è¿˜æœ‰ä»€ä¹ˆé—®é¢˜</p>\n<p>ç„¶åï¼Œç”¨Gradleæ‰§è¡Œpublishä»»åŠ¡ï¼Œå‘å¸ƒåˆ°æŒ‡å®šçš„mavenä»“åº“</p>\n<p>å¦‚æœæ²¡æœ‰æŠ¥é”™ï¼Œé‚£ä¹ˆæ­å–œä½ ï¼Œå·²ç»æˆåŠŸæäº¤åˆ°äº†sonatypeçš„ä»“åº“ä¸­</p>\n<p>ä½†æ˜¯æäº¤æˆåŠŸï¼Œå¹¶ä¸ä»£è¡¨å‘å¸ƒæˆåŠŸ, ä¸Šä¼ å®Œæˆåå»ä½ ä¹‹å‰æçš„ ISSUE ä¸­å›å¤ä¸€ä¸‹å®˜æ–¹äººå‘˜ å‘Šè¯‰ä»–ä½ å·²ç»ä¸Šä¼ å¥½äº†, ä¹‹åä»–ä¼šç»™ä½ å®¡æ ¸,å¹¶ä¸”å‘Šè¯‰ä½ ä¸€ä¸ªåœ°å€</p>\n<figure class=\"highlight livecodeserver\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">I have already completed <span class=\"keyword\">the</span> <span class=\"keyword\">first</span> release.</span><br></pre></td></tr></table></figure>\n<h1><span id=\"wu-gou-jian-fa-bu\">äº”ã€æ„ä»¶å‘å¸ƒ</span><a href=\"#wu-gou-jian-fa-bu\" class=\"header-anchor\">#</a></h1><p>ç”¨ä½ ä¹‹å‰æ³¨å†Œçš„è´¦å·å¯†ç ï¼Œç™»å½•å®˜æ–¹äººå‘˜ç»™ä½ çš„å›å¤é‡Œçš„åœ°å€<br><img src=\"5.png\" alt=\"5\"><br>ç™»å½•åæŸ¥çœ‹å·¦ä¾§çš„Build Promotion-&gt;Staging Repositories</p>\n<p>ä½ çš„æäº¤ï¼Œä¼šå‡ºç°åœ¨æœ€ä¸‹é¢. Staging Repositories ä¸­ğŸ˜‚<br><img src=\"6.png\" alt=\"6\"></p>\n<p><strong>Close</strong><br>ä½ çš„æäº¤åœ¨æœªå¤„ç†å‰ï¼Œæ˜¯opençŠ¶æ€ï¼Œç„¶åç‚¹å‡»CloseæŒ‰é’®ã€‚</p>\n<p>ä¸€å¼€å§‹ä¸å¤ªæ˜ç™½è¿™ä¸ªCloseæ˜¯å•¥æ„æ€ï¼Œåæ¥çœ‹äº†ä¸‹ï¼Œä¸»è¦æŒ‰ç…§ä¸­å¤®ä»“åº“çš„è¦æ±‚æ¥éªŒè¯ä¸‹ä½ ä¸Šä¼ åˆ°æ–‡ä»¶<br>ç­¾åå°±æ˜¯å…¶ä¸­ä¸€ä¸ªæ­¥éª¤ï¼Œä¼šå»å…¬é’¥æœåŠ¡å™¨æ‹‰å–å…¬é’¥ï¼Œç„¶åæ¥éªŒè¯ä½ æ‰€æœ‰çš„æ–‡ä»¶<br>éœ€è¦ç­‰å¾…ä¸€ä¼šï¼Œç­‰å®ƒæ‰§è¡Œå®Œæ¯•ï¼ŒçŠ¶æ€ä¼šä»openå˜æˆclosed</p>\n<p>å¦‚æœç¢°åˆ°é”™è¯¯çš„è¯ï¼Œä»”ç»†çœ‹ä¸‹Activityé€‰é¡¹å¡ï¼Œæ‰§è¡Œäº†ä»€ä¹ˆæ­¥éª¤ï¼Œé‚£ä¸ªæ­¥éª¤å‡ºç°äº†ä»€ä¹ˆé”™è¯¯ï¼Œå¾ˆæ¸…æ™°çš„<br><strong>Release</strong><br>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ„Ÿè§‰å¦‚æœé¡ºåˆ©closeåï¼Œå†æ¬¡é€‰ä¸­ç‚¹å‡»Releaseï¼Œè€å¿ƒç­‰å¾…ä¸€ä¼šï¼Œå°±å¤§åŠŸå‘Šæˆäº†ï¼</p>\n<p>å¯ä»¥åœ¨ä¾§è¾¹æ Artifact Searchä¸­æœç´¢ä¸‹ä½ çš„groupIdï¼Œæ­¤æ—¶åº”è¯¥èƒ½çœ‹åˆ°å¯¹åº”çš„æ„ä»¶åç§°å’Œç‰ˆæœ¬äº†</p>\n<h1><span id=\"liu-chang-jian-wen-ti\">å…­ã€å¸¸è§é—®é¢˜</span><a href=\"#liu-chang-jian-wen-ti\" class=\"header-anchor\">#</a></h1><p>å¦‚æœä¸æƒ³è®©æŸä¸ªæ¨¡å—å‚ä¸å‘å¸ƒï¼Œå¯ä»¥æ·»åŠ å¦‚ä¸‹ä»£ç </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">project.tasks.publish.enabled = <span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>","categories":["Gradle"],"tags":["Gradle","Maven"]},{"title":"ä½¿ç”¨Dockeræ­å»ºåŸºäºå®˜æ–¹é•œåƒçš„Oracle 12c","url":"https://pkaq.org/2021/05/07/oracle12c/","content":"<h1><span id=\"qian-qi-zhun-bei\">å‰æœŸå‡†å¤‡</span><a href=\"#qian-qi-zhun-bei\" class=\"header-anchor\">#</a></h1><p>â€‹    ç”±äºè·å–å®˜æ–¹é•œåƒéœ€è¦ç™»å½•ï¼Œé¦–å…ˆè¦å»hub.docker.comæ³¨å†Œä¸€ä¸ªdocker hubè´¦å·ï¼Œæ³¨å†Œååœ¨å‘½ä»¤è¡Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œç™»å½•ã€‚<br>â€‹    </p>\n<h1><span id=\"huo-qu-jing-xiang\">è·å–é•œåƒ</span><a href=\"#huo-qu-jing-xiang\" class=\"header-anchor\">#</a></h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ä½¿ç”¨åˆšæ‰æ³¨å†Œå¾—ç”¨æˆ·åå¯†ç ç™»å½•</span></span><br><span class=\"line\">docker login</span><br><span class=\"line\"><span class=\"comment\"># æ‹‰å–é•œåƒ</span></span><br><span class=\"line\">docker pull store/oracle/database-enterprise:12.2.0.1-slim</span><br></pre></td></tr></table></figure>\n<p>å®˜æ–¹é•œåƒåˆ†äº†ä¸¤ä¸ªç‰ˆæœ¬ï¼Œå…¶ä¸­ä¸€ä¸ªslimç‰ˆæœ¬æ˜¯ç²¾ç®€ç‰ˆã€‚ç²¾ç®€ç‰ˆä¸åŒ…å« : Analytics, Oracle R, Oracle Label Security, Oracle Text, Oracle Application Express and Oracle DataVault. </p>\n<h1><span id=\"an-zhuang\">å®‰è£…</span><a href=\"#an-zhuang\" class=\"header-anchor\">#</a></h1><ol>\n<li><strong>åˆ›å»ºå®¿ä¸»æœºæ˜ å°„ç›®å½•</strong><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir /opt/data/oradata </span><br></pre></td></tr></table></figure></li>\n<li><strong>åˆ›å»ºå¹¶å¯åŠ¨oracleæ•°æ®åº“</strong><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d --name 12c </span><br><span class=\"line\">-e DB_SID=orcl </span><br><span class=\"line\">-e DB_PDB=pdb </span><br><span class=\"line\">-e WEB_CONSOLE=<span class=\"literal\">false</span> </span><br><span class=\"line\">-e ORACLE_CHARACTERSET=ZHS16GBK </span><br><span class=\"line\">--privileged=<span class=\"literal\">true</span> </span><br><span class=\"line\">-v /opt/data/oradata:/ORCL \\ </span><br><span class=\"line\">-v /etc/localtime:/etc/localtime:ro\\</span><br><span class=\"line\">-p 15210:1521 </span><br><span class=\"line\">store/oracle/database-enterprise:12.2.0.1-slim</span><br></pre></td></tr></table></figure>\nå‘½ä»¤è§£é‡Š<br> -dï¼šåˆ›å»ºåä»¥å®ˆæŠ¤è¿›ç¨‹è¿è¡Œ<br> â€“restart=alwaysï¼š å½“Â dockerÂ é‡å¯æ—¶,å®¹å™¨è‡ªåŠ¨å¯åŠ¨<br> â€“privilegedï¼šè·å–å®¿ä¸»æœºrootæƒé™<br> -vï¼šå°†å®¿ä¸»æœºçš„/opt/data/oradataæ˜ å°„åˆ°å®¹å™¨å†…çš„/u01/app/oracleç›®å½•<br> -eï¼šæŒ‡å®šå®¹å™¨å†…ç¯å¢ƒå˜é‡<br> -pï¼šæŒ‡å®šå®¿ä¸»æœºçš„ 15210 ç«¯å£ æ˜ å°„åˆ°å®¹å™¨å†…çš„ 1521 ç«¯å£   </li>\n</ol>\n<ol start=\"3\">\n<li><strong>è¿æ¥æµ‹è¯•</strong><br>æ•°æ®åº“å®‰è£…æˆåŠŸåä½¿ç”¨å®¢æˆ·ç«¯å·¥å…·ï¼Œç”¨åˆå§‹åˆ›å»ºçš„ç”¨æˆ·å/å¯†ç ç™»å½•è¿›è¡Œè¿æ¥æµ‹è¯•ã€‚<br>ç”¨æˆ·åï¼šsys<br>å¯†ç ï¼šOradoc_db1<br>SID:  orcl</li>\n</ol>\n<h1><span id=\"fu-1-xiu-gai-zi-fu-ji\">é™„1.ä¿®æ”¹å­—ç¬¦é›†</span><a href=\"#fu-1-xiu-gai-zi-fu-ji\" class=\"header-anchor\">#</a></h1><p>1.è¿æ¥æµ‹è¯•</p>\n<p>ä½¿ç”¨å®¢æˆ·ç«¯å·¥å…·æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹å½“å‰å­—ç¬¦é›†é…ç½®ã€‚NLS_CHARACTERSETå‚æ•°ä¸ºå½“å‰å­—ç¬¦é›†è®¾ç½®ã€‚</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from v<span class=\"variable\">$nls_parameters</span>;</span><br></pre></td></tr></table></figure>\n<p>2.è¿›å…¥å®¹å™¨</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker <span class=\"built_in\">exec</span> -it 12c /bin/bash</span><br></pre></td></tr></table></figure>\n<p>3.å­—ç¬¦é›†ä¿®æ”¹</p>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># è¿æ¥æ•°æ®åº“</span><br><span class=\"line\">sqlplus /nolog</span><br><span class=\"line\"># ç™»å½•</span><br><span class=\"line\">conn /<span class=\"keyword\">as</span> sysdba</span><br><span class=\"line\"><span class=\"keyword\">SQL</span>&gt;shutdown <span class=\"keyword\">immediate</span>;  </span><br><span class=\"line\"><span class=\"keyword\">SQL</span>&gt;startup mount</span><br><span class=\"line\"><span class=\"keyword\">SQL</span>&gt;<span class=\"keyword\">ALTER</span>  <span class=\"keyword\">SYSTEM</span>  <span class=\"keyword\">ENABLE</span>  RESTRICTED  <span class=\"keyword\">SESSION</span>;  </span><br><span class=\"line\"><span class=\"keyword\">SQL</span>&gt;<span class=\"keyword\">ALTER</span>  <span class=\"keyword\">SYSTEM</span>  <span class=\"keyword\">SET</span>  JOB_QUEUE_PROCESSES=<span class=\"number\">0</span>;  </span><br><span class=\"line\"><span class=\"keyword\">SQL</span>&gt;<span class=\"keyword\">ALTER</span>  <span class=\"keyword\">SYSTEM</span>  <span class=\"keyword\">SET</span>  AQ_TM_PROCESSES=<span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">SQL</span>&gt;<span class=\"keyword\">alter</span> <span class=\"keyword\">database</span> <span class=\"keyword\">open</span>;  </span><br><span class=\"line\"><span class=\"keyword\">SQL</span>&gt;<span class=\"keyword\">ALTER</span> <span class=\"keyword\">DATABASE</span> <span class=\"type\">CHARACTER</span> <span class=\"keyword\">SET</span> ZHS16GBK;</span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">DATABASE</span> <span class=\"type\">CHARACTER</span> <span class=\"keyword\">SET</span> ZHS16GBK  ERROR at <span class=\"type\">line</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">ORA<span class=\"number\">-12712</span>: <span class=\"built_in\">new</span> <span class=\"type\">character</span> <span class=\"keyword\">set</span> must be a superset <span class=\"keyword\">of</span> <span class=\"built_in\">old</span> <span class=\"type\">character</span> <span class=\"keyword\">set</span></span><br><span class=\"line\">æç¤ºæˆ‘ä»¬çš„å­—ç¬¦é›†ï¼šæ–°å­—ç¬¦é›†å¿…é¡»ä¸ºæ—§å­—ç¬¦é›†çš„è¶…é›†ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥è·³è¿‡è¶…é›†çš„æ£€æŸ¥åšæ›´æ”¹ï¼š</span><br><span class=\"line\">å¤åˆ¶ä»£ç  ä»£ç å¦‚ä¸‹:</span><br><span class=\"line\"><span class=\"keyword\">SQL</span>&gt;<span class=\"keyword\">ALTER</span> <span class=\"keyword\">DATABASE</span> <span class=\"type\">character</span> <span class=\"keyword\">set</span> INTERNAL_USE ZHS16GBK;  </span><br><span class=\"line\"><span class=\"keyword\">SQL</span>&gt;<span class=\"keyword\">select</span> * <span class=\"keyword\">from</span> v$nls_parameters; </span><br><span class=\"line\">é‡å¯æ£€æŸ¥æ˜¯å¦æ›´æ”¹å®Œæˆï¼š</span><br><span class=\"line\">å¤åˆ¶ä»£ç  ä»£ç å¦‚ä¸‹:</span><br><span class=\"line\"><span class=\"keyword\">SQL</span>&gt;shutdown <span class=\"keyword\">immediate</span>;</span><br><span class=\"line\"><span class=\"keyword\">SQL</span>&gt;startup</span><br><span class=\"line\"><span class=\"keyword\">SQL</span>&gt;<span class=\"keyword\">select</span> * <span class=\"keyword\">from</span> v$nls_parameters;</span><br></pre></td></tr></table></figure>","categories":["Database"],"tags":["SSO","Oracle"]},{"title":"ä½¿ç”¨cas-overlay-templateæ­å»ºCASæœåŠ¡","url":"https://pkaq.org/2020/05/07/cas-overlay-template/","content":"<h1><span id=\"gai-shu\">æ¦‚è¿°</span><a href=\"#gai-shu\" class=\"header-anchor\">#</a></h1><p>  å•ç‚¹ç™»å½•çš„è‹±æ–‡åç§°ä¸ºSingle Sign-Onï¼Œç®€å†™ä¸ºSSOï¼Œå®ƒæ˜¯ä¸€ä¸ªç”¨æˆ·è®¤è¯çš„è¿‡ç¨‹ï¼Œå…è®¸ç”¨æˆ·ä¸€æ¬¡æ€§è¿›è¡Œè®¤è¯ä¹‹åï¼Œå°±è®¿é—®ç³»ç»Ÿä¸­ä¸åŒçš„åº”ç”¨ï¼›è€Œä¸éœ€è¦è®¿é—®æ¯ä¸ªåº”ç”¨æ—¶ï¼Œéƒ½é‡æ–°è¾“å…¥å¯†ç ã€‚</p>\n<ul>\n<li>ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®å—ä¿æŠ¤çš„åº”ç”¨ï¼Œå°†ä¼šé‡å®šå‘åˆ°casç™»å½•é¡µé¢</li>\n<li>ç”¨æˆ·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œcas server è®¤è¯ç”¨æˆ·åˆ›å»ºsso session,å¹¶ç”ŸæˆTGTå’Œæ”¹å®¢æˆ·ç«¯çš„æœåŠ¡ç¥¨æ®ï¼ˆSTï¼‰</li>\n<li>åº”ç”¨æ‹¿ç€STåˆ° CAS æœåŠ¡éªŒè¯ST,éªŒè¯é€šè¿‡åè®¾ç½®sessionå’Œcookieè¿”å›æµè§ˆå™¨</li>\n<li>ç”¨æˆ·æµè§ˆå™¨æºå¸¦cookieè®¿é—®ï¼Œåº”ç”¨éªŒè¯åè¿”å›å†…å®¹</li>\n<li>è®¿é—®ç¬¬äºŒä¸ªcas client åº”ç”¨ï¼Œæ­¤æ—¶cookieä¸­æœ‰TGTä½†æ˜¯æ²¡æœ‰STï¼Œåº”ç”¨è¦æ±‚å»CAS æœåŠ¡è·å–ST,cas æœåŠ¡éªŒè¯TGTå¹¶ç”Ÿæˆä¸€ä¸ªST</li>\n<li>å®¢æˆ·ç«¯æºå¸¦STè®¿é—®åº”ç”¨ï¼Œåº”ç”¨æœåŠ¡åŒºCas server éªŒè¯ticket,éªŒè¯æˆåŠŸåè®¾ç½®session,cookie,é‡å®šå‘åˆ°åº”ç”¨æœåŠ¡åœ°å€<br>å±•ç¤ºç¬¬äºŒä¸ªåº”ç”¨çš„å†…å®¹</li>\n</ul>\n<p><img src=\"0.jpg\" alt=\"0\"></p>\n<h1><span id=\"kuai-su-kai-shi\">å¿«é€Ÿå¼€å§‹</span><a href=\"#kuai-su-kai-shi\" class=\"header-anchor\">#</a></h1><p>git clone <a href=\"https://github.com/apereo/cas-overlay-template.git\">https://github.com/apereo/cas-overlay-template.git</a></p>\n<p>æ‰§è¡Œ./gradlew.bat clean build  ç¬¬ä¸€æ¬¡æ„å»ºæ¯”è¾ƒæ…¢ï¼Œè€å¿ƒç­‰å¾…<br>./gradlew.bat explodeWar è§£å‹<br>æ­¤æ—¶å°†ä¼šåœ¨bulidç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªcas-resources æ–‡ä»¶å¤¹ï¼Œæˆ‘ä»¬æŠŠé‡Œé¢çš„æ–‡ä»¶å…¨éƒ¨æ‹·è´åˆ°src/main/resources,å°†\\etc\\cas\\thekeystore ä¹Ÿæ‹·è´åˆ°è¯¥ç›®å½•ä¸‹</p>\n<p>æ›´æ”¹é…ç½®application.properties    server.ssl.key-store=classpath:thekeystore </p>\n<p>./gradlew.bat run å°†casè¿è¡Œåœ¨å†…åµŒçš„ Embedded Tomcat ä¸­</p>\n<p>å¯åŠ¨å®Œæˆåæµè§ˆå™¨ä¸­æ‰“å¼€ <a href=\"https://localhost:8443/cas/login\">https://localhost:8443/cas/login</a> </p>\n<p><img src=\"1.png\" alt=\"1\"></p>\n<p>æ­¤æ—¶æˆ‘ä»¬çš„caså·²ç»éƒ¨ç½²æˆåŠŸ åœ¨ç™»å½•ä¹Ÿé¢è¾“å…¥ç”¨æˆ·åå’Œå¯†ç  casuser Mellon ,å‡ºç°ä¸‹é¢ç•Œé¢è¡¨æ˜caså·²ç»éƒ¨ç½²æˆåŠŸ</p>\n<p><img src=\"2.png\" alt=\"2\"></p>\n","categories":["SSO"],"tags":["CAS","SSO"]},{"title":"åŸºäº TrueLicense çš„é¡¹ç›®è¯ä¹¦éªŒè¯","url":"https://pkaq.org/2020/02/13/truelicense/","content":"<h2><span id=\"yi-jian-shu\">ä¸€ã€ç®€è¿°</span><a href=\"#yi-jian-shu\" class=\"header-anchor\">#</a></h2><p>å¼€å‘çš„è½¯ä»¶äº§å“åœ¨äº¤ä»˜ä½¿ç”¨çš„æ—¶å€™ï¼Œå¾€å¾€æœ‰ä¸€æ®µæ—¶é—´çš„è¯•ç”¨æœŸï¼Œè¿™æœŸé—´æˆ‘ä»¬ä¸å¸Œæœ›è‡ªå·±çš„ä»£ç è¢«å®¢æˆ·äºŒæ¬¡æ‹·è´ï¼Œè¿™ä¸ªæ—¶å€™ license å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œlicense çš„åŠŸèƒ½åŒ…æ‹¬è®¾å®šæœ‰æ•ˆæœŸã€ç»‘å®š ipã€ç»‘å®š mac ç­‰ã€‚æˆæƒæ–¹ç›´æ¥ç”Ÿæˆä¸€ä¸ª license ç»™ä½¿ç”¨æ–¹ä½¿ç”¨ï¼Œå¦‚æœéœ€è¦å»¶é•¿è¯•ç”¨æœŸï¼Œä¹Ÿåªéœ€è¦é‡æ–°ç”Ÿæˆä¸€ä»½ license å³å¯ï¼Œæ— éœ€æ‰‹åŠ¨ä¿®æ”¹æºä»£ç ã€‚</p>\n<p>TrueLicense æ˜¯ä¸€ä¸ªå¼€æºçš„è¯ä¹¦ç®¡ç†å¼•æ“ï¼Œè¯¦ç»†ä»‹ç»è§ <a href=\"https://truelicense.java.net/\">https://truelicense.java.net/</a></p>\n<p>é¦–å…ˆä»‹ç»ä¸‹ license æˆæƒæœºåˆ¶çš„åŸç†ï¼š</p>\n<ol>\n<li>ç”Ÿæˆå¯†é’¥å¯¹ï¼ŒåŒ…å«ç§é’¥å’Œå…¬é’¥ã€‚</li>\n<li>æˆæƒè€…ä¿ç•™ç§é’¥ï¼Œä½¿ç”¨ç§é’¥å¯¹æˆæƒä¿¡æ¯è¯¸å¦‚ä½¿ç”¨æˆªæ­¢æ—¥æœŸï¼Œmac åœ°å€ç­‰å†…å®¹ç”Ÿæˆ license ç­¾åè¯ä¹¦ã€‚</li>\n<li>å…¬é’¥ç»™ä½¿ç”¨è€…ï¼Œæ”¾åœ¨ä»£ç ä¸­ä½¿ç”¨ï¼Œç”¨äºéªŒè¯ license ç­¾åè¯ä¹¦æ˜¯å¦ç¬¦åˆä½¿ç”¨æ¡ä»¶ã€‚</li>\n</ol>\n<a id=\"more\"></a>\n<h2><span id=\"er-sheng-cheng-mi-yao-dui\">äºŒã€ç”Ÿæˆå¯†é’¥å¯¹</span><a href=\"#er-sheng-cheng-mi-yao-dui\" class=\"header-anchor\">#</a></h2><p>ä»¥ä¸‹å‘½ä»¤åœ¨ window cmd å‘½ä»¤çª—å£æ‰§è¡Œï¼Œæ³¨æ„å½“å‰æ‰§è¡Œç›®å½•ï¼Œæœ€åç”Ÿæˆçš„å¯†é’¥å¯¹å³åœ¨è¯¥ç›®å½•ä¸‹ï¼š<br>1ã€é¦–å…ˆè¦ç”¨ KeyTool å·¥å…·æ¥ç”Ÿæˆç§åŒ™åº“ï¼šï¼ˆ-aliasåˆ«å -validity 3650 è¡¨ç¤º10å¹´æœ‰æ•ˆï¼‰</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">keytool -genkey -<span class=\"built_in\">alias</span> privatekey -keysize 1024 -keystore privateKeys.store -validity 3650</span><br></pre></td></tr></table></figure>\n<p>2ã€ç„¶åæŠŠç§åŒ™åº“å†…çš„è¯ä¹¦å¯¼å‡ºåˆ°ä¸€ä¸ªæ–‡ä»¶å½“ä¸­</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">keytool -<span class=\"built_in\">export</span> -<span class=\"built_in\">alias</span> privatekey -file certfile.cer -keystore privateKeys.store</span><br></pre></td></tr></table></figure>\n<p>3ã€ç„¶åå†æŠŠè¿™ä¸ªè¯ä¹¦æ–‡ä»¶å¯¼å…¥åˆ°å…¬åŒ™åº“</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">keytool -import -<span class=\"built_in\">alias</span> publiccert -file certfile.cer -keystore publicCerts.store</span><br></pre></td></tr></table></figure>\n<p>æœ€åç”Ÿæˆçš„æ–‡ä»¶ privateKeys.storeï¼ˆç§é’¥ï¼‰ã€publicCerts.storeï¼ˆå…¬é’¥ï¼‰æ‹·è´å‡ºæ¥å¤‡ç”¨ã€‚</p>\n<h2><span id=\"san-zhun-bei-gong-zuo\">ä¸‰ã€å‡†å¤‡å·¥ä½œ</span><a href=\"#san-zhun-bei-gong-zuo\" class=\"header-anchor\">#</a></h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ truelicense çš„ jar åŒ…ï¼Œç”¨äºå®ç°æˆ‘ä»¬çš„è¯ä¹¦ç®¡ç†ã€‚</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">implementation  <span class=\"string\">&quot;cn.hutool:hutool-all:$&#123;hutool&#125;&quot;</span>,</span><br><span class=\"line\">                   <span class=\"string\">&quot;de.schlichtherle.truelicense:truelicense-core:1.33&quot;</span></span><br></pre></td></tr></table></figure>\n<p>ç„¶åï¼Œæˆ‘ä»¬å»ºç«‹ä¸€ä¸ªå•ä¾‹æ¨¡å¼ä¸‹çš„è¯ä¹¦ç®¡ç†å™¨ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LicenseManagerHolder</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">volatile</span> LicenseManager licenseManager = <span class=\"keyword\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">LicenseManagerHolder</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> LicenseManager <span class=\"title\">getLicenseManager</span><span class=\"params\">(LicenseParam param)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (licenseManager == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (LicenseManagerHolder.class) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (licenseManager == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                    licenseManager = <span class=\"keyword\">new</span> LicenseManager(param);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> licenseManager;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2><span id=\"si-li-yong-si-yao-sheng-cheng-zheng-shu\">å››ã€åˆ©ç”¨ç§é’¥ç”Ÿæˆè¯ä¹¦</span><a href=\"#si-li-yong-si-yao-sheng-cheng-zheng-shu\" class=\"header-anchor\">#</a></h2><p>åˆ©ç”¨ç§é’¥ç”Ÿæˆè¯ä¹¦ï¼Œæˆ‘ä»¬éœ€è¦ä¸¤éƒ¨åˆ†å†…å®¹ï¼Œä¸€éƒ¨åˆ†æ˜¯ç§é’¥çš„é…ç½®ä¿¡æ¯ï¼ˆç§é’¥çš„é…ç½®ä¿¡æ¯åœ¨ç”Ÿæˆç§é’¥åº“çš„è¿‡ç¨‹ä¸­è·å¾—ï¼‰ï¼Œä¸€éƒ¨åˆ†æ˜¯è‡ªå®šä¹‰çš„é¡¹ç›®è¯ä¹¦ä¿¡æ¯ã€‚å¦‚ä¸‹å±•ç¤ºï¼š</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">eva:</span></span><br><span class=\"line\">  <span class=\"attr\">license:</span></span><br><span class=\"line\">    <span class=\"comment\">########## ç§é’¥çš„é…ç½®ä¿¡æ¯ ###########</span></span><br><span class=\"line\">    <span class=\"attr\">priv:</span></span><br><span class=\"line\">      <span class=\"comment\"># ç§é’¥çš„åˆ«å</span></span><br><span class=\"line\">      <span class=\"attr\">key_alias:</span> <span class=\"string\">private_license_key</span></span><br><span class=\"line\">      <span class=\"comment\"># privateKeyPwdï¼ˆè¯¥å¯†ç æ˜¯ç”Ÿæˆå¯†é’¥å¯¹çš„å¯†ç  â€” éœ€è¦å¦¥å–„ä¿ç®¡ï¼Œä¸èƒ½è®©ä½¿ç”¨è€…çŸ¥é“ï¼‰</span></span><br><span class=\"line\">      <span class=\"attr\">key_pwd:</span> <span class=\"string\">7u8i9o0p</span></span><br><span class=\"line\">      <span class=\"comment\"># keyStorePwdï¼ˆè¯¥å¯†ç æ˜¯è®¿é—®å¯†é’¥åº“çš„å¯†ç  â€” ä½¿ç”¨ keytool ç”Ÿæˆå¯†é’¥å¯¹æ—¶è®¾ç½®ï¼Œä½¿ç”¨è€…çŸ¥é“è¯¥å¯†ç ï¼‰</span></span><br><span class=\"line\">      <span class=\"attr\">keystore_pwd:</span> <span class=\"string\">7u8i9o0p</span></span><br><span class=\"line\">      <span class=\"comment\"># å¯†é’¥åº“çš„åœ°å€ï¼ˆæ”¾åœ¨ resource ç›®å½•ä¸‹ï¼‰</span></span><br><span class=\"line\">      <span class=\"attr\">path:</span> <span class=\"string\">/license/private_license.store</span></span><br><span class=\"line\">    <span class=\"comment\">########## å…¬é’¥çš„é…ç½®ä¿¡æ¯ ###########</span></span><br><span class=\"line\">    <span class=\"attr\">pub:</span></span><br><span class=\"line\">      <span class=\"comment\"># å…¬é’¥åˆ«å</span></span><br><span class=\"line\">      <span class=\"attr\">alias:</span> <span class=\"string\">publiccert</span></span><br><span class=\"line\">    <span class=\"comment\"># è¯¥å¯†ç æ˜¯è®¿é—®å¯†é’¥åº“çš„å¯†ç  â€” ä½¿ç”¨ keytool ç”Ÿæˆå¯†é’¥å¯¹æ—¶è®¾ç½®ï¼Œä½¿ç”¨è€…çŸ¥é“è¯¥å¯†ç </span></span><br><span class=\"line\">      <span class=\"attr\">keystore_pwd:</span> <span class=\"string\">7u8i9o0p</span></span><br><span class=\"line\">      <span class=\"comment\"># å…¬å…±åº“è·¯å¾„ï¼ˆæ”¾åœ¨ resource ç›®å½•ä¸‹</span></span><br><span class=\"line\">      <span class=\"attr\">path:</span> <span class=\"string\">/license/publicCerts.store</span></span><br><span class=\"line\">      <span class=\"comment\"># è¯ä¹¦è·¯å¾„ï¼ˆæˆ‘è¿™è¾¹é…ç½®åœ¨äº† linux æ ¹è·¯å¾„ä¸‹ï¼Œå³ /license.lic ï¼‰</span></span><br><span class=\"line\">      <span class=\"attr\">license:</span> <span class=\"string\">/license/license.lic</span></span><br><span class=\"line\">    <span class=\"comment\"># é¡¹ç›®çš„å”¯ä¸€è¯†åˆ«ç </span></span><br><span class=\"line\">    <span class=\"attr\">subject:</span> <span class=\"string\">eva</span></span><br><span class=\"line\">    <span class=\"comment\">########## license content ###########</span></span><br><span class=\"line\">    <span class=\"comment\"># å‘å¸ƒæ—¥æœŸ</span></span><br><span class=\"line\">    <span class=\"attr\">issuedTime:</span> <span class=\"number\">2020-02-09 00:00:00</span></span><br><span class=\"line\">    <span class=\"comment\"># æœ‰æ•ˆå¼€å§‹æ—¥æœŸ</span></span><br><span class=\"line\">    <span class=\"attr\">notBefore:</span> <span class=\"number\">2020-02-09 00:00:00</span></span><br><span class=\"line\">    <span class=\"comment\"># æœ‰æ•ˆæˆªæ­¢æ—¥æœŸ</span></span><br><span class=\"line\">    <span class=\"attr\">notAfter:</span> <span class=\"number\">2029-02-09 23:16:00</span></span><br><span class=\"line\">    <span class=\"comment\"># ip åœ°å€</span></span><br><span class=\"line\">    <span class=\"attr\">ipAddress:</span> <span class=\"number\">192.168</span><span class=\"number\">.0</span><span class=\"number\">.107</span></span><br><span class=\"line\">    <span class=\"comment\"># mac åœ°å€</span></span><br><span class=\"line\">    <span class=\"attr\">macAddress:</span> <span class=\"number\">70</span><span class=\"string\">-C9-4E-E6-6D-D1</span></span><br><span class=\"line\">    <span class=\"comment\"># ä½¿ç”¨è€…ç±»å‹ï¼Œç”¨æˆ·(user)ã€ç”µè„‘(computer)ã€å…¶ä»–ï¼ˆelseï¼‰</span></span><br><span class=\"line\">    <span class=\"attr\">consumerType:</span> <span class=\"string\">user</span></span><br><span class=\"line\">    <span class=\"comment\"># è¯ä¹¦å…è®¸ä½¿ç”¨çš„æ¶ˆè´¹è€…æ•°é‡</span></span><br><span class=\"line\">    <span class=\"attr\">consumerAmount:</span> <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"comment\"># è¯ä¹¦è¯´æ˜</span></span><br><span class=\"line\">    <span class=\"attr\">info:</span> <span class=\"string\">power</span> <span class=\"string\">by</span> <span class=\"string\">xiamen</span> <span class=\"string\">yungu</span></span><br><span class=\"line\">    <span class=\"comment\">#ç”Ÿæˆè¯ä¹¦çš„åœ°å€</span></span><br><span class=\"line\">    <span class=\"attr\">licPath:</span> <span class=\"string\">D:\\eva_license\\license.lic</span></span><br></pre></td></tr></table></figure>\n<p>æ¥ä¸‹æ¥ï¼Œå°±æ˜¯å¦‚ä½•ç”Ÿæˆè¯ä¹¦çš„å®æ“éƒ¨åˆ†äº†</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> io.nerv.license;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> cn.hutool.core.date.DateUtil;</span><br><span class=\"line\"><span class=\"keyword\">import</span> de.schlichtherle.license.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Component;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.security.auth.x500.X500Principal;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.File;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.text.ParseException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.text.SimpleDateFormat;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.time.LocalDateTime;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.HashMap;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Map;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.prefs.Preferences;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LicenseGenerator</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> LicenseConfig licenseConfig;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * X500Princal æ˜¯ä¸€ä¸ªè¯ä¹¦æ–‡ä»¶çš„å›ºæœ‰æ ¼å¼ï¼Œè¯¦è§API</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> X500Principal DEFAULT_HOLDERAND_ISSUER = <span class=\"keyword\">new</span> X500Principal(<span class=\"string\">&quot;CN=Eva, OU=Nerv, O=Nerv, L=Nerv, ST=Unknown, C=CN&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * ç”Ÿæˆè¯ä¹¦ï¼Œåœ¨è¯ä¹¦å‘å¸ƒè€…ç«¯æ‰§è¡Œ</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">create</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        LicenseManager licenseManager = LicenseManagerHolder.getLicenseManager(initLicenseParams());</span><br><span class=\"line\">        licenseManager.store(buildLicenseContent(), <span class=\"keyword\">new</span> File(licenseConfig.getLicPath()));</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;------ è¯ä¹¦å‘å¸ƒæˆåŠŸ ------&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * åˆå§‹åŒ–è¯ä¹¦çš„ç›¸å…³å‚æ•°</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> LicenseParam <span class=\"title\">initLicenseParams</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        Class&lt;LicenseGenerator&gt; clazz = LicenseGenerator.class;</span><br><span class=\"line\">        Preferences preferences = Preferences.userNodeForPackage(clazz);</span><br><span class=\"line\">        <span class=\"comment\">// è®¾ç½®å¯¹è¯ä¹¦å†…å®¹åŠ å¯†çš„å¯¹ç§°å¯†ç </span></span><br><span class=\"line\">        CipherParam cipherParam = <span class=\"keyword\">new</span> DefaultCipherParam(licenseConfig.getPriv().getKeystorePwd());</span><br><span class=\"line\">        <span class=\"comment\">// å‚æ•° 1,2 ä»å“ªä¸ªClass.getResource()è·å¾—å¯†é’¥åº“;</span></span><br><span class=\"line\">        <span class=\"comment\">// å‚æ•° 3 å¯†é’¥åº“çš„åˆ«å;</span></span><br><span class=\"line\">        <span class=\"comment\">// å‚æ•° 4 å¯†é’¥åº“å­˜å‚¨å¯†ç ;</span></span><br><span class=\"line\">        <span class=\"comment\">// å‚æ•° 5 å¯†é’¥åº“å¯†ç </span></span><br><span class=\"line\">        KeyStoreParam privateStoreParam = <span class=\"keyword\">new</span> DefaultKeyStoreParam(clazz, licenseConfig.getPriv().getPath(),</span><br><span class=\"line\">                                                                          licenseConfig.getPriv().getKeyAlias(),</span><br><span class=\"line\">                                                                          licenseConfig.getPriv().getKeystorePwd(),</span><br><span class=\"line\">                                                                          licenseConfig.getPriv().getKeyPwd());</span><br><span class=\"line\">        <span class=\"comment\">// è¿”å›ç”Ÿæˆè¯ä¹¦æ—¶éœ€è¦çš„å‚æ•°</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> DefaultLicenseParam(licenseConfig.getSubject(), preferences, privateStoreParam, cipherParam);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * é€šè¿‡å¤–éƒ¨é…ç½®æ–‡ä»¶æ„å»ºè¯ä¹¦çš„çš„ç›¸å…³ä¿¡æ¯</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> ParseException</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> LicenseContent <span class=\"title\">buildLicenseContent</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> ParseException </span>&#123;</span><br><span class=\"line\">        LicenseContent content = <span class=\"keyword\">new</span> LicenseContent();</span><br><span class=\"line\"><span class=\"comment\">//        SimpleDateFormat formate = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        content.setConsumerAmount(licenseConfig.getConsumerAmount());</span><br><span class=\"line\">        content.setConsumerType(licenseConfig.getConsumerType());</span><br><span class=\"line\">        content.setHolder(DEFAULT_HOLDERAND_ISSUER);</span><br><span class=\"line\">        content.setIssuer(DEFAULT_HOLDERAND_ISSUER);</span><br><span class=\"line\">        content.setIssued( DateUtil.parseDateTime(licenseConfig.getIssuedTime()) );</span><br><span class=\"line\">        content.setNotBefore( DateUtil.parseDateTime(licenseConfig.getNotBefore()) );</span><br><span class=\"line\">        content.setNotAfter( DateUtil.parseDateTime(licenseConfig.getNotAfter()) );</span><br><span class=\"line\">        content.setInfo(licenseConfig.getInfo());</span><br><span class=\"line\">        <span class=\"comment\">// æ‰©å±•å­—æ®µ</span></span><br><span class=\"line\">        Map&lt;String, String&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;(<span class=\"number\">4</span>);</span><br><span class=\"line\">        map.put(<span class=\"string\">&quot;ip&quot;</span>, licenseConfig.getIpAddress());</span><br><span class=\"line\">        map.put(<span class=\"string\">&quot;mac&quot;</span>, licenseConfig.getMacAddress());</span><br><span class=\"line\">        content.setExtra(map);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> content;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>æœ€åï¼Œæ¥å°è¯•ç”Ÿæˆä¸€ä»½è¯ä¹¦å§ï¼</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">       licenseVerify.init();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2><span id=\"si-li-yong-gong-yao-yan-zheng-zheng-shu\">å››ã€åˆ©ç”¨å…¬é’¥éªŒè¯è¯ä¹¦</span><a href=\"#si-li-yong-gong-yao-yan-zheng-zheng-shu\" class=\"header-anchor\">#</a></h2><p>åˆ©ç”¨å…¬é’¥ç”Ÿæˆè¯ä¹¦ï¼Œæˆ‘ä»¬éœ€è¦æœ‰å…¬é’¥åº“ã€license è¯ä¹¦ç­‰ä¿¡æ¯ã€‚</p>\n<p>æ¥ä¸‹æ¥å°±æ˜¯æ€ä¹ˆç”¨å…¬é’¥éªŒè¯ license è¯ä¹¦ï¼Œæ€æ ·éªŒè¯ ipã€mac åœ°å€ç­‰ä¿¡æ¯çš„è¿‡ç¨‹äº†~</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> io.nerv.license;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> cn.hutool.core.net.NetUtil;</span><br><span class=\"line\"><span class=\"keyword\">import</span> de.schlichtherle.license.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Component;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.File;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.InetAddress;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Map;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Objects;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.prefs.Preferences;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LicenseVerify</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> LicenseConfig licenseConfig;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å®‰è£…è¯ä¹¦è¯ä¹¦</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">install</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            LicenseManager licenseManager = getLicenseManager();</span><br><span class=\"line\">            licenseManager.install(<span class=\"keyword\">new</span> File(licenseConfig.getLicPath()));</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;å®‰è£…è¯ä¹¦æˆåŠŸ!&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;æˆæƒå·²è¿‡æœŸ, å®‰è£…è¯ä¹¦å¤±è´¥!&quot;</span>, e);</span><br><span class=\"line\">            Runtime.getRuntime().halt(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> LicenseManager <span class=\"title\">getLicenseManager</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> LicenseManagerHolder.getLicenseManager(initLicenseParams());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * åˆå§‹åŒ–è¯ä¹¦çš„ç›¸å…³å‚æ•°</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> LicenseParam <span class=\"title\">initLicenseParams</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        Class&lt;LicenseVerify&gt; clazz = LicenseVerify.class;</span><br><span class=\"line\">        Preferences pre = Preferences.userNodeForPackage(clazz);</span><br><span class=\"line\">        CipherParam cipherParam = <span class=\"keyword\">new</span> DefaultCipherParam(licenseConfig.getPub().getKeystorePwd());</span><br><span class=\"line\">        KeyStoreParam pubStoreParam = <span class=\"keyword\">new</span> DefaultKeyStoreParam(clazz,</span><br><span class=\"line\">                                                               licenseConfig.getPub().getPath(),</span><br><span class=\"line\">                                                               licenseConfig.getPub().getAlias(),</span><br><span class=\"line\">                                                               licenseConfig.getPub().getKeystorePwd() , <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> DefaultLicenseParam(licenseConfig.getSubject(), pre, pubStoreParam, cipherParam);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * éªŒè¯è¯ä¹¦çš„åˆæ³•æ€§</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">vertify</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            LicenseManager licenseManager = getLicenseManager();</span><br><span class=\"line\">            LicenseContent verify = licenseManager.verify();</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;éªŒè¯è¯ä¹¦æˆåŠŸ!&quot;</span>);</span><br><span class=\"line\">            Map&lt;String, String&gt; extra = (Map) verify.getExtra();</span><br><span class=\"line\">            String ip = extra.get(<span class=\"string\">&quot;ip&quot;</span>);</span><br><span class=\"line\">            InetAddress inetAddress = InetAddress.getLocalHost();</span><br><span class=\"line\">            String localIp = inetAddress.toString().split(<span class=\"string\">&quot;/&quot;</span>)[<span class=\"number\">1</span>];</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!Objects.equals(ip, localIp)) &#123;</span><br><span class=\"line\">                log.error(<span class=\"string\">&quot;IP åœ°å€éªŒè¯ä¸é€šè¿‡&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            String mac = extra.get(<span class=\"string\">&quot;mac&quot;</span>);</span><br><span class=\"line\">            String localMac = getLocalMac(inetAddress);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!Objects.equals(mac, localMac)) &#123;</span><br><span class=\"line\">                log.error(<span class=\"string\">&quot;MAC åœ°å€éªŒè¯ä¸é€šè¿‡&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;IPã€MACåœ°å€éªŒè¯é€šè¿‡&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (LicenseContentException ex) &#123;</span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;è¯ä¹¦å·²ç»è¿‡æœŸ!&quot;</span>, ex);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;éªŒè¯è¯ä¹¦å¤±è´¥!&quot;</span>, e);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å¾—åˆ°æœ¬æœº mac åœ°å€</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> inetAddress</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> String <span class=\"title\">getLocalMac</span><span class=\"params\">(InetAddress inetAddress)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> NetUtil.getMacAddress(inetAddress).toUpperCase();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>æœ‰äº†å…¬é’¥çš„éªŒè¯è¿‡ç¨‹äº†ï¼Œç­‰ä¸‹ï¼äº‹æƒ…è¿˜æ²¡ç»“æŸå‘¢ï¼æˆ‘ä»¬éœ€è¦åœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™ï¼Œå®‰è£… licnese è¯ä¹¦ï¼Œç„¶åéªŒè¯ipã€mac ç­‰ä¿¡æ¯ã€‚å¦‚æœæ ¡éªŒä¸é€šè¿‡ï¼Œå°±é˜»æ­¢é¡¹ç›®å¯åŠ¨ï¼</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (evaConfig.getLicense().isEnable())&#123;</span><br><span class=\"line\">\t<span class=\"comment\">// å®‰è£…license</span></span><br><span class=\"line\">   licenseVerify.init();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// éªŒè¯license</span></span><br><span class=\"line\">   <span class=\"keyword\">if</span> (!licenseVerify.vertify()) &#123;</span><br><span class=\"line\">   log.error(<span class=\"string\">&quot;æˆæƒéªŒè¯æœªé€šè¿‡, è¯·æ›´æ–°æˆæƒæ–‡ä»¶&quot;</span>);</span><br><span class=\"line\">   \tRuntime.getRuntime().halt(<span class=\"number\">1</span>);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>","categories":["Spring Boot"],"tags":["Spring boot","License"]},{"title":"ä½¿ç”¨Spring Boot Adminç›‘æ§Spring Bootåº”ç”¨","url":"https://pkaq.org/2020/01/08/monitor/","content":"<h1><span id=\"1-gai-shu\">1.æ¦‚è¿°</span><a href=\"#1-gai-shu\" class=\"header-anchor\">#</a></h1><p>â€‹    Spring Boot Adminæ˜¯ä¸€ä¸ªå¼€æºç¤¾åŒºé¡¹ç›®ï¼Œç”¨äºç®¡ç†å’Œç›‘æ§SpringBootåº”ç”¨ç¨‹åºã€‚ åº”ç”¨ç¨‹åºä½œä¸ºSpring Boot Admin Clientå‘ä¸ºSpring Boot Admin Serveræ³¨å†Œï¼ˆé€šè¿‡HTTPï¼‰æˆ–ä½¿ç”¨SpringCloudæ³¨å†Œä¸­å¿ƒï¼ˆä¾‹å¦‚Eurekaï¼ŒConsulï¼‰å‘ç°ã€‚ UIæ˜¯çš„AngularJsåº”ç”¨ç¨‹åºï¼Œå±•ç¤ºSpring Boot Admin Clientçš„Actuatorç«¯ç‚¹ä¸Šçš„ä¸€äº›ç›‘æ§ã€‚å¸¸è§çš„åŠŸèƒ½æˆ–è€…ç›‘æ§å¦‚ä¸‹ï¼š</p>\n<a id=\"more\"></a>\n\n<ul>\n<li><p>æ˜¾ç¤ºå¥åº·çŠ¶å†µ</p>\n</li>\n<li><p>æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚</p>\n<ul>\n<li>JVMå’Œå†…å­˜æŒ‡æ ‡</li>\n<li>micrometer.ioæŒ‡æ ‡</li>\n<li>æ•°æ®æºæŒ‡æ ‡</li>\n<li>ç¼“å­˜æŒ‡æ ‡</li>\n</ul>\n</li>\n<li><p>æ˜¾ç¤ºæ„å»ºä¿¡æ¯ç¼–å·</p>\n</li>\n<li><p>å…³æ³¨å¹¶ä¸‹è½½æ—¥å¿—æ–‡ä»¶</p>\n</li>\n<li><p>æŸ¥çœ‹jvmç³»ç»Ÿå’Œç¯å¢ƒå±æ€§</p>\n</li>\n<li><p>æŸ¥çœ‹Spring Booté…ç½®å±æ€§</p>\n</li>\n<li><p>æ”¯æŒSpring Cloudçš„postable / env-å’Œ/ refresh-endpoint</p>\n</li>\n<li><p>è½»æ¾çš„æ—¥å¿—çº§ç®¡ç†</p>\n</li>\n<li><p>ä¸JMX-beansäº¤äº’</p>\n</li>\n<li><p>æŸ¥çœ‹çº¿ç¨‹è½¬å‚¨</p>\n</li>\n<li><p>æŸ¥çœ‹httpè·Ÿè¸ª</p>\n</li>\n<li><p>æŸ¥çœ‹auditevents</p>\n</li>\n<li><p>æŸ¥çœ‹http-endpoints</p>\n</li>\n<li><p>æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡</p>\n</li>\n<li><p>æŸ¥çœ‹å’Œåˆ é™¤æ´»åŠ¨ä¼šè¯ï¼ˆä½¿ç”¨spring-sessionï¼‰</p>\n</li>\n<li><p>æŸ¥çœ‹Flyway / Liquibaseæ•°æ®åº“è¿ç§»</p>\n</li>\n<li><p>ä¸‹è½½heapdump</p>\n</li>\n<li><p>çŠ¶æ€å˜æ›´é€šçŸ¥ï¼ˆé€šè¿‡ç”µå­é‚®ä»¶ï¼ŒSlackï¼ŒHipchatï¼Œâ€¦â€¦ï¼‰</p>\n</li>\n<li><p>çŠ¶æ€æ›´æ”¹çš„äº‹ä»¶æ—¥å¿—ï¼ˆéæŒä¹…æ€§ï¼‰</p>\n</li>\n</ul>\n<h1><span id=\"2-kai-shi\">2.å¼€å§‹</span><a href=\"#2-kai-shi\" class=\"header-anchor\">#</a></h1><p><code>Spring Boot Admin</code>ç”±ä¸¤éƒ¨åˆ†ç»„æˆ<code>Server</code>å’Œ<code>Client</code>ï¼Œä¸€ä¸ª<code>Server</code>å¯æ”¯æŒå¤šä¸ª<code>Client</code>çš„ç›‘æ§ã€‚   </p>\n<h2><span id=\"2-1-server-duan-da-jian\">2.1 Serverç«¯æ­å»º</span><a href=\"#2-1-server-duan-da-jian\" class=\"header-anchor\">#</a></h2><p>â€‹    Serverç«¯æ­å»ºä¸»è¦åˆ†ä¸ºå¦‚ä¸‹æ­¥éª¤ï¼š</p>\n<ul>\n<li><p>å¼•å…¥ä¾èµ–</p>\n</li>\n<li><p>é…ç½®æ³¨è§£</p>\n</li>\n<li><p>é¡¹ç›®é…ç½®</p>\n</li>\n<li><p>ä¸Šçº¿å‘å¸ƒ</p>\n</li>\n</ul>\n<h3><span id=\"2-1-1-yin-ru-yi-lai\">2.1.1 å¼•å…¥ä¾èµ–</span><a href=\"#2-1-1-yin-ru-yi-lai\" class=\"header-anchor\">#</a></h3><figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&quot;de.codecentric:spring-boot-admin-starter-server:$&#123;boot_admin&#125;&quot;</span></span><br><span class=\"line\"># å¯é€‰å¢å¼ºé…ç½®(å¦‚éœ€å¯¹ç›‘æ§é¡µé¢è¿›è¡Œé‰´æƒè®¿é—®æ·»åŠ æ­¤é¡¹) </span><br><span class=\"line\"><span class=\"string\">&quot;org.springframework.boot:spring-boot-starter-security:$&#123;springBootVersion&#125;&quot;</span></span><br></pre></td></tr></table></figure>\n<h3><span id=\"2-1-2-pei-zhi-zhu-jie\">2.1.2 é…ç½®æ³¨è§£</span><a href=\"#2-1-2-pei-zhi-zhu-jie\" class=\"header-anchor\">#</a></h3><p>å¯åŠ¨ç±»ä¸Šæ·»åŠ å¯ç”¨æ³¨è§£<code>@EnableAdminServer</code>å³å¯ã€‚</p>\n<h3><span id=\"2-1-3-xiang-mu-pei-zhi\">2.1.3 é¡¹ç›®é…ç½®</span><a href=\"#2-1-3-xiang-mu-pei-zhi\" class=\"header-anchor\">#</a></h3><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#é…ç½®åº”ç”¨å‘å¸ƒçš„ç«¯å£</span></span><br><span class=\"line\"><span class=\"attr\">server:</span></span><br><span class=\"line\">  <span class=\"attr\">port:</span> <span class=\"number\">19001</span></span><br><span class=\"line\"><span class=\"comment\"># å¯é€‰å¢å¼ºé…ç½®(å¦‚éœ€å¯¹ç›‘æ§é¡µé¢è¿›è¡Œé‰´æƒè®¿é—®æ·»åŠ æ­¤é¡¹) </span></span><br><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">security:</span></span><br><span class=\"line\">    <span class=\"attr\">user:</span></span><br><span class=\"line\">      <span class=\"comment\"># è¿™é‡Œä¸è¦ä¸¢æ‰å¤–é¢çš„å¼•å·</span></span><br><span class=\"line\">      <span class=\"attr\">name:</span> <span class=\"string\">&quot;eva&quot;</span></span><br><span class=\"line\">      <span class=\"attr\">password:</span> <span class=\"string\">&quot;***&quot;</span></span><br></pre></td></tr></table></figure>\n<p>Spring security é‰´æƒé…ç½®</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SecuritySecureConfig</span> <span class=\"keyword\">extends</span> <span class=\"title\">WebSecurityConfigurerAdapter</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> String adminContextPath;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">SecuritySecureConfig</span><span class=\"params\">(AdminServerProperties adminServerProperties)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.adminContextPath = adminServerProperties.getContextPath();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">configure</span><span class=\"params\">(HttpSecurity http)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// @formatter:off</span></span><br><span class=\"line\">        SavedRequestAwareAuthenticationSuccessHandler successHandler = <span class=\"keyword\">new</span> SavedRequestAwareAuthenticationSuccessHandler();</span><br><span class=\"line\">        successHandler.setTargetUrlParameter( <span class=\"string\">&quot;redirectTo&quot;</span> );</span><br><span class=\"line\"></span><br><span class=\"line\">        http.authorizeRequests()</span><br><span class=\"line\">                .antMatchers( adminContextPath + <span class=\"string\">&quot;/assets/**&quot;</span> ).permitAll()</span><br><span class=\"line\">                .antMatchers( adminContextPath + <span class=\"string\">&quot;/login&quot;</span> ).permitAll()</span><br><span class=\"line\">                .anyRequest().authenticated()</span><br><span class=\"line\">                .and()</span><br><span class=\"line\">                .formLogin().loginPage( adminContextPath + <span class=\"string\">&quot;/login&quot;</span> ).successHandler( successHandler ).and()</span><br><span class=\"line\">                .logout().logoutUrl( adminContextPath + <span class=\"string\">&quot;/logout&quot;</span> ).and()</span><br><span class=\"line\">                .httpBasic().and()</span><br><span class=\"line\">                .csrf().disable();</span><br><span class=\"line\">        <span class=\"comment\">// @formatter:on</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n<h3><span id=\"2-1-4-shang-xian-fa-bu\">2.1.4 ä¸Šçº¿å‘å¸ƒ</span><a href=\"#2-1-4-shang-xian-fa-bu\" class=\"header-anchor\">#</a></h3><p>å»ºè®®ä½¿ç”¨<code>Docker</code>å°†æ‰“åŒ…åçš„æ–‡ä»¶å‘å¸ƒ</p>\n<h3><span id=\"2-1-5-jian-dan-fang-shi\">2.1.5 ç®€å•æ–¹å¼</span><a href=\"#2-1-5-jian-dan-fang-shi\" class=\"header-anchor\">#</a></h3><p>å¯ä»¥ç›´æ¥æ‹‰å–æˆ‘ä¸Šä¼ çš„ docker é•œåƒ ç„¶åå¯åŠ¨å®¹å™¨å³å¯</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull mosvex/eva-boot-admin</span><br></pre></td></tr></table></figure>\n<h2><span id=\"2-2-client-pei-zhi\">2.2 Clienté…ç½®</span><a href=\"#2-2-client-pei-zhi\" class=\"header-anchor\">#</a></h2><p>   å®¢æˆ·ç«¯çš„é…ç½®ä¹Ÿååˆ†ç®€å•,åˆ†ä¸ºå¦‚ä¸‹æ­¥éª¤</p>\n<ul>\n<li>å¼•å…¥ä¾èµ–</li>\n<li>é¡¹ç›®é…ç½®</li>\n<li>ä¸Šçº¿å‘å¸ƒ</li>\n</ul>\n<h3><span id=\"2-2-1-yin-ru-yi-lai\">2.2.1 å¼•å…¥ä¾èµ–</span><a href=\"#2-2-1-yin-ru-yi-lai\" class=\"header-anchor\">#</a></h3><figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&quot;de.codecentric:spring-boot-admin-starter-client:$&#123;boot_admin&#125;&quot;</span>,</span><br></pre></td></tr></table></figure>\n<h3><span id=\"2-2-2-xiang-mu-pei-zhi\">2.2.2 é¡¹ç›®é…ç½®</span><a href=\"#2-2-2-xiang-mu-pei-zhi\" class=\"header-anchor\">#</a></h3><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">boot:</span></span><br><span class=\"line\">    <span class=\"attr\">admin:</span></span><br><span class=\"line\">      <span class=\"attr\">client:</span></span><br><span class=\"line\">        <span class=\"attr\">url:</span> <span class=\"string\">http://192.168.10.166:19001/</span></span><br><span class=\"line\">        <span class=\"comment\"># Serveré‰´æƒéœ€è¦çš„ç”¨æˆ·å/å¯†ç  è¿™é‡Œä¸éœ€è¦å¼•å·</span></span><br><span class=\"line\">        <span class=\"attr\">username:</span> <span class=\"string\">eva</span></span><br><span class=\"line\">        <span class=\"attr\">password:</span> <span class=\"string\">***</span></span><br><span class=\"line\">        <span class=\"comment\">#æ˜¯å¦ä½¿ç”¨æ³¨å†Œçš„ipåœ°å€æ¥å–ä»£ä¸Šè¿°å„ä¸ªurlä¸­hostnameçš„å€¼ï¼Œé»˜è®¤å€¼æ˜¯falseï¼ˆä¹Ÿå°±æ˜¯è¯´é»˜è®¤æƒ…å†µä¸‹ä¸Šè¿°å„ä¸ªurlä¸­ä¼šä½¿ç”¨hostnameçš„å€¼ï¼Œæ¯”å¦‚æˆ‘çš„ç”µè„‘çš„hostnameä¸ºp-v-9ï¼‰ã€‚å¦‚æœè®¾ç½®äº†server.addressæˆ–è€…management.addressçš„è¯ipåœ°å€å°±æ˜¯è¯¥å€¼ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®è¿™ä¸¤ä¸ªå±æ€§çš„è¯ipåœ°å€å€¼æ˜¯InetAddress.getLocalHost()çš„å€¼ã€‚</span></span><br><span class=\"line\">        <span class=\"comment\"># æ³¨æ„ ä¸é…ç½®æ­¤é¡¹ä½¿ç”¨é»˜è®¤hostnameå¯èƒ½ä¼šå‡ºç° `Name or service not known`å¼‚å¸¸</span></span><br><span class=\"line\">        <span class=\"attr\">instance:</span></span><br><span class=\"line\">          <span class=\"attr\">prefer-ip:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">management:</span></span><br><span class=\"line\">  <span class=\"attr\">endpoints:</span></span><br><span class=\"line\">    <span class=\"attr\">web:</span></span><br><span class=\"line\">      <span class=\"attr\">exposure:</span></span><br><span class=\"line\">      \t<span class=\"comment\"># æš´éœ²æ‰€æœ‰ç«¯å£</span></span><br><span class=\"line\">        <span class=\"attr\">include:</span> <span class=\"string\">&#x27;*&#x27;</span></span><br><span class=\"line\">  <span class=\"attr\">endpoint:</span></span><br><span class=\"line\">    <span class=\"attr\">health:</span></span><br><span class=\"line\">      <span class=\"attr\">show-details:</span> <span class=\"string\">ALWAYS</span></span><br><span class=\"line\">  <span class=\"comment\"># æœ¬æœºip å¯¹åº”ä¸Šé¢instace:prefeer-ipé…ç½®è¯´æ˜</span></span><br><span class=\"line\">  <span class=\"attr\">server:</span></span><br><span class=\"line\">    <span class=\"attr\">address:</span> <span class=\"number\">192.168</span><span class=\"number\">.10</span><span class=\"number\">.127</span></span><br></pre></td></tr></table></figure>\n\n\n<h3><span id=\"2-2-3-shang-xian-fa-bu\">2.2.3 ä¸Šçº¿å‘å¸ƒ</span><a href=\"#2-2-3-shang-xian-fa-bu\" class=\"header-anchor\">#</a></h3><p>â€‹    å¯åŠ¨å®¢æˆ·ç«¯æœåŠ¡ä¹‹å è®¿é—®<code>Server</code>å³å¯åœ¨åº”ç”¨å¢™çœ‹åˆ°å®¢æˆ·ç«¯æƒ…å†µã€‚</p>\n","categories":["Spring Boot"],"tags":["Spring boot","åº”ç”¨ç›‘æ§"]},{"title":"ä¸ºGradleåˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰æ’ä»¶","url":"https://pkaq.org/2018/12/08/gradleplugin/","content":"<h1><span id=\"gai-shu\">æ¦‚è¿°</span><a href=\"#gai-shu\" class=\"header-anchor\">#</a></h1><p>ã€€ åœ¨å¯¹<code>Gradle</code>æœ‰äº†ä¸€å®šçš„äº†è§£åï¼Œä½ ä¼šå‘ç°é€šè¿‡ä½¿ç”¨Gradleçš„å†…ç½®ä»»åŠ¡ä»¥åŠå„ç§æ’ä»¶å¯ä»¥è½»æ¾åœ°è¾¾æˆæ„å»ºç›®æ ‡ï¼Œä¾‹å¦‚ä½¿ç”¨äº†<code>war</code>æ’ä»¶åï¼Œæ— éœ€ç¼–å†™ä»»ä½•<code>Task</code>å³æ‹¥æœ‰äº†æ‰“<code>war</code>åŒ…çš„èƒ½åŠ›ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå®˜æ–¹æä¾›çš„æ’ä»¶å’Œä¼—å¤šç¬¬ä¸‰æ–¹æ’ä»¶å¯ä»¥æ»¡è¶³ä½ çš„ç»å¤§éƒ¨åˆ†éœ€æ±‚ï¼Œä½†æˆ–è®¸ä½ ä¹Ÿæƒ³ä¸ºå›¢é˜Ÿæä¾›ä¸€ä¸ªå®šåˆ¶åŒ–åŠŸèƒ½çš„æ’ä»¶ã€‚æœ¬ç« èŠ‚å°±æ˜¯æ¥è®²è§£å¦‚ä½•ç¼–å†™ã€å‘å¸ƒä¸€ä¸ªè‡ªå®šä¹‰æ’ä»¶æ¥å®ç°<code>Gradle</code>åŠŸèƒ½çš„æ‰©å±•ã€‚</p>\n<a id=\"more\"></a>\n\n<h1><span id=\"mu-lu-jie-gou\">ç›®å½•ç»“æ„</span><a href=\"#mu-lu-jie-gou\" class=\"header-anchor\">#</a></h1><p>ã€€ åœ¨å‰é¢çš„ç« èŠ‚å·²ç»ä»‹ç»äº†<code>å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ªTask</code>ï¼Œç¼–å†™æ’ä»¶å…¶å®ä¸ä¹‹ç±»ä¼¼ï¼Œä¹Ÿå¯ä»¥æŠŠæ’ä»¶çœ‹ä½œä¸ºè‹¥å¹²ä»»åŠ¡çš„åŒ…è£…å™¨ã€‚ç”šè‡³æ–¹å¼ä¹Ÿä¸ç¼–å†™ä¸€ä¸ª<code>Task</code>ç›¸åŒï¼Œä½ å¯ä»¥é€‰æ‹©æŠŠæ’ä»¶ä»£ç ç›´æ¥ç¼–å†™åˆ°è„šæœ¬ä¸­æˆ–è€…ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„å·¥ç¨‹å‘å¸ƒå‡ºå»ã€‚å‡ºäºå¯ç»´æŠ¤æ€§ã€æ˜“ç”¨æ€§ç­‰æ–¹é¢çš„è€ƒè™‘ï¼Œæœ¬ç« èŠ‚åªä»‹ç»å¦‚ä½•é‡‡ç”¨ç‹¬ç«‹å·¥ç¨‹çš„æ–¹å¼ç¼–å†™æ’ä»¶ã€‚</p>\n<p>ã€€ ä¸€ä¸ªæ’ä»¶å·¥ç¨‹çš„ç›®å½•ç»“æ„ä¸ä¸€ä¸ªæ™®é€šçš„<code>java</code>å·¥ç¨‹ä¸€è‡´ï¼Œä½ å¯ä»¥é€‰æ‹©ä½¿ç”¨Javaæˆ–è€…Groovyæ¥ä½œä¸ºæ’ä»¶çš„å®ç°ã€‚</p>\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">|-src   </span><br><span class=\"line\">\t|-main   </span><br><span class=\"line\">\t\t|-java</span><br><span class=\"line\">        |-groovy</span><br><span class=\"line\">\t\t|-resources   </span><br><span class=\"line\">\t\t\t|-META-INF   </span><br><span class=\"line\">\t|-test   </span><br><span class=\"line\">\t\t|-java </span><br><span class=\"line\">        |-groovy</span><br><span class=\"line\">\t\t|-resource  </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h1><span id=\"ru-he-kai-shi\">å¦‚ä½•å¼€å§‹</span><a href=\"#ru-he-kai-shi\" class=\"header-anchor\">#</a></h1><p>ã€€ æ¥ä¸‹æ¥æˆ‘ä»¬ä¾¿æºä¸ä¸€ä¸ªåä¸º<code>org.pkaq.foLeng</code>çš„æ’ä»¶ï¼Œæ¥æè¿°ä¸€ä¸ªæ’ä»¶ç¼–å†™çš„æ­¥éª¤ï¼Œè¯¥æ’ä»¶æä¾›ä¸€ä¸ªåä¸º<code>mlfl</code>çš„<code>Task</code>ï¼Œè¯¥<code>Task</code>å¯æ¥å—ä¸€ä¸ªåä¸º<code>words</code>çš„è¾“å…¥å±æ€§ï¼Œè¿è¡Œæ’ä»¶ä»»åŠ¡åä¼šåœ¨æ§åˆ¶å°æ˜¾å‡ºä½›ç¥–çœŸèº«ï¼Œä¿ä½‘ä½ çš„ä»£ç ä¸å—<code>bug</code>ä¾µæ‰°ã€‚</p>\n<p>ã€€ è¯¥æ’ä»¶ä¸»è¦æœ‰ä¸‰éƒ¨åˆ†ï¼šä»»åŠ¡å®šä¹‰ã€æ’ä»¶å®šä¹‰ã€æ’ä»¶çš„æ‰©å±•å±æ€§ã€‚</p>\n<p>ã€€ å¼€å§‹ç¼–å†™ä¹‹å‰ä½ éœ€è¦å¼•å…¥<code>Gradle</code>ç›¸å…³ä¾èµ–:</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dependencies &#123;</span><br><span class=\"line\">    compile localGroovy() </span><br><span class=\"line\">    compile gradleApi() </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2><span id=\"1-ren-wu-ding-yi\">1.ä»»åŠ¡å®šä¹‰</span><a href=\"#1-ren-wu-ding-yi\" class=\"header-anchor\">#</a></h2><p>ã€€ é¦–å…ˆå®šä¹‰ä¸€ä¸ªæ’ä»¶ä»»åŠ¡ï¼Œæ–¹å¼ä¸<code>å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ªTask</code>æåˆ°çš„æ–¹å¼ç›¸åŒã€‚åªéœ€ç»§æ‰¿<code>DefaultTask</code>ç±»ï¼Œå¹¶æ·»åŠ ç›¸åº”æ³¨è§£å³å¯ã€‚<code>@Input</code>å®šä¹‰äº†è¯¥ä»»åŠ¡æ¥å—ä¸€ä¸ªåä¸º<code>words</code>çš„å…¥å‚ï¼Œ<code>@TaskAction</code>æ³¨è§£äº†<code>Task</code>çš„è¡Œä¸ºï¼Œè¡¨ç¤ºè¯¥<code>Task</code>è°ƒç”¨æ—¶å°†æ‰§è¡Œæ³¨è§£åŠ¨ä½œã€‚è¯¥åŠ¨ä½œæ‰§è¡Œåä¼šåœ¨æ§åˆ¶å°æ‰“å°å‡ºä½›ç¥–çœŸèº«ä»¥åŠè¾“å…¥çš„å‚æ•°ã€‚</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> org.pkaq</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.gradle.api.DefaultTask</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.gradle.api.tasks.Input</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.gradle.api.tasks.TaskAction</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FoLengTask</span> <span class=\"keyword\">extends</span> <span class=\"title\">DefaultTask</span> &#123;</span></span><br><span class=\"line\">   <span class=\"meta\">@Input</span></span><br><span class=\"line\">    String words = <span class=\"string\">&#x27;Hello&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    FoLengTask()&#123;</span><br><span class=\"line\">       description = <span class=\"string\">&quot;Mai Le FoLeng?&quot;</span></span><br><span class=\"line\">       group = <span class=\"string\">&quot;FoLeng&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@TaskAction</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> mlfl() &#123;</span><br><span class=\"line\">        <span class=\"comment\">// è·å–è¾“å…¥çš„å±æ€§</span></span><br><span class=\"line\">        words = getWords()</span><br><span class=\"line\">        println <span class=\"string\">&#x27;&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"string\">                   _ooOoo_</span></span><br><span class=\"line\"><span class=\"string\">                  o8888888o</span></span><br><span class=\"line\"><span class=\"string\">                  88&quot; . &quot;88</span></span><br><span class=\"line\"><span class=\"string\">                  (| -_- |)</span></span><br><span class=\"line\"><span class=\"string\">                  O\\\\  =  /O</span></span><br><span class=\"line\"><span class=\"string\">               ____/`---&#x27;\\\\____</span></span><br><span class=\"line\"><span class=\"string\">             .&#x27;  \\\\\\\\|     |//  `.</span></span><br><span class=\"line\"><span class=\"string\">            /  \\\\\\\\|||  :  |||//  \\\\</span></span><br><span class=\"line\"><span class=\"string\">           /  _||||| -:- |||||-  \\\\</span></span><br><span class=\"line\"><span class=\"string\">           |   | \\\\\\\\\\\\  -  /// |   |</span></span><br><span class=\"line\"><span class=\"string\">           | \\\\_|  &#x27;&#x27;\\\\---/&#x27;&#x27;  |   |</span></span><br><span class=\"line\"><span class=\"string\">           \\\\  .-\\\\__  `-`  ___/-. /</span></span><br><span class=\"line\"><span class=\"string\">         ___`. .&#x27;  /--.--\\\\  `. . __</span></span><br><span class=\"line\"><span class=\"string\">      .&quot;&quot; &#x27;&lt;  `.___\\\\_&lt;|&gt;_/___.&#x27;  &gt;&#x27;&quot;&quot;.</span></span><br><span class=\"line\"><span class=\"string\">     | | :  ` - `.;`\\\\ _ /`;.`/ - ` : | |</span></span><br><span class=\"line\"><span class=\"string\">     \\\\  \\\\ `-.   \\\\_ __\\\\ /__ _/   .-` /  /</span></span><br><span class=\"line\"><span class=\"string\">======`-.____`-.___\\\\_____/___.-`____.-&#x27;======</span></span><br><span class=\"line\"><span class=\"string\">                   `=---=&#x27;</span></span><br><span class=\"line\"><span class=\"string\">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span></span><br><span class=\"line\"><span class=\"string\">            ä½›ç¥–ä¿ä½‘       æ°¸æ— BUG</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">            &#x27;&#x27;&#x27;</span></span><br><span class=\"line\">        println <span class=\"string\">&quot;            &lt; -   $&#123;words&#125;   -&gt;&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2><span id=\"2-kuo-zhan-shu-xing\">2.æ‰©å±•å±æ€§</span><a href=\"#2-kuo-zhan-shu-xing\" class=\"header-anchor\">#</a></h2><p>ã€€ ä¸ºæ’ä»¶æ·»åŠ ä¸€ä¸ªåä¸º<code>words</code>çš„æ‰©å±•å±æ€§ã€‚è¿™æ ·æˆ‘ä»¬åœ¨æ’ä»¶å‘å¸ƒåå¯ä»¥é‡‡ç”¨å®šä¹‰çš„æ‰©å±•å®¹å™¨æ¥æ–¹é¢çš„è®¾å®šæ’ä»¶çš„å„ç±»å‚æ•°ã€‚</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> org.pkaq</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ‰©å±•å±æ€§</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FolengExtension</span> &#123;</span></span><br><span class=\"line\">   String words</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2><span id=\"3-cha-jian-ding-yi\">3.æ’ä»¶å®šä¹‰</span><a href=\"#3-cha-jian-ding-yi\" class=\"header-anchor\">#</a></h2><p>ã€€ å®šä¹‰æ’ä»¶åªéœ€å®ç°<code>Plugin</code>æ¥å£å³å¯ï¼Œè¯¥æ¥å£åªæä¾›äº†ä¸€ä¸ªæ–¹æ³•ï¼š<code>void apply(Project project)ï¼›</code>ã€‚ç”±<code>DefaultTask</code>ç»§æ‰¿è€Œæ¥çš„<code>Task</code>éƒ½æœ‰ä¸€ä¸ª<code>conventionMapping</code>å±æ€§ï¼Œé€šè¿‡è¿™ä¸ªå±æ€§å¯ä»¥å°†æ‰©å±•æ¨¡å‹çš„å€¼èµ‹å€¼ç»™<code>Task</code>çš„<code>@Input``@Output</code>å‚æ•°ã€‚</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> org.pkaq</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.gradle.api.Plugin</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.gradle.api.Project</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FoLengPlugin</span> <span class=\"keyword\">implements</span> <span class=\"title\">Plugin</span>&lt;<span class=\"title\">Project</span>&gt;&#123;</span></span><br><span class=\"line\">\t<span class=\"meta\">@Override</span>\t\t</span><br><span class=\"line\">    <span class=\"keyword\">void</span> apply(Project project) &#123;</span><br><span class=\"line\">        <span class=\"comment\">/**æ³¨å†Œä¸€ä¸ªæ‰©å±•å®¹å™¨ï¼Œæ‰©å±•å®¹å™¨å¯ä»¥ä½¿æˆ‘ä»¬åœ¨ä¸€ä¸ªé—­åŒ…ä¸­ä¸ºtaskèµ‹å€¼*/</span></span><br><span class=\"line\">        project.extensions.create(<span class=\"string\">&#x27;foleng&#x27;</span>, FolengExtension)</span><br><span class=\"line\">        folengTask(project)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> folengTask(Project project)&#123;</span><br><span class=\"line\">        project.tasks.withType(FoLengTask) &#123;</span><br><span class=\"line\">            <span class=\"comment\">/**æŸ¥æ‰¾æ‰©å±•å®¹å™¨ä¸­å·²é…ç½®çš„å±æ€§*/</span></span><br><span class=\"line\">            <span class=\"keyword\">def</span> extension = project.extensions.findByName(<span class=\"string\">&#x27;foleng&#x27;</span>)</span><br><span class=\"line\">            <span class=\"comment\">/**å°†é—­åŒ…ä¸­çš„æ‰©å±•å±æ€§å€¼èµ‹ç»™ FoLengTask çš„ç›¸å…³å±æ€§*/</span></span><br><span class=\"line\">            conventionMapping.words = &#123; extension.words &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        project.task(<span class=\"string\">&#x27;mlfl&#x27;</span>, <span class=\"attr\">type:</span> FoLengTask) &#123;</span><br><span class=\"line\">            conventionMapping.words = &#123;</span><br><span class=\"line\">               project.hasProperty(<span class=\"string\">&#x27;words&#x27;</span>) ?</span><br><span class=\"line\">                       project.words :</span><br><span class=\"line\">                       project.extensions.findByName(<span class=\"string\">&#x27;foleng&#x27;</span>).words</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            doLast &#123;</span><br><span class=\"line\">                println <span class=\"string\">&#x27; The End &#x27;</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h1><span id=\"fa-bu-cha-jian\">å‘å¸ƒæ’ä»¶</span><a href=\"#fa-bu-cha-jian\" class=\"header-anchor\">#</a></h1><p>ã€€ ã€€ è‡³æ­¤å·²ç»å®Œæˆäº†ä¸€ä¸ªç®€å•æ’ä»¶çš„ç¼–å†™ï¼Œé»˜è®¤æƒ…å†µä¸‹æ’ä»¶çš„IDä¸å·¥ç¨‹çš„åç§°æ˜¯ä¸€è‡´çš„ï¼Œå¦‚æœè¦æ”¹å˜è¿™ä¸ªé»˜è®¤è§„åˆ™å¯ä»¥åœ¨<code>src/main/resources/META-INF/gradle-plugins</code>ä¸‹æ–°å»ºä¸€ä¸ª<code>pluginId.properties</code>çš„æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶çš„åç§°å³ä¸ºæ’ä»¶çš„<code>id</code>ï¼Œåœ¨æ’ä»¶å‘å¸ƒåå¯é€šè¿‡<code>apply plugin:id</code>æ¥å¼•å…¥æ’ä»¶ã€‚å†…å®¹å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">implementation-class</span>=<span class=\"string\">org.pkaq.FoLengPlugin</span></span><br></pre></td></tr></table></figure>\n<h3><span id=\"fa-bu-dao-maven-cang-ku\">å‘å¸ƒåˆ°mavenä»“åº“</span><a href=\"#fa-bu-dao-maven-cang-ku\" class=\"header-anchor\">#</a></h3><p>ã€€ ã€€ ç°åœ¨å¯ä»¥æŠŠç¼–å†™å¥½çš„æ’ä»¶å‘å¸ƒåˆ°<code>Maven</code>ä»“åº“æ¥ä½¿ç”¨äº†ã€‚ä¸è¿‡åœ¨å‘å¸ƒä¹‹å‰å¯ä»¥é€šè¿‡ä½¿ç”¨<code>gradle assemble </code>æœ¬åœ°æ‰“åŒ…æµ‹è¯•ä¸€ä¸‹ã€‚åªéœ€è¦å°†æ‰“åŒ…åçš„<code>jar</code>æ”¾åˆ°éœ€è¦è°ƒç”¨æ’ä»¶çš„å·¥ç¨‹å†…ï¼Œé€šè¿‡æœ¬åœ°æ–‡ä»¶ä»“åº“çš„å½¢å¼å¼•å…¥å³å¯ã€‚å…³äºå¦‚ä½•ä¸Šä¼ åˆ°<code>Maven</code>ä»“åº“ï¼Œè¯·æŸ¥é˜…<code>æ‰“åŒ…ä¸å‘å¸ƒç« èŠ‚</code>è¿›è¡Œè¯¦ç»†äº†è§£ã€‚è¿™é‡Œä½¿ç”¨äº†mavenæ’ä»¶ç®€å•çš„å‘å¸ƒåˆ°äº†æœ¬åœ°ç›®å½•ä¸­ã€‚</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apply <span class=\"attr\">plugin:</span> <span class=\"string\">&#x27;maven&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// å‘å¸ƒæ’ä»¶åˆ°æœ¬åœ°ç›®å½•</span></span><br><span class=\"line\">uploadArchives &#123;</span><br><span class=\"line\">    repositories &#123;</span><br><span class=\"line\">        mavenDeployer &#123;</span><br><span class=\"line\">             repository(<span class=\"attr\">url:</span> uri(<span class=\"string\">&#x27;/opt/repo&#x27;</span>))</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ã€€ ã€€ ä½¿ç”¨æ’ä»¶</p>\n<figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">buildscript</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">repositories</span> &#123; <span class=\"keyword\">flatDir</span> name: <span class=\"string\">&#x27;libs&#x27;</span>, dirs: <span class=\"string\">&quot;libs&quot;</span> &#125;\t</span><br><span class=\"line\">    <span class=\"keyword\">dependencies</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">classpath</span> <span class=\"string\">&#x27;org.pkaq:plugin:1.0&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//åº”ç”¨æ’ä»¶</span></span><br><span class=\"line\">apply plugin: <span class=\"string\">&#x27;org.pkaq.foLeng&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">foleng &#123;</span><br><span class=\"line\">\twords = <span class=\"string\">&#x27;Tom&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3><span id=\"fa-bu-dao-gradle-plugin-portal\">å‘å¸ƒåˆ°<code>Gradle Plugin Portal</code></span><a href=\"#fa-bu-dao-gradle-plugin-portal\" class=\"header-anchor\">#</a></h3><p> ã€€ ã€€ ä¸ºäº†ä¾¿äºæ’ä»¶çš„æ¨å¹¿å’Œæ£€ç´¢ï¼Œæ›´å¥½çš„å½¢å¼æ˜¯å°†ç¼–å†™å¥½çš„æ’ä»¶ä¸Šä¼ åˆ°<code>Gradle Plugin Portal</code>ï¼Œä¸Šä¼ åˆ°<code>Gradle Plugin Portal</code>åªéœ€å¦‚ä¸‹å‡ æ­¥å³å¯ã€‚</p>\n<ol>\n<li>åˆ›å»ºä¸€ä¸ªGradleè´¦æˆ·å’ŒKeyè·å–</li>\n<li>é…ç½®ç›¸å…³Keyå’Œå‘å¸ƒå‚æ•°åˆ°Gradleè„šæœ¬</li>\n</ol>\n<p>ã€€ ã€€ æ³¨å†Œç™»å½•ååœ¨ä¸ªäººä¸­å¿ƒç•Œé¢å¯ä»¥çœ‹åˆ°<code>API Key</code>çš„æ ‡ç­¾é¡µï¼Œå¤åˆ¶keyå’Œsecretåä¿å­˜åˆ°<code>gradle.properties</code>ä¸­å³å¯ã€‚</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">gradle.publish.key</span>=<span class=\"string\">foo</span></span><br><span class=\"line\"><span class=\"meta\">gradle.publish.secret</span>=<span class=\"string\">bar</span></span><br></pre></td></tr></table></figure>\n<p>ã€€ ã€€ è„šæœ¬é…ç½®ï¼Œé¦–å…ˆåº”ç”¨<code>Gradle</code>æä¾›çš„å‘å¸ƒæ’ä»¶ï¼Œç„¶åé’ˆå¯¹æ’ä»¶å‚æ•°è¿›è¡Œé…ç½®ã€‚å¦‚å›¾è¯¥æ’ä»¶æä¾›äº†è§åçŸ¥æ„çš„å±æ€§è¿™é‡Œä¸åšè¿‡å¤šèµ˜è¿°ã€‚</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">plugins</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">id</span> <span class=\"string\">&#x27;java-gradle-plugin&#x27;</span></span><br><span class=\"line\">    id <span class=\"string\">&#x27;com.gradle.plugin-publish&#x27;</span> version <span class=\"string\">&#x27;0.10.0&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">pluginBundle &#123;</span><br><span class=\"line\">    <span class=\"attribute\">website</span> = <span class=\"string\">&#x27;https://github.com/GradleCN/GradleSide&#x27;</span></span><br><span class=\"line\">    vcsUrl = <span class=\"string\">&#x27;https://github.com/GradleCN/GradleSide&#x27;</span></span><br><span class=\"line\">    tags = [<span class=\"string\">&#x27;ä¹°äº†ä½›å†·&#x27;</span>, <span class=\"string\">&#x27;pluginlearn&#x27;</span>]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">gradlePlugin &#123;</span><br><span class=\"line\">    <span class=\"section\">plugins</span> &#123;</span><br><span class=\"line\">        <span class=\"section\">foLeng</span> &#123;</span><br><span class=\"line\">            <span class=\"attribute\">id</span> = <span class=\"string\">&#x27;org.pkaq.foLeng&#x27;</span></span><br><span class=\"line\">            displayName = <span class=\"string\">&#x27;Mai le fo leng?&#x27;</span></span><br><span class=\"line\">            description = <span class=\"string\">&#x27;&lt;a plugin demo&gt;&#x27;</span></span><br><span class=\"line\">            implementationClass = <span class=\"string\">&#x27;org.pkaq.FoLengPlugin&#x27;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<hr>\n<p>å®Œæ•´è„šæœ¬å¦‚ä¸‹</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plugins &#123;</span><br><span class=\"line\">    id <span class=\"string\">&#x27;java-gradle-plugin&#x27;</span></span><br><span class=\"line\">    id <span class=\"string\">&#x27;com.gradle.plugin-publish&#x27;</span> version <span class=\"string\">&#x27;0.10.0&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">apply <span class=\"attr\">plugin:</span> <span class=\"string\">&#x27;groovy&#x27;</span></span><br><span class=\"line\">apply <span class=\"attr\">plugin:</span> <span class=\"string\">&#x27;maven&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">group = <span class=\"string\">&#x27;org.pakq&#x27;</span></span><br><span class=\"line\">archivesBaseName=<span class=\"string\">&quot;plugin&quot;</span></span><br><span class=\"line\">version = <span class=\"string\">&#x27;1.0&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">pluginBundle &#123;</span><br><span class=\"line\">    website = <span class=\"string\">&#x27;https://github.com/GradleCN/GradleSide&#x27;</span></span><br><span class=\"line\">    vcsUrl = <span class=\"string\">&#x27;https://github.com/GradleCN/GradleSide&#x27;</span></span><br><span class=\"line\">    tags = [<span class=\"string\">&#x27;ä¹°äº†ä½›å†·&#x27;</span>, <span class=\"string\">&#x27;pluginlearn&#x27;</span>]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">gradlePlugin &#123;</span><br><span class=\"line\">    plugins &#123;</span><br><span class=\"line\">        foLeng &#123;</span><br><span class=\"line\">            id = <span class=\"string\">&#x27;org.pkaq.foLeng&#x27;</span></span><br><span class=\"line\">            displayName = <span class=\"string\">&#x27;Mai le fo leng?&#x27;</span></span><br><span class=\"line\">            description = <span class=\"string\">&#x27;&lt;a plugin demo&gt;&#x27;</span></span><br><span class=\"line\">            implementationClass = <span class=\"string\">&#x27;org.pkaq.FoLengPlugin&#x27;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">repositories &#123;</span><br><span class=\"line\">    mavenCentral()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">dependencies &#123;</span><br><span class=\"line\">    compile localGroovy() </span><br><span class=\"line\">    compile gradleApi() </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// å‘å¸ƒæ’ä»¶åˆ°æœ¬åœ°ç›®å½•</span></span><br><span class=\"line\">uploadArchives &#123;</span><br><span class=\"line\">    repositories &#123;</span><br><span class=\"line\">        mavenDeployer &#123;</span><br><span class=\"line\">             repository(<span class=\"attr\">url:</span> uri(<span class=\"string\">&#x27;/opt/repo&#x27;</span>))</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","categories":["Build Tools"],"tags":["Gradle"]},{"title":"ä½¿ç”¨pt-archiverè¿›è¡Œæ•°æ®å½’æ¡£","url":"https://pkaq.org/2018/12/04/pt-archiver/","content":"<h1><span id=\"yin-yan\">å¼•è¨€</span><a href=\"#yin-yan\" class=\"header-anchor\">#</a></h1><p>â€‹    pt-archiveræ˜¯perconaå·¥å…·é›†çš„ä¸€å‘˜ ,å¯ä»¥æ–¹ä¾¿é’ˆå¯¹æ•°æ®åº“æ•°æ®ä¸åŒåœºæ™¯è¿›è¡Œæ¸…ç†\\å¯¼å‡º\\åˆå¹¶ç­‰æ“ä½œã€‚</p>\n<a id=\"more\"></a>\n\n<h1><span id=\"ban-ben\">ç‰ˆæœ¬</span><a href=\"#ban-ben\" class=\"header-anchor\">#</a></h1><ul>\n<li>mysql: 5.7.22</li>\n<li>Percona Toolkit: 3.0.12<h1><span id=\"bu-zou\">æ­¥éª¤</span><a href=\"#bu-zou\" class=\"header-anchor\">#</a></h1></li>\n</ul>\n<h3><span id=\"1-an-zhuang-yi-lai\">1.å®‰è£…ä¾èµ–</span><a href=\"#1-an-zhuang-yi-lai\" class=\"header-anchor\">#</a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y perl perl-IO-Socket-SSL perl-DBD-MySQL perl-Time-HiRes perl-Digest-MD5 perl-ExtUtils-MakeMaker</span><br></pre></td></tr></table></figure>\n<h3><span id=\"2-xia-zai-an-zhuang-pt-archiver\">2.ä¸‹è½½ å®‰è£…pt-archiver</span><a href=\"#2-xia-zai-an-zhuang-pt-archiver\" class=\"header-anchor\">#</a></h3><p><a href=\"https://www.percona.com/downloads/percona-toolkit/LATEST/\">ä¸‹è½½Percona Toolkit</a>ï¼Œé€‰æ‹©ä¸ç›®æ ‡ç³»ç»ŸåŒ¹é…çš„ç‰ˆæœ¬ï¼Œä¸‹è½½ç›¸åº”rpmè¿›è¡Œå®‰è£…ã€‚</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rpm ivh percona-toolkit-3.0.12-1.el7.x86_64.rpm</span><br></pre></td></tr></table></figure>\n<h3><span id=\"3-pei-zhi-gui-dang-gui-ze\">3.é…ç½®å½’æ¡£è§„åˆ™</span><a href=\"#3-pei-zhi-gui-dang-gui-ze\" class=\"header-anchor\">#</a></h3><p><code>pt-archiver </code>çš„åŸºæœ¬ç”¨æ³•å¦‚ä¸‹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pt-archiver [OPTIONS] --source DSN [--dest DSN] --where WHERE</span><br><span class=\"line\"></span><br><span class=\"line\">DSNçš„è¯¦ç»†å‚æ•°ï¼š</span><br><span class=\"line\">a:æŸ¥è¯¢</span><br><span class=\"line\">A:å­—ç¬¦é›†</span><br><span class=\"line\">bï¼štrueä»£è¡¨ç¦ç”¨binlog</span><br><span class=\"line\">Dï¼šæ•°æ®åº“</span><br><span class=\"line\">uï¼šæ•°æ®åº“é“¾æ¥è´¦å·</span><br><span class=\"line\">pï¼šæ•°æ®åº“é“¾æ¥å¯†ç </span><br><span class=\"line\">hï¼šä¸»æœºIP</span><br><span class=\"line\">Fï¼šé…ç½®æ–‡ä»¶ä½ç½®</span><br><span class=\"line\">iï¼šæ˜¯å¦ä½¿ç”¨æŸç´¢å¼•</span><br><span class=\"line\">mï¼šæ’ä»¶æ¨¡å—</span><br><span class=\"line\">Pï¼šç«¯å£å·</span><br><span class=\"line\">Sï¼šsocketæ–‡ä»¶</span><br><span class=\"line\">tï¼šè¡¨</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pt-archiver  \\</span><br><span class=\"line\">--source h=ip,P=3306,p=&#x27;pwd!&#x27;,D=dbname,t=tablename  \\</span><br><span class=\"line\">--charset=UTF8  \\</span><br><span class=\"line\">--where &#x27;condition=curdate()-1&#x27;  \\</span><br><span class=\"line\">--progress 5000 --file &quot;/opt/data/pt-archinver/%t-%Y%m%d.dat&quot;  \\</span><br><span class=\"line\">--statistics --limit 5000 --txn-size 1000 --bulk-delete</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>å‚æ•°è¯´æ˜:</p>\n<p>â€“source : æ¥æºæ•°æ®, å­å‚æ•°å‚è§ä¸Šæ–‡</p>\n<p>â€“charset: å­—ç¬¦ç¼–ç </p>\n<p>â€“ where: å½’æ¡£æ¡ä»¶</p>\n<p>â€“progress 5000: æ¯5000è¡Œæ‰“å°ä¸€æ¬¡ä¿¡æ¯</p>\n<p>â€“file : å¯¼å‡ºçš„æ–‡ä»¶å <strong>å¯¼å‡ºçš„è·¯å¾„å¿…é¡»å­˜åœ¨</strong></p>\n<p>â€“statistics:ç»“æŸçš„æ—¶å€™ç»™å‡ºç»Ÿè®¡ä¿¡æ¯ï¼šå¼€å§‹çš„æ—¶é—´ç‚¹ï¼Œç»“æŸçš„æ—¶é—´ç‚¹ï¼ŒæŸ¥è¯¢çš„è¡Œæ•°ï¼Œå½’æ¡£çš„è¡Œæ•°ï¼Œåˆ é™¤çš„è¡Œæ•°ï¼Œä»¥åŠå„ä¸ªé˜¶æ®µæ¶ˆè€—çš„æ€»çš„æ—¶é—´å’Œæ¯”ä¾‹ï¼Œä¾¿äºä»¥æ­¤è¿›è¡Œä¼˜åŒ–ã€‚ </p>\n<p>â€“limit 5000: æ¯æ¬¡äº‹åŠ¡åˆ é™¤5000æ¡æ•°æ®ï¼Œé»˜è®¤1æ¡ </p>\n<p>â€“txn-size 1000: æ¯ä¸ªäº‹åŠ¡æäº¤çš„æ•°æ®è¡Œæ•°ï¼ˆåŒ…æ‹¬è¯»å†™æ“ä½œï¼‰ï¼Œæ‰¹é‡æäº¤ </p>\n<p>â€“bulk-delete: æ‰¹é‡åˆ é™¤sourceä¸Šçš„æ—§æ•°æ® </p>\n</blockquote>\n<h2><span id=\"ding-shi-gui-dang\">å®šæ—¶å½’æ¡£</span><a href=\"#ding-shi-gui-dang\" class=\"header-anchor\">#</a></h2><p>æŠŠå½’æ¡£å‘½ä»¤å­˜æˆ<code>.sh</code>è„šæœ¬å,ä½¿ç”¨<code>crontab -e</code>åˆ›å»ºå®šæ—¶ä»»åŠ¡å®ç°å®šæ—¶å½’æ¡£ã€‚å¦‚ä¸‹ç¤ºä¾‹ä¸ºæ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡:</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">* */1 * * *  sh /opt/cronjob/archiver.sh</span><br></pre></td></tr></table></figure>\n<h2><span id=\"fu-lu\">é™„å½•</span><a href=\"#fu-lu\" class=\"header-anchor\">#</a></h2><p><strong>å¸¸ç”¨å‚æ•°è¯´æ˜</strong></p>\n<blockquote>\n<p><strong>â€“limit10000</strong>       æ¯æ¬¡å–1000è¡Œæ•°æ®ç”¨pt-archiveå¤„ç†ï¼ŒNumber of rows to fetch and archive per statement.<br><strong>â€“txn-size  1000</strong>   è®¾ç½®1000è¡Œä¸ºä¸€ä¸ªäº‹åŠ¡æäº¤ä¸€æ¬¡ï¼ŒNumber of rows pertransaction.<br><strong>â€“whereâ€˜id&lt;3000â€˜</strong>   è®¾ç½®æ“ä½œæ¡ä»¶<br><strong>â€“progress5000</strong>     æ¯å¤„ç†5000è¡Œè¾“å‡ºä¸€æ¬¡å¤„ç†ä¿¡æ¯<br><strong>â€“statistics</strong>       è¾“å‡ºæ‰§è¡Œè¿‡ç¨‹åŠæœ€åçš„æ“ä½œç»Ÿè®¡ã€‚ï¼ˆåªè¦ä¸åŠ ä¸Šâ€“quietï¼Œé»˜è®¤æƒ…å†µä¸‹pt-archiveéƒ½ä¼šè¾“å‡ºæ‰§è¡Œè¿‡ç¨‹çš„ï¼‰<br><strong>â€“charset=UTF8</strong>     æŒ‡å®šå­—ç¬¦é›†ä¸ºUTF8<br><strong>â€“bulk-delete</strong>      æ‰¹é‡åˆ é™¤sourceä¸Šçš„æ—§æ•°æ®(ä¾‹å¦‚æ¯æ¬¡1000è¡Œçš„æ‰¹é‡åˆ é™¤æ“ä½œ)<br><strong>â€“bulk-insert</strong>      æ‰¹é‡æ’å…¥æ•°æ®åˆ°destä¸»æœº (çœ‹destçš„general logå‘ç°å®ƒæ˜¯é€šè¿‡åœ¨destä¸»æœºä¸ŠLOAD DATA LOCAL INFILEæ’å…¥æ•°æ®çš„)<br><strong>â€“replace</strong>          å°†insert into è¯­å¥æ”¹æˆreplaceå†™å…¥åˆ°deståº“<br><strong>â€“sleep120</strong>         æ¯æ¬¡å½’æ¡£äº†limitä¸ªè¡Œè®°å½•åçš„ä¼‘çœ 120ç§’ï¼ˆå•ä½ä¸ºç§’ï¼‰<br><strong>â€“file â€˜/root/test.txtâ€˜</strong>ï¼šæ•°æ®å­˜æ”¾çš„æ–‡ä»¶ï¼Œæœ€å¥½æŒ‡å®šç»å¯¹è·¯å¾„ï¼Œæ–‡ä»¶åå¯ä»¥çµæ´»åœ°ç»„åˆ<br><strong>â€“purge</strong>             åˆ é™¤sourceæ•°æ®åº“çš„ç›¸å…³åŒ¹é…è®°å½•<br><strong>â€“header</strong>            è¾“å…¥åˆ—åç§°åˆ°é¦–è¡Œï¼ˆå’Œâ€“fileä¸€èµ·ä½¿ç”¨ï¼‰<br><strong>â€“no-check-charset</strong>  ä¸æŒ‡å®šå­—ç¬¦é›†<br><strong>â€“check-columns</strong>    æ£€éªŒdestå’Œsourceçš„è¡¨ç»“æ„æ˜¯å¦ä¸€è‡´ï¼Œä¸ä¸€è‡´è‡ªåŠ¨æ‹’ç»æ‰§è¡Œï¼ˆä¸åŠ è¿™ä¸ªå‚æ•°ä¹Ÿè¡Œã€‚é»˜è®¤å°±æ˜¯æ‰§è¡Œæ£€æŸ¥çš„ï¼‰<br><strong>â€“no-check-columns</strong>    ä¸æ£€éªŒdestå’Œsourceçš„è¡¨ç»“æ„æ˜¯å¦ä¸€è‡´ï¼Œä¸ä¸€è‡´ä¹Ÿæ‰§è¡Œï¼ˆä¼šå¯¼è‡´destä¸Šçš„æ— æ³•ä¸sourceåŒ¹é…çš„åˆ—å€¼è¢«ç½®ä¸ºnullæˆ–è€…0ï¼‰<br><strong>â€“chekc-interval</strong>      é»˜è®¤1sæ£€æŸ¥ä¸€æ¬¡<br><strong>â€“local</strong>            ä¸æŠŠoptimizeæˆ–analyzeæ“ä½œå†™å…¥åˆ°binlogé‡Œé¢ï¼ˆé˜²æ­¢é€ æˆä¸»ä»å»¶è¿Ÿå·¨å¤§ï¼‰<br><strong>â€“retries</strong>         è¶…æ—¶æˆ–è€…å‡ºç°æ­»é”çš„è¯ï¼Œpt-archiverè¿›è¡Œé‡è¯•çš„é—´éš”ï¼ˆé»˜è®¤1sï¼‰<br><strong>â€“no-version-check</strong>   ç›®å‰ä¸ºæ­¢ï¼Œå‘ç°éƒ¨åˆ†ptå·¥å…·å¯¹é˜¿é‡Œäº‘RDSæ“ä½œå¿…é¡»åŠ è¿™ä¸ªå‚æ•°<br><strong>â€“analyze=ds</strong>      æ“ä½œç»“æŸåï¼Œä¼˜åŒ–è¡¨ç©ºé—´ï¼ˆdè¡¨ç¤ºdestï¼Œsè¡¨ç¤ºsourceï¼‰<br> é»˜è®¤æƒ…å†µä¸‹ï¼Œpt-archiveræ“ä½œç»“æŸåï¼Œä¸ä¼šå¯¹sourceã€destè¡¨æ‰§è¡Œanalyzeæˆ–optimizeæ“ä½œï¼Œå› ä¸ºè¿™ç§æ“ä½œè´¹æ—¶é—´ï¼Œå¹¶ä¸”éœ€è¦ä½ æå‰é¢„ä¼°æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´ç”¨äºæ‹·è´è¡¨ã€‚ä¸€èˆ¬å»ºè®®ä¹Ÿæ˜¯pt-archiveræ“ä½œç»“æŸåï¼Œåœ¨ä¸šåŠ¡ä½è°·æ‰‹åŠ¨æ‰§è¡Œanalyze tableç”¨ä»¥å›æ”¶è¡¨ç©ºé—´ã€‚</p>\n</blockquote>\n","categories":["æ•°æ®åº“"],"tags":["mysql"]},{"title":"ä½¿ç”¨Let's encryptå’Œnginxé…ç½®httpsè®¿é—®","url":"https://pkaq.org/2018/12/01/https/","content":"<h1><span id=\"yin-yan\">å¼•è¨€</span><a href=\"#yin-yan\" class=\"header-anchor\">#</a></h1><p>ã€€ã€€Letâ€™s Encrypt æ˜¯ä¸€ä¸ªå°†äº2015å¹´æœ«æ¨å‡ºçš„æ•°å­—è¯ä¹¦è®¤è¯æœºæ„ï¼Œå°†é€šè¿‡æ—¨åœ¨æ¶ˆé™¤å½“å‰æ‰‹åŠ¨åˆ›å»ºå’Œå®‰è£…è¯ä¹¦çš„å¤æ‚è¿‡ç¨‹çš„è‡ªåŠ¨åŒ–æµç¨‹ï¼Œä¸ºå®‰å…¨ç½‘ç«™æä¾›å…è´¹çš„SSL/TLSè¯ä¹¦ ï¼Œ è™½ç„¶Letâ€™s Encryptâ€™sè¯ä¹¦æœ‰æ•ˆæœŸåªæœ‰90å¤©ï¼Œä¸è¿‡ä½ å¯ä»¥é€šè¿‡é…ç½®ä¸€ä¸ªç®€å•çš„å®šæ—¶ä»»åŠ¡æ¥å…è´¹æ›´æ–°ä½ çš„è¯ä¹¦ã€‚</p>\n<h1><span id=\"ban-ben\">ç‰ˆæœ¬</span><a href=\"#ban-ben\" class=\"header-anchor\">#</a></h1><ul>\n<li>CentOS Linux 7 (Core) x86_64 </li>\n<li>nginx 1.12.2</li>\n</ul>\n<h1><span id=\"bu-zou\">æ­¥éª¤</span><a href=\"#bu-zou\" class=\"header-anchor\">#</a></h1><h2><span id=\"nginx-pei-zhi\">nginxé…ç½®</span><a href=\"#nginx-pei-zhi\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€é¦–å…ˆè¦é…ç½®<code>nginx</code>çš„<code>server</code>èŠ‚ç‚¹ï¼Œç”¨ä»¥<code>lets&#39;s encrypt </code>è¿›è¡ŒåŸŸåéªŒè¯ã€‚</p>\n<figure class=\"highlight lua\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">\tserver_name yourdomain.com;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>é…ç½®å®Œæˆåï¼Œ<code>reload</code>ä¸€ä¸‹<code>nginx</code>é…ç½®</p>\n<h2><span id=\"zheng-shu-huo-qu\">è¯ä¹¦è·å–</span><a href=\"#zheng-shu-huo-qu\" class=\"header-anchor\">#</a></h2><h3><span id=\"an-zhuang-certbot\">å®‰è£…Certbot</span><a href=\"#an-zhuang-certbot\" class=\"header-anchor\">#</a></h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://dl.eff.org/certbot-auto </span><br><span class=\"line\">chmod a+x ./certbot-auto </span><br></pre></td></tr></table></figure>\n<h3><span id=\"zheng-shu-shen-qing\">è¯ä¹¦ç”³è¯·</span><a href=\"#zheng-shu-shen-qing\" class=\"header-anchor\">#</a></h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./certbot-auto -d yourdomain.com</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>ä½¿ç”¨ -d å‚æ•°æ¥æŒ‡å®šä½ çš„åŸŸå</p>\n<p>ç”³è¯·æ—¶æ ¹æ®æç¤ºè¾“å…¥ä½ çš„<code>Email</code>å¹¶ä¸”åŒæ„åè®®ç­‰ã€‚å®Œæˆåä¼šè‡ªåŠ¨é…ç½®<code>nginx</code></p>\n<p>æ³¨æ„: <code>https</code>èµ°çš„æ˜¯443ç«¯å£ï¼Œè®°å¾—é˜²ç«å¢™æ”¾å¼€443ç«¯å£çš„è®¿é—®</p>\n</blockquote>\n<h2><span id=\"zi-dong-geng-xin\">è‡ªåŠ¨æ›´æ–°</span><a href=\"#zi-dong-geng-xin\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€ä½¿ç”¨<code>crontab -e</code>åˆ›å»ºå®šæ—¶ä»»åŠ¡ï¼Œæ¥å®šæ—¶æ›´æ–°ä½ çš„è¯ä¹¦æ–‡ä»¶ã€‚</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">0 0 15 1-12/2 * /path/of/your/certbot-auto renew --quiet</span><br></pre></td></tr></table></figure>\n\n\n<h2><span id=\"zheng-shu-guan-li\">è¯ä¹¦ç®¡ç†</span><a href=\"#zheng-shu-guan-li\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ä¸ªå‘½ä»¤å‚æ•°æ¥ç®¡ç†ä½ çš„è¯ä¹¦</p>\n<figure class=\"highlight asciidoc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"bullet\">- </span>certificates    æ˜¾ç¤ºè¯ä¹¦ä¿¡æ¯</span><br><span class=\"line\"><span class=\"bullet\">- </span>revoke          æ’¤é”€è¯ä¹¦ï¼ˆæä¾›è¯ä¹¦è·¯å¾„ --cert-pathï¼‰</span><br><span class=\"line\"><span class=\"bullet\">- </span>delete          åˆ é™¤è¯ä¹¦</span><br></pre></td></tr></table></figure>\n","categories":["Http"],"tags":["nginx","https"]},{"title":"ä½¿ç”¨Syncthingè‡ªå»ºç½‘ç›˜","url":"https://pkaq.org/2018/12/01/syncthing/","content":"<h1><span id=\"yin-yan\">å¼•è¨€</span><a href=\"#yin-yan\" class=\"header-anchor\">#</a></h1><p>ã€€ã€€<code>Syncthing</code>æ˜¯ä¸€ä¸ªå¼€æºå…è´¹çš„æ–‡ä»¶å¤¹/æ–‡ä»¶åŒæ­¥ç¥å™¨ï¼Œæ”¯æŒ<code>Android</code>ã€<code>Linux</code>ã€<code>Windows</code>ã€<code>Mac OS X</code>ç­‰ç³»ç»Ÿï¼Œå¯ä»¥ä½¿æˆ‘ä»¬ä»»æ„å°ä»»ä½•ç³»ç»Ÿä»»ä½•è®¾å¤‡ä¹‹é—´ï¼Œå®ç°æ–‡ä»¶å®æ—¶åŒæ­¥ã€‚æ‰€æœ‰é€šä¿¡éƒ½ä½¿ç”¨<code>TLS</code>è¿›è¡Œä¿æŠ¤ã€‚æ‰€ä½¿ç”¨çš„åŠ å¯†åŒ…æ‹¬å®Œç¾çš„å‰å‘ä¿å¯†ï¼Œä»¥é˜²æ­¢çªƒå¬è€…è·å¾—å¯¹æ‚¨çš„æ•°æ®çš„è®¿é—®æƒé™ã€‚å¾ˆé€‚åˆç”¨æ¥æ­å»ºç§æœ‰åŒæ­¥ç½‘ç›˜ã€‚ </p>\n<h1><span id=\"ban-ben\">ç‰ˆæœ¬</span><a href=\"#ban-ben\" class=\"header-anchor\">#</a></h1><ul>\n<li>Centos OS7 + Win10 x64</li>\n<li>Syncthing v0.14.52</li>\n<li>Docker version 1.13.1</li>\n</ul>\n<p>#æ­¥éª¤</p>\n<h2><span id=\"la-qu-jing-xiang\">æ‹‰å–é•œåƒ</span><a href=\"#la-qu-jing-xiang\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€ä½¿ç”¨<code>docker pull syncthing/syncthing</code>æ‹‰å–æœ€æ–°é•œåƒã€‚</p>\n<h2><span id=\"chuang-jian-rong-qi\">åˆ›å»ºå®¹å™¨</span><a href=\"#chuang-jian-rong-qi\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤åˆ›å»ºå®¹å™¨, è¿™é‡Œéœ€è¦æ³¨æ„ å¤–æŒ‚çš„ç›®å½•éœ€è¦æ‰§è¡Œ<code>chown -R 1000:1000 dir</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker create --name syncthing -p 8384:8384 -p 22000:22000 -p 21027:21027/udp -v /opt/data/docker/syncthing/st-cfg:/var/syncthing/config -v /opt/data/docker/syncthing/st-sync:/var/syncthing docker.io/syncthing/syncthing:latest </span><br></pre></td></tr></table></figure>\n<p>ã€€ã€€å‚æ•°è¯´æ˜ï¼š</p>\n<ul>\n<li> â€“nameï¼š å®¹å™¨åˆ«å</li>\n<li>-pï¼š æ˜ å°„ä¸»æœºç«¯å£</li>\n<li>-vï¼š æ˜ å°„ä¸»æœºç›®å½•</li>\n</ul>\n<p>ã€€ã€€å®¹å™¨åˆ›å»ºå®Œæˆåï¼Œä½¿ç”¨<code>docker start syncthing</code>å³å¯å¯åŠ¨å®¹å™¨ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œéœ€è¦æ”¾å¼€é˜²ç«å¢™å¯¹8384ç«¯å£çš„è®¿é—®ã€‚</p>\n<p>ã€€ã€€å¯åŠ¨å®Œæˆåï¼Œè®¿é—®<code>http://ip:8384</code>å³å¯ã€‚</p>\n<h2><span id=\"an-quan-fang-wen\">å®‰å…¨è®¿é—®</span><a href=\"#an-quan-fang-wen\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€è®¿é—®åˆ°webuiç•Œé¢åï¼Œä¾æ¬¡ç‚¹å‡»<code>æ“ä½œ-&gt;è®¾ç½®-&gt;å›¾å½¢ç”¨æˆ·ç•Œé¢</code>ï¼Œè®¾ç½®ç”¨æˆ·å/å¯†ç ã€‚\nã€€ã€€</p>\n<h2><span id=\"wen-jian-tong-bu\">æ–‡ä»¶åŒæ­¥</span><a href=\"#wen-jian-tong-bu\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€åœ¨ä½ çš„<code>Windows</code>æœºå™¨ä¸‹è½½ç›¸åº”çš„å®¢æˆ·ç«¯ï¼Œå¯åŠ¨åç‚¹å‡»<code>æ·»åŠ è¿œç¨‹è®¾å¤‡</code>ï¼Œæ­¤æ—¶ä¼šè¦æ±‚ä½ è¾“å…¥è¿œç¨‹è®¾å¤‡çš„IDï¼Œæ‰“å¼€ä½ çš„è¿œç¨‹ç•Œé¢ï¼Œç‚¹å‡»<code>æ“ä½œ-&gt;æ˜¾ç¤ºID</code>å°†ç›¸åº”è®¾å¤‡IDå¤åˆ¶åå¡«å…¥å³å¯ã€‚</p>\n<p>ã€€ã€€ç•Œé¢å·¦ä¾§å¯ä»¥ç‚¹å‡»<code>æ·»åŠ æ–‡ä»¶å¤¹</code>æ·»åŠ éœ€è¦åŒæ­¥çš„æ–‡ä»¶å¤¹ï¼Œé»˜è®¤ä¼šä¸€å°æ—¶æ‰«æä¸€æ¬¡ç£ç›˜æ›´æ”¹ï¼Œå¯ä»¥ç‚¹å‡»<code>é€‰é¡¹</code>é‡æ–°è®¾ç½®æ‰«æé—´éš”ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„é—´éš”å•ä½æ˜¯<code>ç§’</code>ã€‚è®¾ç½®å®Œæˆåä¾¿ä¼šå¼€å§‹åŒæ­¥å•¦ã€‚</p>\n","categories":["The Others"],"tags":["Syncthing"]},{"title":"ä½¿ç”¨ Docker å‘å¸ƒ Spring Boot åº”ç”¨","url":"https://pkaq.org/2018/09/16/sbwithdocker/","content":"<h1><span id=\"yin-yan\">å¼•è¨€</span><a href=\"#yin-yan\" class=\"header-anchor\">#</a></h1><p>ã€€ã€€ä¸€ä¸ª <code>Spring Boot</code>  åº”ç”¨åœ¨ç¼–å†™å®Œæˆåï¼Œå¯ä»¥æ–¹ä¾¿çš„æ‰“åŒ…æˆä¸€ä¸ª <code>jar</code> æ–‡ä»¶ç›´æ¥è¿è¡Œã€‚é€šå¸¸çš„åšæ³•æ˜¯ä½¿ç”¨ <code>nohup java -jar app.jar &amp;</code> çš„æ–¹å¼ä½¿å…¶åœ¨æœåŠ¡å™¨åå°è¿è¡Œã€‚ è¿™ç§æ–¹å¼å¯¹æœåŠ¡å™¨ç¯å¢ƒä¸ä»…æœ‰ç€å¾ˆå¼ºçš„ä¾èµ–å¹¶ä¸”ä¼šäº§ç”Ÿä¸€ä¸ªéšæ—¶é—´æ¨ç§»è¶Šæ¥è¶Šå¤§çš„ <code>nohup</code> æ–‡ä»¶ ï¼Œè™½ç„¶å¯ä»¥åˆ©ç”¨ç®¡é“é»‘æ´å°†å…¶è¾“å‡ºåˆ°æœªçŸ¥é¢†åŸŸï¼Œä½†æ˜¯å¯¹äºè¿è¡Œç‰ˆæœ¬çš„ç®¡ç†ä»ç„¶ä¾èµ–äºäººè‚‰å¤‡ä»½çš„æ–¹å¼ã€‚</p>\n<p>ã€€ã€€å€ŸåŠ© <code>Docker</code>  ä¸ä»…å¯ä»¥åšåˆ°è¿è¡Œç¯å¢ƒä¸æœåŠ¡å™¨ç¯å¢ƒçš„éš”ç¦»ï¼ŒåŒæ—¶å¯ä»¥æ–¹ä¾¿çš„ç®¡ç†å‘å¸ƒç‰ˆæœ¬ã€‚é€šè¿‡ç‰ˆæœ¬ <code>tag</code>  ä¸ä»…å¯ä»¥æ–¹ä¾¿çš„å›æ»šåˆ°ç›¸åº”ç‰ˆæœ¬ï¼Œä½¿ç”¨ç«¯å£æ˜ å°„ä¹Ÿå¯ä»¥æ–¹ä¾¿çš„é…åˆè“ç»¿å‘å¸ƒã€‚</p>\n<a id=\"more\"></a>\n\n<h1><span id=\"ban-ben\">ç‰ˆæœ¬</span><a href=\"#ban-ben\" class=\"header-anchor\">#</a></h1><ul>\n<li>Spring Bootï¼š 2.0.5 Release</li>\n<li>Dockerï¼š</li>\n<li>Centos: 7.3</li>\n</ul>\n<h1><span id=\"bu-zou\">æ­¥éª¤</span><a href=\"#bu-zou\" class=\"header-anchor\">#</a></h1><h2><span id=\"1-bian-xie-jiao-ben\">1.ç¼–å†™è„šæœ¬</span><a href=\"#1-bian-xie-jiao-ben\" class=\"header-anchor\">#</a></h2><figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># åŸºäºå“ªä¸ªé•œåƒ</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> daocloud.io/java:<span class=\"number\">8</span></span><br><span class=\"line\"><span class=\"comment\"># ä½œè€…</span></span><br><span class=\"line\"><span class=\"keyword\">MAINTAINER</span> PKAQ <span class=\"comment\">#pkaq@msn.com</span></span><br><span class=\"line\"><span class=\"comment\"># åœ¨å®¿ä¸»æœºçš„/var/lib/dockerç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªä¸´æ—¶æ–‡ä»¶å¹¶æŠŠå®ƒé“¾æ¥åˆ°å®¹å™¨ä¸­çš„/tmpç›®å½•ã€‚</span></span><br><span class=\"line\"><span class=\"keyword\">VOLUME</span><span class=\"bash\"> /tmp</span></span><br><span class=\"line\"><span class=\"comment\"># å°†æ‰“åŒ…å¥½çš„springç¨‹åºæ‹·è´åˆ°å®¹å™¨ä¸­çš„æŒ‡å®šä½ç½®</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> ./build/lib/app.jar /opt/app.jar</span></span><br><span class=\"line\"><span class=\"comment\">#å®¹å™¨å¯¹å¤–æš´éœ²9006</span></span><br><span class=\"line\"><span class=\"keyword\">EXPOSE</span> <span class=\"number\">9006</span></span><br><span class=\"line\"><span class=\"comment\"># å®¹å™¨å¯åŠ¨åæ‰§è¡Œçš„å‘½ä»¤</span></span><br><span class=\"line\"><span class=\"keyword\">ENTRYPOINT</span><span class=\"bash\"> [<span class=\"string\">&quot;java&quot;</span>,<span class=\"string\">&quot;-Djava.security.egd=file:/dev/./urandom&quot;</span>,<span class=\"string\">&quot;-jar&quot;</span>,<span class=\"string\">&quot;/opt/app.jar&quot;</span>]</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n<h2><span id=\"2-gou-jian-jing-xiang\">2.æ„å»ºé•œåƒ</span><a href=\"#2-gou-jian-jing-xiang\" class=\"header-anchor\">#</a></h2><p>ã€€    åœ¨ <code>Dockerfile</code> æ‰€åœ¨ç›®å½•ï¼Œä½¿ç”¨ <code>docker build -t MyApp:1.0 .</code>  è¿™å¥è¯çš„æ„æ€æ˜¯ä»å½“å‰ç›®å½•çš„ <code>Dockerfile</code> æ–‡ä»¶æ„å»ºä¸€ä¸ªåä¸º <code>MyApp</code> ï¼Œç‰ˆæœ¬ä¸º <code>1.0</code>  çš„é•œåƒã€‚</p>\n<h2><span id=\"3-yun-xing-rong-qi\">3.è¿è¡Œå®¹å™¨</span><a href=\"#3-yun-xing-rong-qi\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€ä½¿ç”¨ <code>docker run -d -e &quot;SPRING_PROFILES_ACTIVE=dev&quot; -p 9006:9006 --name Myapp1.0 Myapp:1.0</code></p>\n<p>ã€€ã€€ä¸Šé¢æ“ä½œçš„æ„æ€æ˜¯ </p>\n<ul>\n<li><p><code>-d</code> : ä»¥å®ˆæŠ¤è¿›ç¨‹è¿è¡Œä¸€ä¸ªå®¹å™¨</p>\n</li>\n<li><p><code>-e</code> : ä¸ºå®¹å™¨ä¼ é€’ä¸€ä¸ªç¯å¢ƒå˜é‡</p>\n</li>\n<li><p><code>-p</code>ï¼šæ˜ å°„å®¹å™¨ç«¯å£ 9006 åˆ°å®¿ä¸»æœºçš„ 9006</p>\n</li>\n<li><p><code>--name</code>ï¼šæŒ‡å®šå®¹å™¨çš„åˆ«å</p>\n</li>\n</ul>\n<p>ã€€ã€€ä¸‹é¢æ˜¯é’ˆå¯¹å®¹å™¨æ“ä½œçš„å‡ ä¸ªå¸¸ç”¨å‘½ä»¤ï¼š   </p>\n<ul>\n<li><p>å¯åŠ¨å®¹å™¨ï¼š<code>docker start Myapp1.0 </code></p>\n</li>\n<li><p>åœæ­¢å®¹å™¨ï¼š<code>docker stop Myapp1.0 </code></p>\n</li>\n<li><p>åˆ é™¤å®¹å™¨ï¼š<code>docker rm Myapp1.0 </code></p>\n</li>\n</ul>\n<h2><span id=\"4-ying-yong-sheng-ji\">4.åº”ç”¨å‡çº§</span><a href=\"#4-ying-yong-sheng-ji\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€è¦å‡çº§åº”ç”¨ç‰ˆæœ¬æ—¶ï¼Œéœ€è¦é‡å¤æ­¥éª¤ 2-3 æ„å»ºæ–°çš„ <code>Dockerfile</code> é•œåƒã€‚éœ€è¦æ³¨æ„çš„æ˜¯ä¸è¦å¿˜è®°ä¿®æ”¹æ„å»ºæ—¶çš„ç‰ˆæœ¬å·ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡ <code>-p</code> å‚æ•°åœ¨ä¸ä¸Šä¸€ä¸ªç‰ˆæœ¬ä¸åŒçš„ç«¯å£ä¸Šå¯åŠ¨ä¸€ä¸ªæ–°çš„å®¹å™¨ã€‚é…åˆ <code>LB</code> å·¥å…·ï¼ˆå¦‚ <code>nginx</code>ï¼‰åˆ‡æ¢åˆ°æ–°çš„å®¹å™¨ä¸Šå®ç°è“ç»¿éƒ¨ç½²ã€‚</p>\n<p>ã€€ã€€å¦‚æœå‘å¸ƒå‡ºç°é—®é¢˜ï¼Œå¦‚æœåº”ç”¨äº†è“ç»¿éƒ¨ç½²åªéœ€è¦åˆ‡æ¢å›åŸæ¥è¿è¡Œç«¯å£å³å¯ã€‚è‹¥æœªä½¿ç”¨è“ç»¿éƒ¨ç½²çš„æ–¹å¼ï¼Œé‚£ä¹ˆä¹Ÿåªéœ€è¦ <code>stop</code> æœ‰é—®é¢˜çš„ç‰ˆæœ¬ï¼Œé‡æ–° <code>start</code> å³å¯ã€‚</p>\n<h2><span id=\"5-shi-yong-gradle-cha-jian\">5.ä½¿ç”¨ Gradle æ’ä»¶</span><a href=\"#5-shi-yong-gradle-cha-jian\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€å¦‚æœä½ æ˜¯ç”¨ <code>Gradle</code> æ¥è¿›è¡Œåº”ç”¨æ„å»ºçš„ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ <a href=\"https://github.com/palantir/gradle-docker\">Gradle-Docker</a>  æ’ä»¶è¿›è¡Œé•œåƒåˆ›å»ºæ“ä½œã€‚</p>\n<p>1.å¼•å…¥æ’ä»¶</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plugins &#123;</span><br><span class=\"line\">  id <span class=\"string\">&quot;com.palantir.docker&quot;</span> version <span class=\"string\">&quot;0.20.1&quot;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>2.ç¼–å†™ <code>Dockerfile</code></p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># åŸºäºå“ªä¸ªé•œåƒ</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> daocloud.io/java:<span class=\"number\">8</span></span><br><span class=\"line\"><span class=\"comment\"># ä½œè€…</span></span><br><span class=\"line\"><span class=\"keyword\">MAINTAINER</span> PKAQ <span class=\"comment\">#pkaq@msn.com</span></span><br><span class=\"line\"><span class=\"comment\"># åœ¨å®¿ä¸»æœºçš„/var/lib/dockerç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªä¸´æ—¶æ–‡ä»¶å¹¶æŠŠå®ƒé“¾æ¥åˆ°å®¹å™¨ä¸­çš„/tmpç›®å½•ã€‚</span></span><br><span class=\"line\"><span class=\"keyword\">VOLUME</span><span class=\"bash\"> /tmp</span></span><br><span class=\"line\"><span class=\"comment\">#å°†æ‰“åŒ…å¥½çš„springç¨‹åºæ‹·è´åˆ°å®¹å™¨ä¸­çš„æŒ‡å®šä½ç½®</span></span><br><span class=\"line\"><span class=\"keyword\">ARG</span> JAR_FILE</span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> <span class=\"variable\">$&#123;JAR_FILE&#125;</span> /opt/app.jar</span></span><br><span class=\"line\"><span class=\"comment\">#å®¹å™¨å¯¹å¤–æš´éœ²9006</span></span><br><span class=\"line\"><span class=\"keyword\">EXPOSE</span> <span class=\"number\">9006</span></span><br><span class=\"line\"><span class=\"comment\"># å®¹å™¨å¯åŠ¨åæ‰§è¡Œçš„å‘½ä»¤</span></span><br><span class=\"line\"><span class=\"keyword\">ENTRYPOINT</span><span class=\"bash\"> [<span class=\"string\">&quot;java&quot;</span>,<span class=\"string\">&quot;-Djava.security.egd=file:/dev/./urandom&quot;</span>,<span class=\"string\">&quot;-jar&quot;</span>,<span class=\"string\">&quot;/opt/app.jar&quot;</span>]</span></span><br></pre></td></tr></table></figure>\n<p>3.åº”ç”¨æ’ä»¶</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">docker &#123;</span><br><span class=\"line\">    dependsOn build</span><br><span class=\"line\">    name <span class=\"string\">&quot;$&#123;project.group&#125;/$&#123;bootJar.baseName&#125;&quot;</span></span><br><span class=\"line\">    files bootJar.archivePath</span><br><span class=\"line\">    buildArgs([<span class=\"string\">&#x27;JAR_FILE&#x27;</span>: <span class=\"string\">&quot;$&#123;bootJar.archiveName&#125;&quot;</span>])</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","categories":["Spring Boot"],"tags":["Java","Gradle","Spring Boot","Spring"]},{"title":"ä½¿ç”¨Flywayç®¡ç†ä½ çš„Spring bootæ•°æ®åº“ç‰ˆæœ¬","url":"https://pkaq.org/2018/09/11/flyway/","content":"<h1><span id=\"yin-yan\">å¼•è¨€</span><a href=\"#yin-yan\" class=\"header-anchor\">#</a></h1><p>ã€€ã€€<code>Flyway</code>æ˜¯ä¸€æ¬¾å¼€æºçš„æ•°æ®åº“ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œå®ƒæ›´å€¾å‘äºè§„çº¦ä¼˜äºé…ç½®çš„æ–¹å¼ã€‚Flywayå¯ä»¥ç‹¬ç«‹äºåº”ç”¨å®ç°ç®¡ç†å¹¶è·Ÿè¸ªæ•°æ®åº“å˜æ›´ï¼Œæ”¯æŒæ•°æ®åº“ç‰ˆæœ¬è‡ªåŠ¨å‡çº§ï¼Œå¹¶ä¸”æœ‰ä¸€å¥—é»˜è®¤çš„è§„çº¦ï¼Œä¸éœ€è¦å¤æ‚çš„é…ç½®ï¼ŒMigrationså¯ä»¥å†™æˆSQLè„šæœ¬ï¼Œä¹Ÿå¯ä»¥å†™åœ¨Javaä»£ç ä¸­ï¼Œä¸ä»…æ”¯æŒCommand Lineå’ŒJava APIï¼Œè¿˜æ”¯æŒBuildæ„å»ºå·¥å…·å’ŒSpring Bootç­‰ï¼ŒåŒæ—¶åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹èƒ½å¤Ÿå®‰å…¨å¯é åœ°å‡çº§æ•°æ®åº“ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒå¤±è´¥æ¢å¤ç­‰ã€‚</p>\n<p>ã€€ã€€é€šå¸¸åœ¨é¡¹ç›®ä¸Šçº¿åï¼Œç”±äºéœ€æ±‚çš„ä¸æ–­æ”¹è¿›æˆ–åŠŸèƒ½çš„å®Œå–„éœ€è¦å¯¹ä¸ªåˆ«å­—æ®µè¿›è¡Œè°ƒæ•´æˆ–æ–°å¢ã€‚å¦‚æœé‡‡ç”¨ä¼ ç»Ÿæ–¹å¼ç›´æ¥ä¿®æ”¹å¼€å‘å’Œç”Ÿäº§æ•°æ®åº“ä½†å‡¡æ¶‰åŠäººä¸ºæ“ä½œæ€»æ— æ³•é¿å…å‡ºé”™çš„å¯èƒ½ã€‚ä¸€ç§æ–¹æ³•æ˜¯é¿å…ç›´æ¥ä¿®æ”¹æ•°æ®åº“ï¼Œæ‰€æœ‰æ•°æ®åº“ä¿®æ”¹é€šè¿‡PDMå»æ“ä½œã€‚å½“ç„¶æ¯•ç«ŸPDMæ˜¯èŠ±é’±çš„ï¼Œé€šè¿‡é‡‡ç”¨<code>Flyway</code>ç¼–å†™å˜æ›´è„šæœ¬çš„æ–¹å¼ï¼Œå¯ä»¥ä½¿åº”ç”¨åœ¨å¯åŠ¨æ—¶æ£€æŸ¥æ•°æ®åº“å˜æ›´å¹¶è¿›è¡Œè‡ªåŠ¨åŒæ­¥ã€‚</p>\n<a id=\"more\"></a>\n\n<h1><span id=\"ban-ben\">ç‰ˆæœ¬</span><a href=\"#ban-ben\" class=\"header-anchor\">#</a></h1><ul>\n<li>Flyway: 5.1.4</li>\n<li>Gradle: 4.10</li>\n<li>Spring Boot: 2.0.4</li>\n</ul>\n<h1><span id=\"bu-zou\">æ­¥éª¤</span><a href=\"#bu-zou\" class=\"header-anchor\">#</a></h1><p>ã€€ã€€Flywayå¯¹æ•°æ®åº“è¿›è¡Œç‰ˆæœ¬ç®¡ç†ä¸»è¦ç”±Metadataè¡¨å’Œ6ç§å‘½ä»¤å®Œæˆï¼ŒMetadataä¸»è¦ç”¨äºè®°å½•å…ƒæ•°æ®ï¼Œåœ¨Flywayé¦–æ¬¡å¯åŠ¨æ—¶ä¼šåˆ›å»ºé»˜è®¤åä¸º<code>flyway_schema_history</code>çš„å…ƒæ•°æ®è¡¨ï¼Œè¯¥è¡¨ç”¨äºè®°å½•ç‰ˆæœ¬å˜æ›´æ—¥å¿—ã€Checksumç­‰ä¿¡æ¯ã€‚</p>\n<p>ã€€ã€€Flywayè„šæœ¬çš„å‘½åè§„åˆ™å¦‚ä¸‹ï¼š</p>\n<p><img src=\"sql_migration_naming.png\" alt=\"flyway\"></p>\n<ul>\n<li>prefix: å¯é…ç½®ï¼Œå‰ç¼€æ ‡è¯†ï¼Œé»˜è®¤å€¼<code>V</code>è¡¨ç¤ºVersionedï¼Œ<code>R</code>è¡¨ç¤ºRepeatable</li>\n<li>version: æ ‡è¯†ç‰ˆæœ¬å·ï¼Œç”±ä¸€ä¸ªæˆ–å¤šä¸ªæ•°å­—æ„æˆï¼Œæ•°å­—ä¹‹é—´çš„åˆ†éš”ç¬¦å¯ç”¨ç‚¹<code>.</code>æˆ–ä¸‹åˆ’çº¿<code>_</code></li>\n<li>separator: å¯é…ç½®ï¼Œç”¨äºåˆ†éš”ç‰ˆæœ¬æ ‡è¯†ä¸æè¿°ä¿¡æ¯ï¼Œé»˜è®¤ä¸ºä¸¤ä¸ªä¸‹åˆ’çº¿<code>__</code></li>\n<li>description: æè¿°ä¿¡æ¯ï¼Œæ–‡å­—ä¹‹é—´å¯ä»¥ç”¨ä¸‹åˆ’çº¿æˆ–ç©ºæ ¼åˆ†éš”</li>\n<li>suffix: å¯é…ç½®ï¼Œåç»­æ ‡è¯†ï¼Œé»˜è®¤ä¸º<code>.sql</code></li>\n</ul>\n<p>ã€€ã€€è¦å®ç°åœ¨<code>Spring boot</code>ä¸­ä½¿ç”¨<code>Flyway</code>è¿›è¡Œç‰ˆæœ¬ç®¡ç†éœ€è¦åšåˆ°å¦‚ä¸‹æ­¥éª¤ï¼š</p>\n<pre><code> 1. æ·»åŠ ä¾èµ–  \n 2. æ¥ç‚¹é…ç½®\n 3. ç¼–å†™è„šæœ¬</code></pre>\n<p>ã€€ã€€è¿™é‡Œç¤ºä¾‹ä»¥ä¸€ä¸ªå­˜åœ¨è‹¥å¹²å¼ è¡¨çš„æ•°æ®åº“ä¸ºä¾‹ï¼Œä¸ºè¯¥åº“æ·»åŠ ä¸€å¼ æ–°çš„<code>test_alpha</code>è¡¨ï¼Œç„¶åè¿½åŠ ä¸€åˆ—<code>bravo</code>ã€‚   </p>\n<p>1.æ·»åŠ ä¾èµ–   </p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">compile</span> &quot;<span class=\"selector-tag\">org</span><span class=\"selector-class\">.flywaydb</span><span class=\"selector-pseudo\">:flyway-core</span><span class=\"selector-pseudo\">:5.1.4&quot;</span></span><br></pre></td></tr></table></figure>\n<p>2.æ¥ç‚¹é…ç½® <code>application.yaml</code>   </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># flywayé…ç½® å¯¹äºéç©ºæ•°æ®åº“ éœ€è¦å¼€å¯æ­¤é¡¹é¿å…æŠ¥é”™</span></span><br><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\"> <span class=\"attr\">flyway:</span></span><br><span class=\"line\">  <span class=\"attr\">baseline-on-migrate:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n<p>3.å‡†å¤‡è„šæœ¬   </p>\n<p>ã€€ã€€ä¾æ®ä¸Šæ–‡æè¿°çš„å‘½åè§„åˆ™ï¼Œåœ¨<code>src\\main\\resources\\db\\migration</code>ä¸‹æ·»åŠ ä½ çš„æ•°æ®åº“å˜æ›´è„šæœ¬ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºæˆ‘ä»¬æ˜¯åœ¨éç©ºæ•°æ®åº“è¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥è¿™é‡Œçš„ç‰ˆæœ¬å·æ˜¯ä»<code>v2</code>å¼€å§‹ã€‚</p>\n<p><code>V2__Add_new_table.sql</code></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> flyway_test_alpha;</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> `flyway_test_alpha`  (</span><br><span class=\"line\">\t`id`          \t<span class=\"type\">int</span>(<span class=\"number\">11</span>) AUTO_INCREMENT <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\t`column_alpha`\t<span class=\"type\">varchar</span>(<span class=\"number\">30</span>) <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span></span><br></pre></td></tr></table></figure>\n\n\n<p><code>V3__Add_column.sql</code></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> `flyway_test_alpha`</span><br><span class=\"line\">\t<span class=\"keyword\">ADD</span> <span class=\"keyword\">COLUMN</span> `column_bravo` <span class=\"type\">varchar</span>(<span class=\"number\">25</span>) <span class=\"keyword\">NULL</span></span><br></pre></td></tr></table></figure>\n<p>ã€€ã€€</p>\n<p>ç°åœ¨å¯åŠ¨ä½ çš„åº”ç”¨ï¼Œä½ ä¼šå‘ç°è¿™ä¸¤é¡¹æ“ä½œä¼šéšå£«å®Œæˆäº†ï¼Œå®åœ¨æ˜¯éå¸¸çœå¿ƒã€‚</p>\n<p>é™„å½•: Flywayé…ç½®è¯¦è§£</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">flyway.baseline-description</span>= <span class=\"string\"># æ‰§è¡ŒåŸºçº¿æ—¶æ ‡è®°å·²æœ‰Schemaçš„æè¿°</span></span><br><span class=\"line\"><span class=\"meta\">flyway.baseline-version</span>=<span class=\"string\">1 # åŸºçº¿ç‰ˆæœ¬é»˜è®¤å¼€å§‹åºå· é»˜è®¤ä¸º 1. </span></span><br><span class=\"line\"><span class=\"meta\">flyway.baseline-on-migrate</span>=<span class=\"string\">false # é’ˆå¯¹éç©ºæ•°æ®åº“æ˜¯å¦é»˜è®¤è°ƒç”¨åŸºçº¿ç‰ˆæœ¬ ï¼Œ è¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä¸Šé¢ç‰ˆæœ¬å·ä» 2 å¼€å§‹çš„åŸå› </span></span><br><span class=\"line\"><span class=\"meta\">flyway.check-location</span>=<span class=\"string\">false # æ˜¯å¦å¼€å¯è„šæœ¬æ£€æŸ¥ æ£€æŸ¥è„šæœ¬æ˜¯å¦å­˜åœ¨ é»˜è®¤false</span></span><br><span class=\"line\"><span class=\"meta\">flyway.clean-on-validation-error</span>=<span class=\"string\">false # éªŒè¯é”™è¯¯æ—¶ æ˜¯å¦è‡ªåŠ¨æ¸…é™¤æ•°æ®åº“ é«˜å±æ“ä½œï¼ï¼ï¼</span></span><br><span class=\"line\"><span class=\"meta\">flyway.enabled</span>=<span class=\"string\">true # æ˜¯å¦å¯ç”¨ flyway.</span></span><br><span class=\"line\"><span class=\"meta\">flyway.encoding</span>=<span class=\"string\">UTF-8 # è„šæœ¬ç¼–ç .</span></span><br><span class=\"line\"><span class=\"meta\">flyway.ignore-failed-future-migration</span>=<span class=\"string\">true # åœ¨è¯»å…ƒæ•°æ®è¡¨æ—¶ï¼Œæ˜¯å¦å¿½ç•¥å¤±è´¥çš„åç»­è¿ç§».</span></span><br><span class=\"line\"><span class=\"meta\">flyway.init-sqls</span>= <span class=\"string\"># Sè·å–è¿æ¥åç«‹å³æ‰§è¡Œåˆå§‹åŒ–çš„SQLè¯­å¥</span></span><br><span class=\"line\"><span class=\"meta\">flyway.locations</span>=<span class=\"string\">classpath:db/migration # è„šæœ¬ä½ç½®ï¼Œ é»˜è®¤ä¸ºclasspath: db/migration.</span></span><br><span class=\"line\"><span class=\"meta\">flyway.out-of-order</span>=<span class=\"string\">false # æ˜¯å¦å…è®¸ä¹±åºï¼ˆout of orderï¼‰è¿ç§»</span></span><br><span class=\"line\"><span class=\"meta\">flyway.placeholder-prefix</span>= <span class=\"string\"># è®¾ç½®æ¯ä¸ªå ä½ç¬¦çš„å‰ç¼€ã€‚ é»˜è®¤å€¼ï¼š $&#123; ã€‚ </span></span><br><span class=\"line\"><span class=\"meta\">flyway.placeholder-replacement</span>=<span class=\"string\">true # æ˜¯å¦è¦æ›¿æ¢å ä½ç¬¦ã€‚ é»˜è®¤å€¼ï¼š true ã€‚ </span></span><br><span class=\"line\"><span class=\"meta\">flyway.placeholder-suffix</span>=<span class=\"string\">&#125; # è®¾ç½®å ä½ç¬¦çš„åç¼€ã€‚ é»˜è®¤å€¼ï¼š &#125; ã€‚ </span></span><br><span class=\"line\"><span class=\"meta\">flyway.placeholders.*</span>= <span class=\"string\"># è®¾ç½®å ä½ç¬¦çš„å€¼ã€‚</span></span><br><span class=\"line\"><span class=\"meta\">flyway.schemas</span>= <span class=\"string\"># Flywayç®¡ç†çš„Schemaåˆ—è¡¨ï¼ŒåŒºåˆ†å¤§å°å†™ã€‚é»˜è®¤è¿æ¥å¯¹åº”çš„é»˜è®¤Schemaã€‚</span></span><br><span class=\"line\"><span class=\"meta\">flyway.sql-migration-prefix</span>=<span class=\"string\">V # è¿ç§»è„šæœ¬çš„æ–‡ä»¶åå‰ç¼€ã€‚ é»˜è®¤å€¼ï¼š V ã€‚ </span></span><br><span class=\"line\"><span class=\"meta\">flyway.sql-migration-separator</span>=<span class=\"string\">__ # è¿ç§»è„šæœ¬çš„åˆ†å‰²ç¬¦ é»˜è®¤åŒä¸‹åˆ’çº¿</span></span><br><span class=\"line\"><span class=\"meta\">flyway.sql-migration-suffix</span>=<span class=\"string\">.sql # è¿ç§»è„šæœ¬çš„åç¼€ é»˜è®¤ .sql</span></span><br><span class=\"line\"><span class=\"meta\">flyway.table</span>=<span class=\"string\">schema_version # Flywayä½¿ç”¨çš„Schemaå…ƒæ•°æ®è¡¨åç§° é»˜è®¤schema_version</span></span><br><span class=\"line\"><span class=\"meta\">flyway.url</span>= <span class=\"string\"># å¾…è¿ç§»çš„æ•°æ®åº“çš„JDBC URLã€‚å¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œå°±ä½¿ç”¨é…ç½®çš„ä¸»æ•°æ®æºã€‚</span></span><br><span class=\"line\"><span class=\"meta\">flyway.user</span>= <span class=\"string\"># å¾…è¿ç§»æ•°æ®åº“çš„ç™»å½•ç”¨æˆ·ã€‚</span></span><br><span class=\"line\"><span class=\"meta\">flyway.password</span>= <span class=\"string\"># å¾…è¿ç§»æ•°æ®åº“çš„ç™»å½•ç”¨æˆ·å¯†ç ã€‚</span></span><br><span class=\"line\"><span class=\"meta\">flyway.validate-on-migrate</span>=<span class=\"string\">true # åœ¨è¿è¡Œè¿ç§»æ—¶æ˜¯å¦è¦è‡ªåŠ¨éªŒè¯ã€‚ é»˜è®¤å€¼ï¼š true ã€‚ </span></span><br></pre></td></tr></table></figure>\n\n\n","categories":["Spring Boot"],"tags":["Java","Gradle","Spring Boot","Spring"]},{"title":"ä½¿ç”¨P6Spyç›‘æ§ä½ çš„Spring bootæ•°æ®åº“æ“ä½œ","url":"https://pkaq.org/2018/09/10/p6spy/","content":"<h1><span id=\"yin-yan\">å¼•è¨€</span><a href=\"#yin-yan\" class=\"header-anchor\">#</a></h1><p>ã€€ã€€æœ€è¿‘æ¢äº†å·ç§°æœ€å¿«çš„<code>HikariDataSource</code>ï¼Œç”±äºæ²¡æœ‰äº†<code>SQL</code>ç›‘æ§ï¼ŒåŠ ä¹‹äº<code>Mybaits</code>é»˜è®¤è¾“å‡ºæ—¥å¿—ä¹‹æ‹™è®¡ã€‚é‚ç”¨æ­¤ç‰©ï¼Œä¸ä¹‹ç›¸ä»¿è¿˜æœ‰<code>log4jdbc</code>ï¼Œæ¯”è¾ƒæ´»è·ƒåº¦åé€‰æ‹©äº†<code>P6Spy</code>ã€‚</p>\n<a id=\"more\"></a>\n\n<h1><span id=\"ban-ben\">ç‰ˆæœ¬</span><a href=\"#ban-ben\" class=\"header-anchor\">#</a></h1><ul>\n<li>P6Sspy: 3.7</li>\n<li>Gradle: 4.10</li>\n<li>Spring Boot: 2.0.4</li>\n</ul>\n<h1><span id=\"bu-zou\">æ­¥éª¤</span><a href=\"#bu-zou\" class=\"header-anchor\">#</a></h1><p>ã€€ã€€å…·ä½“æ­¥éª¤æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œè¯´ä¸‹ç®€å•åŸç†ã€‚<code>P6Spy</code>é€šè¿‡åŠ«æŒ<code>JDBC</code>é©±åŠ¨ï¼Œåœ¨è°ƒç”¨å®é™…<code>JDBC</code>é©±åŠ¨å‰æ‹¦æˆªè°ƒç”¨çš„ç›®æ ‡è¯­ï¼Œè¾¾åˆ°<code>SQL</code>è¯­å¥æ—¥å¿—è®°å½•çš„ç›®çš„ã€‚</p>\n<p>ã€€ã€€å®ƒåŒ…æ‹¬<code>P6Log</code>å’Œ<code>P6Outage</code>ä¸¤ä¸ªæ¨¡å—ã€‚</p>\n<ul>\n<li>P6Log ç”¨æ¥æ‹¦æˆªå’Œè®°å½•ä»»åŠ¡åº”ç”¨ç¨‹åºçš„ JDBC è¯­å¥</li>\n<li>P6Outage ä¸“é—¨ç”¨æ¥æ£€æµ‹å’Œè®°å½•è¶…è¿‡é…ç½®æ¡ä»¶é‡Œæ—¶é—´çš„ SQL è¯­å¥</li>\n</ul>\n<p>ã€€ã€€åº”ç”¨<code>P6Spy</code>åªéœ€è¦</p>\n<ul>\n<li>1.æ›¿æ¢ä½ çš„<code>JDBC Driver</code>ä¸º<code>com.p6spy.engine.spy.P6SpyDriver</code></li>\n<li>2.ä¿®æ”¹<code>JDBC Url</code>ä¸º<code>jdbc:p6spy:xxxx</code></li>\n<li>3.é…ç½®<code>spy.properties</code></li>\n</ul>\n<p>1.ä¿®æ”¹<code>application.yml</code>æ–‡ä»¶,æ›¿æ¢<code>jdbc driver</code>å’Œ<code>url</code></p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># æ•°æ®æº</span><br><span class=\"line\"><span class=\"selector-tag\">spring</span>:</span><br><span class=\"line\">  <span class=\"selector-tag\">datasource</span>:</span><br><span class=\"line\">    <span class=\"selector-tag\">type</span>: <span class=\"selector-tag\">com</span><span class=\"selector-class\">.zaxxer</span><span class=\"selector-class\">.hikari</span><span class=\"selector-class\">.HikariDataSource</span></span><br><span class=\"line\">    <span class=\"selector-tag\">url</span>: <span class=\"selector-tag\">jdbc</span><span class=\"selector-pseudo\">:p6spy</span><span class=\"selector-pseudo\">:mysql</span>://...</span><br><span class=\"line\">    <span class=\"selector-tag\">username</span>: ...</span><br><span class=\"line\">    <span class=\"selector-tag\">password</span>: ...</span><br><span class=\"line\">    <span class=\"selector-tag\">driver-class-name</span>: <span class=\"selector-tag\">com</span><span class=\"selector-class\">.p6spy</span><span class=\"selector-class\">.engine</span><span class=\"selector-class\">.spy</span><span class=\"selector-class\">.P6SpyDriver</span></span><br></pre></td></tr></table></figure>\n\n\n<p>2.é…ç½®<code>spy.properties</code></p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">module.log</span>=<span class=\"string\">com.p6spy.engine.logging.P6LogFactory,com.p6spy.engine.outage.P6OutageFactory</span></span><br><span class=\"line\"><span class=\"comment\"># è‡ªå®šä¹‰æ—¥å¿—æ‰“å°</span></span><br><span class=\"line\"><span class=\"attr\">logMessageFormat</span>=<span class=\"string\">org.pkaq.core.log.P6SpyLogger</span></span><br><span class=\"line\"><span class=\"comment\"># ä½¿ç”¨æ—¥å¿—ç³»ç»Ÿè®°å½•sql</span></span><br><span class=\"line\"><span class=\"attr\">appender</span>=<span class=\"string\">com.p6spy.engine.spy.appender.Slf4JLogger</span></span><br><span class=\"line\"><span class=\"comment\">## é…ç½®è®°å½•Logä¾‹å¤–</span></span><br><span class=\"line\"><span class=\"attr\">excludecategories</span>=<span class=\"string\">info,debug,result,batc,resultset</span></span><br><span class=\"line\"><span class=\"comment\"># è®¾ç½®ä½¿ç”¨p6spy driveræ¥åšä»£ç†</span></span><br><span class=\"line\"><span class=\"attr\">deregisterdrivers</span>=<span class=\"string\">true</span></span><br><span class=\"line\"><span class=\"comment\"># æ—¥æœŸæ ¼å¼</span></span><br><span class=\"line\"><span class=\"attr\">dateformat</span>=<span class=\"string\">yyyy-MM-dd HH:mm:ss</span></span><br><span class=\"line\"><span class=\"comment\"># å®é™…é©±åŠ¨ </span></span><br><span class=\"line\"><span class=\"attr\">driverlist</span>=<span class=\"string\">com.mysql.jdbc.Driver</span></span><br><span class=\"line\"><span class=\"comment\"># æ˜¯å¦å¼€å¯æ…¢SQLè®°å½•</span></span><br><span class=\"line\"><span class=\"attr\">outagedetection</span>=<span class=\"string\">true</span></span><br><span class=\"line\"><span class=\"comment\"># æ…¢SQLè®°å½•æ ‡å‡† ç§’</span></span><br><span class=\"line\"><span class=\"attr\">outagedetectioninterval</span>=<span class=\"string\">2</span></span><br></pre></td></tr></table></figure>\n<p>3.è‡ªå®šä¹‰æ—¥å¿—æ‰“å° , å®ç°<code>MessageFormattingStrategy</code>æ¥å£å³å¯</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">P6SpyLogger</span> <span class=\"keyword\">implements</span> <span class=\"title\">MessageFormattingStrategy</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">formatMessage</span><span class=\"params\">(<span class=\"keyword\">int</span> connectionId, String now, <span class=\"keyword\">long</span> elapsed, String category, String prepared, String sql)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> !<span class=\"string\">&quot;&quot;</span>.equals(sql.trim()) ? <span class=\"string\">&quot;[ &quot;</span> + LocalDateTime.now() + <span class=\"string\">&quot; ] --- | took &quot;</span></span><br><span class=\"line\">                + elapsed + <span class=\"string\">&quot;ms | &quot;</span> + category + <span class=\"string\">&quot; | connection &quot;</span> + connectionId + <span class=\"string\">&quot;\\n &quot;</span></span><br><span class=\"line\">                + sql + <span class=\"string\">&quot;;&quot;</span> : <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<p>é™„å½•: <code>spy.properties</code>è¯¦ç»†è¯´æ˜</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># æŒ‡å®šåº”ç”¨çš„æ—¥å¿—æ‹¦æˆªæ¨¡å—,é»˜è®¤ä¸ºcom.p6spy.engine.spy.P6SpyFactory </span></span><br><span class=\"line\"><span class=\"comment\">#modulelist=com.p6spy.engine.spy.P6SpyFactory,com.p6spy.engine.logging.P6LogFactory,com.p6spy.engine.outage.P6OutageFactory</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># çœŸå®JDBC driver , å¤šä¸ªä»¥ é€—å· åˆ†å‰² é»˜è®¤ä¸ºç©º</span></span><br><span class=\"line\"><span class=\"comment\">#driverlist=</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ˜¯å¦è‡ªåŠ¨åˆ·æ–° é»˜è®¤ flase</span></span><br><span class=\"line\"><span class=\"comment\">#autoflush=false</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># é…ç½®SimpleDateFormatæ—¥æœŸæ ¼å¼ é»˜è®¤ä¸ºç©º</span></span><br><span class=\"line\"><span class=\"comment\">#dateformat=</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ‰“å°å †æ ˆè·Ÿè¸ªä¿¡æ¯ é»˜è®¤flase</span></span><br><span class=\"line\"><span class=\"comment\">#stacktrace=false</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å¦‚æœ stacktrace=trueï¼Œåˆ™å¯ä»¥æŒ‡å®šå…·ä½“çš„ç±»åæ¥è¿›è¡Œè¿‡æ»¤ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">#stacktraceclass=</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç›‘æµ‹å±æ€§é…ç½®æ–‡ä»¶æ˜¯å¦è¿›è¡Œé‡æ–°åŠ è½½</span></span><br><span class=\"line\"><span class=\"comment\">#reloadproperties=false</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å±æ€§é…ç½®æ–‡ä»¶é‡æ–°åŠ è½½çš„æ—¶é—´é—´éš”ï¼Œå•ä½:ç§’ é»˜è®¤60s</span></span><br><span class=\"line\"><span class=\"comment\">#reloadpropertiesinterval=60</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æŒ‡å®š Log çš„ appenderï¼Œå–å€¼ï¼š</span></span><br><span class=\"line\"><span class=\"comment\">#appender=com.p6spy.engine.spy.appender.Slf4JLogger</span></span><br><span class=\"line\"><span class=\"comment\">#appender=com.p6spy.engine.spy.appender.StdoutLogger</span></span><br><span class=\"line\"><span class=\"comment\">#appender=com.p6spy.engine.spy.appender.FileLogger</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æŒ‡å®š Log çš„æ–‡ä»¶å é»˜è®¤ spy.log</span></span><br><span class=\"line\"><span class=\"comment\">#logfile=spy.log</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æŒ‡å®šæ˜¯å¦æ¯æ¬¡æ˜¯å¢åŠ  Logï¼Œè®¾ç½®ä¸º false åˆ™æ¯æ¬¡éƒ½ä¼šå…ˆè¿›è¡Œæ¸…ç©º é»˜è®¤true</span></span><br><span class=\"line\"><span class=\"comment\">#append=true</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æŒ‡å®šæ—¥å¿—è¾“å‡ºæ ·å¼  é»˜è®¤ä¸ºcom.p6spy.engine.spy.appender.SingleLineFormat , å•è¡Œè¾“å‡º ä¸æ ¼å¼åŒ–è¯­å¥</span></span><br><span class=\"line\"><span class=\"comment\">#logMessageFormat=com.p6spy.engine.spy.appender.SingleLineFormat</span></span><br><span class=\"line\"><span class=\"comment\"># ä¹Ÿå¯ä»¥é‡‡ç”¨  com.p6spy.engine.spy.appender.CustomLineFormat æ¥è‡ªå®šä¹‰è¾“å‡ºæ ·å¼, é»˜è®¤å€¼æ˜¯%(currentTime)|%(executionTime)|%(category)|connection%(connectionId)|%(sqlSingleLine)</span></span><br><span class=\"line\"><span class=\"comment\"># å¯ç”¨çš„å˜é‡ä¸º:</span></span><br><span class=\"line\"><span class=\"comment\">#   %(connectionId)            connection id</span></span><br><span class=\"line\"><span class=\"comment\">#   %(currentTime)             å½“å‰æ—¶é—´</span></span><br><span class=\"line\"><span class=\"comment\">#   %(executionTime)           æ‰§è¡Œè€—æ—¶</span></span><br><span class=\"line\"><span class=\"comment\">#   %(category)                æ‰§è¡Œåˆ†ç»„</span></span><br><span class=\"line\"><span class=\"comment\">#   %(effectiveSql)            æäº¤çš„SQL æ¢è¡Œ</span></span><br><span class=\"line\"><span class=\"comment\">#   %(effectiveSqlSingleLine)  æäº¤çš„SQL ä¸æ¢è¡Œæ˜¾ç¤º</span></span><br><span class=\"line\"><span class=\"comment\">#   %(sql)                     æ‰§è¡Œçš„çœŸå®SQLè¯­å¥ï¼Œå·²æ›¿æ¢å ä½</span></span><br><span class=\"line\"><span class=\"comment\">#   %(sqlSingleLine)           æ‰§è¡Œçš„çœŸå®SQLè¯­å¥ï¼Œå·²æ›¿æ¢å ä½ ä¸æ¢è¡Œæ˜¾ç¤º</span></span><br><span class=\"line\"><span class=\"comment\">#customLogMessageFormat=%(currentTime)|%(executionTime)|%(category)|connection%(connectionId)|%(sqlSingleLine)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># dateç±»å‹å­—æ®µè®°å½•æ—¥å¿—æ—¶ä½¿ç”¨çš„æ—¥æœŸæ ¼å¼ é»˜è®¤dd-MMM-yy</span></span><br><span class=\"line\"><span class=\"comment\">#databaseDialectDateFormat=dd-MMM-yy</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># booleanç±»å‹å­—æ®µè®°å½•æ—¥å¿—æ—¶ä½¿ç”¨çš„æ—¥æœŸæ ¼å¼ é»˜è®¤boolean å¯é€‰å€¼numeric</span></span><br><span class=\"line\"><span class=\"comment\">#databaseDialectBooleanFormat=boolean</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ˜¯å¦é€šè¿‡jmxæš´éœ²å±æ€§ é»˜è®¤true</span></span><br><span class=\"line\"><span class=\"comment\">#jmx=true</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å¦‚æœjmxè®¾ç½®ä¸ºtrue æŒ‡å®šé€šè¿‡jmxæš´éœ²å±æ€§æ—¶çš„å‰ç¼€ é»˜è®¤ä¸ºç©º</span></span><br><span class=\"line\"><span class=\"comment\"># com.p6spy(.&lt;jmxPrefix&gt;)?:name=&lt;optionsClassName&gt;</span></span><br><span class=\"line\"><span class=\"comment\">#jmxPrefix=</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ˜¯å¦æ˜¾ç¤ºçº³ç§’ é»˜è®¤false</span></span><br><span class=\"line\"><span class=\"comment\">#useNanoTime=false</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å®é™…æ•°æ®æº JNDI</span></span><br><span class=\"line\"><span class=\"comment\">#realdatasource=/RealMySqlDS</span></span><br><span class=\"line\"><span class=\"comment\"># å®é™…æ•°æ®æº datasource class</span></span><br><span class=\"line\"><span class=\"comment\">#realdatasourceclass=com.mysql.jdbc.jdbc2.optional.MysqlDataSource</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å®é™…æ•°æ®æºæ‰€æºå¸¦çš„é…ç½®å‚æ•° ä»¥ k=v æ–¹å¼æŒ‡å®š ä»¥ åˆ†å· åˆ†å‰²</span></span><br><span class=\"line\"><span class=\"comment\">#realdatasourceproperties=port;3306,serverName;myhost,databaseName;jbossdb,foo;bar</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># jndiæ•°æ®æºé…ç½® </span></span><br><span class=\"line\"><span class=\"comment\"># è®¾ç½® JNDI æ•°æ®æºçš„ NamingContextFactoryã€‚ </span></span><br><span class=\"line\"><span class=\"comment\">#jndicontextfactory=org.jnp.interfaces.NamingContextFactory</span></span><br><span class=\"line\"><span class=\"comment\"># è®¾ç½® JNDI æ•°æ®æºçš„æä¾›è€…çš„ URLã€‚ </span></span><br><span class=\"line\"><span class=\"comment\">#jndicontextproviderurl=localhost:1099</span></span><br><span class=\"line\"><span class=\"comment\"># è®¾ç½® JNDI æ•°æ®æºçš„ä¸€äº›å®šåˆ¶ä¿¡æ¯ï¼Œä»¥åˆ†å·åˆ†éš”ã€‚ </span></span><br><span class=\"line\"><span class=\"comment\">#jndicontextcustom=java.naming.factory.url.pkgs;org.jboss.naming:org.jnp.interfaces</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ˜¯å¦å¼€å¯æ—¥å¿—è¿‡æ»¤ é»˜è®¤falseï¼Œ è¿™é¡¹é…ç½®æ˜¯å¦ç”Ÿæ•ˆå‰ææ˜¯é…ç½®äº† include/exclude/sqlexpression</span></span><br><span class=\"line\"><span class=\"comment\">#filter=false</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è¿‡æ»¤ Log æ—¶æ‰€åŒ…å«çš„è¡¨ååˆ—è¡¨ï¼Œä»¥é€—å·åˆ†éš” é»˜è®¤ä¸ºç©º</span></span><br><span class=\"line\"><span class=\"comment\">#include=</span></span><br><span class=\"line\"><span class=\"comment\"># è¿‡æ»¤ Log æ—¶æ‰€æ’é™¤çš„è¡¨ååˆ—è¡¨ï¼Œä»¥é€—å·åˆ†éš” é»˜è®¤ä¸ºç©º</span></span><br><span class=\"line\"><span class=\"comment\">#exclude=</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è¿‡æ»¤ Log æ—¶çš„ SQL æ­£åˆ™è¡¨è¾¾å¼åç§°  é»˜è®¤ä¸ºç©º</span></span><br><span class=\"line\"><span class=\"comment\">#sqlexpression=</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#æ˜¾ç¤ºæŒ‡å®šè¿‡æ»¤ Log æ—¶æ’é˜Ÿçš„åˆ†ç±»åˆ—è¡¨ï¼Œå–å€¼: error, info, batch, debug, statement,</span></span><br><span class=\"line\"><span class=\"comment\">#commit, rollback, result and resultset are valid values</span></span><br><span class=\"line\"><span class=\"comment\"># (é»˜è®¤ info,debug,result,resultset,batch)</span></span><br><span class=\"line\"><span class=\"comment\">#excludecategories=info,debug,result,resultset,batch</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ˜¯å¦è¿‡æ»¤äºŒè¿›åˆ¶å­—æ®µ</span></span><br><span class=\"line\"><span class=\"comment\"># (default is false)</span></span><br><span class=\"line\"><span class=\"comment\">#excludebinary=false</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># P6Log æ¨¡å—æ‰§è¡Œæ—¶é—´è®¾ç½®ï¼Œæ•´æ•°å€¼ (ä»¥æ¯«ç§’ä¸ºå•ä½)ï¼Œåªæœ‰å½“è¶…è¿‡è¿™ä¸ªæ—¶é—´æ‰è¿›è¡Œè®°å½• Logã€‚ é»˜è®¤ä¸º0</span></span><br><span class=\"line\"><span class=\"comment\">#executionThreshold=</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># P6Outage æ¨¡å—æ˜¯å¦è®°å½•è¾ƒé•¿æ—¶é—´è¿è¡Œçš„è¯­å¥ é»˜è®¤false</span></span><br><span class=\"line\"><span class=\"comment\"># outagedetection=true|false</span></span><br><span class=\"line\"><span class=\"comment\"># P6Outage æ¨¡å—æ‰§è¡Œæ—¶é—´è®¾ç½®ï¼Œæ•´æ•°å€¼ ï¼ˆä»¥ç§’ä¸ºå•ä½)ï¼‰ï¼Œåªæœ‰å½“è¶…è¿‡è¿™ä¸ªæ—¶é—´æ‰è¿›è¡Œè®°å½• Logã€‚ é»˜è®¤30s</span></span><br><span class=\"line\"><span class=\"comment\"># outagedetectioninterval=integer time (seconds)</span></span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n","categories":["Spring Boot"],"tags":["Java","Gradle","Spring Boot","Spring"]},{"title":"ä½¿ç”¨JasyptåŠ å¯†ä½ çš„Spring Booté…ç½®æ–‡ä»¶","url":"https://pkaq.org/2018/09/06/jasypt/","content":"<h1><span id=\"yin-yan\">å¼•è¨€</span><a href=\"#yin-yan\" class=\"header-anchor\">#</a></h1><p>ã€€ã€€<a href=\"http://jasypt.org/\">Jasypt</a> æ˜¯ä¸€ä¸ªJavaåº“ï¼Œå…è®¸å¼€å‘äººå‘˜ä»¥å¾ˆç®€å•çš„æ–¹å¼æ·»åŠ åŸºæœ¬åŠ å¯†åŠŸèƒ½ï¼Œè€Œæ— éœ€æ·±å…¥ç ”ç©¶åŠ å¯†åŸç†ã€‚åˆ©ç”¨å®ƒå¯ä»¥å®ç°é«˜å®‰å…¨æ€§çš„ï¼ŒåŸºäºæ ‡å‡†çš„åŠ å¯†æŠ€æœ¯ï¼Œæ— è®ºæ˜¯å•å‘å’ŒåŒå‘åŠ å¯†ã€‚åŠ å¯†å¯†ç ï¼Œæ–‡æœ¬ï¼Œæ•°å­—ï¼ŒäºŒè¿›åˆ¶æ–‡ä»¶ã€‚å¹¶ä¸”å¯é›†æˆåˆ°Springåº”ç”¨ç¨‹åºä¸­ï¼Œä¸Spring Securityé›†æˆï¼ŒåŠ å¯†çš„åº”ç”¨ç¨‹åºï¼ˆå³æ•°æ®æºï¼‰çš„é…ç½®ç­‰ä¿¡æ¯ã€‚</p>\n<h1><span id=\"ban-ben\">ç‰ˆæœ¬</span><a href=\"#ban-ben\" class=\"header-anchor\">#</a></h1><ul>\n<li>jasypt-spring-boot-starter ï¼š 2.1.0</li>\n<li>Spring Boot : 2.0.4</li>\n<li>JDK 1.9</li>\n</ul>\n<h1><span id=\"bu-zou\">æ­¥éª¤</span><a href=\"#bu-zou\" class=\"header-anchor\">#</a></h1><p>ã€€ã€€å€ŸåŠ©<code>jasypt-spring-boot-starter</code>ç»™<code>Spring boot</code>åº”ç”¨é…ç½®åŠ å¯†éå¸¸ç®€å•ã€‚   </p>\n<ol>\n<li>å¼•å…¥ä¾èµ–<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">compile <span class=\"string\">&quot;com.github.ulisesbocchio:jasypt-spring-boot-starter:$&#123;jasypt&#125;&quot;</span></span><br></pre></td></tr></table></figure></li>\n<li>é…ç½®å¯†ç <br>ã€€ã€€åœ¨<code>application.yml</code>ä¸­é…ç½®åŠ å¯†éœ€è¦ä½¿ç”¨çš„å¯†é’¥ã€‚<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">jasypt:</span></span><br><span class=\"line\">\t<span class=\"attr\">encryptor:</span></span><br><span class=\"line\">  \t<span class=\"attr\">password:</span> <span class=\"string\">eva</span></span><br></pre></td></tr></table></figure></li>\n<li>åŠ å¯†å†…å®¹<br>ã€€ã€€ç¼–å†™ä¸€ä¸ªå•å…ƒæµ‹è¯•åŠ å¯†ä½ éœ€è¦åŠ å¯†çš„å†…å®¹ã€‚<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\t<span class=\"meta\">@Autowired</span></span><br><span class=\"line\">StringEncryptor stringEncryptor;</span><br><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">encrypt</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;PWD: &quot;</span> + stringEncryptor.encrypt(<span class=\"string\">&quot;yourpassword&quot;</span>));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n<li>ä¿®æ”¹é…ç½®æ–‡ä»¶,ä½¿ç”¨<code>ENC</code>åŒ…è£¹åŠ å¯†å¾—åˆ°çš„å¯†æ–‡å³å¯ã€‚<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">datasource:</span></span><br><span class=\"line\">    <span class=\"attr\">type:</span> <span class=\"string\">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class=\"line\">    <span class=\"attr\">url:</span> <span class=\"string\">jdbc:mysql://localhost:3306/jxc?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=UTC</span></span><br><span class=\"line\">    <span class=\"attr\">username:</span> <span class=\"string\">ENC(dghf0DZZJA+vQ95xgHz5iA==)</span></span><br><span class=\"line\">    <span class=\"attr\">password:</span> <span class=\"string\">ENC(TNbKfi0lHjpfPcdepEnR5oKHikoDfVr+/amPonxytqK5u+B8Pid7k4hmlGUOhv+6QxEuB3gjJPPn7L8ishuFYym/Gr59qRO6Uf5/XiyT+3FUTujtyybxUjTyo4CO1wKe+zubp27QVYM=)</span></span><br></pre></td></tr></table></figure>\n\n\n</li>\n</ol>\n<blockquote>\n<p>å‚è€ƒ: <a href=\"https://github.com/ulisesbocchio/jasypt-spring-boot\">https://github.com/ulisesbocchio/jasypt-spring-boot</a></p>\n</blockquote>\n","categories":["Spring Boot"],"tags":["Java","Gradle","Spring Boot","Spring"]},{"title":"Gradleä¸­çš„ä»»åŠ¡","url":"https://pkaq.org/2018/08/12/gradletask/","content":"<p><code>Project</code>å’Œ<code>Task</code>æ˜¯<code>Gradle</code>ä¸­æœ€æ ¸å¿ƒçš„ä¸¤ä¸ªå…ƒç´ ï¼Œå½“åˆ›å»ºäº†ä¸€ä¸ª<code>build.gradle</code>è„šæœ¬é‚£ä¹ˆ<code>Gradle</code>ä¾¿ä¼šä¾æ®è„šæœ¬çš„é…ç½®åˆ›å»ºä¸€ä¸ª<code>Project</code>,è€Œè„šæœ¬ä¸­çš„<code>Task</code>ä¹Ÿä¼šåˆ›å»ºä¸ä¹‹ç›¸å¯¹åº”<code>DeafultTask</code>å®ç°ã€‚</p>\n<p>ã€€ã€€<code>Gradle</code>é€šè¿‡ä¸€ä¸ªä¸ª<code>Task</code>æ¥å®Œæˆå…·ä½“çš„æ„å»ºä»»åŠ¡ ,å¯ä»¥è¯´<code>Task</code>ä¹ƒæ˜¯<code>Gradle</code>çš„æ ¸å¿ƒã€‚æ ¹æ®æ‰§è¡Œé˜¶æ®µçš„ä¸åŒï¼Œå¯ä»¥å°†<code>Gradle</code>ä¸­<code>Task</code>åˆ†ä¸º<code>é…ç½®å‹Task</code>ä»¥åŠ<code>åŠ¨ä½œå‹Task</code>ã€‚</p>\n<h2><span id=\"yi-task-de-ji-ben-zu-cheng\">ä¸€ã€Taskçš„åŸºæœ¬ç»„æˆ</span><a href=\"#yi-task-de-ji-ben-zu-cheng\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€æŸ¥çœ‹<code>Task DSL</code>è¯´æ˜æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œé€šå¸¸ä¸€ä¸ª<code>Task</code>åŒ…æ‹¬: ä¾èµ–ã€åŠ¨ä½œã€å±æ€§ã€è¾“å…¥ã€è¾“å‡ºã€ç»ˆç»“å™¨ç­‰æ„æˆã€‚</p>\n<p>å½“ç„¶è¿™äº›å¹¶ä¸æ˜¯æ¯ä¸€ä¸ªéƒ½æ˜¯å¿…é¡»çš„ã€‚åˆ›å»ºä»»åŠ¡çš„æ—¶å€™éœ€è¦æ ¹æ®è‡ªå·±çš„å…·ä½“éœ€è¦è¿›è¡Œé€‰æ‹©æ€§é…ç½®ã€‚</p>\n<a id=\"more\"></a>\n\n<h2><span id=\"er-ding-yi-task\">äºŒã€å®šä¹‰Task</span><a href=\"#er-ding-yi-task\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€<code>Gralde</code>ä¸­å®šä¹‰ä¸€ä¸ªä»»åŠ¡çš„æ–¹å¼ååˆ†çµæ´»ï¼Œä¸‹é¢éƒ½æ˜¯å®šä¹‰ä¸€ä¸ªä»»åŠ¡çš„æ–¹å¼ã€‚</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">task myTask</span><br><span class=\"line\">task myTask &#123; configure closure &#125;</span><br><span class=\"line\">task myTask(<span class=\"attr\">type:</span> SomeType)</span><br><span class=\"line\">task myTask(<span class=\"attr\">type:</span> SomeType) &#123; configure closure &#125;</span><br></pre></td></tr></table></figure>\n\n\n<h3><span id=\"pei-zhi-xing-task\">é…ç½®å‹Task</span><a href=\"#pei-zhi-xing-task\" class=\"header-anchor\">#</a></h3><p>ã€€ã€€å®šä¹‰ä¸€ä¸ª<code>Task</code>ååˆ†ç®€å•ï¼Œåªéœ€è¦ä½¿ç”¨<code>task name&#123;&#125;</code>å³å¯å®šä¹‰ä¸€ä¸ªç®€å•çš„ä»»åŠ¡ã€‚</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">task helloTask &#123;</span><br><span class=\"line\">    println <span class=\"string\">&quot;Hello World&quot;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ã€€ã€€æ‰§è¡Œ<code>gradle hT</code>ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°æ‰§è¡Œç»“æœã€‚è¿™é‡Œä½ å¯èƒ½ä¼šæ³¨æ„åˆ°<code>Hello world</code>å¹¶éåœ¨æ‰§è¡Œé˜¶æ®µå¼€å§‹æ‰§è¡Œçš„,è€Œæ˜¯åœ¨é…ç½®é˜¶æ®µå°±å·²ç»æ‰“å°äº†ã€‚æ²¡é”™ï¼Œè¿™å°±æ˜¯ä¸€ä¸ª<code>é…ç½®å‹Task</code>ï¼Œå› ä¸ºGradleåœ¨ä»»åŠ¡æ‰§è¡Œå‰ï¼Œæ€»ä¼šå»éå†æ‰€æœ‰ä»»åŠ¡å»ç”Ÿæˆä¸€å¼ <code>DAG(æœ‰å‘æ— ç¯å›¾)</code>æ¥ç¡®å®šä»»åŠ¡ä¹‹é—´çš„å…³ç³»ã€‚</p>\n<h3><span id=\"dong-zuo-xing-task\">åŠ¨ä½œå‹Task</span><a href=\"#dong-zuo-xing-task\" class=\"header-anchor\">#</a></h3><p>ã€€ã€€å¦‚æœä¸æƒ³è®©ä»»åŠ¡åœ¨é…ç½®é˜¶æ®µæ‰§è¡Œï¼Œé‚£ä¹ˆå¯ä»¥å‚ç…§å¦‚ä¸‹æ–¹å¼ï¼Œé€šè¿‡ç»™ä»»åŠ¡æ·»åŠ actionçš„æ–¹å¼ä½¿å…¶åœ¨æ‰§è¡Œé˜¶æ®µè¿è¡Œã€‚</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">task helloTask &#123;</span><br><span class=\"line\">    doLast &#123;</span><br><span class=\"line\">        println <span class=\"string\">&quot;Hello World&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å¸¸ç”¨çš„actionæœ‰ä¸¤ä¸ªï¼Œ<code>doFirst</code>å’Œ<code>doLast</code>ï¼Œé€šè¿‡è¿™ä¸¤ä¸ªè§åçŸ¥æ„çš„<code>action</code>å¯ä»¥ç”¨æ¥å®šç½®åŒ–ä½ çš„ä»»åŠ¡è¡Œä¸ºã€‚</p>\n<ul>\n<li>ä¸€ä¸ªTaskåŒ…å«è‹¥å¹²<code>Action</code>ã€‚æ‰€ä»¥ï¼ŒTaskæœ‰<code>doFirst</code>å’Œ<code>doLast</code>ä¸¤ä¸ªå‡½æ•°ï¼Œç”¨äºæ·»åŠ éœ€è¦æœ€å…ˆæ‰§è¡Œçš„<code>Action</code>å’Œéœ€è¦å’Œéœ€è¦æœ€åæ‰§è¡Œçš„<code>Action</code>ã€‚<code>Action</code>å°±æ˜¯ä¸€ä¸ªé—­åŒ…ã€‚</li>\n<li> Taskåˆ›å»ºçš„æ—¶å€™å¯ä»¥æŒ‡å®šTypeï¼Œé€šè¿‡<em>type:åå­—</em>è¡¨è¾¾ã€‚è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå…¶å®å°±æ˜¯å‘Šè¯‰<code>Gradle</code>ï¼Œè¿™ä¸ªæ–°å»ºçš„Taskå¯¹è±¡ä¼šä»å“ªä¸ªåŸºç±»Taskæ´¾ç”Ÿã€‚æ¯”å¦‚ï¼ŒGradleæœ¬èº«æä¾›äº†ä¸€äº›é€šç”¨çš„Taskï¼Œæœ€å¸¸è§çš„æœ‰Copy ä»»åŠ¡ã€‚Copyæ˜¯Gradleä¸­çš„ä¸€ä¸ªç±»ã€‚å½“æˆ‘ä»¬ï¼š<code>*task myTask(type:Copy)*</code>çš„æ—¶å€™ï¼Œåˆ›å»ºçš„Taskå°±æ˜¯ä¸€ä¸ªCopy Taskã€‚</li>\n<li>å½“æˆ‘ä»¬ä½¿ç”¨ <code>task myTask&#123; xxx&#125;</code>çš„æ—¶å€™ã€‚èŠ±æ‹¬å·æ˜¯ä¸€ä¸ª<code>closure</code>ã€‚è¿™ä¼šå¯¼è‡´gradleåœ¨åˆ›å»ºè¿™ä¸ªTaskä¹‹åï¼Œè¿”å›ç»™ç”¨æˆ·ä¹‹å‰ï¼Œä¼šå…ˆæ‰§è¡Œclosureçš„å†…å®¹ã€‚</li>\n</ul>\n<p>å½“ç”¨æˆ·æ‰§è¡Œtestä»»åŠ¡æ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼šÂ  </p>\n<ol>\n<li>æ‰§è¡Œbuild.gradleï¼Œåˆå§‹åŒ–ä»»åŠ¡ï¼Œåˆå§‹åŒ–æ­¥éª¤ä¸º2-7;Â </li>\n<li>æ³¨å†Œtestä»»åŠ¡ï¼Œä»»åŠ¡ä½“éƒ½æ˜¯é»˜è®¤å¥½çš„ï¼Œä¸å¯æ›´æ”¹ï¼Œä¸ºæ‰“å°å†’å·åŠ ä»»åŠ¡åï¼Œæ‰€ä»¥testçš„ä»»åŠ¡ä½“ä¸º<code>println &#39;:test&#39;</code>ï¼›  </li>\n<li>æ¯ä¸ªä»»åŠ¡éƒ½æœ‰ä¸€ä¸ªé˜Ÿåˆ—ä¸€ä¸ªæ ˆï¼Œä¸€ä¸ªæ˜¯ä¾èµ–é˜Ÿåˆ—ï¼Œä¸€ä¸ªæ˜¯firstæ ˆï¼Œä¸€ä¸ªæ˜¯lasté˜Ÿåˆ—ï¼›  </li>\n<li>é‡åˆ°doFirstå‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å—ä¸€ä¸ªé—­åŒ…ä½œä¸ºå‚æ•°ï¼ŒdoFirstå‡½æ•°ä¼šæŠŠé—­åŒ…å‚æ•°æ”¾å…¥firstæ ˆï¼›Â </li>\n<li>é‡åˆ°doLastå‡½æ•°ï¼ŒåŒç†doFirstå‡½æ•°ï¼Œé—­åŒ…å‚æ•°ä¼šè¢«æ”¾å…¥lasté˜Ÿåˆ—ï¼›  </li>\n<li>ç„¶åé‡åˆ°<code>println &#39;hello.&#39;</code>ï¼Œæ‰§è¡Œè¯¥æŒ‡ä»¤//1ï¼›  </li>\n<li>è‡³æ­¤åˆå§‹åŒ–è¿‡ç¨‹å®Œæˆã€‚Â </li>\n<li>å¼€å§‹æ‰§è¡Œtestä»»åŠ¡å‰ï¼Œå…ˆæ£€æŸ¥æ˜¯å¦ä»»åŠ¡ä¾èµ–ï¼Œå¦‚æœæœ‰ï¼Œå…ˆæŠŠä¾èµ–çš„ä»»åŠ¡éƒ½æ‰§è¡Œå®Œã€‚Â </li>\n<li>ç„¶åå¼€å§‹æ‰§è¡Œtestä»»åŠ¡ï¼›  </li>\n<li>æ‰§è¡Œæ—¶ï¼Œé¦–å…ˆæ‰§è¡Œtestä»»åŠ¡çš„ä»»åŠ¡ä½“ï¼Œå³<code>println &#39;:test&#39;</code>ï¼›  </li>\n<li>ç„¶åæ‰§è¡Œtestä»»åŠ¡çš„firstæ ˆ//2å’Œlasté˜Ÿåˆ—//3ï¼›  </li>\n<li>ä»»åŠ¡æ‰§è¡Œç»“æŸã€‚ </li>\n</ol>\n<h2><span id=\"san-task-zhong-shu-xing-de-ying-yong\">ä¸‰ã€Taskä¸­å±æ€§çš„åº”ç”¨</span><a href=\"#san-task-zhong-shu-xing-de-ying-yong\" class=\"header-anchor\">#</a></h2><h3><span id=\"fen-zu\">åˆ†ç»„</span><a href=\"#fen-zu\" class=\"header-anchor\">#</a></h3><p>ã€€ <code>DeafultTask</code>æä¾›äº†å¾ˆå¤šæ–¹ä¾¿çš„å±æ€§ï¼Œçµæ´»è¿ç”¨è¿™äº›å±æ€§å¯ä»¥è®©ä½ æ›´åŠ çµæ´»çš„é…ç½®è‡ªå·±çš„<code>Task</code>ã€‚å¦‚ï¼šåœ¨<code>IDEA</code>ç­‰ç¼–è¾‘å™¨ä¸­æˆ‘ä»¬æŸ¥çœ‹<code>Gradle</code>ä»»åŠ¡æ—¶ï¼Œä»»åŠ¡éƒ½æ˜¯æ”¾åœ¨å„ä¸ªä»»åŠ¡ç»„ä¸‹é¢çš„ï¼Œè¿™ä¾¿æ˜¯å€ŸåŠ©ä»»åŠ¡å±æ€§ä¸­çš„<code>group</code>å±æ€§å®ç°çš„ã€‚å¦‚æœåœ¨åˆ›å»ºä»»åŠ¡æ—¶æ²¡æŒ‡å®šè¿™ä¸ªå±æ€§ï¼Œé‚£ä¹ˆä»»åŠ¡ä¼šé»˜è®¤åˆ†é…åˆ°<code>other tasks</code>åˆ†ç»„ã€‚</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">task mytask&#123;</span><br><span class=\"line\">    <span class=\"symbol\">group:</span> <span class=\"string\">&#x27;build&#x27;</span></span><br><span class=\"line\">     doLast &#123;</span><br><span class=\"line\">        println <span class=\"string\">&quot;Hello World&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3><span id=\"yi-lai\">ä¾èµ–</span><a href=\"#yi-lai\" class=\"header-anchor\">#</a></h3><p>ã€€ ç”±äº<code>Gradle</code>ä¸­ä»»åŠ¡çš„æ‰§è¡Œé¡ºåºæ˜¯ä¸ç¡®å®šçš„ï¼Œå½“ä½ éœ€è¦æŒ‰é¡ºåºæ‰§è¡ŒæŸäº›ä»»åŠ¡æ—¶ï¼Œå¯ä»¥é€šè¿‡<code>dependsOn</code>ã€<code>mustRunAfter</code>ã€<code>finalizedBy</code>ç­‰å®šä¹‰ä»»åŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»æ¥è¾¾åˆ°è®©ä»»åŠ¡æŒ‰é¡ºåºæ‰§è¡Œçš„ç›®çš„ã€‚çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">task one&#123;</span><br><span class=\"line\">\tgroup <span class=\"string\">&#x27;timo&#x27;</span></span><br><span class=\"line\">     doLast &#123;</span><br><span class=\"line\">        println <span class=\"string\">&quot;Hello frist&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">task two(<span class=\"attr\">dependsOn:</span> one)&#123;</span><br><span class=\"line\">     doLast &#123;</span><br><span class=\"line\">        println <span class=\"string\">&quot;Hello two&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">task three&#123;</span><br><span class=\"line\">\tdependsOn two</span><br><span class=\"line\">     doLast &#123;</span><br><span class=\"line\">        println <span class=\"string\">&quot;Hello three&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">task four&#123;</span><br><span class=\"line\">\t mustRunAfter three</span><br><span class=\"line\">     doLast &#123;</span><br><span class=\"line\">        println <span class=\"string\">&quot;Hello four&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// TASK THREEæ‰§è¡Œå®Œåå¿…ç„¶æ‰§è¡Œfour</span></span><br><span class=\"line\">three.finalizedBy four</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n<h3><span id=\"tiao-guo\">è·³è¿‡</span><a href=\"#tiao-guo\" class=\"header-anchor\">#</a></h3><p>ã€€ æœ‰æ—¶ä¸ºäº†èŠ‚çº¦æ„å»ºæ—¶é—´æˆ‘ä»¬éœ€è¦è·³è¿‡æŸäº›ä»»åŠ¡çš„æ‰§è¡Œï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡æŒ‡å®š<code>enabled</code>å±æ€§çš„æ–¹å¼æ¥è·³è¿‡æŸäº›ä»»åŠ¡çš„æ‰§è¡Œã€‚</p>\n<p>ã€€ å½“ç„¶ï¼Œåœ¨æ‰§è¡Œæ—¶å€™é€šè¿‡å‘½ä»¤è¡Œå‚æ•°<code>-x taskname</code>ä¹Ÿå¯ä»¥è¾¾åˆ°ç›¸åŒçš„æ•ˆæœã€‚</p>\n<p>ã€€ ä¸ºäº†æé«˜æ„å»ºçš„é€Ÿåº¦ï¼ŒGradleåœ¨æ‰§è¡Œä»»åŠ¡æ—¶éƒ½ä¼šæ£€æŸ¥ä»»åŠ¡çš„è¾“å…¥ä¸è¾“å‡ºï¼Œå¦‚æœè¾“å…¥è¾“å‡ºç›¸å¯¹ä¸Šæ¬¡æ„å»ºæ²¡æœ‰å˜åŒ–é‚£ä¹ˆä¼šå°†æ­¤ä»»åŠ¡æ ‡è®°ä¸º<code>UP-TO-DATE</code>æ¥è·³è¿‡ä»»åŠ¡çš„æ‰§è¡Œã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€šè¿‡<code>inputs</code>å’Œ<code>outputs</code>çš„<code>upToDateWhen&#123;&#125;</code>æ¥æ§åˆ¶è¿™ç§è¡Œä¸ºã€‚</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">task one&#123;</span><br><span class=\"line\">\tenabled <span class=\"literal\">false</span></span><br><span class=\"line\">    doLast&#123;</span><br><span class=\"line\">         println <span class=\"string\">&quot;Hello frist&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">task two(<span class=\"attr\">dependsOn:</span>one)&#123;</span><br><span class=\"line\">    doLast&#123;  </span><br><span class=\"line\">         println <span class=\"string\">&quot;Hello two&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">task three&#123;</span><br><span class=\"line\">    dependsOn two</span><br><span class=\"line\">     doLast &#123;</span><br><span class=\"line\">        println <span class=\"string\">&quot;Hello three&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3><span id=\"dong-tai-ren-wu\">åŠ¨æ€ä»»åŠ¡</span><a href=\"#dong-tai-ren-wu\" class=\"header-anchor\">#</a></h3><p>ã€€ å¾—ç›Šäº<code>Gradle</code>åŸºäº<code>groovy</code>çš„<code>dsl</code>å¯ä»¥æ–¹ä¾¿çš„å®šä¹‰ä¸€ä¸ªåŠ¨æ€ä»»åŠ¡ã€‚</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">4.</span>times &#123; counter -&gt;</span><br><span class=\"line\">    task <span class=\"string\">&quot;task$counter&quot;</span> &#123;</span><br><span class=\"line\">        doLast&#123;</span><br><span class=\"line\">       \t println <span class=\"string\">&quot;I&#x27;m task number $counter&quot;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2><span id=\"lei-xing-ren-wu\">ç±»å‹ä»»åŠ¡</span><a href=\"#lei-xing-ren-wu\" class=\"header-anchor\">#</a></h2><p>ã€€<code> Gradle</code>åŠå…¶å„ç§æ’ä»¶æä¾›äº†è®¸å¤šå†…ç½®çš„ä»»åŠ¡ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ›å»ºéœ€è¦çš„ç±»å‹ä»»åŠ¡æ¥å®ç°ä¸€äº›è‡ªå®šä¹‰æ•ˆæœã€‚ä¸‹é¢çš„ä»£ç åˆ›å»ºäº†ä¸€ä¸ª<code>Copy</code>ç±»å‹çš„ä»»åŠ¡ã€‚<code>Copy</code>ä»»åŠ¡å®ç°äº†<code>CopySpec</code>æ¥å£ï¼Œé€šè¿‡æŸ¥é˜…<code>CopySpec</code>çš„APIè¯´æ˜æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰è¯¥ä»»åŠ¡çš„å±æ€§å’Œæ–¹æ³•çš„å®ç°ã€‚</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">task copyTask(<span class=\"attr\">type:</span> Copy) &#123;</span><br><span class=\"line\">    from <span class=\"string\">&#x27;.&#x27;</span></span><br><span class=\"line\">    into <span class=\"string\">&#x27;abc&#x27;</span></span><br><span class=\"line\">    include <span class=\"string\">&#x27;in.txt&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2><span id=\"si-zi-ding-yi-ren-wu\">å››ã€è‡ªå®šä¹‰ä»»åŠ¡</span><a href=\"#si-zi-ding-yi-ren-wu\" class=\"header-anchor\">#</a></h2><p>ã€€ åœ¨<code>Gradle</code>ä¸­è‡ªå®šä¹‰ä¸€ä¸ªä»»åŠ¡æ˜¯ååˆ†æ–¹ä¾¿çš„ï¼Œåªéœ€è¦ç¼–å†™ä¸€ä¸ªç»§æ‰¿è‡ª<code>DefaultTask  </code>çš„ç±»å³å¯ã€‚ä½ å¯ä»¥ç›´æ¥åœ¨ä½ çš„è„šæœ¬æ–‡ä»¶ä¸­ç¼–å†™ï¼Œä¹Ÿå¯ä»¥æ”¾åˆ°<code>buildSrc</code>ä¸­ï¼Œå½“ç„¶å‡ºäºå¯ç»´æŠ¤æ€§çš„è€ƒè™‘ä»¥åŠè§†è§‰ä¸Šçš„æ„Ÿå—æ›´æ¨èåè€…çš„æ–¹å¼ã€‚</p>\n<p>ã€€ è‹¥è¦åœ¨<code>buildSrc</code>ä¸‹å®šä¹‰ï¼Œåªéœ€è¦åœ¨<code>build.gradle</code>åŒçº§ç›®å½•åˆ›å»º<code>buildSrc</code>å¹¶æŠŠä»»åŠ¡ç±»æ”¾åœ¨<code>src\\main\\java</code>æˆ–<code>src\\main\\groovy</code>ä¸‹å³å¯ã€‚</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ç›´æ¥åœ¨è„šæœ¬æ–‡ä»¶ä¸­å®šä¹‰è‡ªå®šä¹‰ä»»åŠ¡</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Inner</span> <span class=\"keyword\">extends</span> <span class=\"title\">DefaultTask</span> &#123;</span></span><br><span class=\"line\">    String words = <span class=\"string\">&#x27;Inner&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@TaskAction</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> action1() &#123; println words + name &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@TaskAction</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> action2() &#123; println words + <span class=\"string\">&#x27; InnerTom&#x27;</span>  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä½¿ç”¨buildSrcä¸‹å®šä¹‰çš„ä»»åŠ¡</span></span><br><span class=\"line\">task say(<span class=\"attr\">type:</span> Hello) &#123;</span><br><span class=\"line\">    words = <span class=\"string\">&#x27;Aloha &#x27;</span></span><br><span class=\"line\">    doFirst &#123; println <span class=\"string\">&#x27;fisrt blood&#x27;</span> &#125;</span><br><span class=\"line\">    doLast &#123; println <span class=\"string\">&#x27;double kill&#x27;</span> &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">task sayIn(<span class=\"attr\">type:</span> Inner) &#123;</span><br><span class=\"line\">    words = <span class=\"string\">&#x27;Aloha Inner &#x27;</span></span><br><span class=\"line\">    doFirst &#123; println <span class=\"string\">&#x27;Inner blood&#x27;</span> &#125;</span><br><span class=\"line\">    doLast &#123; println <span class=\"string\">&#x27;Inner kill&#x27;</span> &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","categories":["æ„å»º"],"tags":["Gradle"]},{"title":"Flutteråˆä½“éªŒ","url":"https://pkaq.org/2018/08/12/helloflutter/","content":"<h1><span id=\"yin-yan\">å¼•è¨€</span><a href=\"#yin-yan\" class=\"header-anchor\">#</a></h1><p>ã€€ã€€Flutteræ˜¯è°·æ­Œçš„ç§»åŠ¨UIæ¡†æ¶ï¼Œå¯ä»¥å¿«é€Ÿåœ¨iOSå’ŒAndroidä¸Šæ„å»ºé«˜è´¨é‡çš„åŸç”Ÿç”¨æˆ·ç•Œé¢ã€‚ Flutterå¯ä»¥ä¸ç°æœ‰çš„ä»£ç ä¸€èµ·å·¥ä½œã€‚åœ¨å…¨ä¸–ç•Œï¼ŒFlutteræ­£åœ¨è¢«è¶Šæ¥è¶Šå¤šçš„å¼€å‘è€…å’Œç»„ç»‡ä½¿ç”¨ï¼Œå¹¶ä¸”Flutteræ˜¯å®Œå…¨å…è´¹ã€å¼€æºçš„ã€‚ </p>\n<h1><span id=\"ban-ben\">ç‰ˆæœ¬</span><a href=\"#ban-ben\" class=\"header-anchor\">#</a></h1><p>ã€€ã€€ä»¥ä¸‹å·¥å…·å‡ä¸ºå¿…è¦å·¥å…·ï¼š</p>\n<ul>\n<li>Git2.18.0</li>\n<li>Flutter 0.5.1</li>\n<li>Windows 10ï¼ˆ64ä½ï¼‰</li>\n</ul>\n<h1><span id=\"bu-zou\">æ­¥éª¤</span><a href=\"#bu-zou\" class=\"header-anchor\">#</a></h1><h2><span id=\"xia-zai-an-zhuang\">ä¸‹è½½å®‰è£…</span><a href=\"#xia-zai-an-zhuang\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€ä¸‹è½½åè§£å‹åˆ°ä»»æ„ç›®å½•å³å¯(æ³¨æ„ç›®å½•è·¯å¾„ä¸­ä¸è¦æœ‰ä¸­æ–‡\\ç‰¹æ®Šç¬¦å·\\ç©ºæ ¼)   </p>\n<p>1 SDKä¸‹è½½ï¼š <a href=\"https://flutter.io/sdk-archive/#windows\">https://flutter.io/sdk-archive/#windows</a></p>\n<p>2 é…ç½®ç¯å¢ƒå˜é‡</p>\n<ul>\n<li><pre><code>PUB_HOSTED_URL=https://pub.flutter-io.cn //å›½å†…ç”¨æˆ·éœ€è¦è®¾ç½®\nFLUTTER_STORAGE_BASE_URL=https://storage.flutter-io.cn //å›½å†…ç”¨æˆ·éœ€è¦è®¾ç½®</code></pre>\n</li>\n</ul>\n<blockquote>\n<p><strong>æ³¨æ„ï¼š</strong>Â ç”±äºä¸€äº›<code>flutter</code>å‘½ä»¤éœ€è¦è”ç½‘è·å–æ•°æ®ï¼Œå¦‚æœæ‚¨æ˜¯åœ¨å›½å†…è®¿é—®ï¼Œç”±äºä¸å¯æè¿°çš„åŸå› ï¼Œç›´æ¥è®¿é—®å¾ˆå¯èƒ½ä¸ä¼šæˆåŠŸã€‚ ä¸Šé¢çš„<code>PUB_HOSTED_URL</code>å’Œ<code>FLUTTER_STORAGE_BASE_URL</code>æ˜¯googleä¸ºå›½å†…å¼€å‘è€…æ­å»ºçš„ä¸´æ—¶é•œåƒã€‚è¯¦æƒ…è¯·å‚è€ƒÂ <a href=\"https://github.com/flutter/flutter/wiki/Using-Flutter-in-China\">Using Flutter in China</a> </p>\n</blockquote>\n<h2><span id=\"chuang-jian\">åˆ›å»º</span><a href=\"#chuang-jian\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€åœ¨è§£å‹ç›®å½•æ‰§è¡Œ<code>flutter_console.bat</code>ä¼šæ‰“å¼€ä¸€ä¸ªçŸ³é’è‰²çš„æ§åˆ¶å°ç•Œé¢ï¼Œæ ¹æ®æç¤ºå¯ä»¥è¿è¡Œ<code>flutter docter</code>æ£€æŸ¥ç¯å¢ƒä¾èµ–ï¼Œç„¶åè·³è½¬åˆ°ä½ çš„<code>workspace</code>ç›®å½•æ‰§è¡Œ<code>flutter create hello</code>å°±ç”Ÿæˆäº†ä¸€ä¸ªç®€å•è®¡æ•°å™¨åº”ç”¨ã€‚</p>\n<ul>\n<li><p><code>ios</code>ç›®å½•åŒ…å«äº†iosçš„å…¨éƒ¨ä»£ç å¯ä»¥ç›´æ¥ä½¿ç”¨xcodeï¼ˆéœ€è¦9.0+ç‰ˆæœ¬ï¼‰è¿›è¡Œå¼€å‘ã€‚</p>\n</li>\n<li><p> <code>android</code>ç›®å½•åŒ…å«äº†androidçš„å…¨éƒ¨ä»£ç ï¼Œç›´æ¥ä½¿ç”¨android studioå¼€å‘å³å¯ã€‚</p>\n</li>\n<li><p><code>lib</code>ç›®å½•ä¸­åŒ…å«äº†ä¸¤ç«¯é€šç”¨çš„dartä»£ç ï¼Œåœ¨æ‰“åŒ…ç”Ÿæˆåº”ç”¨æ—¶ï¼Œå…¨éƒ¨çš„dartä»£ç ä¼šè¢«ç¼–è¯‘ä¸ºæœ¬åœ°ä»£ç ï¼ˆå¦‚åœ¨androidç«¯ï¼Œä¼šè¢«ç›´æ¥ç¼–è¯‘ä¸ºsoæ–‡ä»¶ï¼‰ã€‚</p>\n<p>ã€€ã€€æ­¤æ—¶è¿æ¥ä½ çš„å®‰å“æ‰‹æœºæ‰“å¼€USBè°ƒè¯•æ¨¡å¼ï¼Œæ‰§è¡Œ<code>flutter run</code>å³å¯å°†ç”Ÿæˆçš„<code>hello</code>åº”ç”¨å®‰è£…åˆ°ä½ çš„æ‰‹æœºä¸Šã€‚</p>\n</li>\n</ul>\n<p><strong>å‚è€ƒèµ„æ–™</strong></p>\n<ul>\n<li><p><a href=\"https://flutterchina.club/\">Flutterä¸­æ–‡ç½‘</a></p>\n</li>\n<li><p><a href=\"https://flutter.io/\">Flutterå®˜æ–¹ç½‘ç«™</a></p>\n</li>\n</ul>\n","categories":["App"],"tags":["Flutter","è·¨å¹³å°App"]},{"title":"mybatis plusæ•´åˆsharding-jdbcåœ¨åŸºäºspring bootçš„é¡¹ç›®ä¸­çš„å•åº“åˆ†è¡¨åº”ç”¨","url":"https://pkaq.org/2018/08/10/shardingjdbc/","content":"<h1><span id=\"yin-yan\">å¼•è¨€</span><a href=\"#yin-yan\" class=\"header-anchor\">#</a></h1><p>ã€€ã€€åœ¨äº§å“åº”ç”¨ä¸­ï¼Œå½“æŸäº›ä¸šåŠ¡æ•°æ®é‡è¿‡å¤§æ—¶ä¼šå¯¼è‡´æ•°æ®åº“è¯»å†™æ€§èƒ½æ€¥å‰§ä¸‹é™ç”šè‡³æ‹–æ…¢å…¶å®ƒä¸šåŠ¡çš„æƒ…å†µã€‚æ­¤æ—¶ä¾¿éœ€è¦å¯¹æ•°æ®åº“è¿›è¡Œä¸åŒç»´åº¦çš„æ‹†åˆ†ï¼Œä¾‹å¦‚æ°´å¹³æ‹†åˆ†æˆ–è€…å‚ç›´æ‹†åˆ†ã€‚<br>ã€€ã€€<strong>å‚ç›´æ‹†åˆ†ï¼ˆåˆ†åº“ï¼‰ï¼š</strong>æŒ‰ä¸šåŠ¡ç›¸å…³åº¦å°†ç›¸å…³ä¸šåŠ¡çš„è¡¨æ‹†åˆ†åˆ°ä¸åŒæ•°æ®åº“ä¸­ï¼Œä¾‹å¦‚è®¢å•åº“ã€å•†å“åº“ã€‚é€šè¿‡è¿™ç§æ‹†åˆ†ç›¸å…³ä¸šåŠ¡æ¨¡å—ä»…éœ€è¯·æ±‚å…¶ä¸šåŠ¡ç›¸å…³çš„åº“å³å¯ã€‚<br>ã€€ã€€<strong>æ°´å¹³æ‹†åˆ†ï¼ˆåˆ†è¡¨ï¼‰ï¼š</strong>æŒ‰æ•°æ®ç›¸å…³åº¦å°†å•è¡¨æ‹†åˆ†ä¸ºå¤šå¼ è¡¨ï¼Œä¸å‚ç›´æ‹†åˆ†ä¸åŒçš„æ˜¯æ°´å¹³æ‹†åˆ†æ˜¯é’ˆå¯¹å•è¡¨ï¼Œå½“ç³»ç»Ÿä¸­æŸå¼ è¡¨æ•°æ®é‡å¤ªå¤§æ—¶å¯ä»¥é‡‡ç”¨æ°´å¹³æ‹†åˆ†çš„æ–¹å¼æ ¹æ®å®šä¹‰çš„è§„åˆ™æ‹†åˆ†æˆå¤šå¼ è¡¨ä»¥æé«˜è¯»å†™æ€§èƒ½ã€‚<br>ã€€ã€€å…·ä½“é€‰æ‹©å“ªç§æ‹†åˆ†æ–¹å¼è¿˜éœ€è¦ç»“åˆå®é™…ä¸šåŠ¡æƒ…å†µã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé‡‡ç”¨ä¸¤ç§æ–¹å¼è¿›è¡Œè”åˆæ‹†åˆ†çš„æƒ…å†µä¹Ÿæ˜¯éå¸¸å¸¸è§çš„ï¼Œå½“ç„¶ï¼Œå¦‚æœåœ¨å°è§„æ¨¡åº”ç”¨çš„æƒ…å†µä¸‹éè¦åšä¸¤ç§æ‹†åˆ†ï¼Œé‚£é™¤äº†ç‚«æŠ€ä¹‹å¤–åŒæ—¶è¿˜ä¼šå¢åŠ å¼€å‘è¿ç»´æˆæœ¬ï¼Œæ˜¯æ¯«æ— æ„ä¹‰çš„ã€‚<br>ã€€ã€€æœ¬æ–‡è®¨è®ºçš„æƒ…å†µä»…é™äºæ°´å¹³æ‹†åˆ†ï¼Œå³å¯¹å•åº“å¤§æ•°æ®é‡è¡¨è¿›è¡Œæ‹†åˆ†ã€‚å…·ä½“åŸç†ä¹Ÿå¾ˆç®€å•,åªè¦æŠŠmybatis plusçš„æ•°æ®æºæ¢æˆshardingJdbcDatasourceå³å¯ã€‚ä¸‹é¢çš„ç¤ºä¾‹æ˜¯ä»¥è®¢å•è¡¨ä¸ºä¾‹ï¼ŒæŒ‰è¡¨ä¸­çš„monthå­—æ®µæŒ‰æœˆåˆ†è¡¨ã€‚   </p>\n<h1><span id=\"ban-ben\">ç‰ˆæœ¬</span><a href=\"#ban-ben\" class=\"header-anchor\">#</a></h1><ul>\n<li>sharding-jdbc: 3.0.0.M2</li>\n<li>mybatis plus: 2.3</li>\n<li>druid: 1.1.10</li>\n</ul>\n<a id=\"more\"></a>\n\n<h1><span id=\"bu-zou\">æ­¥éª¤</span><a href=\"#bu-zou\" class=\"header-anchor\">#</a></h1><h2><span id=\"gui-ze-ding-yi\">è§„åˆ™å®šä¹‰</span><a href=\"#gui-ze-ding-yi\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€æ‹†åˆ†ä¹‹å‰é¦–å…ˆè¦ç¡®å®šå¥½æ‹†åˆ†è§„åˆ™ï¼Œå¹¶ä¸”æ ¹æ®æ‹†åˆ†è§„åˆ™åœ¨æ•°æ®åº“ä¸­å»ºç«‹å¥½ç›¸å…³è¡¨</p>\n<h2><span id=\"yi-lai-yin-ru\">ä¾èµ–å¼•å…¥</span><a href=\"#yi-lai-yin-ru\" class=\"header-anchor\">#</a></h2><figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ext &#123;</span><br><span class=\"line\">   \tdruid = <span class=\"string\">&quot;1.1.10&quot;</span></span><br><span class=\"line\">    mybatis_plus = <span class=\"string\">&quot;2.3&quot;</span></span><br><span class=\"line\">    mybatis_plus_starter = <span class=\"string\">&quot;1.0.5&quot;</span></span><br><span class=\"line\">    sharding_jdbc = <span class=\"string\">&quot;3.0.0.M2&quot;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">compile</span> <span class=\"string\">&quot;io.shardingsphere:sharding-jdbc:$&#123;sharding_jdbc&#125;&quot;</span>,</span><br><span class=\"line\">\t\t<span class=\"string\">&quot;com.baomidou:mybatis-plus-core:$&#123;mybatis_plus&#125;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">compile</span>(<span class=\"string\">&quot;com.alibaba:druid-spring-boot-starter:$&#123;druid&#125;&quot;</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">exclude</span> <span class=\"keyword\">group</span>: <span class=\"string\">&#x27;com.alibaba&#x27;</span>, module: <span class=\"string\">&#x27;jconsole&#x27;</span></span><br><span class=\"line\">            <span class=\"keyword\">exclude</span> <span class=\"keyword\">group</span>: <span class=\"string\">&#x27;com.alibaba&#x27;</span>, module: <span class=\"string\">&#x27;tools&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2><span id=\"gui-ze-pei-zhi\">è§„åˆ™é…ç½®</span><a href=\"#gui-ze-pei-zhi\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€<br>** é…ç½®ç±» **</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> org.pkaq.config;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.spring.MybatisSqlSessionFactoryBean;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.shardingsphere.core.api.ShardingDataSourceFactory;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.shardingsphere.core.api.config.ShardingRuleConfiguration;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.shardingsphere.core.api.config.TableRuleConfiguration;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.shardingsphere.core.api.config.strategy.StandardShardingStrategyConfiguration;</span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.autoconfigure.AutoConfigureAfter;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Bean;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Configuration;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.annotation.PostConstruct;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.sql.DataSource;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.SQLException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.HashMap;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Map;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Properties;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * shardingjdbc é…ç½®ç±»</span></span><br><span class=\"line\"><span class=\"comment\"> * Datetime: 2016-11-25 11:44</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> PKAQ</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@AutoConfigureAfter(DataSource.class)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ShardingJDBCConfiguration</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> DataSource dataSource;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> DataSource shardingDataSource;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ShardingJDBCConfiguration</span><span class=\"params\">(DataSource dataSource)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.dataSource = dataSource;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PostConstruct</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">shardingDataSource</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> SQLException </span>&#123;</span><br><span class=\"line\">        ShardingRuleConfiguration shardingRuleConfig = <span class=\"keyword\">new</span> ShardingRuleConfiguration();</span><br><span class=\"line\">        <span class=\"comment\">//åˆ†è¡¨ç­–ç•¥</span></span><br><span class=\"line\">        shardingRuleConfig.getTableRuleConfigs().add(getOrderTableRuleConfiguration());</span><br><span class=\"line\">        <span class=\"comment\">//ç»‘å®šè¡¨è§„åˆ™åˆ—è¡¨</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.shardingDataSource = ShardingDataSourceFactory.createDataSource(createDataSourceMap(), shardingRuleConfig,  <span class=\"keyword\">new</span> HashMap&lt;&gt;(<span class=\"number\">1</span>), <span class=\"keyword\">new</span> Properties());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * åˆ†è¡¨ç­–ç•¥</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> TableRuleConfiguration <span class=\"title\">getOrderTableRuleConfiguration</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        TableRuleConfiguration rule = <span class=\"keyword\">new</span> TableRuleConfiguration();</span><br><span class=\"line\">        <span class=\"comment\">//é€»è¾‘è¡¨åç§°</span></span><br><span class=\"line\">        rule.setLogicTable(<span class=\"string\">&quot;T_ORDER&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//æºå + è¡¨å</span></span><br><span class=\"line\">        rule.setActualDataNodes(<span class=\"string\">&quot;ds0.T_ORDER_$-&gt;&#123;2018..2019&#125;_$-&gt;&#123;[&#x27;01&#x27;,&#x27;08&#x27;,&#x27;12&#x27;]&#125;&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">// è¡¨åˆ†ç‰‡ç­–ç•¥</span></span><br><span class=\"line\">        StandardShardingStrategyConfiguration strategyConfiguration =</span><br><span class=\"line\">                <span class=\"keyword\">new</span> StandardShardingStrategyConfiguration(<span class=\"string\">&quot;month&quot;</span>, <span class=\"keyword\">new</span> MonthTableShardingAlgorithm());</span><br><span class=\"line\">        rule.setTableShardingStrategyConfig(strategyConfiguration);</span><br><span class=\"line\">        <span class=\"comment\">//è‡ªå¢åˆ—åç§°</span></span><br><span class=\"line\">        rule.setKeyGeneratorColumnName(<span class=\"string\">&quot;id&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> rule;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> Map&lt;String, DataSource&gt; <span class=\"title\">createDataSourceMap</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        Map&lt;String, DataSource&gt; result = <span class=\"keyword\">new</span> HashMap&lt;&gt;(<span class=\"number\">1</span>);</span><br><span class=\"line\">        result.put(<span class=\"string\">&quot;ds0&quot;</span>, dataSource);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è®¾ç½®æ•°æ®æºä¸ºsharding jdbc</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> MybatisSqlSessionFactoryBean <span class=\"title\">mybatisSqlSessionFactoryBean</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        MybatisSqlSessionFactoryBean mysqlplus = <span class=\"keyword\">new</span> MybatisSqlSessionFactoryBean();</span><br><span class=\"line\">        mysqlplus.setDataSource(<span class=\"keyword\">this</span>.getShardingDataSource());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> mysqlplus;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> DataSource <span class=\"title\">getShardingDataSource</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.shardingDataSource;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>** åˆ†ç‰‡è§„åˆ™å®ç° **<br>ã€€ã€€è¿™é‡Œçš„åˆ†ç‰‡è§„åˆ™ç†è®ºä¸Šæ˜¯å¯é€‰é…ç½®ï¼Œåªæ˜¯å¦‚æœä¸é…ç½®çš„è¯é»˜è®¤ä¼šè¿›è¡Œå…¨è¡¨è·¯ç”±ï¼Œå³ä»æ‰€æœ‰æ‹†åˆ†çš„è¡¨ä¸­è¿›è¡ŒæŸ¥è¯¢ã€‚   </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> org.pkaq.config;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> cn.hutool.core.date.DateUtil;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.shardingsphere.core.api.algorithm.sharding.PreciseShardingValue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.shardingsphere.core.api.algorithm.sharding.standard.PreciseShardingAlgorithm;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Collection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * ç²¾å‡†åˆ†ç‰‡ç­–ç•¥ç±»</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span>: S.PKAQ</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Datetime</span>: 2018/8/10 0:15</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MonthTableShardingAlgorithm</span> <span class=\"keyword\">implements</span> <span class=\"title\">PreciseShardingAlgorithm</span>&lt;<span class=\"title\">Date</span>&gt; </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * ç­‰å€¼æŸ¥è¯¢åˆ†è¡¨è·¯ç”±ç­–ç•¥, æ ¹æ®ä¼ å…¥dateè¿”å›å“åº”ä»¥å¹´æœˆç»“å°¾çš„è¡¨</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> availableTargetNames å¯ç”¨è¡¨å</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> shardingValue åˆ†ç‰‡æ¡ä»¶</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> ç¬¦åˆåˆ†ç‰‡æ¡ä»¶çš„è¡¨å</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">doSharding</span><span class=\"params\">(Collection&lt;String&gt; availableTargetNames, PreciseShardingValue&lt;Date&gt; shardingValue)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">// æ ¹æ®é…ç½®çš„åˆ†è¡¨è§„åˆ™ç”Ÿæˆç›®æ ‡è¡¨çš„åç¼€</span></span><br><span class=\"line\">        String tableExt = DateUtil.format(shardingValue.getValue(), <span class=\"string\">&quot;yyyy_MM&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (String availableTableName : availableTargetNames) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (availableTableName.endsWith(tableExt)) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> availableTableName;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>","categories":["åå°å¼€å‘"],"tags":["spring","åˆ†åº“åˆ†è¡¨"]},{"title":"åŸºäºnginxçš„ç®€æ˜“è“ç»¿å‘å¸ƒ","url":"https://pkaq.org/2018/08/02/blueandgreen/","content":"<p>Blue/Green Deploymentï¼ˆè“ç»¿éƒ¨ç½²ï¼‰,åˆç§°ä¸º<code>è“ç»¿å‘å¸ƒ</code>,æ˜¯ä¸€ç§é€šè¿‡åˆ‡æ¢è“ç»¿ç¯å¢ƒçš„æ–¹å¼å®ç°æ–°ç‰ˆæœ¬çš„ä¸åœæœºå‘å¸ƒæ‰‹æ³•.é€šè¿‡è¿™ç§æ–¹å¼å¯ä»¥å®ç°åº”ç”¨çš„ä¸åœæœºå‡çº§,å¿«é€Ÿå›æ»šç­‰è¯¸å¤šå¥½å¤„.å½“ç„¶å¼Šç«¯æ˜¯åˆ‡æ¢çš„ç¬é—´å¯¹äºå°šæœªæ¥å¾—åŠå“åº”çš„è¯·æ±‚ä¼šä¸¢å¤±å“åº”.</p>\n<p>  å…·ä½“çš„åšæ³•æ˜¯    </p>\n<ul>\n<li><p>1.éƒ¨ç½²ä¸¤å¥—ç”Ÿäº§ç¯å¢ƒ,æˆ‘ä»¬ç§°è¿™ä¸¤å¥—ç¯å¢ƒåˆ†åˆ«ä¸º<code>è“è‰²ç¯å¢ƒ</code>å’Œ<code>ç»¿è‰²ç¯å¢ƒ</code>.</p>\n</li>\n<li><p>2.ä½¿ç”¨è´Ÿè½½å‡è¡¡æŒ‡å‘å…¶ä¸­ä¸€å¥—ç¯å¢ƒ(ä¹Ÿå¯ä»¥éƒ½æŒ‡å‘),å½“ç‰ˆæœ¬å‡çº§æ—¶ å…ˆå°†ç‰ˆæœ¬å‘å¸ƒåˆ°å¤‡ç”¨ç¯å¢ƒä¸­ ,è¿›è¡Œæœ‰æ•ˆæ€§æµ‹è¯•, æµ‹è¯•é€šè¿‡å,å°†éœ€è¦å‡çº§çš„ç¯å¢ƒ(å¦‚è“è‰²ç¯å¢ƒ)æµé‡å…¨éƒ¨å¯¼æµåˆ°å¤‡ç”¨ç¯å¢ƒä¸­,æ­¤æ—¶å¤‡ç”¨ç¯å¢ƒä¸åŸæ¥çš„æ­£å¼ç¯å¢ƒå®Œæˆäº†ä¸€æ¬¡è§’è‰²äº’æ¢.</p>\n</li>\n<li><p>3.é‡æ–°é…ç½®è´Ÿè½½å‡è¡¡.   </p>\n</li>\n<li><p>4.å¦‚éœ€å›æ»šå°†LBæµé‡é‡æ–°æŒ‡å‘æ—§ç¯å¢ƒå³å¯.</p>\n<p>å½“ç„¶,è¿™é‡Œä¹Ÿå¯ä»¥è®©è“ç»¿ä¸¤å¥—ç¯å¢ƒåŒæ—¶æ”¯æŒçº¿ä¸Š, æ€è·¯æ˜¯ä¸€æ ·çš„, æ ¸å¿ƒçš„æŠ€æœ¯ç‚¹ä»ç„¶æ˜¯é€šè¿‡<code>nginx</code>é…ç½®çƒ­åŠ è½½å®Œæˆå¯¼æµå®ç°.</p>\n<a id=\"more\"></a>   \n\n</li>\n</ul>\n<h1><span id=\"1-huan-jing-zhun-bei\">1.ç¯å¢ƒå‡†å¤‡</span><a href=\"#1-huan-jing-zhun-bei\" class=\"header-anchor\">#</a></h1><ul>\n<li>nginxä¸€ä»½</li>\n<li>tomcatä¸¤ä»½(é…ç½®å¥½ç«¯å£å¹¶å¯åŠ¨éªŒè¯å¯è®¿é—®)</li>\n</ul>\n<h1><span id=\"2-lb-pei-zhi\">2.LBé…ç½®</span><a href=\"#2-lb-pei-zhi\" class=\"header-anchor\">#</a></h1><p>  <code>nginx.conf</code>é…ç½®å¦‚ä¸‹<br>  <figure class=\"highlight lua\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">  # ... çœç•¥</span><br><span class=\"line\">  http &#123;</span><br><span class=\"line\">  \t# ... å‰é¢çœç•¥</span><br><span class=\"line\">    upstream nginx_blue_green &#123;</span><br><span class=\"line\">     \t#è“è‰²ç¯å¢ƒ</span><br><span class=\"line\">        #server <span class=\"number\">127.0</span><span class=\"number\">.0</span><span class=\"number\">.1</span>:<span class=\"number\">8081</span> down;</span><br><span class=\"line\">        #server <span class=\"number\">127.0</span><span class=\"number\">.0</span><span class=\"number\">.1</span>:<span class=\"number\">8080</span> weight=<span class=\"number\">100</span>;</span><br><span class=\"line\">        #ç»¿è‰²ç¯å¢ƒ</span><br><span class=\"line\">        server <span class=\"number\">127.0</span><span class=\"number\">.0</span><span class=\"number\">.1</span>:<span class=\"number\">8080</span> down;</span><br><span class=\"line\">        server <span class=\"number\">127.0</span><span class=\"number\">.0</span><span class=\"number\">.1</span>:<span class=\"number\">8081</span> weight=<span class=\"number\">100</span>;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">     # ... ä¸­é—´çœç•¥</span><br><span class=\"line\">\tserver &#123;</span><br><span class=\"line\">\t\t location / &#123;</span><br><span class=\"line\">       \t\t proxy_pass http://nginx_blue_green;</span><br><span class=\"line\">    \t&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    # ... åé¢çœç•¥</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h1><span id=\"3-fa-bu-qie-huan\">3.å‘å¸ƒåˆ‡æ¢</span><a href=\"#3-fa-bu-qie-huan\" class=\"header-anchor\">#</a></h1><p>  å‘å¸ƒæ—¶åªéœ€è¦ç¼–è¾‘<code>nginx.conf</code>æ³¨é‡Šè§£æ³¨å¯¹åº”è“ç»¿ç¯å¢ƒ,ç„¶åä½¿ç”¨<code>nginx -s reload</code>é‡æ–°åŠ è½½é…ç½®å³å¯å®ç°è“ç»¿åˆ‡æ¢.</p>\n<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“ ** åˆ†å‰²çº¿ ** â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“   </p>\n<p>** ä»¥ä¸‹å†…å®¹ä¸ºwordæ‰‹å†Œç‰ˆ **</p>\n<h1><span id=\"1-lan-lu-bu-shu\">1    è“ç»¿éƒ¨ç½²</span><a href=\"#1-lan-lu-bu-shu\" class=\"header-anchor\">#</a></h1><h2><span id=\"1-1-mu-de\">1.1    ç›®çš„</span><a href=\"#1-1-mu-de\" class=\"header-anchor\">#</a></h2><p>ä¸ºå®ç°åœ¨çº¿æœåŠ¡æ–°ç‰ˆæœ¬çš„ä¸åœæœºæ›´æ–°ï¼Œå¯ä»¥é‡‡ç”¨è“ç»¿éƒ¨ç½²çš„æ–¹å¼å®ç°ç‰ˆæœ¬çš„å¹³æ»‘å‡çº§ã€‚   </p>\n<h2><span id=\"1-2-qian-ti\">1.2    å‰æ</span><a href=\"#1-2-qian-ti\" class=\"header-anchor\">#</a></h2><p>å®ç°è“ç»¿éƒ¨ç½²éœ€è¦åŒæ—¶é…ç½®ä¸¤å¥—<code>tomca</code>ä½œä¸ºè“ç»¿å‘å¸ƒç¯å¢ƒï¼ŒåŒæ—¶é…ç½®<code>nginx</code>ä½œä¸ºè´Ÿè½½ã€‚   </p>\n<h2><span id=\"1-3-bu-zou\">1.3    æ­¥éª¤</span><a href=\"#1-3-bu-zou\" class=\"header-anchor\">#</a></h2><h3><span id=\"1-3-1-pei-zhi-lan-lu-huan-jing\">1.3.1    é…ç½®è“ç»¿ç¯å¢ƒ</span><a href=\"#1-3-1-pei-zhi-lan-lu-huan-jing\" class=\"header-anchor\">#</a></h3><p>è§£å‹é™„ä»¶åŒ…ä¸­çš„è“ç»¿ç¯å¢ƒ<code>tomcat</code>   </p>\n<h3><span id=\"1-3-2-an-zhuang-nginx\">1.3.2    å®‰è£…nginx</span><a href=\"#1-3-2-an-zhuang-nginx\" class=\"header-anchor\">#</a></h3><p>è§£å‹é™„ä»¶ä¸­çš„<code>nginx-1.15.2.tar.gz</code>å¹¶æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤   </p>\n<h3><span id=\"1-3-3-pei-zhi-nginx\">1.3.3    é…ç½®nginx</span><a href=\"#1-3-3-pei-zhi-nginx\" class=\"header-anchor\">#</a></h3><p>  ä½¿ç”¨whereisæŸ¥çœ‹nginxå®‰è£…çš„è·¯å¾„ï¼Œé€šå¸¸åœ¨<code>/usr/local/nginx</code>ä¸‹ï¼Œä¿®æ”¹nginxé…ç½®å¹¶ä½¿ç”¨å¦‚ä¸‹é…ç½®æ›¿æ¢åŸæœ‰é…ç½®å†…å®¹    </p>\n<h3><span id=\"1-3-4-bu-shu-fang-shi\">1.3.4    éƒ¨ç½²æ–¹å¼</span><a href=\"#1-3-4-bu-shu-fang-shi\" class=\"header-anchor\">#</a></h3><p>** é¦–æ¬¡éƒ¨ç½²æ–¹å¼ï¼š**<br>åªéœ€è¦æŒ‰ç…§ç« èŠ‚4æ­¥éª¤éƒ¨ç½²ä¸€å¥—åº”ç”¨å³å¯ï¼Œè¿™é‡Œå‡è®¾éƒ¨ç½²åˆ°<code>tomcat-blueï¼ˆ8081ï¼‰</code>ï¼Œç„¶ååœ¨<code>nginx</code>ç›®å½•ä¸‹ä½¿ç”¨ <code>./sbin/nginx</code>å¯åŠ¨nginxå³å¯ã€‚   </p>\n<p>** ç‰ˆæœ¬æ›´æ–°æ–¹å¼ï¼š**   </p>\n<ol>\n<li>   å°†æ–°ç‰ˆæœ¬å‘å¸ƒåˆ°<code>ç»¿è‰²ç¯å¢ƒ(tomcat-green)</code>ï¼Œå¯åŠ¨tomcat-greenå¹¶éªŒè¯æ˜¯å¦å¯ä»¥è®¿é—®ï¼Œä»¥åŠappæ˜¯å¦å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚</li>\n<li>   ç¡®è®¤ç»¿è‰²ç¯å¢ƒæµ‹è¯•é€šè¿‡ï¼Œä¿®æ”¹nginxé…ç½®æ”¾å¼€ç»¿è‰²ç¯å¢ƒç›¸å…³é…ç½®çš„æ³¨é‡Šï¼ŒåŒæ—¶æ³¨é‡Šè“è‰²ç¯å¢ƒç›¸å…³é…ç½®çš„æ³¨é‡Š</li>\n<li>   ä½¿ç”¨ <code>nginx -s reload</code> å‘½ä»¤é‡æ–°åŠ è½½nginxé…ç½®å®Œæˆè“è‰²ç¯å¢ƒåˆ°ç»¿è‰²ç¯å¢ƒçš„åˆ‡æ¢</li>\n<li>   å…³é—­è“è‰²ç¯å¢ƒtomcatï¼Œå‡†å¤‡ä¸‹æ¬¡éƒ¨ç½²ä½¿ç”¨ã€‚</li>\n<li>   å¦‚å‡çº§å¤±è´¥ï¼Œä¿®æ”¹nginxé…ç½®å°†è´Ÿè½½é‡æ–°æŒ‡å‘<code>è“è‰²ç¯å¢ƒ</code>å³å¯ã€‚</li>\n</ol>\n","categories":["DevOps"],"tags":["DevOps","nginx","tomcat"]},{"title":"åŸºäºæ³¨è§£çš„æ§åˆ¶å™¨ï¼šSpring Web/WebFlux å’Œ æµ‹è¯•","url":"https://pkaq.org/2018/05/21/annotated-controllers-spring-webwebflux-and-testin/","content":"<h1><span id></span><a href=\"#\" class=\"header-anchor\">#</a></h1><h3><span id=\"spring-web-he-spring-webflux-liang-ge-ming-zi-kan-shang-qu-hen-xiang-si-na-me-jin-xing-ce-shi-shi-shi-fou-ye-lei-si-ni-xia-mian-jiu-rang-wo-men-liao-jie-yi-xia-ta-men-zai-jin-xing-ce-shi-shi-de-bu-tong\">Spring Webå’ŒSpring WebFluxä¸¤ä¸ªåå­—çœ‹ä¸Šå»å¾ˆç›¸ä¼¼ï¼Œé‚£ä¹ˆè¿›è¡Œæµ‹è¯•æ—¶æ˜¯å¦ä¹Ÿç±»ä¼¼å‘¢ï¼Ÿä¸‹é¢å°±è®©æˆ‘ä»¬äº†è§£ä¸€ä¸‹å®ƒä»¬åœ¨è¿›è¡Œæµ‹è¯•æ—¶çš„ä¸åŒã€‚</span><a href=\"#spring-web-he-spring-webflux-liang-ge-ming-zi-kan-shang-qu-hen-xiang-si-na-me-jin-xing-ce-shi-shi-shi-fou-ye-lei-si-ni-xia-mian-jiu-rang-wo-men-liao-jie-yi-xia-ta-men-zai-jin-xing-ce-shi-shi-de-bu-tong\" class=\"header-anchor\">#</a></h3><p>åŸæ–‡é“¾æ¥ï¼š<a href=\"https://dzone.com/articles/annotated-controllers-spring-webwebflux-and-testin\">https://dzone.com/articles/annotated-controllers-spring-webwebflux-and-testin</a></p>\n<p>ä½œè€…ï¼šBiju Kunjummen ï¼Œ2017-12-05  å‘å¸ƒäº Java Zone   </p>\n<p>è¯‘è€…ï¼š<a href=\"http://pkaq.org/\">PKAQ</a> , 2018-05-20 å‘å¸ƒäº Spring4All    </p>\n<p><a href=\"https://docs.spring.io/spring/docs/current/spring-framework-reference/web-reactive.html#spring-webflux\">Spring WebFlux</a>Â å’ŒÂ <a href=\"https://docs.spring.io/spring/docs/current/spring-framework-reference/web.html#spring-web\">Spring WebÂ </a> é‡‡ç”¨çš„æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„æŠ€æœ¯æ ˆã€‚ä¸è¿‡ï¼Œ Spring Webflux ä¾æ—§æ”¯æŒåŸºäºæ³¨è§£çš„ç¼–ç¨‹æ¨¡å‹ã€‚  </p>\n<p>äºŒè€…å®šä¹‰<code>endpoint(åŠŸèƒ½æ€§ç«¯ç‚¹)</code>çš„æ–¹å¼æ˜¯ç±»ä¼¼çš„ï¼Œä½†æ˜¯å¯¹<code>endpoint(åŠŸèƒ½æ€§ç«¯ç‚¹)</code>è¿›è¡Œå•å…ƒæµ‹è¯•æ—¶æœ‰ç€æ˜æ˜¾çš„ä¸åŒã€‚ä½ å¿…é¡»æ˜ç¡®æ‰€é€‰ç”¨çš„æŠ€æœ¯æ ˆæ¥ç¼–å†™ä¸åŒçš„å•å…ƒæµ‹è¯•æ–¹æ³•ã€‚  </p>\n<h2><span id=\"endpoint-shi-li\">Endpointç¤ºä¾‹</span><a href=\"#endpoint-shi-li\" class=\"header-anchor\">#</a></h2><p>ä¸€ä¸ªåŸºäºæ³¨è§£çš„<code>endpoint</code>ç¤ºä¾‹:   </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.PostMapping</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RequestBody</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RequestMapping</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RestController</span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\">data class <span class=\"title\">Greeting</span><span class=\"params\">(val message: String)</span></span></span><br><span class=\"line\"><span class=\"function\"> </span></span><br><span class=\"line\"><span class=\"function\">@RestController</span></span><br><span class=\"line\"><span class=\"function\">@<span class=\"title\">RequestMapping</span><span class=\"params\">(<span class=\"string\">&quot;/web&quot;</span>)</span></span></span><br><span class=\"line\"><span class=\"function\">class GreetingController </span>&#123;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"meta\">@PostMapping(&quot;/greet&quot;)</span></span><br><span class=\"line\">    <span class=\"function\">fun <span class=\"title\">handleGreeting</span><span class=\"params\">(<span class=\"meta\">@RequestBody</span> greeting: Greeting)</span>: Greeting </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Greeting(<span class=\"string\">&quot;Thanks: $&#123;greeting.message&#125;&quot;</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2><span id=\"spring-web-de-dan-yuan-ce-shi\">Spring Webçš„å•å…ƒæµ‹è¯•</span><a href=\"#spring-web-de-dan-yuan-ce-shi\" class=\"header-anchor\">#</a></h2><p>å¦‚æœé‡‡ç”¨åŸºäº<code>Spring Web</code>çš„starteråˆ›å»ºåº”ç”¨ï¼Œé‚£ä¹ˆå¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼åœ¨<code>Gradle</code>é…ç½®æ–‡ä»¶ä¸­å¼•å…¥ä¾èµ–ã€‚   </p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">compile(<span class=\"string\">&#x27;org.springframework.boot:spring-boot-starter-web&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<p>æ¥ä¸‹æ¥é‡‡ç”¨ <a href=\"https://docs.spring.io/spring/docs/current/spring-framework-reference/testing.html#spring-mvc-test-framework\">Mock MVC </a>æ¥å¯¹ä¸Šé¢çš„<code>endpoint(åŠŸèƒ½æ€§ç«¯ç‚¹)</code>æ‰§è¡Œä¸€ä¸ªæ¨¡æ‹Ÿçš„webæµ‹è¯•ã€‚   </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> org.junit.Test</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.junit.runner.RunWith</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.test.context.junit4.SpringRunner</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.test.web.servlet.MockMvc</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.test.web.servlet.result.MockMvcResultMatchers.content</span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"meta\">@RunWith(SpringRunner::class)</span></span><br><span class=\"line\"><span class=\"meta\">@WebMvcTest(GreetingController::class)</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">GreetingControllerMockMvcTest</span> </span>&#123;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    lateinit <span class=\"keyword\">var</span> mockMvc: MockMvc</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"function\">fun <span class=\"title\">testHandleGreetings</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        mockMvc</span><br><span class=\"line\">                .perform(</span><br><span class=\"line\">                        post(<span class=\"string\">&quot;/web/greet&quot;</span>)</span><br><span class=\"line\">                                .content(<span class=\"string\">&quot;&quot;</span><span class=\"string\">&quot; </span></span><br><span class=\"line\"><span class=\"string\">                                |&#123;</span></span><br><span class=\"line\"><span class=\"string\">                                |&quot;</span>message<span class=\"string\">&quot;: &quot;</span>Hello Web<span class=\"string\">&quot;</span></span><br><span class=\"line\"><span class=\"string\">                                |&#125;</span></span><br><span class=\"line\"><span class=\"string\">                            &quot;</span><span class=\"string\">&quot;&quot;</span>.trimMargin())</span><br><span class=\"line\">                ).andExpect(content().json(<span class=\"string\">&quot;&quot;</span><span class=\"string\">&quot;</span></span><br><span class=\"line\"><span class=\"string\">                    |&#123;</span></span><br><span class=\"line\"><span class=\"string\">                    |&quot;</span>message<span class=\"string\">&quot;: &quot;</span>Thanks: Hello Web<span class=\"string\">&quot;</span></span><br><span class=\"line\"><span class=\"string\">                    |&#125;</span></span><br><span class=\"line\"><span class=\"string\">                &quot;</span><span class=\"string\">&quot;&quot;</span>.trimMargin()))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2><span id=\"spring-webflux-de-dan-yuan-ce-shi\">Spring WebFluxçš„å•å…ƒæµ‹è¯•</span><a href=\"#spring-webflux-de-dan-yuan-ce-shi\" class=\"header-anchor\">#</a></h2><p>é¦–å…ˆï¼Œåƒä¸Šé¢ä¸€æ ·ï¼Œé‡‡ç”¨å¦‚ä¸‹æ–¹å¼å¼•å…¥<code>Spring-WebFlux</code>ç›¸å…³ä¾èµ–</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">compile(<span class=\"string\">&#x27;org.springframework.boot:spring-boot-starter-webflux&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<p>ç„¶åï¼Œå¯ä»¥ä½¿ç”¨ <a href=\"https://docs.spring.io/spring/docs/current/spring-framework-reference/testing.html#webtestclient\">WebTestClient</a> ç±»å¯¹ä¸Šé¢çš„<code>endpoint</code>ç¼–å†™å•å…ƒæµ‹è¯•ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> org.junit.Test</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.junit.runner.RunWith</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.test.autoconfigure.web.reactive.WebFluxTest</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.http.HttpHeaders</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.test.context.junit4.SpringRunner</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.test.web.reactive.server.WebTestClient</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.reactive.function.BodyInserters</span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"meta\">@RunWith(SpringRunner::class)</span></span><br><span class=\"line\"><span class=\"meta\">@WebFluxTest(GreetingController::class)</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">GreetingControllerTest</span> </span>&#123;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    lateinit <span class=\"keyword\">var</span> webTestClient: WebTestClient</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"function\">fun <span class=\"title\">testHandleGreetings</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        webTestClient.post()</span><br><span class=\"line\">                .uri(<span class=\"string\">&quot;/web/greet&quot;</span>)</span><br><span class=\"line\">                .header(HttpHeaders.CONTENT_TYPE, <span class=\"string\">&quot;application/json&quot;</span>)</span><br><span class=\"line\">                .body(BodyInserters</span><br><span class=\"line\">                        .fromObject(<span class=\"string\">&quot;&quot;</span><span class=\"string\">&quot; </span></span><br><span class=\"line\"><span class=\"string\">                                |&#123;</span></span><br><span class=\"line\"><span class=\"string\">                                |   &quot;</span>message<span class=\"string\">&quot;: &quot;</span>Hello Web<span class=\"string\">&quot;</span></span><br><span class=\"line\"><span class=\"string\">                                |&#125;</span></span><br><span class=\"line\"><span class=\"string\">                            &quot;</span><span class=\"string\">&quot;&quot;</span>.trimMargin()))</span><br><span class=\"line\">                 <span class=\"comment\">//ä½¿ç”¨exchangeï¼ˆï¼‰æ–¹æ³•æ¥æ£€ç´¢å“åº”           </span></span><br><span class=\"line\">                .exchange()</span><br><span class=\"line\">                .expectStatus().isOk</span><br><span class=\"line\">                .expectBody()</span><br><span class=\"line\">                .json(<span class=\"string\">&quot;&quot;</span><span class=\"string\">&quot;</span></span><br><span class=\"line\"><span class=\"string\">                    |&#123;</span></span><br><span class=\"line\"><span class=\"string\">                    |   &quot;</span>message<span class=\"string\">&quot;: &quot;</span>Thanks: Hello Web<span class=\"string\">&quot;</span></span><br><span class=\"line\"><span class=\"string\">                    |&#125;</span></span><br><span class=\"line\"><span class=\"string\">                &quot;</span><span class=\"string\">&quot;&quot;</span>.trimMargin())</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2><span id=\"jie-lun\">ç»“è®º</span><a href=\"#jie-lun\" class=\"header-anchor\">#</a></h2><p>æ˜¾è€Œæ˜“è§ï¼Œ<code>Spring Web</code>å’Œ<code>Spring WebFlux</code>ä¸¤è€…çš„ç¼–ç æ–¹å¼ååˆ†ç›¸ä¼¼ï¼Œå¹¶ä¸”<code>Spirng WebFlux</code>ä¹Ÿå»¶ç»­äº†<code>Spring  Web</code>çš„æµ‹è¯•æ–¹å¼ã€‚ä½†æ˜¯ï¼Œä½œä¸ºä¸€åå¼€å‘è€…ï¼Œåº”è¯¥æ³¨æ„åˆ°å®ƒä»¬ä¹‹é—´æ½œåœ¨çš„ä¸åŒå¹¶æ ¹æ®å®é™…æƒ…å†µç¼–å†™æµ‹è¯•ä»£ç ã€‚å¸Œæœ›ä½ é€šè¿‡è¿™ç¯‡æ–‡ç« èƒ½äº†è§£åˆ°æ¥å¦‚ä½•ç¼–å†™ä¸åŒçš„ç”¨ä¾‹ä»£ç ã€‚</p>\n","categories":["Spring"],"tags":["Spring Boot","Spring cloud","Spring"]},{"title":"ä½¿ç”¨Electronå¿«é€Ÿå°†B/Såº”ç”¨æ„å»ºä¸ºæ¡Œé¢åº”ç”¨","url":"https://pkaq.org/2018/02/09/electronbs/","content":"<p>å€ŸåŠ©<code>Electron</code>å¯ä»¥ç”¨æ¥éå¸¸è½»æ˜“çš„æ„å»ºè·¨å¹³å°æ¡Œé¢åº”ç”¨ï¼Œå› ä¸ºä½ åªéœ€è¦ç†Ÿæ‚‰<code>html</code>ã€<code>css</code>ã€<code>javascript</code>è¿™äº›åŸºæœ¬æŠ€èƒ½å°±å¯ä»¥å¿«é€Ÿæ„å»ºä¸€ä¸ªç®€å•åº”ç”¨ã€‚<br>è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å€ŸåŠ©<code>Electron</code>æ¥æ‰“åŒ…æˆ‘ä»¬çš„<code>B/S</code>åº”ç”¨ä¼ªè£…æˆä¸€ä¸ªæœ¬åœ°åº”ç”¨,è¿™ä¸ä»…å¯ä»¥æé«˜ä¼ ç»Ÿç”¨æˆ·çš„äº²å’Œåº¦è¿˜å¯ä»¥å…å»<code>ä¸è¦ç”¨ieè£…è°·æ­Œ; æ€ä¹ˆè£…è°·æ­Œ,360å¯ä»¥å—?</code>çš„çƒ¦æ¼\\æ‰©å¤§å¯è§†åŒºåŸŸ(å…å»åœ°å€æ  èœå•æ ç­‰)\\å¿«é€Ÿæ‰“å¼€åº”ç”¨(æ— éœ€æ‰“å¼€æµè§ˆå™¨ç¿»æ”¶è—å¤¹)ç­‰ä¸€ç³»åˆ—å¥½å¤„ã€‚<br>  é‚£ä¹ˆä¸‹é¢çš„å†…å®¹å°±æ˜¯å‘Šè¯‰ä½ å¦‚ä½•å¿«é€Ÿæ‰“åŒ…ä¸€ä¸ªä¼ªæ¡Œé¢åº”ç”¨</p>\n<p>å‰æ:   </p>\n<ul>\n<li>nodejs   </li>\n<li>yarn   </li>\n</ul>\n<h2><span id=\"1-an-zhuang\">1.å®‰è£…</span><a href=\"#1-an-zhuang\" class=\"header-anchor\">#</a></h2><p>å¯ä»¥æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤,æ›´å¤šè¯¦ç»†å†…å®¹å¯ä»¥æŸ¥çœ‹<a href=\"https://electronjs.org/docs/tutorial/installation\">å®˜ç½‘å®‰è£…æ–‡æ¡£</a>    </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yarn global add electron</span><br></pre></td></tr></table></figure>\n<h2><span id=\"2-chuang-jian-ru-kou-pei-zhi-main-js\">2.åˆ›å»ºå…¥å£é…ç½® main.js</span><a href=\"#2-chuang-jian-ru-kou-pei-zhi-main-js\" class=\"header-anchor\">#</a></h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> electron = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;electron&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">// æ§åˆ¶åº”ç”¨ç”Ÿå‘½å‘¨æœŸçš„æ¨¡å—</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> &#123;app&#125; = electron;</span><br><span class=\"line\"><span class=\"comment\">// åˆ›å»ºæœ¬åœ°æµè§ˆå™¨çª—å£çš„æ¨¡å—</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> &#123;BrowserWindow&#125; = electron;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æŒ‡å‘çª—å£å¯¹è±¡çš„ä¸€ä¸ªå…¨å±€å¼•ç”¨ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªå¼•ç”¨ï¼Œé‚£ä¹ˆå½“è¯¥javascriptå¯¹è±¡è¢«åƒåœ¾å›æ”¶çš„</span></span><br><span class=\"line\"><span class=\"comment\">// æ—¶å€™è¯¥çª—å£å°†ä¼šè‡ªåŠ¨å…³é—­</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> win;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">createWindow</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// åˆ›å»ºä¸€ä¸ªæ–°çš„æµè§ˆå™¨çª—å£</span></span><br><span class=\"line\">    win = <span class=\"keyword\">new</span> BrowserWindow();</span><br><span class=\"line\">    <span class=\"comment\">// æ‰“å¼€åæœ€å¤§åŒ–çª—å£</span></span><br><span class=\"line\">    win.maximize();</span><br><span class=\"line\">    <span class=\"comment\">// å¹¶ä¸”è£…è½½åº”ç”¨çš„index.htmlé¡µé¢</span></span><br><span class=\"line\">    win.loadURL(<span class=\"string\">`http://localhost:8000/#/user/login`</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// å¦‚æœæ˜¯å‰åç«¯åˆ†ç¦»å¾—é¡¹ç›®å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼ä¹¦å†™</span></span><br><span class=\"line\">    win.loadURL(<span class=\"string\">`file://<span class=\"subst\">$&#123;__dirname&#125;</span>/index.html`</span>);</span><br><span class=\"line\">    <span class=\"comment\">// æ‰“å¼€å¼€å‘å·¥å…·é¡µé¢</span></span><br><span class=\"line\">    <span class=\"comment\">//win.webContents.openDevTools();</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// å½“çª—å£å…³é—­æ—¶è°ƒç”¨çš„æ–¹æ³•</span></span><br><span class=\"line\">    win.on(<span class=\"string\">&#x27;closed&#x27;</span>, <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// è§£é™¤çª—å£å¯¹è±¡çš„å¼•ç”¨ï¼Œé€šå¸¸è€Œè¨€å¦‚æœåº”ç”¨æ”¯æŒå¤šä¸ªçª—å£çš„è¯ï¼Œä½ ä¼šåœ¨ä¸€ä¸ªæ•°ç»„é‡Œ</span></span><br><span class=\"line\">        <span class=\"comment\">// å­˜æ”¾çª—å£å¯¹è±¡ï¼Œåœ¨çª—å£å…³é—­çš„æ—¶å€™åº”å½“åˆ é™¤ç›¸åº”çš„å…ƒç´ ã€‚</span></span><br><span class=\"line\">        win = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å½“Electronå®Œæˆåˆå§‹åŒ–å¹¶ä¸”å·²ç»åˆ›å»ºäº†æµè§ˆå™¨çª—å£ï¼Œåˆ™è¯¥æ–¹æ³•å°†ä¼šè¢«è°ƒç”¨ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">// æœ‰äº›APIåªèƒ½åœ¨è¯¥äº‹ä»¶å‘ç”Ÿåæ‰èƒ½è¢«ä½¿ç”¨ã€‚</span></span><br><span class=\"line\">app.on(<span class=\"string\">&#x27;ready&#x27;</span>, createWindow);</span><br><span class=\"line\"><span class=\"comment\">/* var mainWindow = new BrowserWindow(&#123;</span></span><br><span class=\"line\"><span class=\"comment\">  webPreferences: &#123;</span></span><br><span class=\"line\"><span class=\"comment\">    nodeIntegration: false</span></span><br><span class=\"line\"><span class=\"comment\">  &#125;</span></span><br><span class=\"line\"><span class=\"comment\">&#125;); */</span></span><br><span class=\"line\"><span class=\"comment\">// å½“æ‰€æœ‰çš„çª—å£è¢«å…³é—­åé€€å‡ºåº”ç”¨</span></span><br><span class=\"line\">app.on(<span class=\"string\">&#x27;window-all-closed&#x27;</span>, <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// å¯¹äºOS Xç³»ç»Ÿï¼Œåº”ç”¨å’Œç›¸åº”çš„èœå•æ ä¼šä¸€ç›´æ¿€æ´»ç›´åˆ°ç”¨æˆ·é€šè¿‡Cmd + Qæ˜¾å¼é€€å‡º</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (process.platform !== <span class=\"string\">&#x27;darwin&#x27;</span>) &#123;</span><br><span class=\"line\">        app.quit();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">app.on(<span class=\"string\">&#x27;activate&#x27;</span>, <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// å¯¹äºOS Xç³»ç»Ÿï¼Œå½“dockå›¾æ ‡è¢«ç‚¹å‡»åä¼šé‡æ–°åˆ›å»ºä¸€ä¸ªappçª—å£ï¼Œå¹¶ä¸”ä¸ä¼šæœ‰å…¶ä»–</span></span><br><span class=\"line\">    <span class=\"comment\">// çª—å£æ‰“å¼€</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (win === <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        createWindow();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åœ¨è¿™ä¸ªæ–‡ä»¶åé¢ä½ å¯ä»¥ç›´æ¥åŒ…å«ä½ åº”ç”¨ç‰¹å®šçš„ç”±ä¸»è¿›ç¨‹è¿è¡Œçš„ä»£ç ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">// ä¹Ÿå¯ä»¥æŠŠè¿™äº›ä»£ç æ”¾åœ¨å¦ä¸€ä¸ªæ–‡ä»¶ä¸­ç„¶ååœ¨è¿™é‡Œå¯¼å…¥ã€‚</span></span><br></pre></td></tr></table></figure>\n<h2><span id=\"3-chuang-jian-da-bao-pei-zhi-package-json\">3.åˆ›å»ºæ‰“åŒ…é…ç½® package.json</span><a href=\"#3-chuang-jian-da-bao-pei-zhi-package-json\" class=\"header-anchor\">#</a></h2><p>å¯ä»¥é€šè¿‡ <code>yarn init</code>æˆ–æ–°å»ºæ–‡ä»¶å¾—æ–¹å¼åˆ›å»ºæ­¤æ–‡ä»¶   </p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">&quot;name&quot;</span>: <span class=\"string\">&quot;Evatron&quot;</span>,</span><br><span class=\"line\">  <span class=\"attr\">&quot;version&quot;</span>: <span class=\"string\">&quot;1.0.0&quot;</span>,</span><br><span class=\"line\">  <span class=\"attr\">&quot;description&quot;</span>: <span class=\"string\">&quot;Eva desktop&quot;</span>,</span><br><span class=\"line\">  <span class=\"attr\">&quot;main&quot;</span>: <span class=\"string\">&quot;main.js&quot;</span>,</span><br><span class=\"line\">  <span class=\"attr\">&quot;author&quot;</span>: <span class=\"string\">&quot;PKAQ&quot;</span>,</span><br><span class=\"line\">  <span class=\"attr\">&quot;license&quot;</span>: <span class=\"string\">&quot;MIT&quot;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2><span id=\"4-da-bao\">4.æ‰“åŒ…</span><a href=\"#4-da-bao\" class=\"header-anchor\">#</a></h2><p>å®‰è£…æ‰“åŒ…ç®¡ç†å™¨</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yarn global add electron-packager</span><br><span class=\"line\">```   </span><br><span class=\"line\">æ‰§è¡Œæ‰“åŒ…   </span><br><span class=\"line\">```bash</span><br><span class=\"line\">electron-packager . Evatron </span><br><span class=\"line\">\t--win --out=release </span><br><span class=\"line\">    --arch=x64 </span><br><span class=\"line\">    --version=1.0.0 </span><br><span class=\"line\">    --electron-version=2.0.0 </span><br><span class=\"line\">    --overwrite </span><br><span class=\"line\">    --icon=./favicon.ico</span><br></pre></td></tr></table></figure>\n<p>å‘½ä»¤è§£é‡Š   </p>\n<ul>\n<li><code>.</code> ï¼šæ‰“åŒ…å…¥å£   </li>\n<li><code>Evatron</code> ï¼š æ‰“åŒ…æ–‡ä»¶å   </li>\n<li><code>--win --out=release --arch=x64</code> ï¼š ç”Ÿæˆwin64ç±»å‹æ–‡ä»¶   </li>\n<li><code>--version=1.0.0</code> ï¼šç”Ÿæˆçš„æ–‡ä»¶ç‰ˆæœ¬   </li>\n<li><code>--electron-version=2.0.0</code> ï¼šelectronç‰ˆæœ¬,å¯ä»¥é€šè¿‡<code>electron --version</code>æŸ¥çœ‹   </li>\n<li><code>--overwrite</code> ï¼šæ˜¯å¦è¦†ç›–ä¹‹å‰çš„æ‰“åŒ…æ–‡ä»¶   </li>\n<li><code>--icon=./favicon.ico</code> ï¼šfavicon   </li>\n</ul>\n<p>æ‰“åŒ…åä¼šåœ¨å‘½ä»¤ç›®å½•ç”Ÿæˆä¸€ä¸ªreleaseæ–‡ä»¶å¤¹ ç‚¹å‡»é‡Œé¢ç”Ÿæˆçš„exeå¯ä»¥æŸ¥çœ‹æˆ‘ä»¬çš„æ¡Œé¢ç¨‹åº   </p>\n<blockquote>\n<p>p.s:å¦‚æœä½ çš„reacté¡¹ç›®indexé¡µé¢æ­»æ´»å‡ºä¸æ¥ï¼Œå¯èƒ½æ˜¯ä½ ä½¿ç”¨äº†react-routerçš„BroswerHistoryï¼Œæ¢æˆHashHistoryå°±å¯ä»¥äº†ã€‚  </p>\n</blockquote>\n<p>å‚è€ƒï¼š<a href=\"https://segmentfault.com/a/1190000014030465\">https://segmentfault.com/a/1190000014030465</a></p>\n","categories":["å‰ç«¯"],"tags":["Electron"]},{"title":"ä¸€åˆ†é’±è®©è‡ªå·±ç§‘å­¦ä¸Šç½‘","url":"https://pkaq.org/2018/02/09/gfw/","content":"<h1><span id=\"huo-qu-yun-fu-wu-qi\">è·å–äº‘æœåŠ¡å™¨</span><a href=\"#huo-qu-yun-fu-wu-qi\" class=\"header-anchor\">#</a></h1><h3><span id=\"1-zhu-ce-vultr\">1.æ³¨å†Œvultr</span><a href=\"#1-zhu-ce-vultr\" class=\"header-anchor\">#</a></h3><p> ç‚¹å‡» <a href=\"https://www.vultr.com/?ref=7353037\">|&gt;æ³¨å†Œä¼ é€é—¨&lt;|</a> æ³¨å†Œ<code>vultr</code>   </p>\n<h3><span id=\"2-xuan-ze-pei-zhi\">2.é€‰æ‹©é…ç½®</span><a href=\"#2-xuan-ze-pei-zhi\" class=\"header-anchor\">#</a></h3><a id=\"more\"></a>\n<p>  ç‚¹å‡»<code>servers</code>èœå•é¡µé¢çš„<code>åŠ å·</code>åˆ›å»ºæœåŠ¡å™¨ã€‚è¿™é‡Œå»ºè®®é€‰æ‹©æ¬§æ´²æœåŠ¡å™¨,æ ¹æ®ç»éªŒæ¬§æ´²æœåŠ¡å™¨æ˜¯ç¨³å®šæ€§å’Œé€Ÿåº¦æœ€å¥½çš„ã€‚è¿™é‡Œé€‰æ‹©æœ€ä¾¿å®œçš„é…ç½®å°±å¤Ÿç”¨äº†ï¼Œå½“ç„¶2.5çš„åŸºæœ¬å¸¸å¹´å¤„äºç¼ºè´§çŠ¶æ€ã€‚<br>  é€‰æ‹©å®Œæˆåï¼Œç‚¹å‡»éƒ¨ç½²ï¼Œç­‰å¾…åˆ›å»ºå®Œæˆã€‚<br><img src=\".%5C0.jpg\" alt=\"0.jpg\"></p>\n<h3><span id=\"fu-wu-qi-cao-zuo\">æœåŠ¡å™¨æ“ä½œ</span><a href=\"#fu-wu-qi-cao-zuo\" class=\"header-anchor\">#</a></h3><p>åœ¨æœåŠ¡å™¨æ§åˆ¶å°å¯ä»¥çœ‹åˆ°åˆšæ‰åˆ›å»ºçš„æœåŠ¡å™¨ï¼Œç‚¹å‡»å³ä¾§çš„ä¸‰ä¸ªåŸç‚¹å¯ä»¥å¯ç”¨æ“ä½œï¼›<br><img src=\".%5C1.jpg\" alt=\"1.jpg\"><br>ç‚¹å‡»æ ‡é¢˜å¯ä»¥æŸ¥çœ‹é…ç½®è¯¦æƒ…ã€‚åˆ°è¿™é‡Œä½ å°±å¯ä»¥é€šè¿‡<code>online console</code>æˆ–è€…<code>xshell</code>ç­‰å„ç§æ–¹å¼æ¥ç™»å½•æ“ä½œä½ çš„æœåŠ¡å™¨äº†:)<br><img src=\".%5C2.jpg\" alt=\"2.jpg\"></p>\n<h1><span id=\"da-jian-ti-zi\">æ­å»ºæ¢¯å­</span><a href=\"#da-jian-ti-zi\" class=\"header-anchor\">#</a></h1><p>æ­å»ºæ¢¯å­éå¸¸ç®€å•,ç™»å½•æœåŠ¡å™¨åä½¿ç”¨ä¸€é”®è„šæœ¬å³å¯<br><strong>via curl</strong>  </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sh -c <span class=\"string\">&quot;<span class=\"subst\">$(curl -fsSL https://raw.githubusercontent.com/pkaq/1kss/master/1kss.sh)</span>&quot;</span></span><br></pre></td></tr></table></figure>\n<p><strong>via wget</strong>  </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sh -c <span class=\"string\">&quot;<span class=\"subst\">$(wget https://raw.githubusercontent.com/pkaq/1kss/master/1kss.sh -O -)</span>&quot;</span></span><br></pre></td></tr></table></figure>\n<h1><span id=\"shi-yong-ti-zi\">ä½¿ç”¨æ¢¯å­</span><a href=\"#shi-yong-ti-zi\" class=\"header-anchor\">#</a></h1><p>ä½¿ç”¨æ¢¯å­çš„æ–¹å¼ä¹Ÿååˆ†ç®€å•,åªéœ€è¦å» <code>https://shadowsocks.com/client.html</code>ä¸‹è½½ä¸€ä¸ª<code>ShadowSocks</code>å®¢æˆ·ç«¯,å¡«å…¥ç›¸åº”çš„é…ç½®å³å¯ã€‚</p>\n<p>p.s:æœ¬è´´ä»…ç”¨ä»¥æŠ€æœ¯äº¤æµæ¢è®¨ - 2018.06.14æ›´æ–°ä¸€é”®è„šæœ¬</p>\n","categories":["æ‚æ–‡"],"tags":["GFW"]},{"title":"ä½¿ç”¨æ’ä»¶æ£€æŸ¥Gradleä¾èµ–æ›´æ–°","url":"https://pkaq.org/2018/02/07/gradleCDU/","content":"<p>â€‹    å¦‚ä»Šå„å¤§å°æœ‰åæ— åå‚å•†å‘å¸ƒçš„å„ç§ä¾èµ–åŒ…ç‰ˆæœ¬æ»šåŠ¨è¶Šæ¥è¶Šé¢‘ç¹ï¼Œä¹Ÿæ€»æœ‰é‚£ä¹ˆä¸€æ³¢åŒå­¦å¸Œæœ›é¡¹ç›®ä¸­çš„ä¾èµ–å°½å¯èƒ½ä¿æŒæ–°çš„ç‰ˆæœ¬ï¼Œä¸”çœ‹å¦‚ä¸‹å‡ ç§æ–¹å¼ï¼š</p>\n<h2><span id=\"shou-dong-jian-cha\">æ‰‹åŠ¨æ£€æŸ¥</span><a href=\"#shou-dong-jian-cha\" class=\"header-anchor\">#</a></h2><p>â€‹    æœ€åŸå§‹è´¹æ—¶çš„æ–¹å¼è«è¿‡äºæ‰‹åŠ¨æ£€æŸ¥äº† ï¼š}ï¼Œå–œæ¬¢è¿™ç§æ–¹å¼è‡ªè™çš„åŒå­¦å¯ä»¥ç‚¹å‡»ä¼ é€é—¨<br><a href=\"http://mvnrepository.com/\">Mavenä¸­å¤®ä»“åº“</a></p>\n<h2><span id=\"bao-chi-zui-xin\">ä¿æŒæœ€æ–°</span><a href=\"#bao-chi-zui-xin\" class=\"header-anchor\">#</a></h2><p>â€‹    ä½¿ç”¨<code>+</code>å¯ä»¥ä½¿ä¾èµ–ä¿æŒæœ€æ–°ï¼Œä¸è¿‡è¿™æ ·å¸¦æ¥çš„å‰¯ä½œç”¨å³æ˜¯æ¯æ¬¡æ„å»ºæ€»ä¼šå»æ£€æŸ¥æ¯ä¸ªä¾èµ–æ˜¯å¦å­˜åœ¨æœ€æ–°ç‰ˆæœ¬ï¼Œè¿™å¿…ç„¶ä¼šæ‹–æ…¢æ„å»ºçš„é€Ÿåº¦ã€‚</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">org.springframework.boot:spring-boot-starter-web:+</span><br></pre></td></tr></table></figure>\n<h2><span id=\"shi-yong-cha-jian\">ä½¿ç”¨æ’ä»¶</span><a href=\"#shi-yong-cha-jian\" class=\"header-anchor\">#</a></h2><p>â€‹    ä½¿ç”¨ä¸‰æ–¹æ’ä»¶è¿›è¡Œæ£€æŸ¥ï¼Œå¯ä»¥ä½¿ä¾èµ–å›ºå®šåœ¨ä¸€ä¸ªç›¸å¯¹æ–°çš„ç‰ˆæœ¬ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œpluginséœ€è¦æ”¾ç½®åœ¨è„šæœ¬çš„é¡¶éƒ¨ï¼Œæ›´å¤šå…³äº<code>plugins</code>çš„å†…å®¹å¯ä»¥æŸ¥çœ‹<a href=\"https://docs.gradle.org/4.5/userguide/plugins.html#sec:plugins_block\">å®˜æ–¹æ–‡æ¡£</a></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plugins &#123;</span><br><span class=\"line\">   id &quot;name.remal.check-dependency-updates&quot; version &quot;1.0.6&quot; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>â€‹    åº”ç”¨æ­¤æ’ä»¶å,å¯ä»¥æ‰§è¡Œ<code>gradle checkDependencyUpdates</code> æˆ– <code>gradle cDU</code> æ£€æŸ¥ä¾èµ–æœ€æ–°ç‰ˆæœ¬ : }</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> Task :web:checkDependencyUpdates</span></span><br><span class=\"line\">New dependency version: com.alibaba:druid: 1.0.29 -&gt; 1.1.7</span><br></pre></td></tr></table></figure>","categories":["Build Tools"],"tags":["Gradle"]},{"title":"åœ¨Gradleä¸­ä½¿ç”¨é˜¿é‡Œå·´å·´Javaå¼€å‘è§„çº¦è¿›è¡Œä»£ç æ£€æŸ¥","url":"https://pkaq.org/2017/10/19/gradlewithp3c/","content":"<h1><span id></span><a href=\"#\" class=\"header-anchor\">#</a></h1><h2><span id=\"gai-shu\">æ¦‚è¿°</span><a href=\"#gai-shu\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€æœ€è¿‘é˜¿é‡Œå‘å¸ƒäº†<a href=\"https://yq.aliyun.com/articles/69327?spm=5176.100239.blogcont69327.158.xUUgiz&p=2#comments\">ã€Šé˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œã€‹</a>,ä¸€æ—¶é—´æ— æ•°é˜¿é‡Œæ‹¥è¶¸å¦‚è·æ­¦ç©†é—ä¹¦,å°±åœ¨è¿‘æ—¥é˜¿é‡Œåˆé¡ºä¾¿å‘å¸ƒäº†<a href=\"https://github.com/alibaba/p3c\">&lt;é˜¿é‡Œå·´å·´javaå¼€å‘è§„çº¦æ’ä»¶&gt;</a>,å¯ä»¥è½»æ¾çš„åœ¨ç å­—é˜¶æ®µè·å¾—ç›¸åº”çš„ç¼–ç æç¤º,é‚£ä¹ˆ,åœ¨Gradleä¸­å¦‚ä½•åº”ç”¨<code>é˜¿é‡Œå¼€å‘è§„çº¦</code>è¿›è¡Œä»£ç æ£€æŸ¥å‘¢.ä¸”çœ‹ä¸‹æ–‡.</p>\n<p>ã€€ã€€é˜¿é‡Œçš„å¼€å‘è§„çº¦æ’ä»¶æ˜¯åŸºäºPMDè¿›è¡Œçš„ä»£ç æ£€æµ‹,æ‰€ä»¥åœ¨Gradleåº”ç”¨<code>é˜¿é‡Œå¼€å‘è§„çº¦</code>æ£€æŸ¥åªéœ€è¦ä½¿ç”¨<code>gradle</code>æä¾›çš„<a href=\"https://docs.gradle.org/current/dsl/org.gradle.api.plugins.quality.Pmd.html\"><code>pmd</code>æ’ä»¶</a>å³å¯è¾¾æˆç›®çš„.<br>  ç›®å‰é˜¿é‡Œå¼€å‘è§„çº¦æä¾›äº†å¦‚ä¸‹ä¸€äº›è§„åˆ™é…ç½®,è¦åº”ç”¨è¿™äº›é…ç½®åªéœ€è¦å°†ä»–ä»¬é…ç½®åˆ°<code>pmd</code>çš„æ£€æŸ¥è§„åˆ™ä¸­å³å¯.</p>\n<ul>\n<li>ali-comment.xml    </li>\n<li>ali-concurrent.xml</li>\n<li>ali-constant.xml    </li>\n<li>ali-exception.xml    </li>\n<li>ali-flowcontrol.xml    </li>\n<li>ali-naming.xml    </li>\n<li>ali-oop.xml    </li>\n<li>ali-orm.xml    </li>\n<li>ali-other.xml    </li>\n<li>ali-set.xml</li>\n</ul>\n<blockquote>\n<p><strong>PMDä»‹ç»</strong><br>ã€€ã€€PMD(Project Manager Design)æ˜¯ä¸€ç§å¼€æºåˆ†æJavaä»£ç é”™è¯¯çš„å·¥å…·ã€‚ä¸å…¶ä»–åˆ†æå·¥å…·ä¸åŒçš„æ˜¯ï¼ŒPMDé€šè¿‡é™æ€åˆ†æè·çŸ¥ä»£ç é”™è¯¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä¸è¿è¡ŒJavaç¨‹åºçš„æƒ…å†µä¸‹æŠ¥å‘Šé”™è¯¯ã€‚PMDé™„å¸¦äº†è®¸å¤šå¯ä»¥ç›´æ¥ä½¿ç”¨çš„è§„åˆ™ï¼Œåˆ©ç”¨è¿™äº›è§„åˆ™å¯ä»¥æ‰¾å‡ºJavaæºç¨‹åºçš„è®¸å¤šé—®é¢˜ã€‚æ­¤å¤–ï¼Œç”¨æˆ·è¿˜å¯ä»¥è‡ªå·±å®šä¹‰è§„åˆ™ï¼Œæ£€æŸ¥Javaä»£ç æ˜¯å¦ç¬¦åˆæŸäº›ç‰¹å®šçš„ç¼–ç è§„èŒƒã€‚<br>ã€€ã€€PMDçš„æ ¸å¿ƒæ˜¯JavaCCè§£æå™¨ç”Ÿæˆå™¨ã€‚PMDç»“åˆè¿ç”¨JavaCCå’ŒEBNFï¼ˆæ‰©å±•å·´ç§‘æ–¯-è¯ºå°”èŒƒå¼ï¼ŒExtended Backus-Naur Formalï¼‰è¯­æ³•ï¼Œå†åŠ ä¸ŠJJTreeï¼ŒæŠŠJavaæºä»£ç è§£ææˆæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼ŒAbstract Syntax Treeï¼‰ã€‚</p>\n</blockquote>\n<blockquote>\n<p>ä»¥ä¸Šå†…å®¹å¼•è‡ªç™¾åº¦ç™¾ç§‘-PMDæ¡ç›®</p>\n</blockquote>\n<h2><span id=\"shi-yong\">ä½¿ç”¨</span><a href=\"#shi-yong\" class=\"header-anchor\">#</a></h2><figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apply <span class=\"attr\">plugin:</span> <span class=\"string\">&#x27;java&#x27;</span></span><br><span class=\"line\">apply <span class=\"attr\">plugin:</span> <span class=\"string\">&#x27;pmd&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">ext &#123;</span><br><span class=\"line\">\tp3c = <span class=\"string\">&quot;1.3.0&quot;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">pmd &#123;</span><br><span class=\"line\">\tconsoleOutput = <span class=\"literal\">true</span></span><br><span class=\"line\">    reportsDir = file(<span class=\"string\">&quot;build/reports/pmd&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">\truleSets = [</span><br><span class=\"line\">\t\t<span class=\"string\">&quot;java-ali-comment&quot;</span></span><br><span class=\"line\">\t]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">repositories &#123;</span><br><span class=\"line\">   jcenter()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">dependencies &#123;</span><br><span class=\"line\">\tpmd <span class=\"string\">&quot;com.alibaba.p3c:p3c-pmd:$&#123;p3c&#125;&quot;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œæœ‰å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹</p>\n<ul>\n<li>gradleçš„pmdæ’ä»¶ä¸º<code>rule</code>éƒ½æ·»åŠ äº†é»˜è®¤çš„<code>java-</code>å‰ç¼€,ä¸€å®šä¸è¦ä¸¢æ‰</li>\n<li>dependenciesä¸­ä¾èµ–çš„èŒƒå›´æ˜¯<code>pmd</code>,è¿™æ ·ä¾èµ–æ‰ä¼šåŠ åˆ°<code>pmdClasspath</code>ä¸­ä¸º<code>pmd</code>æ‰€ç”¨</li>\n<li>å…³äºæœ¬æ’ä»¶çš„ä¸€äº›å…¶å®ƒé…ç½®å¯ä»¥æŸ¥çœ‹ <a href=\"https://docs.gradle.org/current/dsl/org.gradle.api.plugins.quality.Pmd.html\"><code>pmdæ’ä»¶dslæ‰‹å†Œ</code></a></li>\n</ul>\n<h2><span id=\"yun-xing-jian-cha\">è¿è¡Œæ£€æŸ¥</span><a href=\"#yun-xing-jian-cha\" class=\"header-anchor\">#</a></h2><p>è¯¥æ’ä»¶æä¾›äº†å¦‚ä¸‹å‡ ä¸ªä»»åŠ¡</p>\n<table>\n<thead>\n<tr>\n<th>ä»»åŠ¡åç§°</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>pmdMain</td>\n<td>æ£€æŸ¥src/main/javaä¸‹çš„ä»£ç </td>\n</tr>\n<tr>\n<td>pmdTest</td>\n<td>æ£€æŸ¥src/main/testä¸‹çš„ä»£ç </td>\n</tr>\n<tr>\n<td>pmdSourceSet</td>\n<td>æ£€æŸ¥ç»™å®šèŒƒå›´çš„ä»£ç </td>\n</tr>\n<tr>\n<td>check</td>\n<td>æ£€æŸ¥æºç å’Œå•å…ƒæµ‹è¯•ä»£ç </td>\n</tr>\n</tbody></table>\n<p>å¯ä»¥æŒ‰ç…§éœ€æ±‚è¿è¡Œå¯¹åº”ä»»åŠ¡è¿›è¡Œä»£ç æ£€æŸ¥ã€‚</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//ä½¿ç”¨çŸ­å†™æ–¹å¼è¿è¡ŒpmdMainä»»åŠ¡</span></span><br><span class=\"line\">gradle pM</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºçš„æ£€æµ‹æŠ¥å‘Šåœ¨æˆ‘ä»¬å®šä¹‰çš„ç›®å½•é‡Œå¯ä»¥æ‰¾åˆ°<code>build/reports/pmd</code></p>\n","categories":["Build Tools"],"tags":["Gradle"]},{"title":"Spring Cloud ä¹‹æœåŠ¡æ²»ç† - EurekaæœåŠ¡å‘ç°-æ¶ˆè´¹è€…(Feign)","url":"https://pkaq.org/2017/09/12/sc-routingfeign/","content":"<p>Feignæ˜¯ä¸€ç§å£°æ˜å¼ã€æ¨¡æ¿åŒ–çš„HTTPå®¢æˆ·ç«¯ã€‚åœ¨Spring Cloudä¸­ä½¿ç”¨Feign, æˆ‘ä»¬å¯ä»¥åšåˆ°ä½¿ç”¨HTTPè¯·æ±‚è¿œç¨‹æœåŠ¡æ—¶èƒ½ä¸è°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·çš„ç¼–ç ä½“éªŒï¼Œå¼€å‘è€…å®Œå…¨æ„ŸçŸ¥ä¸åˆ°è¿™æ˜¯è¿œç¨‹æ–¹æ³•ï¼Œæ›´æ„ŸçŸ¥ä¸åˆ°è¿™æ˜¯ä¸ªHTTPè¯·æ±‚ã€‚<br>Feignä½¿å¾— Java HTTP å®¢æˆ·ç«¯ç¼–å†™æ›´æ–¹ä¾¿ã€‚Feign çµæ„Ÿæ¥æºäºRetrofitã€JAXRS-2.0å’ŒWebSocketã€‚Feignæœ€åˆæ˜¯ä¸ºäº†é™ä½ç»Ÿä¸€ç»‘å®šDenominatoråˆ°HTTP APIçš„å¤æ‚åº¦ï¼Œä¸åŒºåˆ†æ˜¯å¦æ”¯æŒRestfulã€‚Feignæ—¨åœ¨é€šè¿‡æœ€å°‘çš„èµ„æºå’Œä»£ç æ¥å®ç°å’ŒHTTP APIçš„è¿æ¥ã€‚é€šè¿‡å¯å®šåˆ¶çš„è§£ç å™¨å’Œé”™è¯¯å¤„ç†ï¼Œå¯ä»¥ç¼–å†™ä»»æ„çš„HTTP APIã€‚</p>\n<p>** ä¸»è¦ç‰¹ç‚¹ **</p>\n<ul>\n<li>å®šåˆ¶åŒ–</li>\n<li>æä¾›å¤šä¸ªæ¥å£</li>\n<li>æ”¯æŒJSONæ ¼å¼çš„ç¼–ç å’Œè§£ç </li>\n<li>æ”¯æŒXMLæ ¼å¼çš„ç¼–ç å’Œè§£ç </li>\n</ul>\n<p>ç”±äºFeignæ˜¯åŸºäºRibbonçš„,æ‰€ä»¥è¿™é‡Œä½¿ç”¨äº†Feignå°±å·²ç»å…·å¤‡äº†Ribbonçš„è´Ÿè½½å‡è¡¡åŠŸèƒ½</p>\n<a id=\"more\"></a>\n<p>1.å¼•å…¥ä¾èµ–</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&quot;org.springframework.cloud:spring-cloud-starter-feign:$&#123;cloud_config&#125;&quot;</span></span><br></pre></td></tr></table></figure>\n<p>2.ç¨ä½œé…ç½®</p>\n<p>åœ¨<code>bootstrap.yaml</code>ä¸­åŠ å…¥<code>Eureka server</code>ç›¸å…³é…ç½®</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">    <span class=\"attr\">cloud:</span></span><br><span class=\"line\">        <span class=\"attr\">config:</span></span><br><span class=\"line\">            <span class=\"attr\">uri:</span> <span class=\"string\">http://localhost:8888</span></span><br><span class=\"line\">                <span class=\"attr\">profile:</span> <span class=\"string\">rabbit</span></span><br><span class=\"line\">                <span class=\"attr\">name:</span> <span class=\"string\">appliaction</span></span><br><span class=\"line\">                <span class=\"attr\">username:</span> <span class=\"string\">pkaq</span></span><br><span class=\"line\">                <span class=\"attr\">password:</span> <span class=\"string\">pkaqx</span></span><br></pre></td></tr></table></figure>\n\n<p>Feignåœ¨é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨çš„æ˜¯JDKåŸç”Ÿçš„URLConnectionå‘é€HTTPè¯·æ±‚ï¼Œæ²¡æœ‰è¿æ¥æ± ï¼Œä½†æ˜¯å¯¹æ¯ä¸ªåœ°å€ä¼šä¿æŒä¸€ä¸ªé•¿è¿æ¥ï¼Œå³åˆ©ç”¨HTTPçš„persistence connection ã€‚æˆ‘ä»¬å¯ä»¥ç”¨Apacheçš„HTTP Clientæ›¿æ¢FeignåŸå§‹çš„http client, ä»è€Œè·å–è¿æ¥æ± ã€è¶…æ—¶æ—¶é—´ç­‰ä¸æ€§èƒ½æ¯æ¯ç›¸å…³çš„æ§åˆ¶èƒ½åŠ›ã€‚Spring Cloudä»Brixtion.SR5ç‰ˆæœ¬å¼€å§‹æ”¯æŒè¿™ç§æ›¿æ¢ï¼Œé¦–å…ˆåœ¨é¡¹ç›®ä¸­å£°æ˜Apache HTTP Clientå’Œfeign-httpclientä¾èµ–ï¼š\\</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">compile <span class=\"string\">&quot;com.netflix.feign:feign-httpclient:$&#123;feign_httpclient&#125;&quot;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">feign:</span></span><br><span class=\"line\">    <span class=\"attr\">httpclient:</span></span><br><span class=\"line\">        <span class=\"attr\">enabled:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n<p>3.æ·»åŠ æ³¨è§£</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@EnableEurekaClient</span></span><br></pre></td></tr></table></figure>\n<p>4.æ¥ç‚¹ä»£ç </p>\n<p>å¯åŠ¨ç±»ä»£ç </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"meta\">@EnableEurekaClient</span></span><br><span class=\"line\"><span class=\"meta\">@EnableFeignClients</span></span><br><span class=\"line\">open class RibbonClientBooter: CommandLineRunner&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Throws(Exception::class)</span></span><br><span class=\"line\">    <span class=\"function\">override fun <span class=\"title\">run</span><span class=\"params\">(vararg args: String)</span> </span>&#123;</span><br><span class=\"line\">        println(<span class=\"string\">&quot;  --- --- --- [ Ribbon client started ] --- --- ---  &quot;</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">fun <span class=\"title\">main</span><span class=\"params\">(args: Array&lt;String&gt;)</span> </span>&#123;</span><br><span class=\"line\">    org.springframework.boot.SpringApplication.run(org.pkaq.RibbonClientBooter::class.java, *args)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Feignæ¥å£</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@org</span>.springframework.cloud.netflix.feign.FeignClient(<span class=\"string\">&quot;tiger&quot;</span>)</span><br><span class=\"line\">internal <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">FeignClient</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// æ‰€è¯·æ±‚çš„æœåŠ¡æ¥å£</span></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping(&quot;/say&quot;)</span></span><br><span class=\"line\">    <span class=\"function\">fun <span class=\"title\">say</span><span class=\"params\">()</span>: String</span></span><br><span class=\"line\"><span class=\"function\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>Controllerä»£ç </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\">open <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FeignController</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">var</span> feignClient: FeignClient? = <span class=\"keyword\">null</span></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping(&quot;/Feign&quot;)</span></span><br><span class=\"line\">    <span class=\"function\">fun <span class=\"title\">say</span><span class=\"params\">()</span>: String </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> feignClient!!.say()+<span class=\"string\">&quot;--&gt; Feign&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>5.å¯åŠ¨æœåŠ¡,å¤§åŠŸå‘Šæˆ</p>\n","categories":["å¾®æœåŠ¡","Spring"],"tags":["Spring Cloud","å¾®æœåŠ¡"]},{"title":"Spring Cloud ä¹‹æœåŠ¡æ²»ç† - EurekaæœåŠ¡å‘ç°-æ¶ˆè´¹è€…(è´Ÿè½½å‡è¡¡å™¨Ribbon)","url":"https://pkaq.org/2017/09/12/sc-routingribbon/","content":"<p>1.å¼•å…¥ä¾èµ–</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">compile <span class=\"string\">&quot;org.springframework.cloud:spring-cloud-starter-ribbon:$&#123;cloud_config&#125;&quot;</span></span><br></pre></td></tr></table></figure>\n<p>2.ç¨ä½œé…ç½®</p>\n<p>åœ¨<code>bootstrap.yaml</code>ä¸­åŠ å…¥<code>Eureka server</code>ç›¸å…³é…ç½®<br>    <figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">    <span class=\"attr\">cloud:</span></span><br><span class=\"line\">        <span class=\"attr\">config:</span></span><br><span class=\"line\">            <span class=\"attr\">uri:</span> <span class=\"string\">http://localhost:8888</span></span><br><span class=\"line\">                <span class=\"attr\">profile:</span> <span class=\"string\">rabbit</span></span><br><span class=\"line\">                <span class=\"attr\">name:</span> <span class=\"string\">appliaction</span></span><br><span class=\"line\">                <span class=\"attr\">username:</span> <span class=\"string\">pkaq</span></span><br><span class=\"line\">                <span class=\"attr\">password:</span> <span class=\"string\">pkaqx</span></span><br></pre></td></tr></table></figure><br>3.æ·»åŠ æ³¨è§£</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@EnableEurekaClient</span></span><br></pre></td></tr></table></figure>\n<p>4.æ¥ç‚¹ä»£ç </p>\n<p>å¯åŠ¨ç±»ä»£ç </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"meta\">@EnableEurekaClient</span></span><br><span class=\"line\">open class RibbonClientBooter: CommandLineRunner&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    val builder: RestTemplateBuilder? = <span class=\"keyword\">null</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"comment\">// è¿™ä¸ªæ˜¯æ–°åŠ çš„æ³¨è§£,è¡¨ç¤ºå¼€å¯robbinçš„è´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚</span></span><br><span class=\"line\">    <span class=\"meta\">@LoadBalanced</span></span><br><span class=\"line\">    <span class=\"function\">open fun <span class=\"title\">restTemplate</span><span class=\"params\">()</span>: RestTemplate </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> builder!!.build()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Throws(Exception::class)</span></span><br><span class=\"line\">    <span class=\"function\">override fun <span class=\"title\">run</span><span class=\"params\">(vararg args: String)</span> </span>&#123;</span><br><span class=\"line\">        println(<span class=\"string\">&quot;  --- --- --- [ Ribbon client started ] --- --- ---  &quot;</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">fun <span class=\"title\">main</span><span class=\"params\">(args: Array&lt;String&gt;)</span> </span>&#123;</span><br><span class=\"line\">    org.springframework.boot.SpringApplication.run(org.pkaq.RibbonClientBooter::class.java, *args)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Controllerä»£ç </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RibbonController</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> restTemplate: RestTemplate? = <span class=\"keyword\">null</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping(&quot;/Ribbon&quot;)</span></span><br><span class=\"line\">    <span class=\"function\">fun <span class=\"title\">say</span><span class=\"params\">()</span>: String </span>&#123;</span><br><span class=\"line\">        val microServiceNode = <span class=\"string\">&quot;tiger&quot;</span></span><br><span class=\"line\">        val serviceName = <span class=\"string\">&quot;say&quot;</span></span><br><span class=\"line\">        val url = <span class=\"string\">&quot;http://$&#123;microServiceNode&#125;/$&#123;serviceName&#125;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> restTemplate!!.getForObject(url, String::class.java)+<span class=\"string\">&quot; - &gt; Ribbon&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œå·²ç»ä¸ç”¨é€šè¿‡æ³¨å…¥<code>LoadBalancerClient</code>è·å–<code>serviceInstance</code>çš„æ–¹å¼æ¥æ‹¼æ¥è¯·æ±‚è·¯å¾„äº†,è¿™æ˜¯å› ä¸º,å½“ä¸€ä¸ªè¢«@LoadBalancedæ³¨è§£ä¿®é¥°çš„RestTemplateå¯¹è±¡å‘å¤–å‘èµ·HTTPè¯·æ±‚æ—¶ï¼Œä¼šè¢«LoadBalancerInterceptorç±»çš„interceptå‡½æ•°æ‰€æ‹¦æˆªã€‚ç”±äºæˆ‘ä»¬åœ¨ä½¿ç”¨RestTemplateæ—¶å€™é‡‡ç”¨äº†æœåŠ¡åä½œä¸ºhostï¼Œæ‰€ä»¥ç›´æ¥ä»HttpRequestçš„URIå¯¹è±¡ä¸­é€šè¿‡getHost()å°±å¯ä»¥æ‹¿åˆ°æœåŠ¡åï¼Œç„¶åè°ƒç”¨executeå‡½æ•°å»æ ¹æ®æœåŠ¡åæ¥é€‰æ‹©å®ä¾‹å¹¶å‘èµ·å®é™…çš„è¯·æ±‚ã€‚</p>\n<p>5.å¯åŠ¨æœåŠ¡,å¤§åŠŸå‘Šæˆ</p>\n","categories":["å¾®æœåŠ¡","Spring"],"tags":["Spring Cloud","å¾®æœåŠ¡"]},{"title":"Spring Cloud ä¹‹æœåŠ¡æ²»ç† - EurekaæœåŠ¡å‘ç°-æ¶ˆè´¹è€…(RestTemplate)","url":"https://pkaq.org/2017/08/12/sc-resttemplate/","content":"<p>æœ¬éƒ¨åˆ†éœ€è¦ä¾èµ–ä¹‹å‰çš„<a href=\"https://github.com/pkaq/springcloud7/tree/master/cloud-config-server\">é…ç½®ä¸­å¿ƒ</a>å’Œ<a href=\"https://github.com/pkaq/springcloud7/tree/master/cloud-eureka-server-simple\">æœåŠ¡æ³¨å†Œä¸­å¿ƒ</a>ã€<a href=\"https://github.com/pkaq/springcloud7/tree/master/cloud-config-client\">æœåŠ¡æä¾›è€…</a>ä¸‰ä¸ªç¤ºä¾‹ä»£ç è¿è¡Œ</p>\n<p>ä¸‰ç§æ–¹å¼</p>\n<ul>\n<li>RestTemplate</li>\n<li>Ribbon</li>\n<li>Feign</li>\n</ul>\n<p>ä¸‹é¢æè¿°çš„æ˜¯é€šè¿‡<code>RestTemplate</code>çš„æ–¹å¼è¿›è¡ŒæœåŠ¡è°ƒç”¨</p>\n<a id=\"more\"></a>\n<ul>\n<li>RestTemplate<br>ã€€ã€€RestTemplateæ˜¯Springæä¾›çš„ç”¨äºè®¿é—®RestæœåŠ¡çš„å®¢æˆ·ç«¯ï¼ŒRestTemplateæä¾›äº†å¤šç§ä¾¿æ·è®¿é—®è¿œç¨‹HttpæœåŠ¡çš„æ–¹æ³•ï¼Œèƒ½å¤Ÿå¤§å¤§æé«˜å®¢æˆ·ç«¯çš„ç¼–å†™æ•ˆç‡<br> 1.å¼•å…¥ä¾èµ–<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">compile <span class=\"string\">&quot;org.springframework.cloud:spring-cloud-starter-eureka:$&#123;cloud_config&#125;&quot;</span></span><br></pre></td></tr></table></figure>\n 2.ç¨ä½œé…ç½®<br>  åœ¨<code>bootstrap.yaml</code>ä¸­åŠ å…¥<code>Eureka server</code>ç›¸å…³é…ç½®<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">    <span class=\"attr\">cloud:</span></span><br><span class=\"line\">        <span class=\"attr\">config:</span></span><br><span class=\"line\">            <span class=\"attr\">uri:</span> <span class=\"string\">http://localhost:8888</span></span><br><span class=\"line\">                <span class=\"attr\">profile:</span> <span class=\"string\">rabbit</span></span><br><span class=\"line\">                <span class=\"attr\">name:</span> <span class=\"string\">appliaction</span></span><br><span class=\"line\">                <span class=\"attr\">username:</span> <span class=\"string\">pkaq</span></span><br><span class=\"line\">                <span class=\"attr\">password:</span> <span class=\"string\">pkaqx</span></span><br></pre></td></tr></table></figure>\n 3.æ·»åŠ æ³¨è§£<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@EnableEurekaClient</span></span><br></pre></td></tr></table></figure>\n 4.æ¥ç‚¹ä»£ç <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"meta\">@EnableEurekaClient</span></span><br><span class=\"line\">open class RabbitClientBooter: CommandLineRunner&#123;</span><br><span class=\"line\">   <span class=\"comment\">//springé»˜è®¤å·²æ³¨å…¥RestTemplateBuilderå®ä¾‹</span></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    val builder: RestTemplateBuilder? = <span class=\"keyword\">null</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// å®ä¾‹åŒ–restTemplate</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\">open fun <span class=\"title\">restTemplate</span><span class=\"params\">()</span>: RestTemplate </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> builder!!.build()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Throws(Exception::class)</span></span><br><span class=\"line\">    <span class=\"function\">override fun <span class=\"title\">run</span><span class=\"params\">(vararg args: String)</span> </span>&#123;</span><br><span class=\"line\">        println(<span class=\"string\">&quot;  --- --- --- [ Rabbit client started ] --- --- ---  &quot;</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">fun <span class=\"title\">main</span><span class=\"params\">(args: Array&lt;String&gt;)</span> </span>&#123;</span><br><span class=\"line\">    org.springframework.boot.SpringApplication.run(org.pkaq.RabbitClientBooter::class.java, *args)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\nControllerä»£ç <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RabbitController</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Autowired</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> loadBalancerClient: LoadBalancerClient? = <span class=\"keyword\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Autowired</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> restTemplate: RestTemplate? = <span class=\"keyword\">null</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;/jump&quot;)</span></span><br><span class=\"line\">    <span class=\"function\">fun <span class=\"title\">say</span><span class=\"params\">()</span>: String </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// è¿™é‡Œé…ç½®è¦è°ƒç”¨å‘çš„æœåŠ¡æä¾›è€…çš„spring.</span></span><br><span class=\"line\">        val microServiceNode = <span class=\"string\">&quot;tiger&quot;</span></span><br><span class=\"line\">        val serviceName = <span class=\"string\">&quot;say&quot;</span></span><br><span class=\"line\">        val serviceInstance  = loadBalancerClient!!.choose(microServiceNode)</span><br><span class=\"line\">        </span><br><span class=\"line\">        val url = <span class=\"string\">&quot;http://&quot;</span>+serviceInstance.host+<span class=\"string\">&quot;:&quot;</span>+serviceInstance.port+<span class=\"string\">&quot;/&quot;</span>+serviceName</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> restTemplate!!.getForObject(url, String::class.java)+<span class=\"string\">&quot; - &gt; Rabbit&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\nå¯ä»¥çœ‹åˆ° é‡‡ç”¨è¿™ç§æ–¹å¼ æ¯”è¾ƒç¹ç,å…¶ä¸­æ‹¼æ¥urlçš„éƒ¨åˆ†ä»£ç ä¼šäº§ç”Ÿå¤§é‡é‡å¤,æˆ–è®¸ä½ ç¬¬ä¸€ååº”ä¼šæ˜¯å°è£…ä¸€ä¸‹,ä½†å¥½åœ¨å·²ç»æœ‰äº†è¶³å¤Ÿå¤šçš„ç°æˆè½®å­å¯ä»¥ä½¿ç”¨<br> 5.å¯åŠ¨æœåŠ¡,å¤§åŠŸå‘Šæˆ</li>\n</ul>\n","categories":["å¾®æœåŠ¡","Spring"],"tags":["Spring Cloud","å¾®æœåŠ¡"]},{"title":"ä½¿ç”¨Gradleæ„å»ºåŸºäºKotlinçš„Spring Booté¡¹ç›®","url":"https://pkaq.org/2017/08/11/build-gradle-with-kotlin/","content":"<p>Hello Kotlin~</p>\n<p><code>Kotlin</code>æ­£å¼å‘å¸ƒä¹‹åå¸å¼•äº†ä¸å°‘ç›®å…‰,å°±è¿<code>Gradle</code>åœ¨3.5ç‰ˆæœ¬çš„æ—¶å€™éƒ½æ¨å‡ºäº†åŸºäº<code>Gradle</code>çš„dsl.<br>ä¸Šæœ‰äº²çˆ¹<code>jetbrains</code>,ä¸‹æœ‰å¹²çˆ¹<code>google</code>,çœŸæ˜¯æƒ³æ²¡äººå…³æ³¨éƒ½éš¾.</p>\n<p>ä¸‹é¢å±•ç¤ºäº†å¦‚ä½•ç”¨<code>Gradle</code>æ¥æ„å»ºä¸€ä¸ªåŸºäº<code>Kotlin</code>çš„<code>Srping Boot</code>é¡¹ç›®.</p>\n<blockquote>\n<p>p.s å¥½å§,æˆ‘æ‰¿è®¤åŠ spring bootçº¯ç²¹æ˜¯ä¸ºäº†åšçœ¼çƒè¹­çƒ­åº¦çš„</p>\n</blockquote>\n<a id=\"more\"></a>\n<p>1.é¡¹ç›®ç»“æ„<br>src<br>    |-main<br>        |-kotlin</p>\n<p>è¿™é‡Œæ”¾åœ¨<code>src/main/java</code>ä¸‹ä¹Ÿæ˜¯å¯ä»¥çš„</p>\n<p>2.æ„å»ºè„šæœ¬</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// åº”ç”¨kotlinæ’ä»¶</span></span><br><span class=\"line\">plugins &#123;</span><br><span class=\"line\">    id <span class=\"string\">&quot;org.jetbrains.kotlin.jvm&quot;</span> version <span class=\"string\">&quot;1.1.3-2&quot;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// å®šä¹‰ç‰ˆæœ¬å·</span></span><br><span class=\"line\">ext&#123;</span><br><span class=\"line\">    kotlin_version = <span class=\"string\">&#x27;1.1.2-4&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// å®šä¹‰ä»“åº“</span></span><br><span class=\"line\">repositories &#123;</span><br><span class=\"line\">    mavenLocal()</span><br><span class=\"line\">    maven &#123; url<span class=\"string\">&quot;https://repo.spring.io/libs-release&quot;</span> &#125;</span><br><span class=\"line\">    jcenter()</span><br><span class=\"line\">    mavenCentral()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">dependencies &#123;</span><br><span class=\"line\">    <span class=\"comment\">// kotlinæ ‡å‡†åº“æ”¯æŒ</span></span><br><span class=\"line\">    compile <span class=\"string\">&quot;org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version&quot;</span></span><br><span class=\"line\">    <span class=\"comment\">// ç¼–è¯‘æˆjava8è§„èŒƒå­—èŠ‚ç </span></span><br><span class=\"line\">    compile <span class=\"string\">&quot;org.jetbrains.kotlin:kotlin-stdlib-jre8:$kotlin_version&quot;</span></span><br><span class=\"line\">    <span class=\"comment\">// ...å…¶å®ƒä¾èµ–</span></span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>3.çŒ®ä¸Šä»£ç <br><a href=\"https://github.com/GradleCN/GradleSide/tree/master/14-kotlin/00-spring_boot\">https://github.com/GradleCN/GradleSide/tree/master/14-kotlin/00-spring_boot</a></p>\n","categories":["Build Tools","Spring"],"tags":["Gradle","Kotlin","Spring boot"]},{"title":"ä½¿ç”¨GradleæŒ‰ä¸åŒç¯å¢ƒæ‰“åŒ…é¡¹ç›®","url":"https://pkaq.org/2017/08/09/envpackage/","content":"<h2><span id=\"0-gai-shu\">0.æ¦‚è¿°</span><a href=\"#0-gai-shu\" class=\"header-anchor\">#</a></h2><p>åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¼€å‘\\æµ‹è¯•\\ç”Ÿäº§ç¯å¢ƒéƒ½æ˜¯ç‹¬ç«‹å­˜åœ¨çš„ã€‚åœ¨ä¸Šå¤æ—¶ä»£ï¼ŒçŒ¿ä»¬é€šè¿‡æ‰“åŒ…æ—¶æˆ–è€…å¼€å‘æ—¶æ‰‹å·¥ä¿®æ”¹é…ç½®æ–‡ä»¶çš„æ–¹å¼æ¥åŒºåˆ†ç”Ÿäº§ç¯å¢ƒå’Œå¼€å‘ç¯å¢ƒã€‚æ˜¾ç„¶è¿™ç§æ–¹å¼æ˜¯æ¯”è¾ƒä½æ•ˆä¸”lowbeeçš„ï¼›åˆ°äº†<code>maven</code>æ—¶ä»£ï¼Œå¯ä»¥é€šè¿‡å®šä¹‰ä¸åŒçš„<code>profile</code>æ¥å®ç°å¯¹ä¸åŒç¯å¢ƒçš„æ‰“åŒ…ï¼Œè¿™ä¸€ä¸‹æŠŠç¨‹åºçŒ¿ä»å…³é—­/æ‰“å¼€ä¸åŒç¯å¢ƒæ³¨é‡Šçš„æ¡æ¢ä¸­è§£æ•‘äº†å‡ºæ¥ã€‚<code>Gradle</code>è™½ç„¶æ²¡æœ‰<code>maven</code>çš„<code>profile</code>æœºåˆ¶,ä½†ä»ç„¶å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å®ç°å¯¹ä¸åŒç¯å¢ƒçš„æ‰“åŒ…ã€‚<br>1.é€šè¿‡åŠ¨æ€åŠ è½½ä¸åŒç¯å¢ƒèµ„æºæ–‡ä»¶å®ç°ç¯å¢ƒåŒ…<br>2.é€šè¿‡<code>ConfigSlurper</code>ç‰¹æ€§å®ç°ç¯å¢ƒåŒ…</p>\n<a id=\"more\"></a>\n\n<h2><span id=\"1-tong-guo-dong-tai-jia-zai-bu-tong-huan-jing-zi-yuan-wen-jian-shi-xian-huan-jing-bao\">1.é€šè¿‡åŠ¨æ€åŠ è½½ä¸åŒç¯å¢ƒèµ„æºæ–‡ä»¶å®ç°ç¯å¢ƒåŒ…</span><a href=\"#1-tong-guo-dong-tai-jia-zai-bu-tong-huan-jing-zi-yuan-wen-jian-shi-xian-huan-jing-bao\" class=\"header-anchor\">#</a></h2><p>æ ¹æ®ä¸åŒç¯å¢ƒçš„å‚æ•°å»ºç«‹ä¸åŒçš„ç¯å¢ƒæ–‡ä»¶ï¼Œæ‰“åŒ…æ—¶åªæ‰“åŒ…ç›¸åº”çš„ç¯å¢ƒæ–‡ä»¶<br>æŠŠç¯å¢ƒå‚æ•°é…ç½®åˆ°x.propertiesæ–‡ä»¶ä¸­ï¼Œæ‰“åŒ…æ—¶ä»æ–‡ä»¶ä¸­è¯»å–ç›¸åº”å‚æ•°åŠ¨æ€ä¿®æ”¹é…ç½®æ–‡ä»¶<br>ä¸‹é¢çš„å§¿åŠ¿æ˜¯é€‰å–çš„ç¬¬ä¸€ç§ï¼Œåœ¨src/main/resourcesæŒ‰ä¸åŒç¯å¢ƒå»ºç«‹ç›¸åº”çš„folder,æ‰“åŒ…æ—¶å°†ä¸éœ€è¦ç¯å¢ƒæ–‡ä»¶æ’é™¤æ‰ã€‚å½“ç„¶æˆ‘è¿™é‡Œåªæ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œå®é™…æƒ…å†µå¯ä»¥è‡ªè¡Œä¿®æ”¹ä»£ç å®ç°ï¼Œæ¯”å¦‚å¦‚æœä¸æƒ³ä¿ç•™ç¯å¢ƒç›®å½•ç›´æ¥æŠŠç¯å¢ƒæ–‡ä»¶æ‰“åŒ…åˆ°src/main/resourcesï¼Œåˆ™ç›´æ¥æŠŠç¯å¢ƒç›®å½•è¿½åŠ åˆ°srcDirä¸‹å³å¯</p>\n<p>æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æ‰“ç›¸å…³ç¯å¢ƒçš„åŒ…</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gradle -q -Penv=pro</span><br></pre></td></tr></table></figure>\n<p>å¯ä»¥ä¿®æ”¹gradle.propertiesä¸­çš„envé»˜è®¤å€¼</p>\n<p>gradle.properties</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">env</span>=<span class=\"string\">dev   </span></span><br></pre></td></tr></table></figure>\n<p>è¿™ç§æ–¹å¼æ˜¯ç›´æ¥å°†ç¯å¢ƒåŒ…ç›®å½•ä¸‹çš„æ–‡ä»¶æ‰“åŒ…åˆ°resourcesæ ¹ç›®å½•ä¸‹çš„æ–¹å¼<br>build.gradle   </p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apply <span class=\"attr\">plugin:</span> <span class=\"string\">&#x27;java&#x27;</span>   </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">sourceSets &#123;    </span><br><span class=\"line\">    main &#123;</span><br><span class=\"line\">        resources &#123;</span><br><span class=\"line\">            srcDir <span class=\"string\">&quot;src/main/resources/$&#123;env&#125;&quot;</span></span><br><span class=\"line\">            </span><br><span class=\"line\">            sourceSets.main.resources.srcDirs.each   &#123;      </span><br><span class=\"line\">                it.listFiles().each &#123;</span><br><span class=\"line\">                     <span class=\"keyword\">if</span>(it.isDirectory()) &#123;        </span><br><span class=\"line\">                        exclude <span class=\"string\">&quot;$&#123;it.name&#125;&quot;</span></span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;                   </span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;   </span><br></pre></td></tr></table></figure>\n<p>â€”â€”â€”â€”â€”â€” â€”â€”â€”â€”â€”â€” wei suo fen ge xian â€”â€”â€”â€”â€”â€” â€”â€”â€”â€”â€”â€”</p>\n<p>ä¸‹é¢è¿™ç§æ˜¯ä¿ç•™ç¯å¢ƒåŒ…ç›®å½•çš„æ–¹å¼<br>build.gradle</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apply <span class=\"attr\">plugin:</span> <span class=\"string\">&#x27;java&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">sourceSets &#123;    </span><br><span class=\"line\">    main &#123;</span><br><span class=\"line\">        resources &#123;</span><br><span class=\"line\">            sourceSets.main.resources.srcDirs.each   &#123;      </span><br><span class=\"line\">                it.listFiles().each &#123;</span><br><span class=\"line\">                     <span class=\"keyword\">if</span>(it.isDirectory() &amp;&amp; it.name != <span class=\"string\">&quot;$&#123;env&#125;&quot;</span>) &#123;</span><br><span class=\"line\">                        println <span class=\"string\">&quot;exclude $&#123;it.name&#125;&quot;</span>       </span><br><span class=\"line\">                        exclude <span class=\"string\">&quot;$&#123;it.name&#125;&quot;</span></span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;                   </span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2><span id=\"2-li-yong-configslurper-jin-xing-bu-tong-huan-jing-gou-jian\">2.åˆ©ç”¨ConfigSlurperè¿›è¡Œä¸åŒç¯å¢ƒæ„å»º</span><a href=\"#2-li-yong-configslurper-jin-xing-bu-tong-huan-jing-gou-jian\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€é™¤äº†é€šè¿‡ä¼ å…¥å‚æ•°åŠ è½½ä¸åŒç›®å½•ä¸‹çš„propertiesæ–‡ä»¶æ¥å®ç°å¤šç¯å¢ƒæ‰“åŒ…ä¹‹å¤–,è¿˜æœ‰ä¸€ç§æ›´ä¾¿æ·çš„æ–¹å¼æ¥å®ç°è¿™ç§æ“ä½œ.<br>å€ŸåŠ©Groovyçš„<a href=\"http://docs.groovy-lang.org/latest/html/gapi/groovy/util/ConfigSlurper.html#method_detail\">ConfigSlurper</a>ç‰¹æ€§å¯ä»¥ç®€æ´è€Œæ˜å¿«çš„è¾¾åˆ°å¤šç¯å¢ƒæ‰“åŒ…çš„ç›®çš„.æ‰“åŒ…æ—¶å€™ä»…éœ€é€šè¿‡<code>-D</code>å‚æ•°ä¼ å…¥ç›®æ ‡ç¯å¢ƒå˜é‡å³å¯å¦‚:<code>gradle build -Denv=dev</code>,è¿™é‡Œå¯ä»¥é€šè¿‡æ·»åŠ <code>gradle.properties</code>æ–‡ä»¶è®¾ç½®é»˜è®¤çš„ç¯å¢ƒå˜é‡å€¼.</p>\n<p>æ¯”å¦‚å½“å‰æœ‰å¦‚ä¸‹éœ€æ±‚:   </p>\n<ul>\n<li>éœ€è¦æ ¹æ®ä¼ å…¥çš„å˜é‡å‚æ•°è¿›è¡Œä¸åŒç¯å¢ƒæ‰“åŒ…</li>\n<li>éœ€è¦æ ¹æ®ä¸åŒç¯å¢ƒå‚æ•°æ”¹å˜esourcesç›®å½•ä¸‹å±æ€§æ–‡ä»¶\\xmlæ–‡ä»¶ç­‰æ–‡ä»¶çš„å†…å®¹</li>\n</ul>\n<p>1.ä¸<code>build.gradle</code>å¹³çº§å»ºç«‹<code>config.groovy</code>,è¿™é‡Œçš„å‘½åå¯ä»¥éšæ„.</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">environments &#123;</span><br><span class=\"line\">    <span class=\"comment\">// å¼€å‘ç¯å¢ƒ</span></span><br><span class=\"line\">    dev &#123;</span><br><span class=\"line\">        db &#123;</span><br><span class=\"line\">            username = <span class=\"string\">&quot;dev&quot;</span></span><br><span class=\"line\">            password = <span class=\"string\">&#x27;devpwd&#x27;</span></span><br><span class=\"line\">        &#125;        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// çº¿ä¸Šç¯å¢ƒ</span></span><br><span class=\"line\">    production &#123; </span><br><span class=\"line\">        db &#123;</span><br><span class=\"line\">            username = <span class=\"string\">&quot;prod&quot;</span></span><br><span class=\"line\">            password = <span class=\"string\">&#x27;prodpwd&#x27;</span></span><br><span class=\"line\">        &#125;        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>2.ä¿®æ”¹<code>build.gradle</code></p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//å¼•å…¥ReplaceToken</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.tools.ant.filters.ReplaceTokens</span><br><span class=\"line\"><span class=\"comment\">//å¤„ç†èµ„æºæ–‡ä»¶æ—¶è¿›è¡ŒåŠ è½½æ›¿æ¢</span></span><br><span class=\"line\">processResources &#123;</span><br><span class=\"line\">    println <span class=\"string\">&quot;==&gt; Load configuration for $env&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> config =  <span class=\"keyword\">new</span> ConfigSlurper(env).parse(file(<span class=\"string\">&quot;config.groovy&quot;</span>).toURI().toURL()).toProperties()</span><br><span class=\"line\">    </span><br><span class=\"line\">    from(sourceSets.main.resources.srcDirs) &#123;</span><br><span class=\"line\">       filesMatching(<span class=\"string\">&#x27;**/*.properties&#x27;</span>) &#123;</span><br><span class=\"line\">        filter(ReplaceTokens, <span class=\"attr\">tokens:</span> config, <span class=\"attr\">beginToken :</span> <span class=\"string\">&#x27;$&#123;&#x27;</span>, <span class=\"attr\">endToken :</span> <span class=\"string\">&#x27;&#125;&#x27;</span>)</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ã€€ã€€é»˜è®¤æƒ…å†µä¸‹<code>ReplaceTokens</code>ä¼šå°†<code>@attribute@</code>çš„å€¼æ›¿æ¢æˆç›®æ ‡å€¼,è¿™é‡Œæˆ‘ä»¬ä¿®æ”¹å ä½æè¿°ç¬¦ä¸º<code>$&#123;attribute&#125;</code></p>\n<p>ã€€ã€€ç»è¿‡ä¸Šé¢çš„æ“ä½œ,åœ¨æ‰§è¡Œæ‰“åŒ…å‘½ä»¤æ—¶,<code>Gradle</code>ä¼šåŠ è½½<code>config.groovy</code>æ–‡ä»¶ä¸­çš„é…ç½®å¯¹<code>src/main/resources</code>èµ„æºç›®å½•ä¸‹çš„èµ„æºæ–‡ä»¶è¿›è¡Œæ›¿æ¢,æ³¨æ„è¿™é‡Œæ›¿æ¢çš„æ˜¯æ‰€æœ‰èµ„æºæ–‡ä»¶(properties/xml/txtç­‰)ä¸­çš„å ä½ç¬¦,å¦‚æœåªæƒ³æ›¿æ¢<code>properties</code>æ–‡ä»¶å¯ä»¥æ·»åŠ è¿‡æ»¤é™åˆ¶æ¥å®ç°å¯¹éƒ¨åˆ†æ–‡ä»¶å†…å®¹çš„æ›¿æ¢   </p>\n<p>æ³•1.</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from(sourceSets.main.resources.srcDirs) &#123;</span><br><span class=\"line\">     filesMatching(<span class=\"string\">&#x27;**/*.properties&#x27;</span>) &#123;</span><br><span class=\"line\">      filter(ReplaceTokens, <span class=\"attr\">tokens:</span> config, <span class=\"attr\">beginToken :</span> <span class=\"string\">&#x27;$&#123;&#x27;</span>, <span class=\"attr\">endToken :</span> <span class=\"string\">&#x27;&#125;&#x27;</span>)</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n<p>æ³•2.</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from(sourceSets.main.resources.srcDirs) &#123;</span><br><span class=\"line\">      include <span class=\"string\">&#x27;**/*.properties&#x27;</span>       </span><br><span class=\"line\">      filter(ReplaceTokens, <span class=\"attr\">tokens:</span> config, <span class=\"attr\">beginToken :</span> <span class=\"string\">&#x27;$&#123;&#x27;</span>, <span class=\"attr\">endToken :</span> <span class=\"string\">&#x27;&#125;&#x27;</span>)</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n<p>å®Œæ•´ä»£ç åœ¨æ­¤:<br><a href=\"https://github.com/GradleCN/GradleSide/tree/master/12-env/02-configfile\">https://github.com/GradleCN/GradleSide/tree/master/12-env/02-configfile</a></p>\n","categories":["Build Tools"],"tags":["Gradle"]},{"title":"Spring Cloud ä¹‹æœåŠ¡æ²»ç† - EurekaæœåŠ¡å‘ç°-ç”Ÿäº§è€…","url":"https://pkaq.org/2017/08/07/sc-eurekaprovider/","content":"<p>å®ç°æœåŠ¡å‘ç°éå¸¸å®¹æ˜“ï¼Œåªéœ€è¦å¦‚ä¸‹å‡ æ­¥ï¼š</p>\n<a id=\"more\"></a>\n<p>1.æ·»åŠ ä¾èµ–</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">compile <span class=\"string\">&quot;org.springframework.cloud:spring-cloud-starter-eureka:$&#123;cloud_config&#125;&quot;</span></span><br></pre></td></tr></table></figure>\n<p>2.æ·»åŠ æ³¨è§£</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@EnableEurekaClient</span></span><br></pre></td></tr></table></figure>\n<p>3.ç¨ä½œé…ç½®<br>åœ¨åº”ç”¨ä¸Šä¸‹æ–‡(ä¸€èˆ¬æ˜¯application.yaml)ä¸­é…ç½®<code>Eureka Server</code>åœ°å€</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">eureka:</span></span><br><span class=\"line\">  <span class=\"attr\">client:</span></span><br><span class=\"line\">    <span class=\"attr\">service-url:</span></span><br><span class=\"line\">      <span class=\"attr\">defaultZone:</span> <span class=\"string\">http://localhost:9871/eureka</span></span><br><span class=\"line\"><span class=\"string\">```</span>     </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">æµ‹è¯•ä»£ç </span></span><br><span class=\"line\"><span class=\"string\">```kotlin</span></span><br><span class=\"line\">    <span class=\"string\">@Autowired</span></span><br><span class=\"line\">    <span class=\"attr\">var discoveryClient:</span> <span class=\"string\">DiscoveryClient?</span> <span class=\"string\">=</span> <span class=\"literal\">null</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">@RequestMapping(&quot;/say&quot;)</span></span><br><span class=\"line\">    <span class=\"string\">fun</span> <span class=\"string\">say():</span> <span class=\"string\">String</span> &#123;</span><br><span class=\"line\">        <span class=\"string\">return</span> <span class=\"string\">&quot;Services: &quot;</span> <span class=\"string\">+</span> <span class=\"string\">discoveryClient!!.services</span></span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n<p>4.å¯åŠ¨æœåŠ¡ï¼Œå¤§åŠŸå‘Šæˆ</p>\n","categories":["å¾®æœåŠ¡","Spring"],"tags":["Spring Cloud","å¾®æœåŠ¡"]},{"title":"Spring Cloud ä¹‹æœåŠ¡æ²»ç† - æ­å»ºé«˜å¯ç”¨çš„EurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒ","url":"https://pkaq.org/2017/08/06/sc-eureka/","content":"<h1><span id=\"spring-cloud-zhi-fu-wu-zhi-li-da-jian-gao-ke-yong-de-eureka-fu-wu-zhu-ce-zhong-xin\">Spring Cloud ä¹‹æœåŠ¡æ²»ç† - æ­å»ºé«˜å¯ç”¨çš„EurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒ</span><a href=\"#spring-cloud-zhi-fu-wu-zhi-li-da-jian-gao-ke-yong-de-eureka-fu-wu-zhu-ce-zhong-xin\" class=\"header-anchor\">#</a></h1><h2><span id=\"gai-shu\">æ¦‚è¿°</span><a href=\"#gai-shu\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€è‘—åçš„CAPç†è®ºæŒ‡å‡ºï¼Œä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸å¯èƒ½åŒæ—¶æ»¡è¶³C(ä¸€è‡´æ€§)ã€A(å¯ç”¨æ€§)å’ŒP(åˆ†åŒºå®¹é”™æ€§)ã€‚ç”±äºåˆ†åŒºå®¹é”™æ€§åœ¨æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¿…é¡»è¦ä¿è¯çš„ï¼Œå› æ­¤æˆ‘ä»¬åªèƒ½åœ¨Aå’ŒCä¹‹é—´è¿›è¡Œæƒè¡¡ã€‚</p>\n<p>ã€€ã€€<code>Eureka Server</code>æä¾›æœåŠ¡æ³¨å†ŒæœåŠ¡ï¼Œå„ä¸ªèŠ‚ç‚¹å¯åŠ¨åï¼Œä¼šåœ¨<code>Eureka Server</code>ä¸­è¿›è¡Œæ³¨å†Œï¼Œè¿™æ ·<code>Eureka Server</code>ä¸­çš„æœåŠ¡æ³¨å†Œè¡¨ä¸­å°†ä¼šå­˜å‚¨æ‰€æœ‰å¯ç”¨æœåŠ¡èŠ‚ç‚¹çš„ä¿¡æ¯ï¼ŒæœåŠ¡èŠ‚ç‚¹çš„ä¿¡æ¯å¯ä»¥åœ¨ç•Œé¢ä¸­ç›´è§‚çš„çœ‹åˆ°ã€‚</p>\n<p>ã€€ã€€<code>Eureka</code>çœ‹æ˜ç™½äº†è¿™ä¸€ç‚¹ï¼Œå› æ­¤åœ¨è®¾è®¡æ—¶å°±ä¼˜å…ˆä¿è¯å¯ç”¨æ€§ã€‚åœ¨æ­¤<code>Zookeeper</code>ä¿è¯çš„æ˜¯CP, è€Œ<code>Eureka</code>åˆ™æ˜¯APã€‚<code>Eureka</code>å„ä¸ªèŠ‚ç‚¹éƒ½æ˜¯å¹³ç­‰çš„ï¼Œå‡ ä¸ªèŠ‚ç‚¹æŒ‚æ‰ä¸ä¼šå½±å“æ­£å¸¸èŠ‚ç‚¹çš„å·¥ä½œï¼Œå‰©ä½™çš„èŠ‚ç‚¹ä¾ç„¶å¯ä»¥æä¾›æ³¨å†Œå’ŒæŸ¥è¯¢æœåŠ¡ã€‚</p>\n<a id=\"more\"></a>\n<p>åœ¨åº”ç”¨å¯åŠ¨åï¼Œå°†ä¼šå‘<code>Eureka Server</code>å‘é€å¿ƒè·³,é»˜è®¤å‘¨æœŸä¸º30ç§’ï¼Œå¦‚æœ<code>Eureka Server</code>åœ¨å¤šä¸ªå¿ƒè·³å‘¨æœŸå†…æ²¡æœ‰æ¥æ”¶åˆ°æŸä¸ªèŠ‚ç‚¹çš„å¿ƒè·³ï¼Œ<code>Eureka Server</code>å°†ä¼šä»æœåŠ¡æ³¨å†Œè¡¨ä¸­æŠŠè¿™ä¸ªæœåŠ¡èŠ‚ç‚¹ç§»é™¤(é»˜è®¤90ç§’)ã€‚<br>ã€€ã€€å…¶æ¬¡ï¼Œ<code>Eureka Client</code>å¯¹å·²ç»è·å–åˆ°çš„æ³¨å†Œä¿¡æ¯ä¹Ÿåšäº†30sç¼“å­˜ã€‚å³æœåŠ¡é€šè¿‡<code>eureka</code>å®¢æˆ·ç«¯ç¬¬ä¸€æ¬¡æŸ¥è¯¢åˆ°å¯ç”¨æœåŠ¡åœ°å€åä¼šå°†ç»“æœç¼“å­˜ï¼Œä¸‹æ¬¡å†è°ƒç”¨æ—¶å°±ä¸ä¼šçœŸæ­£å‘<code>Eureka</code>å‘èµ·HTTPè¯·æ±‚äº†ã€‚<br>ã€€ã€€å†æ¬¡ï¼Œ è´Ÿè½½å‡è¡¡ç»„ä»¶<code>Ribbon</code>ä¹Ÿæœ‰30sç¼“å­˜ã€‚**<code>Ribbon</code>ä¼šä»ä¸Šé¢æåˆ°çš„<code>Eureka Client</code>è·å–æœåŠ¡åˆ—è¡¨ï¼Œç„¶åå°†ç»“æœç¼“å­˜<code>30s</code>ã€‚<br>ã€€ã€€æœ€åï¼Œå¦‚æœä½ å¹¶ä¸æ˜¯åœ¨<code>Spring Cloud</code>ç¯å¢ƒä¸‹ä½¿ç”¨è¿™äº›ç»„ä»¶(<code>Eureka</code>, <code>Ribbon</code>)ï¼Œä½ çš„æœåŠ¡å¯åŠ¨åå¹¶ä¸ä¼šé©¬ä¸Šå‘<code>Eureka</code>æ³¨å†Œï¼Œè€Œæ˜¯éœ€è¦ç­‰åˆ°ç¬¬ä¸€æ¬¡å‘é€å¿ƒè·³è¯·æ±‚æ—¶æ‰ä¼šæ³¨å†Œã€‚å¿ƒè·³è¯·æ±‚çš„å‘é€é—´éš”ä¹Ÿæ˜¯30sã€‚ï¼ˆSpring Cloudå¯¹æ­¤åšäº†ä¿®æ”¹ï¼ŒæœåŠ¡å¯åŠ¨åä¼šé©¬ä¸Šæ³¨å†Œï¼‰<br>ã€€ã€€<code>Eureka Server</code>ä¹‹é—´é€šè¿‡å¤åˆ¶çš„æ–¹å¼å®Œæˆæ•°æ®çš„åŒæ­¥ï¼Œ<code>Eureka</code>è¿˜æä¾›äº†å®¢æˆ·ç«¯ç¼“å­˜æœºåˆ¶ï¼Œå³ä½¿æ‰€æœ‰çš„<code>Eureka Server</code>éƒ½æŒ‚æ‰ï¼Œå®¢æˆ·ç«¯ä¾ç„¶å¯ä»¥åˆ©ç”¨ç¼“å­˜ä¸­çš„ä¿¡æ¯æ¶ˆè´¹å…¶ä»–æœåŠ¡çš„APIã€‚<br>ã€€ã€€ä»¥ä¸Šè¿™å‡ ä¸ª30ç§’æ­£æ˜¯å®˜æ–¹wikiä¸Šå†™æœåŠ¡æ³¨å†Œæœ€é•¿éœ€è¦2åˆ†é’Ÿçš„åŸå› ã€‚<code>Eureka</code>é€šè¿‡å¿ƒè·³æ£€æŸ¥ã€å®¢æˆ·ç«¯ç¼“å­˜ç­‰æœºåˆ¶ï¼Œç¡®ä¿äº†ç³»ç»Ÿçš„é«˜å¯ç”¨æ€§ã€çµæ´»æ€§å’Œå¯ä¼¸ç¼©æ€§ã€‚<br>ã€€ã€€è€Œ<code>Eureka</code>çš„å®¢æˆ·ç«¯åœ¨å‘æŸä¸ª<code>Eureka</code>æ³¨å†Œæˆ–æ—¶å¦‚æœå‘ç°è¿æ¥å¤±è´¥ï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ‡æ¢è‡³å…¶å®ƒèŠ‚ç‚¹ï¼Œåªè¦æœ‰ä¸€å°<code>Eureka</code>è¿˜åœ¨ï¼Œå°±èƒ½ä¿è¯æ³¨å†ŒæœåŠ¡å¯ç”¨(ä¿è¯å¯ç”¨æ€§)ï¼Œåªä¸è¿‡æŸ¥åˆ°çš„ä¿¡æ¯å¯èƒ½ä¸æ˜¯æœ€æ–°çš„(ä¸ä¿è¯å¼ºä¸€è‡´æ€§)ã€‚<br>é™¤æ­¤ä¹‹å¤–ï¼Œ<code>Eureka</code>è¿˜æœ‰ä¸€ç§è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ï¼Œå¦‚æœåœ¨15åˆ†é’Ÿå†…è¶…è¿‡85%çš„èŠ‚ç‚¹éƒ½æ²¡æœ‰æ­£å¸¸çš„å¿ƒè·³ï¼Œé‚£ä¹ˆ<code>Eureka</code>å°±è®¤ä¸ºå®¢æˆ·ç«¯ä¸æ³¨å†Œä¸­å¿ƒå‡ºç°äº†ç½‘ç»œæ•…éšœï¼Œæ­¤æ—¶ä¼šå‡ºç°ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p>\n<ol>\n<li><code>Eureka</code>ä¸å†ä»æ³¨å†Œåˆ—è¡¨ä¸­ç§»é™¤å› ä¸ºé•¿æ—¶é—´æ²¡æ”¶åˆ°å¿ƒè·³è€Œåº”è¯¥è¿‡æœŸçš„æœåŠ¡</li>\n<li><code>Eureka</code>ä»ç„¶èƒ½å¤Ÿæ¥å—æ–°æœåŠ¡çš„æ³¨å†Œå’ŒæŸ¥è¯¢è¯·æ±‚ï¼Œä½†æ˜¯ä¸ä¼šè¢«åŒæ­¥åˆ°å…¶å®ƒèŠ‚ç‚¹ä¸Š(å³ä¿è¯å½“å‰èŠ‚ç‚¹ä¾ç„¶å¯ç”¨)</li>\n<li>å½“ç½‘ç»œç¨³å®šæ—¶ï¼Œå½“å‰å®ä¾‹æ–°çš„æ³¨å†Œä¿¡æ¯ä¼šè¢«åŒæ­¥åˆ°å…¶å®ƒèŠ‚ç‚¹ä¸­</li>\n</ol>\n<p>ã€€ã€€å› æ­¤ï¼Œ <code>Eureka</code>å¯ä»¥å¾ˆå¥½çš„åº”å¯¹å› ç½‘ç»œæ•…éšœå¯¼è‡´éƒ¨åˆ†èŠ‚ç‚¹å¤±å»è”ç³»çš„æƒ…å†µï¼Œè€Œä¸ä¼šåƒ<code>Zookeeper</code>é‚£æ ·ä½¿æ•´ä¸ªæ³¨å†ŒæœåŠ¡ç˜«ç—ªã€‚</p>\n<h2><span id=\"chuang-jian-fu-wu\">åˆ›å»ºæœåŠ¡</span><a href=\"#chuang-jian-fu-wu\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€åˆ›å»ºä¸€ä¸ª<code>Eureka</code>æœåŠ¡ä¸­å¿ƒååˆ†ç®€å•,åªéœ€è¦å¼•å…¥ç›¸å…³ä¾èµ–,æ·»åŠ æ³¨è§£,ç¨ä½œé…ç½®å³å¯ã€‚<br>1.å¼•å…¥ä¾èµ–</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">compile <span class=\"string\">&quot;org.springframework.cloud:spring-cloud-starter-eureka-server:$&#123;cloud_eureka&#125;&quot;</span></span><br></pre></td></tr></table></figure>\n<p>2.æ·»åŠ æ³¨è§£</p>\n<figure class=\"highlight aspectj\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@EnableEurekaServer</span></span><br></pre></td></tr></table></figure>\n<p>3.ç¨ä½œé…ç½®</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">eureka:</span></span><br><span class=\"line\">    <span class=\"attr\">instance:</span></span><br><span class=\"line\">        <span class=\"comment\">#é…ç½®ä¸»æœºå</span></span><br><span class=\"line\">        <span class=\"attr\">hostname:</span> <span class=\"string\">eureka.alpha</span></span><br><span class=\"line\">        <span class=\"attr\">appname:</span> <span class=\"string\">reka-alpha</span></span><br><span class=\"line\">    <span class=\"attr\">client:</span></span><br><span class=\"line\">        <span class=\"comment\">#  ã€åœ¨é»˜è®¤è®¾ç½®ä¸‹ï¼ŒEurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒä¹Ÿä¼šå°†è‡ªå·±ä½œä¸ºå®¢æˆ·ç«¯æ¥å°è¯•æ³¨å†Œå®ƒè‡ªå·±ï¼Œ</span></span><br><span class=\"line\">        <span class=\"comment\">#    æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç¦ç”¨å®ƒçš„å®¢æˆ·ç«¯æ³¨å†Œè¡Œä¸ºã€‚</span></span><br><span class=\"line\">        <span class=\"comment\">#    å› ä¸ºå½“æ³¨å†Œä¸­å¿ƒå°†è‡ªå·±ä½œä¸ºå®¢æˆ·ç«¯æ³¨å†Œçš„æ—¶å€™ï¼Œå‘ç°åœ¨serverä¸Šçš„ç«¯å£è¢«è‡ªå·±å æ®äº†ï¼Œç„¶åå°±æŒ‚äº†</span></span><br><span class=\"line\">        <span class=\"attr\">register-with-eureka:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">        <span class=\"attr\">fetch-registry:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">        <span class=\"attr\">service-url:</span></span><br><span class=\"line\">            <span class=\"attr\">defaultZone:</span> <span class=\"string\">http://eureka.alpha:9871/eureka</span></span><br></pre></td></tr></table></figure>\n<p>ã€€ã€€è¿™é‡Œè®¿é—®çš„æ˜¯<code>http://eureka.alpha</code>,éœ€è¦ä¿®æ”¹<code>hosts</code>æ–‡ä»¶å°†<code>eureka.alpha</code>æŒ‡å‘<code>127.0.0.1</code>,å¦‚æœä¸åšæŒ‡å‘,è¿™é‡Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>localhost</code>è®¿é—®,å½“ç„¶,ä¸ºäº†åé¢çš„é«˜å¯ç”¨é…ç½®å»ºè®®è¿™é‡ŒåšæŒ‡å‘.<br>4.å¯åŠ¨æœåŠ¡,å¤§åŠŸå‘Šæˆ</p>\n<p><a href=\"https://github.com/pkaq/springcloud7/tree/master/cloud-eureka-server-simple\">ä»£ç ä¼ é€é—¨</a></p>\n<h2><span id=\"gao-ke-yong-pei-zhi\">é«˜å¯ç”¨é…ç½®</span><a href=\"#gao-ke-yong-pei-zhi\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€ä¸»è¦æ˜¯åˆ©ç”¨å¤šä¸ªeurekaç›¸äº’æ³¨å†Œ,ä¸‹ä¾‹ç”¨é‡‡ç”¨ä¸‰å°æœåŠ¡å™¨åšé›†ç¾¤éƒ¨ç½²,å…¶ä¸­æ¯å°<code>eureka</code>æœåŠ¡å™¨å‘å¦å¤–ä¸¤å°æ³¨å†Œè‡ªå·±çš„å®ä¾‹.<br>è¿™é‡Œéœ€è¦æ³¨æ„å¦‚ä¸‹å‡ ç‚¹</p>\n<blockquote>\n<p>1.Eureka Serverçš„åŒæ­¥éµå¾ªç€ä¸€ä¸ªéå¸¸ç®€å•çš„åŸåˆ™ï¼šåªè¦æœ‰ä¸€æ¡è¾¹å°†èŠ‚ç‚¹è¿æ¥ï¼Œå°±å¯ä»¥è¿›è¡Œä¿¡æ¯ä¼ æ’­ä¸åŒæ­¥   </p>\n</blockquote>\n<blockquote>\n<p>2.å¦‚æœEureka Açš„peeræŒ‡å‘äº†B, Bçš„peeræŒ‡å‘äº†Cï¼Œé‚£ä¹ˆå½“æœåŠ¡å‘Aæ³¨å†Œæ—¶ï¼ŒBä¸­ä¼šæœ‰è¯¥æœåŠ¡çš„æ³¨å†Œä¿¡æ¯ï¼Œä½†æ˜¯Cä¸­æ²¡æœ‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ å¸Œæœ›åªè¦å‘ä¸€å°Eurekaæ³¨å†Œå…¶å®ƒæ‰€æœ‰å®ä¾‹éƒ½èƒ½å¾—åˆ°æ³¨å†Œä¿¡æ¯ï¼Œé‚£ä¹ˆå°±å¿…é¡»æŠŠå…¶å®ƒæ‰€æœ‰èŠ‚ç‚¹éƒ½é…ç½®åˆ°å½“å‰Eurekaçš„peerå±æ€§ä¸­ã€‚è¿™ä¸€é€»è¾‘æ˜¯åœ¨PeerAwareInstanceRegistryImpl#replicateToPeers()æ–¹æ³•ä¸­å®ç°çš„ï¼š</p>\n</blockquote>\n<p><a href=\"https://github.com/pkaq/springcloud7/tree/master/cloud-eureka-server\">ä»£ç ä¼ é€é—¨</a></p>\n<p>ç¤ºä¾‹ä»£ç ä¸­æ‹†åˆ†äº†ä¸‰ä¸ªé…ç½®,å¯ä»¥æ ¹æ®è¿™ä¸‰ä¸ªé…ç½®åˆ†åˆ«æ‰“æˆjaråŒ…è¿è¡Œå³å¯,å½“ç„¶,è¿™é‡Œå»ºè®®é…åˆ<code>docker-compose</code>è¿›è¡Œç¼–æ’éƒ¨ç½².</p>\n<p>1.åœ¨Eurekaä¸­ï¼Œä¸€ä¸ª<code>instance</code>é€šè¿‡ä¸€ä¸ª<code>eureka.instance.instanceId</code> æ¥å”¯ä¸€æ ‡è¯†ï¼Œå¦‚æœè¿™ä¸ªå€¼æ²¡æœ‰è®¾ç½®ï¼Œå°±é‡‡ç”¨<code>eureka.instance.metadataMap.instanceId</code>æ¥ä»£æ›¿ã€‚<code>instance</code>ä¹‹é—´é€šè¿‡<code>eureka.instance.appName</code> æ¥å½¼æ­¤è®¿é—®ï¼Œåœ¨<code>spring cloud</code>ä¸­é»˜è®¤å€¼æ˜¯<code>spring.application.name</code>,å¦‚æœæ²¡æœ‰è®¾ç½®åˆ™ä¸º<code>UNKNOWN</code>ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­<code>spring.application.name</code>ä¸å¯æˆ–ç¼º,å› ä¸ºç›¸åŒåå­—çš„åº”ç”¨ä¼šè¢«Eurekaåˆå¹¶æˆä¸€ä¸ªç¾¤é›†ã€‚<code>eureka.instance.instanceId</code>ä¹Ÿå¯ä»¥ä¸è®¾ç½®ï¼Œç›´æ¥ä½¿ç”¨ç¼ºçœå€¼(<code>client.hostname:application.name:port</code>)<br>,åŒä¸€ä¸ª<code>appName</code>ä¸‹<code>InstanceId</code>ä¸èƒ½ç›¸åŒã€‚</p>\n<p>2.å¦‚æœ <code>eureka.client.registerWithEureka</code>è®¾ç½®æˆtrueï¼ˆé»˜è®¤å€¼trueï¼‰ï¼Œåº”ç”¨å¯åŠ¨æ—¶ï¼Œä¼šåˆ©ç”¨æŒ‡å®šçš„<code>eureka.client.serviceUrl.defaultZone</code>æ³¨å†Œåˆ°å¯¹åº”çš„Eureka serverä¸­ã€‚ä¹‹åæ¯éš”30sï¼ˆé€šè¿‡<code>eureka.instance.leaseRenewalIntervalInSeconds</code>æ¥é…ç½®ï¼‰å‘<code>Eureka server</code>å‘é€ä¸€æ¬¡å¿ƒè·³ï¼Œå¦‚æœ<code>Eureka server</code>åœ¨90sï¼ˆé€šè¿‡<code>eureka.instance.leaseExpirationDurationInSeconds</code>é…ç½®ï¼‰å†…æ²¡æœ‰æ”¶åˆ°æŸä¸ª<code>instance</code>å‘æ¥çš„å¿ƒè·³å°±ä¼šæŠŠè¿™ä¸ª<code>instance</code>ä»æ³¨å†Œä¸­å¿ƒä¸­ç§»èµ°ã€‚å‘é€å¿ƒè·³çš„æ“ä½œæ˜¯ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œå¦‚æœå‘é€å¤±è´¥ï¼Œåˆ™ä»¥2çš„æŒ‡æ•°å½¢å¼å»¶é•¿é‡è¯•çš„æ—¶é—´ï¼Œç›´åˆ°è¾¾åˆ°<code>eureka.instance.leaseRenewalIntervalInSeconds * eureka.client.heartbeatExecutorExponentialBackOffBound</code>è¿™ä¸ªä¸Šé™,ä¹‹åä¸€ç›´ä»¥è¿™ä¸ªä¸Šé™å€¼ä½œä¸ºé‡è¯•é—´éš”ï¼Œç›´è‡³é‡æ–°è¿æ¥åˆ°<code>Eureka server</code>ï¼Œå¹¶ä¸”é‡æ–°å°è¯•è¿æ¥åˆ°<code>Eureka server</code>çš„æ¬¡æ•°æ˜¯ä¸å—é™åˆ¶çš„ã€‚</p>\n<p>3.åœ¨<code>Eureka server</code>ä¸­æ¯ä¸€ä¸ª<code>instance</code>éƒ½ç”±ä¸€ä¸ªåŒ…å«å¤§é‡è¿™ä¸ª<code>instance</code>ä¿¡æ¯çš„<code>com.netflix.appinfo.InstanceInfo</code>æ ‡è¯†ï¼Œ<code>client</code>å‘<code>Eureka server</code>å‘é€å¿ƒè·³å’Œæ›´æ–°æ³¨å†Œä¿¡æ¯æ˜¯ä¸ç›¸åŒçš„ï¼ŒInstanceInfoä¹Ÿä»¥å›ºå®šçš„é¢‘ç‡å‘é€åˆ°<code>Eureka server</code>ï¼Œè¿™äº›ä¿¡æ¯åœ¨<code>Eureka client</code>å¯åŠ¨åçš„40sï¼ˆé€šè¿‡<code>eureka.client.initialInstanceInfoReplicationIntervalSeconds</code>é…ç½®ï¼‰é¦–æ¬¡å‘é€ï¼Œä¹‹åæ¯éš”30s(é€šè¿‡<code>eureka.client.instanceInfoReplicationIntervalSeconds</code>é…ç½®)å‘é€ä¸€æ¬¡ã€‚</p>\n<p>4.å¦‚æœ<code>eureka.client.fetchRegistry</code>è®¾ç½®æˆtrueï¼ˆé»˜è®¤å€¼trueï¼‰ï¼Œ<code>Eureka client</code>åœ¨å¯åŠ¨æ—¶ä¼šä»<code>Eureka server</code>è·å–æ³¨å†Œä¿¡æ¯å¹¶ç¼“å­˜åˆ°æœ¬åœ°ï¼Œä¹‹ååªä¼šå¢é‡è·å–ä¿¡æ¯ï¼ˆå¯ä»¥æŠŠ<code>eureka.client.shouldDisableDelta</code>è®¾ç½®æˆfalseæ¥å¼ºåˆ¶æ¯æ¬¡éƒ½å…¨é‡è·å–ï¼‰ã€‚è·å–æ³¨å†Œä¿¡æ¯çš„æ“ä½œä¹Ÿæ˜¯ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œæ¯éš”30ç§’æ‰§è¡Œä¸€æ¬¡ï¼ˆé€šè¿‡<code>eureka.client.registryFetchIntervalSeconds</code>é…ç½®ï¼‰ï¼Œå¦‚æœæ“ä½œå¤±è´¥ï¼Œä¹Ÿæ˜¯ä»¥2çš„æŒ‡æ•°å½¢å¼å»¶é•¿é‡è¯•æ—¶é—´ï¼Œç›´åˆ°è¾¾åˆ°<code>eureka.client.registryFetchIntervalSeconds * eureka.client.cacheRefreshExecutorExponentialBackOffBound</code> è¿™ä¸ªä¸Šé™ï¼Œä¹‹åä¸€ç›´ä»¥è¿™ä¸ªä¸Šé™å€¼ä½œä¸ºé‡è¯•é—´éš”ï¼Œç›´è‡³é‡æ–°è·å–åˆ°æ³¨å†Œä¿¡æ¯ï¼Œå¹¶ä¸”é‡æ–°å°è¯•è·å–æ³¨å†Œä¿¡æ¯çš„æ¬¡æ•°æ˜¯ä¸å—é™åˆ¶çš„ã€‚<br>è¿™äº›ä»»åŠ¡éƒ½æ˜¯åœ¨<code>com.netflix.discovery.DiscoveryClientä¸­å¯åŠ¨ï¼Œspring cloud</code>ç”¨<code>org.springframework.cloud.netflix.eureka.CloudEurekaClient</code>å¯¹è¿™ä¸ªç±»è¿›è¡Œäº†æ‰©å±•ã€‚</p>\n<h2><span id=\"chang-jian-wen-ti\">[å¸¸è§é—®é¢˜]</span><a href=\"#chang-jian-wen-ti\" class=\"header-anchor\">#</a></h2><p>1.è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼    </p>\n<figure class=\"highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">EMERGENCY! EUREKA MAY BE INCORRECTLY CLAIMING INSTANCES ARE UP WHEN THEY&#x27;RE <span class=\"keyword\">NOT</span>. RENEWALS ARE LESSER THAN THRESHOLD AND HENCE THE INSTANCES ARE <span class=\"keyword\">NOT</span> BEING EXPIRED JUST TO BE SAFE.</span><br></pre></td></tr></table></figure>\n<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœ<code>Eureka Server</code>åœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æ¥æ”¶åˆ°æŸä¸ªå¾®æœåŠ¡å®ä¾‹çš„å¿ƒè·³ï¼Œ<code>Eureka Server</code>å°†ä¼šæ³¨é”€è¯¥å®ä¾‹ï¼ˆé»˜è®¤90ç§’ï¼‰ã€‚ä½†æ˜¯å½“ç½‘ç»œåˆ†åŒºæ•…éšœå‘ç”Ÿæ—¶ï¼Œå¾®æœåŠ¡ä¸<code>Eureka Server</code>ä¹‹é—´æ— æ³•æ­£å¸¸é€šä¿¡ï¼Œä»¥ä¸Šè¡Œä¸ºå¯èƒ½å˜å¾—éå¸¸å±é™©äº†â€”â€”å› ä¸ºå¾®æœåŠ¡æœ¬èº«å…¶å®æ˜¯å¥åº·çš„ï¼Œæ­¤æ—¶æœ¬ä¸åº”è¯¥æ³¨é”€è¿™ä¸ªå¾®æœåŠ¡ã€‚</p>\n<p>Eurekaé€šè¿‡â€œè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼â€æ¥è§£å†³è¿™ä¸ªé—®é¢˜â€”â€”å½“Eureka ServerèŠ‚ç‚¹åœ¨çŸ­æ—¶é—´å†…ä¸¢å¤±è¿‡å¤šå®¢æˆ·ç«¯æ—¶ï¼ˆå¯èƒ½å‘ç”Ÿäº†ç½‘ç»œåˆ†åŒºæ•…éšœï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªèŠ‚ç‚¹å°±ä¼šè¿›å…¥è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚ä¸€æ—¦è¿›å…¥è¯¥æ¨¡å¼ï¼Œ<code>Eureka Server</code>å°±ä¼šä¿æŠ¤æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„ä¿¡æ¯ï¼Œä¸å†åˆ é™¤æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„æ•°æ®ï¼ˆä¹Ÿå°±æ˜¯ä¸ä¼šæ³¨é”€ä»»ä½•å¾®æœåŠ¡ï¼‰ã€‚å½“ç½‘ç»œæ•…éšœæ¢å¤åï¼Œè¯¥<code>Eureka Server</code>èŠ‚ç‚¹ä¼šè‡ªåŠ¨é€€å‡ºè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚</p>\n<p>ç»¼ä¸Šï¼Œè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼æ˜¯ä¸€ç§åº”å¯¹ç½‘ç»œå¼‚å¸¸çš„å®‰å…¨ä¿æŠ¤æªæ–½ã€‚å®ƒçš„æ¶æ„å“²å­¦æ˜¯å®å¯åŒæ—¶ä¿ç•™æ‰€æœ‰å¾®æœåŠ¡ï¼ˆå¥åº·çš„å¾®æœåŠ¡å’Œä¸å¥åº·çš„å¾®æœåŠ¡éƒ½ä¼šä¿ç•™ï¼‰ï¼Œä¹Ÿä¸ç›²ç›®æ³¨é”€ä»»ä½•å¥åº·çš„å¾®æœåŠ¡ã€‚ä½¿ç”¨è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ï¼Œå¯ä»¥è®©<code>Eureka</code>é›†ç¾¤æ›´åŠ çš„å¥å£®ã€ç¨³å®šã€‚</p>\n<p>åœ¨Spring Cloudä¸­ï¼Œå¯ä»¥ä½¿ç”¨<code>eureka.server.enable-self-preservation = false</code> ç¦ç”¨è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚</p>\n<p>2.<code>unavailable-replicas</code><br>åœ¨é…ç½®æ–‡ä»¶ä¸­å¦‚æœä¸ä½¿ç”¨åŸŸåçš„æ–¹å¼ï¼Œè€ŒæŒ‡å®šlocalhostæˆ–è€…ip(127.0.0.1/å¤–ç½‘ip)ï¼ŒæœåŠ¡èƒ½å¤Ÿæ­£å¸¸å¯åŠ¨ï¼Œä½†åˆ†ç‰‡æœåŠ¡æ€»æ˜¾ç¤ºåœ¨<code>unavailable-replicas</code>ä¸­ï¼Œå› æ­¤åœ¨hostä¸­æŒ‡å®šäº†ç›¸åº”çš„åŸŸååšæœåŠ¡åŒºåˆ†</p>\n<p>** å‚è€ƒ **</p>\n<ul>\n<li><a href=\"http://www.cnblogs.com/ityouknow/p/6854805.html\">http://www.cnblogs.com/ityouknow/p/6854805.html</a></li>\n<li><a href=\"https://eacdy.gitbooks.io/spring-cloud-book/content/\">https://eacdy.gitbooks.io/spring-cloud-book/content/</a></li>\n<li><a href=\"http://fengyilin.iteye.com/blog/2367265\">http://fengyilin.iteye.com/blog/2367265</a></li>\n</ul>\n","categories":["å¾®æœåŠ¡","Spring"],"tags":["Spring Cloud","å¾®æœåŠ¡"]},{"title":"Spring Cloud ä¹‹åˆ›å»ºé…ç½®ä¸­å¿ƒæœåŠ¡ - è¯·æ±‚ç«¯","url":"https://pkaq.org/2017/07/18/sc-configclient/","content":"<p>Spring Cloud ä¹‹åˆ›å»ºé…ç½®ä¸­å¿ƒæœåŠ¡-å®¢æˆ·ç«¯<br>ã€€ã€€å„ä¸ªå¾®æœåŠ¡æƒ³è¦ä½¿ç”¨é…ç½®ä¸­å¿ƒæœåŠ¡éå¸¸ç®€å•,ä»…éœ€è¦åœ¨<code>bootstrap.yaml</code>(æˆ–<code>.properties</code>)æ–‡ä»¶ä¸­ç¨ä½œé…ç½®å³å¯</p>\n<a id=\"more\"></a>\n<h2><span id=\"1-tian-jia-yi-lai\">1.æ·»åŠ ä¾èµ–</span><a href=\"#1-tian-jia-yi-lai\" class=\"header-anchor\">#</a></h2><figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">`org.springframework.<span class=\"attr\">cloud:</span>spring-cloud-starter-<span class=\"attr\">config:</span>$&#123;cloud_config&#125;`</span><br></pre></td></tr></table></figure>\n<h2><span id=\"2-pei-zhi-shang-xia-wen\">2.é…ç½®ä¸Šä¸‹æ–‡</span><a href=\"#2-pei-zhi-shang-xia-wen\" class=\"header-anchor\">#</a></h2><p><code>bootstrap.yaml</code>ä¸­æ·»åŠ </p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">    <span class=\"attr\">application:</span></span><br><span class=\"line\">        <span class=\"attr\">name:</span> <span class=\"string\">config-client</span></span><br><span class=\"line\">    <span class=\"attr\">cloud:</span></span><br><span class=\"line\">        <span class=\"attr\">config:</span></span><br><span class=\"line\">            <span class=\"comment\"># é…ç½®ä¸­å¿ƒåœ°å€</span></span><br><span class=\"line\">            <span class=\"attr\">uri:</span> <span class=\"string\">http://localhost:8888</span></span><br><span class=\"line\">            <span class=\"comment\"># è¦åº”ç”¨çš„é…ç½®æ–‡ä»¶</span></span><br><span class=\"line\">            <span class=\"attr\">profile:</span> <span class=\"string\">dev</span></span><br><span class=\"line\">            <span class=\"comment\"># è¦è¯»å–çš„é…ç½®æ–‡ä»¶å</span></span><br><span class=\"line\">            <span class=\"attr\">name:</span> <span class=\"string\">bravo</span></span><br><span class=\"line\">            <span class=\"comment\"># å¯¹åº”æœåŠ¡ç«¯securityè®¾ç½®çš„ç”¨æˆ·åå¯†ç </span></span><br><span class=\"line\">            <span class=\"attr\">username:</span> <span class=\"string\">pkaq</span></span><br><span class=\"line\">            <span class=\"attr\">password:</span> <span class=\"string\">pkaqx</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>æ³¨æ„è¿™é‡Œæ˜¯<code>bootstrap.yml</code>è€Œä¸æ˜¯<code>appliction.yml</code>,å› ä¸º<code>bootstrap.yml</code>ä¼šåœ¨åº”ç”¨å¯åŠ¨ä¹‹å‰è¯»å–, è€Œ<code>spring.cloud.config.uri</code>ä¼šå½±å“åº”ç”¨å¯åŠ¨,å…³äºä¸Šä¸‹æ–‡å¯å‚è§å¦‚ä¸‹å†…å®¹.</p>\n</blockquote>\n<h3><span id=\"2-1-qi-dong-shang-xia-wen\">2.1 å¯åŠ¨ä¸Šä¸‹æ–‡</span><a href=\"#2-1-qi-dong-shang-xia-wen\" class=\"header-anchor\">#</a></h3><p>ã€€ã€€Spring Cloudä¼šåˆ›å»ºä¸€ä¸ª<code>Bootstrap Context</code>ï¼Œä½œä¸ºSpringåº”ç”¨çš„<code>Application Context</code>çš„çˆ¶ä¸Šä¸‹æ–‡ã€‚åˆå§‹åŒ–çš„æ—¶å€™ï¼Œ<code>Bootstrap Context</code>è´Ÿè´£ä»å¤–éƒ¨æºåŠ è½½é…ç½®å±æ€§å¹¶è§£æé…ç½®ã€‚è¿™ä¸¤ä¸ªä¸Šä¸‹æ–‡å…±äº«ä¸€ä¸ªä»å¤–éƒ¨è·å–çš„<code>Environment</code>ã€‚<code>Bootstrap</code>å±æ€§æœ‰é«˜ä¼˜å…ˆçº§ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä»¬ä¸ä¼šè¢«æœ¬åœ°é…ç½®è¦†ç›–ã€‚ <code>Bootstrap context</code>å’Œ<code>Application Context</code>æœ‰ç€ä¸åŒçš„çº¦å®šï¼Œæ‰€ä»¥æ–°å¢äº†ä¸€ä¸ª<code>bootstrap.yml</code>æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä½¿ç”¨<code>application.yml</code> (æˆ–è€…<code>application.properties</code>)ã€‚ä¿è¯<code>Bootstrap Context</code>å’Œ<code>Application Context</code>é…ç½®çš„åˆ†ç¦»ã€‚</p>\n<p>ã€€ã€€æ¨èåœ¨<code>bootstrap.yml</code> or <code>application.yml</code>é‡Œé¢é…ç½®<code>spring.application.name</code>. ä½ å¯ä»¥é€šè¿‡è®¾ç½®<code>spring.cloud.bootstrap.enabled=false</code>æ¥ç¦ç”¨<code>bootstrap</code>ã€‚</p>\n<h3><span id=\"2-2-ying-yong-shang-xia-wen-ceng-ci-jie-gou\">2.2 åº”ç”¨ä¸Šä¸‹æ–‡å±‚æ¬¡ç»“æ„</span><a href=\"#2-2-ying-yong-shang-xia-wen-ceng-ci-jie-gou\" class=\"header-anchor\">#</a></h3><p>ã€€ã€€å¦‚æœä½ é€šè¿‡<code>SpringApplication</code>æˆ–è€…<code>SpringApplicationBuilder</code>åˆ›å»ºä¸€ä¸ª<code>Application Context</code>,é‚£ä¹ˆä¼šä¸ºspringåº”ç”¨çš„<code>Application Context</code>åˆ›å»ºçˆ¶ä¸Šä¸‹æ–‡<code>Bootstrap Context</code>ã€‚åœ¨Springé‡Œæœ‰ä¸ªç‰¹æ€§ï¼Œå­ä¸Šä¸‹æ–‡ä¼šç»§æ‰¿çˆ¶ç±»çš„<code>property sources</code> and <code>profiles</code> ï¼Œæ‰€ä»¥<code>main application context</code> ç›¸å¯¹äºæ²¡æœ‰ä½¿ç”¨Spring Cloud Configï¼Œä¼šæ–°å¢é¢å¤–çš„<code>property sources</code>ã€‚é¢å¤–çš„<code>property sources</code>æœ‰ï¼š</p>\n<ul>\n<li>â€œbootstrapâ€ : å¦‚æœåœ¨<code>Bootstrap Context</code>æ‰«æåˆ°<code>PropertySourceLocator</code>å¹¶ä¸”æœ‰å±æ€§ï¼Œåˆ™ä¼šæ·»åŠ åˆ°<code>CompositePropertySource</code>ã€‚<code>Spirng Cloud Config</code>å°±æ˜¯é€šè¿‡è¿™ç§æ–¹å¼æ¥æ·»åŠ çš„å±æ€§çš„ï¼Œè¯¦ç»†çœ‹æºç <code>ConfigServicePropertySourceLocator</code>ã€‚ä¸‹é¢ä¹Ÿä¹Ÿæœ‰ä¸€ä¸ªä¾‹å­è‡ªå®šä¹‰çš„ä¾‹å­ã€‚</li>\n<li>â€œapplicationConfig: [classpath:bootstrap.yml]â€ ï¼Œï¼ˆå¦‚æœæœ‰<code>spring.profiles.active=production</code>åˆ™ä¾‹å¦‚ <code>applicationConfig: [classpath:/bootstrap.yml]#productionï¼‰</code>: å¦‚æœä½ ä½¿ç”¨<code>bootstrap.yml</code>æ¥é…ç½®<code>Bootstrap Context</code>ï¼Œä»–æ¯”<code>application.yml</code>ä¼˜å…ˆçº§è¦ä½ã€‚å®ƒå°†æ·»åŠ åˆ°å­ä¸Šä¸‹æ–‡ï¼Œä½œä¸ºSpring Bootåº”ç”¨ç¨‹åºçš„ä¸€éƒ¨åˆ†ã€‚ä¸‹æ–‡æœ‰ä»‹ç»ã€‚<br>ã€€ã€€ç”±äºä¼˜å…ˆçº§è§„åˆ™ï¼Œ<code>Bootstrap Context</code>ä¸åŒ…å«ä»<code>bootstrap.yml</code>æ¥çš„æ•°æ®ï¼Œä½†æ˜¯å¯ä»¥ç”¨å®ƒä½œä¸ºé»˜è®¤è®¾ç½®ã€‚</li>\n</ul>\n<blockquote>\n<p><code>bootstrap.yml</code>æ˜¯ç”±<code>spring.cloud.bootstrap.name</code>ï¼ˆé»˜è®¤:â€bootstrapâ€ï¼‰æˆ–è€…<code>spring.cloud.bootstrap.location</code>ï¼ˆé»˜è®¤ç©ºï¼‰</p>\n</blockquote>\n<p><strong>è¦†ç›–è¿œç¨‹å±æ€§</strong> </p>\n<p>ã€€ã€€<code>property sources</code>è¢«<code>bootstrap context</code> æ·»åŠ åˆ°åº”ç”¨é€šå¸¸é€šè¿‡è¿œç¨‹çš„æ–¹å¼ï¼Œæ¯”å¦‚â€Config Serverâ€ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæœ¬åœ°çš„é…ç½®æ–‡ä»¶ä¸èƒ½è¦†ç›–è¿œç¨‹é…ç½®ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å¯åŠ¨å‘½ä»¤è¡Œå‚æ•°æ¥è¦†ç›–è¿œç¨‹é…ç½®ã€‚å¦‚æœéœ€è¦æœ¬åœ°æ–‡ä»¶è¦†ç›–è¿œç¨‹æ–‡ä»¶ï¼Œéœ€è¦åœ¨è¿œç¨‹é…ç½®æ–‡ä»¶é‡Œè®¾ç½®æˆæƒ<br><code>spring.cloud.config.allowOverride=true</code>ï¼ˆè¿™ä¸ªé…ç½®ä¸èƒ½åœ¨æœ¬åœ°è¢«è®¾ç½®ï¼‰ã€‚ä¸€æ—¦è®¾ç½®äº†è¿™ä¸ªæƒé™ï¼Œä½ å¯ä»¥é…ç½®æ›´åŠ ç»†ç²’åº¦çš„é…ç½®æ¥é…ç½®è¦†ç›–çš„æ–¹å¼ï¼Œ</p>\n<p>æ¯”å¦‚ï¼š </p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">    <span class=\"attr\">cloud:</span></span><br><span class=\"line\">        <span class=\"attr\">config:</span></span><br><span class=\"line\">            <span class=\"comment\"># è¦†ç›–ä»»ä½•æœ¬åœ°å±æ€§ </span></span><br><span class=\"line\">            <span class=\"attr\">overrideNone:</span> <span class=\"literal\">true</span> </span><br><span class=\"line\">            <span class=\"comment\"># ä»…ä»…ç³»ç»Ÿå±æ€§å’Œç¯å¢ƒå˜é‡ </span></span><br><span class=\"line\">            <span class=\"attr\">overrideSystemProperties:</span> <span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n<p>æºæ–‡ä»¶è§PropertySourceBootstrapPropertie</p>\n<h2><span id=\"3-qi-dong-fu-wu-da-gong-gao-cheng\">3.å¯åŠ¨æœåŠ¡,å¤§åŠŸå‘Šæˆ.</span><a href=\"#3-qi-dong-fu-wu-da-gong-gao-cheng\" class=\"header-anchor\">#</a></h2><p>ç«¯å£å·é‡‡ç”¨é…ç½®ä¸­å¿ƒç›¸åº”é…ç½®æ–‡ä»¶çš„ç«¯å£<br>å¯åŠ¨åè®¿é—® <a href=\"http://localhost:port/say\">http://localhost:port/say</a></p>\n<p>** <a href=\"https://github.com/pkaq/springcloud7/tree/master/cloud-config-client\">ç¤ºä¾‹ä»£ç </a> ** </p>\n<p><strong>å‚è€ƒ</strong></p>\n<ul>\n<li><a href=\"http://cloud.spring.io/spring-cloud-static/Dalston.SR3/\">http://cloud.spring.io/spring-cloud-static/Dalston.SR3/</a></li>\n</ul>\n","categories":["å¾®æœåŠ¡","Spring"],"tags":["Spring Boot","Spring Cloud"]},{"title":"Spring Cloud ä¹‹åˆ›å»ºé…ç½®ä¸­å¿ƒæœåŠ¡ - å‘å¸ƒç«¯","url":"https://pkaq.org/2017/07/17/sc-configserver/","content":"<p>åœ¨å¼€å‘å¾®æœåŠ¡æ—¶,å„ä¸ªæœåŠ¡æœ‰ä¸€äº›å…±åŒçš„é…ç½®,è‹¥æ˜¯å‡ åä¸ªå¾®æœåŠ¡é‚£ä¹ˆä¾¿éœ€è¦å°†è¿™äº›é…ç½®å¤åˆ¶å‡ åä»½.åœ¨å¼€å‘è¿‡ç¨‹ä¸­,å¯¹è¿™äº›é…ç½®æ–‡ä»¶çš„ç¼–è¾‘ç»´æŠ¤æ˜¯ä¸€ä»¶ååˆ†éº»çƒ¦çš„äº‹æƒ…,è‹¥æ˜¯å¯ä»¥å¯¹è¿™äº›å…¬ç”¨é…ç½®è¿›è¡Œç»Ÿä¸€é…ç½®æ— ç–‘å°†ä¼šæå¤§å‡è½»ç»´æŠ¤çš„éš¾åº¦å’Œå·¥ä½œé‡,å€ŸåŠ©springæä¾›çš„é…ç½®ä¸­å¿ƒæœåŠ¡å¯ä»¥å¯¹è¿™äº›å…¬å…±é…ç½®è¿›è¡Œç»Ÿä¸€ç®¡ç†,å…·ä½“æ“ä½œå¦‚ä¸‹</p>\n<a id=\"more\"></a>\n\n<h2><span id=\"1-chuang-jian-pei-zhi-zhong-xin-cang-ku\">1 åˆ›å»ºé…ç½®ä¸­å¿ƒä»“åº“</span><a href=\"#1-chuang-jian-pei-zhi-zhong-xin-cang-ku\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€ç•¥</p>\n<h2><span id=\"2-chuang-jian-pei-zhi-zhong-xin-wen-jian\">2 åˆ›å»ºé…ç½®ä¸­å¿ƒæ–‡ä»¶</span><a href=\"#2-chuang-jian-pei-zhi-zhong-xin-wen-jian\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€å…¶ä¸­<code>spring.cloud.config.server.git.uri</code>æ”¯æŒå¦‚ä¸‹å‡ ç§æ–¹å¼è¿›è¡Œé…ç½®</p>\n<h3><span id=\"2-1-ban-ben-kong-zhi-xi-tong-git-svn\">2.1 ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ(git,svn)</span><a href=\"#2-1-ban-ben-kong-zhi-xi-tong-git-svn\" class=\"header-anchor\">#</a></h3><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">   <span class=\"attr\">cloud:</span></span><br><span class=\"line\">     <span class=\"attr\">config:</span>          </span><br><span class=\"line\">       <span class=\"attr\">server:</span></span><br><span class=\"line\">         <span class=\"attr\">git:</span></span><br><span class=\"line\">           <span class=\"attr\">uri:</span> <span class=\"string\">https://git.oschina.net/pkaq/spring-cloud-7simple.git</span></span><br><span class=\"line\">           <span class=\"comment\"># ä»è¯¥åº“ä¸‹çš„cloud-cconig-repoè·¯å¾„ä¸‹åŠ è½½,è¿™é‡Œå¦‚æœéœ€è¦é…ç½®å¤šä¸ªå¯ä»¥ç”¨`,`åˆ†éš”å¼€</span></span><br><span class=\"line\">  <span class=\"attr\">search-paths:</span> <span class=\"string\">cloud-config-repo</span></span><br></pre></td></tr></table></figure>\n<p>ã€€ã€€å¦‚æœé‡‡ç”¨çš„<code>svn</code>ä½œä¸ºç‰ˆæœ¬æ§åˆ¶,åªéœ€è¦å°†<code>git</code>èŠ‚ç‚¹æ›¿æ¢ä¸º<code>svn</code>å³å¯</p>\n<p>ã€€ã€€ä¼´éšç€ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä½œä¸ºåç«¯(<code>git</code> <code>svn</code>ï¼Œæ–‡ä»¶éƒ½ä¼šè¢«<code>check out</code>æˆ–<code>clone</code>åˆ°æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­. é»˜è®¤è¿™äº›æ–‡ä»¶ä¼šè¢«æ”¾ç½®åˆ°ä»¥<code>config-repo-</code>ä¸ºå‰ç¼€çš„ç³»ç»Ÿä¸´æ—¶ç›®å½•ä¸­.åœ¨ <code>linux</code> è­¬å¦‚åº”è¯¥æ˜¯ <code>/tmp/config-repo-&lt;randomid&gt;</code>å½•.è¿™ä¼šå¯¼è‡´ä¸å¯é¢„çŸ¥çš„é—®é¢˜å‡ºç°.ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜,é€šè¿‡è®¾ç½®<code>spring.cloud.config.server.git.basedir</code>å‚æ•°å€¼ä¸ºéç³»ç»Ÿä¸´æ—¶ç›®å½•.</p>\n<h4><span id=\"2-1-1-ren-zheng-pei-zhi\">2.1.1 è®¤è¯é…ç½®</span><a href=\"#2-1-1-ren-zheng-pei-zhi\" class=\"header-anchor\">#</a></h4><ul>\n<li><h5><span id=\"a-http-ren-zheng\">[a].httpè®¤è¯</span><a href=\"#a-http-ren-zheng\" class=\"header-anchor\">#</a></h5>å¯¹äºéœ€è¦è¿›è¡Œè®¤è¯çš„è¿œç¨‹é…ç½®åº“,å¯ä»¥ä½¿ç”¨HTTPçš„ basic authentication æ–¹æ³•è¿›è¡Œè®¤è¯,åªéœ€è¦æ·»åŠ <code>username</code>,<code>password</code> å±æ€§å³å¯<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">cloud:</span></span><br><span class=\"line\">    <span class=\"attr\">config:</span></span><br><span class=\"line\">      <span class=\"attr\">server:</span></span><br><span class=\"line\">        <span class=\"attr\">git:</span></span><br><span class=\"line\">          <span class=\"attr\">uri:</span> <span class=\"string\">https://github.com/pkaq/springcloud7.git</span></span><br><span class=\"line\">          <span class=\"attr\">username:</span> <span class=\"string\">tiger</span></span><br><span class=\"line\">          <span class=\"attr\">password:</span> <span class=\"string\">scott</span></span><br></pre></td></tr></table></figure></li>\n<li><h5><span id=\"b-ssh-ren-zheng\">[b].sshè®¤è¯</span><a href=\"#b-ssh-ren-zheng\" class=\"header-anchor\">#</a></h5>ã€€ã€€è¿™ä¸ªæ¯”è¾ƒç®€å•,åªè¦å°†<code>uri</code>ä¸­çš„åœ°å€æ¢æˆå¯¹åº”çš„sshåœ°å€,å¹¶ä¸”ä¿è¯ä½ æœ¬åœ°<code>~/.ssh</code>ç›®å½•ä¸­å­˜å‚¨å¥½è®¤è¯çš„<code>key</code>å³å¯</li>\n</ul>\n<h3><span id=\"2-1-2-mo-shi-pi-pei-duo-ge-cang-ku\">2.1.2 æ¨¡å¼åŒ¹é…å¤šä¸ªä»“åº“</span><a href=\"#2-1-2-mo-shi-pi-pei-duo-ge-cang-ku\" class=\"header-anchor\">#</a></h3><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">cloud:</span></span><br><span class=\"line\">    <span class=\"attr\">config:</span></span><br><span class=\"line\">      <span class=\"attr\">server:</span></span><br><span class=\"line\">        <span class=\"attr\">git:</span></span><br><span class=\"line\">        <span class=\"comment\"># è¿œç¨‹ä»“åº“åœ°å€</span></span><br><span class=\"line\">          <span class=\"attr\">uri:</span> <span class=\"string\">https://github.com/pkaq/springcloud7.git</span></span><br><span class=\"line\">        <span class=\"comment\"># å­ç›®å½•</span></span><br><span class=\"line\">          <span class=\"attr\">search-paths:</span> <span class=\"string\">cloud-config-repo</span></span><br><span class=\"line\">        <span class=\"comment\"># åœ¨å¯åŠ¨æ—¶å°±ä¸‹è½½é…ç½®æ–‡ä»¶</span></span><br><span class=\"line\">          <span class=\"attr\">clone-on-start:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        <span class=\"comment\"># è¯»å–é…ç½®è¶…æ—¶æ—¶é—´ é»˜è®¤5s</span></span><br><span class=\"line\">          <span class=\"attr\">timeout:</span> <span class=\"number\">15</span></span><br><span class=\"line\">        <span class=\"comment\"># å¼ºåˆ¶è¯»å–è¿œç¨‹ç‰ˆæœ¬(å½“æœ¬åœ°ç‰ˆæœ¬è¢«ç¯¡æ”¹æ—¶ä»ç„¶ä¿è¯ä½¿ç”¨è¿œç¨‹å‰¯æœ¬)</span></span><br><span class=\"line\">          <span class=\"attr\">force-pull:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        <span class=\"comment\"># ç¦æ­¢è°ƒç”¨ç«¯è¦†ç›–æ­¤å±æ€§</span></span><br><span class=\"line\">          <span class=\"attr\">overrides:</span></span><br><span class=\"line\">            <span class=\"attr\">foo:</span> <span class=\"string\">bar</span></span><br><span class=\"line\"><span class=\"comment\">#          å¤šä»“åº“é…ç½®</span></span><br><span class=\"line\">          <span class=\"attr\">repos:</span></span><br><span class=\"line\"><span class=\"comment\">#            åˆ«å,éšæ„</span></span><br><span class=\"line\">            <span class=\"attr\">repo-a:</span></span><br><span class=\"line\"><span class=\"comment\">#               åŒ¹é…ç¬¦</span></span><br><span class=\"line\">               <span class=\"attr\">pattern:</span></span><br><span class=\"line\">                  <span class=\"bullet\">-</span> <span class=\"string\">&#x27;bravo*&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">#               ä»“åº“åœ°å€</span></span><br><span class=\"line\">               <span class=\"attr\">uri:</span> <span class=\"string\">http://git/config-repo.git</span></span><br><span class=\"line\">            <span class=\"attr\">repo-b:</span></span><br><span class=\"line\">               <span class=\"attr\">pattern:</span></span><br><span class=\"line\">                  <span class=\"bullet\">-</span> <span class=\"string\">&#x27;alpha*&#x27;</span></span><br><span class=\"line\">               <span class=\"attr\">uri:</span> <span class=\"string\">file://D:/git/spring-cloud-7simple</span></span><br></pre></td></tr></table></figure>\n<p>ã€€ã€€å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡<code>spring.application.name</code>æˆ–<code>spring.cloud.config.name</code>æ¥å¤šä¸ªåº“ä¸­çš„<code>application</code>éƒ¨åˆ†æè¿°,é€šè¿‡<code>spring.cloud.config.profile</code>é…ç½®<code>profile</code>éƒ¨åˆ†çš„æè¿°.å¦‚æœåŠ è½½ä¸åˆ°å“åº”çš„é…ç½®æ–‡ä»¶åˆ™ä»<code>git.uri</code>ä¸‹è¿›è¡ŒåŠ è½½.</p>\n<blockquote>\n<p>æ³¨æ„:æ·»åŠ å¤šä¸ªæ¨¡å¼åº“é…ç½®å,ç›´æ¥é€šè¿‡æµè§ˆå™¨è®¿é—®é…ç½®ä¸­å¿ƒæœåŠ¡ä¼šå°†é»˜è®¤é…ç½®ä¹ŸåŠ è½½å‡ºæ¥</p>\n</blockquote>\n<h3><span id=\"2-1-3-clone-on-start\">2.1.3 clone-on-start</span><a href=\"#2-1-3-clone-on-start\" class=\"header-anchor\">#</a></h3><p>ã€€ã€€é»˜è®¤æƒ…å†µä¸‹,é…ç½®æœåŠ¡ä¼šåœ¨é…ç½®æ–‡ä»¶ç¬¬ä¸€æ¬¡è¢«è¯·æ±‚æ—¶<code>clone</code>è¿œç¨‹çš„é…ç½®åº“.å½“ç„¶ä¹Ÿå¯ä»¥é…ç½®ä¸ºåœ¨å¯åŠ¨æ—¶cloneè¿œç¨‹çš„é…ç½®åº“<br>åªéœ€è¦é…ç½®<code>spring.cloud.config.server.git.clone-on-start</code>ä¸º<code>true</code>å³å¯</p>\n<h3><span id=\"2-2-native-filesystem\">2.2 native filesystem</span><a href=\"#2-2-native-filesystem\" class=\"header-anchor\">#</a></h3><p>ã€€ã€€å¯ä»¥é€šè¿‡é‡‡ç”¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„æ–¹å¼è®¿é—®é…ç½®æ–‡ä»¶</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">cloud:</span></span><br><span class=\"line\">    <span class=\"attr\">config:</span>      </span><br><span class=\"line\">      <span class=\"attr\">server:</span></span><br><span class=\"line\">        <span class=\"attr\">native:</span></span><br><span class=\"line\">          <span class=\"attr\">search-locations:</span> <span class=\"string\">file:///$&#123;path&#125;/config-repo</span></span><br></pre></td></tr></table></figure>\n<p>ã€€ã€€å¯æ”¯æŒä»¥<code>[classpath:/, classpath:/config,file:./, file:./config]</code>ç­‰æ–¹å¼åŠ è½½</p>\n<blockquote>\n<p>p.s:æ³¨æ„,è¿™é‡Œæœ‰ä¸ªå‘<code>win</code>ä¸‹<code>file</code>åéœ€è¦å¤šåŠ ä¸ª<code>/</code>å³,<code>file:///$&#123;path&#125;/config-repo</code></p>\n</blockquote>\n<h3><span id=\"2-3-vault\">2.3 vault</span><a href=\"#2-3-vault\" class=\"header-anchor\">#</a></h3><p>ã€€ã€€å¯ä»¥é€šè¿‡<code>spring.cloud.config.server.vault</code>èŠ‚ç‚¹å¯¹<code>vault</code>æ–¹å¼è¿›è¡Œé…ç½®</p>\n<h2><span id=\"3-shi-yong-enableconfigserver-zhu-jie-fa-bu-pei-zhi-fu-wu\">3 ä½¿ç”¨<code>@EnableConfigServer</code>æ³¨è§£å‘å¸ƒé…ç½®æœåŠ¡</span><a href=\"#3-shi-yong-enableconfigserver-zhu-jie-fa-bu-pei-zhi-fu-wu\" class=\"header-anchor\">#</a></h2><p>1.æ·»åŠ  <code>spring-cloud-config-server</code> ç›¸å…³ä¾èµ–</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">compile <span class=\"string\">&quot;org.springframework.cloud:spring-cloud-config-server:1.5.6.RELEASE&quot;</span></span><br></pre></td></tr></table></figure>\n<p>2.åœ¨ä½ çš„<code>spring boot</code>å¯åŠ¨ç±»ä¸Šæ·»åŠ <code>@EnableConfigServer</code>æ³¨è§£<br>3.å¯åŠ¨æœåŠ¡,å¤§åŠŸå‘Šæˆ.</p>\n<blockquote>\n<p>p.s:<code>application.properties, application.yml, application-*.properties</code>è¿™ç±»é…ç½®æ–‡ä»¶éƒ½ä¼šé€šè¿‡æœåŠ¡å‘å¸ƒå‡ºå».ä½†æ˜¯,å½“é‡‡ç”¨<code>native filesystem</code>æ–¹å¼æ—¶,<code>application*</code>æ­¤ç±»æ–‡ä»¶ä¸ä¼šè¢«å‘å¸ƒ.</p>\n</blockquote>\n<h2><span id=\"4-fang-wen-pei-zhi\">4 è®¿é—®é…ç½®</span><a href=\"#4-fang-wen-pei-zhi\" class=\"header-anchor\">#</a></h2><p>ã€€ã€€å¯ä»¥é€šè¿‡å¦‚ä¸‹è§„åˆ™å¯¹é…ç½®èµ„æºè¿›è¡Œè®¿é—®è¯»å–<code>profile</code>çš„ä¼˜å…ˆçº§,æ¿€æ´»çš„profilesçš„ä¼˜å…ˆçº§é«˜äºdefaults,æœ‰å¤šä¸ªprofiles,æœ€åä¸€ä¸ªèµ·ä½œç”¨ã€‚</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">/&#123;application&#125;/&#123;profile&#125;[/&#123;label&#125;]</span></span><br><span class=\"line\"><span class=\"string\">/&#123;application&#125;-&#123;profile&#125;.yml</span></span><br><span class=\"line\"><span class=\"string\">/&#123;label&#125;/&#123;application&#125;-&#123;profile&#125;.yml</span></span><br><span class=\"line\"><span class=\"string\">/&#123;application&#125;-&#123;profile&#125;.properties</span></span><br><span class=\"line\"><span class=\"string\">/&#123;label&#125;/&#123;application&#125;-&#123;profile&#125;.properties</span></span><br></pre></td></tr></table></figure>\n<p><img src=\".%5Csc-configserver%5Cconfigserver.png\" alt=\"é…ç½®èµ„æºè§„åˆ™\"></p>\n<blockquote>\n</blockquote>\n<ul>\n<li><code>application</code>:<code>client</code>å¯ä»¥é€šè¿‡<code>spring.config.name</code>è¿›è¡Œé…ç½®,é»˜è®¤ä¸º<code>application</code>;</li>\n<li><code>profile</code>:ä¸ºé…ç½®åç§°,å¯¹åº”<code>sprng.profiles.active</code>é…ç½®;</li>\n<li><code>label</code>:å¯é€‰é¡¹ ï¼Œgitåˆ†æ”¯åç§°æˆ–è€…tagåç§°,é»˜è®¤ä¸º<code>master</code>;å¦‚æœgitåˆ†æ”¯æˆ–tagçš„åç§°åŒ…å«ä¸€ä¸ªæ–œæ  (â€œ/â€œ),æ­¤æ—¶HTTP URLä¸­çš„labeléœ€è¦ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ä¸²â€(_)â€æ¥æ›¿ä»£(ä¸ºäº†é¿å…ä¸å…¶ä»–URLè·¯å¾„ç›¸äº’æ··æ·†)</li>\n</ul>\n<h2><span id=\"5-jian-kang-jian-cha\">5 å¥åº·æ£€æŸ¥</span><a href=\"#5-jian-kang-jian-cha\" class=\"header-anchor\">#</a></h2><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">cloud:</span></span><br><span class=\"line\">    <span class=\"attr\">config:</span></span><br><span class=\"line\">      <span class=\"attr\">server:</span></span><br><span class=\"line\">        <span class=\"attr\">health:</span></span><br><span class=\"line\">          <span class=\"attr\">repositories:</span></span><br><span class=\"line\">            <span class=\"attr\">myservice:</span></span><br><span class=\"line\">              <span class=\"attr\">label:</span> <span class=\"string\">mylabel</span></span><br><span class=\"line\">            <span class=\"attr\">myservice-dev:</span></span><br><span class=\"line\">              <span class=\"attr\">name:</span> <span class=\"string\">myservice</span></span><br><span class=\"line\">              <span class=\"attr\">profiles:</span> <span class=\"string\">development</span></span><br><span class=\"line\"><span class=\"string\">```</span>              </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">å¯ä»¥é€šè¿‡è®¾ç½®`spring.cloud.config.server.health.enabled=false`</span> <span class=\"string\">æ¥ç¦ç”¨è¿è¡ŒçŠ¶å†µæŒ‡ç¤ºå™¨ã€‚</span>   </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 6 å®‰å…¨é…ç½®   </span></span><br><span class=\"line\"></span><br><span class=\"line\">ã€€ã€€<span class=\"string\">ä¸ºäº†ä¿è¯é…ç½®ä¸­å¿ƒé…ç½®é¡¹çš„å®‰å…¨æ€§,é€šå¸¸éœ€è¦å¯¹è®¿é—®è¿›è¡Œé™åˆ¶,å¯ä»¥å€ŸåŠ©spring-ssecurity,å¯¹é…ç½®ä¸­å¿ƒæœåŠ¡æ·»åŠ èº«ä»½è®¤è¯.</span></span><br><span class=\"line\">ã€€ã€€<span class=\"number\">1</span><span class=\"string\">.éœ€è¦æ·»åŠ `spring-boot-starter-security`ä¾èµ–åŒ…</span></span><br><span class=\"line\">ã€€ã€€<span class=\"number\">2</span><span class=\"string\">.è¿›è¡Œå®‰å…¨è®¤è¯é…ç½®</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">```yml</span></span><br><span class=\"line\"><span class=\"comment\"># è®¿é—®è®¤è¯</span></span><br><span class=\"line\"><span class=\"attr\">security:</span></span><br><span class=\"line\">  <span class=\"attr\">basic:</span></span><br><span class=\"line\">    <span class=\"attr\">enabled:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">user:</span></span><br><span class=\"line\">    <span class=\"attr\">name:</span> <span class=\"string\">pkaq</span></span><br><span class=\"line\">    <span class=\"attr\">password:</span> <span class=\"string\">pkaqx</span></span><br></pre></td></tr></table></figure>\n<p>** <a href=\"https://github.com/pkaq/springcloud7/tree/master/cloud-config-server\">ç¤ºä¾‹ä»£ç </a> ** </p>\n<p>** å‚è€ƒ **</p>\n<ul>\n<li><a href=\"http://cloud.spring.io/spring-cloud-static/Dalston.SR3/\">http://cloud.spring.io/spring-cloud-static/Dalston.SR3/</a></li>\n</ul>\n","categories":["å¾®æœåŠ¡","Spring"],"tags":["Spring Cloud","å¾®æœåŠ¡"]},{"title":"ä½¿ç”¨yarnæ›¿ä»£npm","url":"https://pkaq.org/2017/01/20/yarn/","content":"<p>å¼ºçƒˆå®‰åˆ©ä¸€æ³¢yarn,yarné»˜è®¤å°±æœ‰é”å®šæ–‡ä»¶ã€æ›´å¿«é€Ÿåœ°å®‰è£…ä¾èµ–ä»¥åŠä¾èµ–çš„æ›´æ–°ä¼šè‡ªåŠ¨åŒæ­¥åˆ° package.json æ–‡ä»¶ä¸­ã€‚ä»npmè¿ç§»è¿‡æ¥æ ¹æœ¬ä¸éœ€è¦åšä»€ä¹ˆ,åŸæœ‰çš„package.jsonç›´æ¥å¯ç”¨</p>\n<p>æ³¨æ„ ä»¥ä¸‹å†…å®¹æ‘˜è‡ª : <a href=\"https://segmentfault.com/a/1190000007189426\">https://segmentfault.com/a/1190000007189426</a></p>\n<h2><span id=\"an-zhuang\">å®‰è£…</span><a href=\"#an-zhuang\" class=\"header-anchor\">#</a></h2><p>1.å¦‚æœåŸå…ˆæœ‰npmå·¥å…·çš„è¯ï¼Œå®‰è£…yarnå¾ˆç®€å•ï¼Œåªéœ€è¦ä¸€è¡Œå‘½ä»¤å³å¯</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install -g yarn</span><br></pre></td></tr></table></figure>\n<p>2.å¦‚æœæ²¡æœ‰npmå·¥å…·ï¼Œå®‰è£…yarnå¯å‚ç…§ -&gt; <a href=\"https://yarnpkg.com/en/docs/install\">å„å¹³å°ä¸‹yarnå·¥å…·å®‰è£…æ–¹å¼</a></p>\n<a id=\"more\"></a>\n<h2><span id=\"pei-zhi\">é…ç½®</span><a href=\"#pei-zhi\" class=\"header-anchor\">#</a></h2><p>å®‰è£…yarnä¹‹åé»˜è®¤çš„åŒ…å®‰è£…æºæ˜¯ <a href=\"https://registry.yarnpkg.com,å¯ç”¨æŸ¥çœ‹å‘½ä»¤/\">https://registry.yarnpkg.comï¼Œå¯ç”¨æŸ¥çœ‹å‘½ä»¤</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yarn config get registry</span><br></pre></td></tr></table></figure>\n<p>è‹¥æƒ³æé«˜yarnå®‰è£…çš„é€Ÿåº¦ï¼Œå¯å°†åŒ…å®‰è£…æºä¿®æ”¹ä¸ºcnpmçš„å®‰è£…æºï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yarn config <span class=\"built_in\">set</span> registry <span class=\"string\">&#x27;https://registry.npm.taobao.org&#x27;</span></span><br></pre></td></tr></table></figure>\n<h2><span id=\"shi-yong\">ä½¿ç”¨</span><a href=\"#shi-yong\" class=\"header-anchor\">#</a></h2><p>1.åˆå§‹åŒ–æŸä¸ªé¡¹ç›®</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm init</span><br><span class=\"line\">yarn init</span><br></pre></td></tr></table></figure>\n<p>2.é»˜è®¤çš„å®‰è£…ä¾èµ–æ“ä½œ</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install/link</span><br><span class=\"line\">yarn install/link</span><br></pre></td></tr></table></figure>\n<p>3.å®‰è£…æŸä¸ªä¾èµ–ï¼Œå¹¶ä¸”é»˜è®¤ä¿å­˜åˆ°package</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install xxx â€”save</span><br><span class=\"line\">yarn add xxx</span><br></pre></td></tr></table></figure>\n<p>4.ç§»é™¤æŸä¸ªä¾èµ–é¡¹ç›®</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm uninstall xxx â€”save</span><br><span class=\"line\">yarn remove xxx</span><br></pre></td></tr></table></figure>\n<p>5.å®‰è£…æŸä¸ªå¼€å‘æ—¶ä¾èµ–é¡¹ç›®</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install --save-dev xxx </span><br><span class=\"line\">yarn add xxx â€”dev</span><br></pre></td></tr></table></figure>\n<p>6.æ›´æ–°æŸä¸ªä¾èµ–é¡¹ç›®</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm update --save xxx</span><br><span class=\"line\">yarn upgrade xxx</span><br></pre></td></tr></table></figure>\n<p>7.å®‰è£…æŸä¸ªå…¨å±€ä¾èµ–é¡¹ç›®</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install -g xxx </span><br><span class=\"line\">yarn global add xxx</span><br></pre></td></tr></table></figure>\n<p>8.å‘å¸ƒ/ç™»å½•/ç™»å‡ºï¼Œä¸€ç³»åˆ—NPM Registryæ“ä½œ</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm publish/login/<span class=\"built_in\">logout</span></span><br><span class=\"line\">yarn publish/login/<span class=\"built_in\">logout</span></span><br></pre></td></tr></table></figure>\n<p>9.è¿è¡ŒæŸä¸ªå‘½ä»¤</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm run/<span class=\"built_in\">test</span></span><br><span class=\"line\">yarn run/<span class=\"built_in\">test</span></span><br></pre></td></tr></table></figure>\n","categories":["Build Tools","å‰ç«¯"],"tags":["yarn"]},{"title":"é‡‡ç”¨Gradleå¿«é€Ÿæ„å»ºåŸºäºSpring bootçš„MVCåº”ç”¨","url":"https://pkaq.org/2016/12/13/springboot-gradle/","content":"<p><code>Spring boot</code>æ˜¯ç”¨ä»¥ç®€åŒ–<code>Spring</code>é…ç½®å¼€å‘çš„ä¸€æšæ¡†æ¶ï¼Œé‡‡ç”¨<code>Spring boot</code>å¯ä»¥æŠ›å¼ƒç¹ççš„XMLé…ç½®ï¼Œé‡‡ç”¨<code>JavaConfigure</code>çš„æ–¹å¼è¿›è¡Œå¿«é€Ÿé…ç½®ã€‚åŒæ—¶è¯¥æ¡†æ¶æä¾›äº†åŒ…å«é¢„é…ç½®çš„ä¼—å¤šçš„<code>starter</code>å¯ä»¥æå¤§çš„ç®€åŒ–é…ç½®å·¥ä½œé‡ã€‚ä¸‹é¢çš„ä»£ç ä¾¿æ˜¯é‡‡ç”¨<code>web-starter</code>å’Œ<code>Gradle</code>è¿›è¡Œå¿«é€Ÿåˆ›å»ºä¸€ä¸ªmvcåº”ç”¨çš„ç¤ºä¾‹ã€‚</p>\n<a id=\"more\"></a>\n<h4><span id=\"mu-lu-jie-gou\">ç›®å½•ç»“æ„</span><a href=\"#mu-lu-jie-gou\" class=\"header-anchor\">#</a></h4><p><img src=\"structure.jpg\"></p>\n<h4><span id=\"yin-ru-yi-lai\">å¼•å…¥ä¾èµ–</span><a href=\"#yin-ru-yi-lai\" class=\"header-anchor\">#</a></h4><figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apply <span class=\"attr\">plugin:</span> <span class=\"string\">&quot;war&quot;</span></span><br><span class=\"line\"><span class=\"comment\">// ç‰ˆæœ¬å·</span></span><br><span class=\"line\">ext &#123;</span><br><span class=\"line\">    bootVersion = <span class=\"string\">&quot;1.4.2.RELEASE&quot;</span></span><br><span class=\"line\">    tomcat_embed = <span class=\"string\">&quot;8.5.4&quot;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// ä»“åº“é…ç½®</span></span><br><span class=\"line\">repositories &#123;</span><br><span class=\"line\">    maven &#123; url<span class=\"string\">&quot;https://repo.spring.io/libs-release&quot;</span> &#125;</span><br><span class=\"line\">    jcenter()</span><br><span class=\"line\">    mavenCentral()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// ä¾èµ–é…ç½®</span></span><br><span class=\"line\">dependencies &#123;</span><br><span class=\"line\">    compile <span class=\"string\">&quot;org.springframework.boot:spring-boot-starter-web:$&#123;bootVersion&#125;&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;org.apache.tomcat.embed:tomcat-embed-jasper:$&#123;tomcat_embed&#125;&quot;</span>            </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4><span id=\"ge-xing-hua-pei-zhi\">ä¸ªæ€§åŒ–é…ç½®</span><a href=\"#ge-xing-hua-pei-zhi\" class=\"header-anchor\">#</a></h4><p>ã€€ã€€å¦‚æœä½ é‡‡ç”¨çš„æ˜¯æ ‡å‡†ç›®å½•ç»“æ„ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡åœ¨<code>src/main/resources</code>ä¸‹åˆ›å»º<code>application.yaml</code>æ–‡ä»¶å¯¹é¢„é…ç½®é¡¹è¿›è¡Œä¿®æ”¹ï¼Œæ— è®ºæ˜¯åœ¨<code>IDEA</code>è¿˜æ˜¯åœ¨<code>STS</code>ä¸­ï¼Œç¼–è¾‘æ­¤æ–‡ä»¶è¾“å…¥<code>spring.</code>éƒ½ä¼šæœ‰ç›¸åº”çš„ä»£ç æç¤ºï¼Œç›¸å…³é…ç½®é¡¹çš„åå­—åŸºæœ¬ä¹Ÿæ˜¯è§åçŸ¥æ„ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±å»ä½“ä¼šä¸€ä¸‹ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥<code>ctrl+click</code>æŸ¥çœ‹ä¸‹æºç åšæ·±å…¥äº†è§£ã€‚</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">mvc:</span></span><br><span class=\"line\">    <span class=\"attr\">date-format:</span> <span class=\"string\">yyyy-MM-dd</span></span><br><span class=\"line\">    <span class=\"attr\">view:</span></span><br><span class=\"line\">       <span class=\"attr\">prefix:</span> <span class=\"string\">/WEB-INF/web/</span></span><br><span class=\"line\">       <span class=\"attr\">suffix:</span> <span class=\"string\">.jsp</span></span><br></pre></td></tr></table></figure>\n<h4><span id=\"qi-dong-lei-pei-zhi\">å¯åŠ¨ç±»é…ç½®</span><a href=\"#qi-dong-lei-pei-zhi\" class=\"header-anchor\">#</a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Booter</span> <span class=\"keyword\">implements</span> <span class=\"title\">CommandLineRunner</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å…¥å£å‡½æ•°.</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> args args</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        SpringApplication.run(Booter.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">(String... args)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;  --- --- --- [ web started ] --- --- ---  &quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4><span id=\"yi-ge-shi-li-controller\">ä¸€ä¸ªç¤ºä¾‹controller</span><a href=\"#yi-ge-shi-li-controller\" class=\"header-anchor\">#</a></h4><p>ã€€ã€€è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œå¦‚æœæ²¡æœ‰é…ç½® <code>ComponentScan</code> æŒ‡å®šæ‰«æçš„åŒ…ï¼Œ<code>controller</code> åº”è¯¥æ”¾åœ¨å¯åŠ¨ç±»çš„åŒçº§æˆ–è€…å­åŒ…ä¸‹ï¼Œå¦åˆ™æ— æ³•æ‰«æåˆ°ç›¸åº”çš„Beanã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Controller</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TigerController</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping(&quot;/tiger&quot;)</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ModelAndView <span class=\"title\">tiger</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ModelAndView(<span class=\"string\">&quot;Tiger&quot;</span>,<span class=\"string\">&quot;tigerName&quot;</span>,<span class=\"string\">&quot;Scott&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4><span id=\"view-ye-mian\">viewé¡µé¢</span><a href=\"#view-ye-mian\" class=\"header-anchor\">#</a></h4><p>ã€€ã€€æ— ä»–ï¼ŒJSPå°”ã€‚</p>\n<figure class=\"highlight jsp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page contentType=<span class=\"string\">&quot;text/html;charset=UTF-8&quot;</span> language=<span class=\"string\">&quot;java&quot;</span> %&gt;</span><br><span class=\"line\">&lt;html&gt;</span><br><span class=\"line\">&lt;head&gt;</span><br><span class=\"line\">    &lt;title&gt;Hello Spring MVC&lt;/title&gt;</span><br><span class=\"line\">&lt;/head&gt;</span><br><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">Tiger<span class=\"string\">&#x27;s name is : $&#123;tigerName&#125;</span></span><br><span class=\"line\"><span class=\"string\">&lt;/body&gt;</span></span><br><span class=\"line\"><span class=\"string\">&lt;/html&gt;</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br></pre></td></tr></table></figure>","categories":["Build Tools","Spring"],"tags":["Gradle","Spring Boot"]},{"title":"ä½¿ç”¨Gradleè¿›è¡Œå¤šæ¨¡å—é¡¹ç›®æ„å»º","url":"https://pkaq.org/2016/12/13/gradle-multi/","content":"<div class=\"toc\">\n\n<!-- toc -->\n\n<ul>\n<li><a href=\"#gai-shu\">æ¦‚è¿°</a></li>\n<li><a href=\"#xiang-mu-jie-gou\">é¡¹ç›®ç»“æ„</a></li>\n<li><a href=\"#settings-wen-jian\">settingsæ–‡ä»¶</a></li>\n<li><a href=\"#build-wen-jian\">buildæ–‡ä»¶</a></li>\n<li><a href=\"#fen-chi-pei-zhi\">åˆ†ç¦»é…ç½®</a></li>\n<li><a href=\"#shui-ping-bu-ju-he-fen-ceng-bu-ju\">æ°´å¹³å¸ƒå±€å’Œåˆ†å±‚å¸ƒå±€</a></li>\n</ul>\n<!-- tocstop -->\n\n</div>\n\n<h3><span id=\"gai-shu\">æ¦‚è¿°</span><a href=\"#gai-shu\" class=\"header-anchor\">#</a></h3><p>ã€€ã€€éšç€é¡¹ç›®è§„æ¨¡çš„æ‰©å±•å’ŒåŠŸèƒ½çš„å¢åŠ ï¼Œä»»ä½•ä¸€ä¸ªç®€å•çš„é¡¹ç›®åŸºæœ¬éƒ½ä¼šè¿›è¡Œæ¨¡å—çš„æ‹†åˆ†ç‹¬ç«‹ï¼Œç„¶åé€šè¿‡é¡¹ç›®ä¹‹é—´çš„ä¾èµ–è¿›è¡Œé‡æ–°æ•´åˆã€‚</p>\n<p>ã€€ã€€é¡¹ç›®æ‹†åˆ†å¸¦æ¥çš„å¥½å¤„ä¹Ÿæ˜¾è€Œæ˜“è§ã€‚æ‹†åˆ†å¯ä»¥æ˜¯é¡¹ç›®ç»“æ„æ›´åŠ æ¸…æ™°ï¼ŒèŒè´£åˆ’åˆ†æ›´åŠ æ˜ç¡®ï¼Œç›¸å…³æ¨¡å—çš„è´Ÿè´£äººåªéœ€ä¸“æ³¨äºè‡ªå·±è´Ÿè´£çš„å­æ¨¡å—è€Œæ— éœ€å¯¹æ•´ä¸ªé¡¹ç›®è¿›è¡Œä¸€æ¬¡æ„å»ºã€‚ã€€ã€€</p>\n<p>ã€€ã€€å¦‚æœä¸é‡‡ç”¨æ„å»ºå·¥å…·æˆ–è®¸æœ€åŸå§‹çš„æ–¹å¼æ— éäºå°†ä¸€äº›ç›¸å¯¹ç‹¬ç«‹çš„å’Œå…¬å…±çš„æ¨¡å—ä»£ç æ‹†åˆ†æˆç‹¬ç«‹é¡¹ç›®ï¼Œé€šè¿‡æ‰‹å·¥æ‰“jaråŒ…æ›¿æ¢çš„æ–¹å¼è¿›è¡Œå¤šé¡¹ç›®ä¹‹é—´çš„ä¾èµ–ç®¡ç†ï¼Œè¿™æ— ç–‘æ˜¯ä½æ•ˆã€ç¹çä¸”æ²¡æœ‰ä»·å€¼çš„å·¥ä½œã€‚</p>\n<a id=\"more\"></a>\n\n<p>ã€€ã€€Gradleå¯¹å¤šæ¨¡å—é¡¹ç›®æœ‰ç€ä¼˜ç§€çš„æ”¯æŒï¼Œç°åœ¨å€ŸåŠ©äºGradleå¯ä»¥æŠŠä½ ä»ä¸€äº›ä½ä»·å€¼çš„åŠ³åŠ¨ä¸­è§£æ”¾å‡ºæ¥ã€‚ä½ å¯ä»¥è‚†æ„çš„é‡‡ç”¨æ°´å¹³æˆ–è€…åˆ†å±‚çš„æ–¹å¼ç»„ç»‡ä½ çš„é¡¹ç›®æ¨¡å—ï¼Œè‚†æ„çš„è¿›è¡Œæ¨¡å—ä¹‹é—´çš„ä¾èµ–ï¼Œç”šè‡³æ˜¯æ¨¡å—ä¹‹é—´æ·±å±‚æ¬¡çš„ä¾èµ–ã€‚ä¸¾ä¸ªæ —å­ï¼Œå¦‚æœæœ‰ä¸ªwebå·¥ç¨‹ä¾èµ–äºä¸€ä¸ª<code>util</code>å·¥ç¨‹å’Œä¸€ä¸ª<code>common-service</code>å·¥ç¨‹ï¼Œé‚£ä¹ˆå½“<code>util</code>å’Œ<code>common-service</code>è¿›è¡Œäº†ä»»ä½•ä¿®æ”¹ï¼Œåœ¨webå·¥ç¨‹è¿›è¡Œæ‰“åŒ…çš„æ—¶å€™ä¼šè‡ªåŠ¨ç¼–è¯‘æ‰“åŒ…ä¾èµ–çš„<code>util</code>å’Œ<code>common-service</code>å·¥ç¨‹ï¼Œå¦‚æœä½ é‡‡ç”¨äº†åˆç†çš„<code>ä¾èµ–å£°æ˜</code>é‚£ä¹ˆåœ¨å‘å¸ƒwarçš„æ—¶å€™è¿™ä¸¤ä¸ªå·¥ç¨‹çš„ä¼šè¢«è‡ªåŠ¨æ‰“æˆ<code>jar</code>åŒ…æ‰“è¿›æœ€ç»ˆçš„<code>war</code>ä¸­ã€‚<br>  è¿™ä¸€ç« èŠ‚ä½ å°†ä¼šäº†è§£åˆ°å¦‚ä¸‹å†…å®¹</p>\n<ul>\n<li>å¤šæ¨¡å—é¡¹ç›®ç»“æ„</li>\n<li>å¤šæ¨¡å—é¡¹ç›®è„šæœ¬</li>\n<li>æ„å»ºåˆ†å±‚å¸ƒå±€çš„å¤šæ¨¡å—é¡¹ç›®</li>\n<li>æ„å»ºé›†ä¸­åŒ–é…ç½®çš„å¤šæ¨¡å—é¡¹ç›®</li>\n</ul>\n<h3><span id=\"xiang-mu-jie-gou\">é¡¹ç›®ç»“æ„</span><a href=\"#xiang-mu-jie-gou\" class=\"header-anchor\">#</a></h3><p>ã€€ã€€åœ¨è¿›è¡Œä»‹ç»ä¹‹å‰ï¼Œè¿™é‡Œæœ‰å¿…è¦å…ˆè§£é‡Šä¸€ä¸‹é¡¹ç›®ï¼ˆprojectï¼‰å’Œæ¨¡å—ï¼ˆmoduleï¼‰çš„æ¦‚å¿µã€‚Gradleä¸­é»˜è®¤æ˜¯ä¸å­˜åœ¨æ¨¡å—æ¦‚å¿µçš„ï¼Œè¿™é‡ŒæŒ‡çš„å¤šæ¨¡å—é¡¹ç›®æ„å»ºå¯¹åº”åˆ°Gradleä¸­å³æ˜¯<code>å¤šé¡¹ç›®æ„å»º</code>ï¼Œä¸ºäº†ä¾¿äºç†è§£ï¼Œæ‰€ä»¥æœ¬æ–‡ä¸­ä¸€å¾‹æŒ‰å¤šæ¨¡å—è¿›è¡Œæè¿°ã€‚</p>\n<blockquote>\n<p>å…³äºå¤šé¡¹ç›®å’Œå¤šæ¨¡å—çš„åˆ†æ­§æ— æ³•æº¯æºï¼Œæˆ–è®¸æ˜¯ç”±äº<code>eclipse</code>å’Œ<code>idea</code>ä¸åŒå®šä¹‰è€Œèµ·å§ã€‚åœ¨<code>eclipse</code>ä¸­ä¸å­˜åœ¨æ¨¡å—æ¦‚å¿µï¼Œèµ°çš„æ˜¯<code>workspace - working set - project</code>è·¯çº¿ï¼Œè€Œåœ¨<code>idea</code>ä¸­ï¼Œåˆ™æ˜¯æŒ‰<code>project - module</code>è¿›è¡Œç»„ç»‡é¡¹ç›®ã€‚è‡ªä»è½¬ä¸º<code>idea</code>å…šä¹‹åï¼Œç§ä»¥ä¸º<code>idea</code>çš„è·¯å­æ›´ç§‘å­¦ï¼Œæ‰€ä»¥è¿™é‡ŒæŒ‰<code>idea</code>çš„å¥—è·¯è¿›è¡Œæè¿°ã€‚   </p>\n</blockquote>\n<p>ä¸‹é¢å±•ç¤ºäº†åˆ†å±‚å¸ƒå±€å’Œæ°´å¹³å¸ƒå±€çš„ä¸¤ç§å¤šæ¨¡å—é¡¹ç›®ç»“æ„<br><img src=\"structure.jpg\" alt=\"å¤šæ¨¡å—é¡¹ç›®ç»“æ„\">ã€€ã€€ã€€ã€€<br><img src=\"structure-flat.jpg\" alt=\"å¤šæ¨¡å—é¡¹ç›®ç»“æ„\">ã€€ã€€</p>\n<p>ã€€ã€€ä¸ºäº†æ›´åŠ ç›´è§‚ï¼Œè¿™é‡Œé¡¹ç›®ç»“æ„é‡‡ç”¨äº†åˆ†å±‚å¸ƒå±€çš„æ–¹å¼ã€‚è¿™ä¹Ÿæ˜¯Gradleé»˜è®¤çš„å¸ƒå±€æ–¹å¼ã€‚è¿™é‡Œæ ¹é¡¹ç›®æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œå°½ç®¡åœ¨åˆ†å±‚å¸ƒå±€ä¸­å®ƒçœ‹ä¸Šå»æ›´åƒæ˜¯ä¸€ä¸ªé¡¶çº§çš„<code>working set</code>ã€‚å…¶ä¸­æ ¹é¡¹ç›®ä¸‹çš„<code>build.gradle</code>æ–‡ä»¶å¯ä»¥å¯¹ä¸€äº›å…¬å…±å±æ€§ã€æ’ä»¶ã€ä¾èµ–ç­‰è¿›è¡Œç»Ÿä¸€é…ç½®ï¼Œ<code>setting.gradle</code>åˆ™æ˜¯æè¿°é¡¹ç›®å…³ç³»çš„æ–‡ä»¶ã€‚<br>ã€€ã€€æˆ–è®¸ä½ å·²ç»æ³¨æ„åˆ°ï¼Œåœ¨æ°´å¹³å¸ƒå±€çš„ç¤ºä¾‹å›¾ä¸­å­é¡¹ç›®ä¸‹æ²¡æœ‰<code>build.gradle</code>è„šæœ¬æ–‡ä»¶,è¿™æ˜¯ç”±äºåœ¨æ„å»ºå¤šæ¨¡å—é¡¹ç›®æ—¶ Gradle å…è®¸ä½ è‡ªç”±çš„é€‰ç”¨é›†ä¸­åŒ–é…ç½®å’Œåˆ†å¼€å¼é…ç½®ã€‚åœ¨æ°´å¹³å¸ƒå±€çš„ç»“æ„å›¾ä¸­ï¼Œæ‰€ç”»çš„å³æ˜¯é‡‡ç”¨é›†ä¸­åŒ–é…ç½®çš„ç»“æ„ã€‚</p>\n<h3><span id=\"settings-wen-jian\">settingsæ–‡ä»¶</span><a href=\"#settings-wen-jian\" class=\"header-anchor\">#</a></h3><p>ã€€ã€€æˆ‘ä»¬äº†è§£åˆ°ä¸€ä¸ªå…¸å‹çš„å¤šæ¨¡å—é¡¹ç›®éœ€è¦æœ‰ä¸€ä¸ªæ ¹æ¨¡å—é¡¹ç›®ä»¥åŠæ¨¡å—æè¿°æ–‡ä»¶(é»˜è®¤ä¸º<code>settings.gradle</code>)ï¼Œä¸‹é¢æˆ‘ä»¬å°†é€šè¿‡ä¸€ä¸ª <a href=\"https://github.com/GradleCN/GradleSide/tree/master/17-multi-project-central\">å¤šé¡¹ç›®ç¤ºä¾‹</a> æ¥å¯¹å¤šæ¨¡å—é¡¹ç›®çš„ç»“æ„ä»¥åŠè„šæœ¬è¿›è¡Œæ›´æ·±å…¥çš„äº†è§£ã€‚</p>\n<p>å¦‚æœè¦è®© <code>Gradle</code> æ”¯æŒå¤š<br>æ„å»ºï¼Œåªéœ€ä¸ºä½ çš„é¡¹ç›®ç¡®å®šä¸€ä¸ª æ ¹æ¨¡å—é¡¹ç›® å¹¶ä¸”åœ¨æ ¹æ¨¡å—é¡¹ç›®ä¸‹æ·»åŠ  <code>settings.gradle</code> æ–‡ä»¶ç”¨ä»¥æè¿°æ¨¡å—ï¼ˆé¡¹ç›®ï¼‰å…³ç³»</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include <span class=\"string\">&#x27;base&#x27;</span>,<span class=\"string\">&#x27;main&#x27;</span></span><br></pre></td></tr></table></figure>\n<p>ã€€ã€€è¿™é‡Œå°†æ¨¡å—ï¼ˆé¡¹ç›®ï¼‰åç§°è·¯å¾„çš„å­—ç¬¦ä¸²ä»¥æ•°ç»„çš„å½¢å¼ä¼ é€’ç»™äº†<code>include</code>å‡½æ•°ï¼ŒGradle ä¼šä»¥ç›¸å¯¹äºå½“å‰ç›®å½•æŒ‰ç…§ include ç»™å®šçš„æ¨¡å—ï¼ˆé¡¹ç›®ï¼‰è·¯å¾„æŸ¥æ‰¾å¯¹åº”çš„å­æ¨¡å—ï¼Œå¦‚æœè¦å£°æ˜çš„æ¨¡å—ï¼ˆé¡¹ç›®ï¼‰æœ‰å¤šä¸ªå±‚æ¬¡å¯ä»¥ç”¨<code>:</code>è¿›è¡Œæè¿°ï¼Œå‡è®¾<code>main</code>ä¸‹é¢åˆåˆ†äº†<code>Alpha</code>,<code>Bravo</code> é‚£ä¹ˆå£°æ˜æ–¹å¼åˆ™æŒ‰å¦‚ä¸‹æ–¹å¼ä¹¦å†™</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include <span class=\"string\">&#x27;base&#x27;</span>,<span class=\"string\">&#x27;main:Alpha&#x27;</span>,<span class=\"string\">&#x27;main:Bravo&#x27;</span></span><br></pre></td></tr></table></figure>\n<p>ã€€ã€€è¿™é‡Œçš„ <code>settings</code> æ–‡ä»¶å®é™…ä¸Šæ˜¯å¯¹åº”çš„ <code>Settings</code> æ¥å£ï¼Œ<code>Setitings</code> æ¥å£ä¸­æä¾›çš„å‡½æ•°åœ¨æœ¬è„šæœ¬ä¸­éƒ½æ˜¯å¯ç”¨çš„ï¼Œå…·ä½“ç»†èŠ‚è¯·æŸ¥é˜… <a href=\"https://docs.gradle.org/current/dsl/\">&gt;Settinsæ¥å£DSL&lt;</a> æ–‡æ¡£è¿›è¡Œäº†è§£ã€‚</p>\n<p>ã€€ã€€åœ¨æ„å»ºçš„ <strong>åˆå§‹åŒ–é˜¶æ®µ</strong>ï¼ŒGradle ä¼šè¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶åˆ›å»ºä¸€ä¸ª Settings ç±»å‹çš„å®ä¾‹ã€‚Gradle ä¼šä¾æ®æ­¤æ–‡ä»¶è¿›è¡Œå¤šæ¨¡å—é¡¹ç›®æ„å»ºï¼Œé»˜è®¤æƒ…å†µä¸‹ Gradle ä¼šä»åŒçº§çš„ master ç›®å½•ä¸‹å¯»æ‰¾æ­¤æ–‡ä»¶ï¼Œå¦‚æœæœªæ‰¾åˆ°åˆ™ä¼šå»çˆ¶çº§ç›®å½•å¯»æ‰¾ã€‚å¦‚æœæœå¯»ä¸åˆ° <code>settings</code> æ–‡ä»¶ï¼Œé‚£ä¹ˆ Gradle ä¼šæŠŠæ¨¡å—å½“åšå•ç‹¬æ„å»ºçš„é¡¹ç›®å»æ‰§è¡Œå•ç‹¬æ„å»ºã€‚è¿™é‡Œ Gradle æä¾›äº†ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•° <code>-u</code> æˆ– <code>--no-search-upward</code> æ¥æ§åˆ¶ Gradle ä¸å»çˆ¶ç›®å½•æœå¯» <code>settings</code> æ–‡ä»¶ã€‚</p>\n<p>ã€€ã€€é»˜è®¤æƒ…å†µä¸‹ï¼ŒGradle ä¼šé‡‡ç”¨<code>settings.gradle</code>ä½œä¸ºæ–‡ä»¶åå»æŸ¥æ‰¾ï¼Œä½†å¦‚æœå¤„äºæŸç§ä¸å¯æè¿°çš„åŸå› è¦é‡‡ç”¨å…¶å®ƒåç§°çš„è¯ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œè°ƒç”¨å‘½ä»¤æ—¶å¯ä»¥é€šè¿‡<code>-c</code>æˆ–è€…<code>--settings-file</code>å‚æ•°æ¥æŒ‡å®š<code>settings</code>æ–‡ä»¶çš„ä½ç½®ä»¥åŠåç§°ã€‚</p>\n<blockquote>\n<p>tip: é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸å­˜åœ¨å­¤ç«‹çš„å­æ¨¡å—ï¼Œæ‰€ä»¥æ„å»ºçš„æ‰§è¡Œé¡ºåºå¾€å¾€æ˜¯ç”±ä¾èµ–é¡ºåºæ‰€å†³å®šçš„ã€‚ä½†å¦‚æœæ— æ³•é€šè¿‡ä¾èµ–é¡ºåºå†³å®šï¼Œé‚£ä¹ˆ Gradle ä¼šç®€å•çš„æŒ‰ç…§é¦–å­—æ¯é¡ºåºå†³å®šæ„å»ºé¡ºåºã€‚</p>\n</blockquote>\n<h3><span id=\"build-wen-jian\">buildæ–‡ä»¶</span><a href=\"#build-wen-jian\" class=\"header-anchor\">#</a></h3><p>ã€€ã€€åœ¨æ ¹é¡¹ç›®ä¸‹ï¼Œé™¤äº† <code>settings.gradle</code> æ–‡ä»¶ä¹‹å¤–ï¼Œé€šå¸¸è¿˜éœ€è¦æä¾›ä¸€ä¸ª <code>build.gradle</code> æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ç”¨ä»¥å®šä¹‰å­æ¨¡å—è¡Œä¸ºä»¥åŠæè¿°é¡¹ç›®çš„ä¸€äº›å…¬å…±æ’ä»¶ã€å±æ€§ã€ä¾èµ–ç­‰ã€‚</p>\n<p>ã€€ã€€ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œå®šä¹‰äº†æ‰€æœ‰æ¨¡å—å…±äº«çš„groupã€ç‰ˆæœ¬å·ï¼Œæ‰€æœ‰å­æ¨¡å—å…±äº«çš„æ’ä»¶ï¼Œä»¥åŠé’ˆå¯¹<code>main</code>é¡¹ç›®çš„å®šåˆ¶åŒ–é…ç½®ã€‚</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ‰€æœ‰æ¨¡å—éƒ½é‡‡ç”¨ç»Ÿä¸€çš„ç‰ˆæœ¬å·ä»¥åŠgroupName</span></span><br><span class=\"line\">allprojects &#123;</span><br><span class=\"line\">    group = <span class=\"string\">&#x27;org.pkaq.gradle.multi&#x27;</span></span><br><span class=\"line\">    version = <span class=\"string\">&quot;0.1.0&quot;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä¸ºæ‰€æœ‰å­æ¨¡å—éƒ½åº”ç”¨javaæ’ä»¶</span></span><br><span class=\"line\">subprojects &#123;</span><br><span class=\"line\">   apply <span class=\"attr\">plugin:</span> <span class=\"string\">&#x27;java&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//ä¸ºmainæ¨¡å—å®šä¹‰ç‰¹å®šè¡Œä¸º,é‡‡ç”¨waræ’ä»¶å¹¶ä¸”ä¾èµ–baseæ¨¡å—</span></span><br><span class=\"line\">project(<span class=\"string\">&#x27;:main&#x27;</span>)&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\tapply <span class=\"attr\">plugin:</span> <span class=\"string\">&#x27;war&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">\tdependencies &#123;</span><br><span class=\"line\">    \tcompile  project(<span class=\"string\">&#x27;:base&#x27;</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ã€€ã€€å¦‚æœæ‚¨é˜…è¯»äº†ä¸Šä¸€å°èŠ‚ï¼Œ<code>settings</code>æ–‡ä»¶æ˜¯å¯¹<code>Settings</code>æ¥å£çš„è„šæœ¬åŒ–ç¼–ç¨‹å®ç°ï¼Œé‚£ä¹ˆæ­¤å¤„åŒç†ï¼Œå€Ÿç”± <code>Project</code> APIï¼Œå¯å¯¹æ¨¡å—çš„è¡Œä¸ºè¿›è¡Œå®šåˆ¶ã€‚</p>\n<table>\n<thead>\n<tr>\n<th>æ–¹æ³•å</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>allprojects</td>\n<td>é…ç½®å½“å‰æ¨¡å—ä»¥åŠæ‰€æœ‰å­æ¨¡å—è¡Œä¸º</td>\n</tr>\n<tr>\n<td>subprojects</td>\n<td>é…ç½®æ‰€æœ‰å­æ¨¡å—è¡Œä¸º</td>\n</tr>\n<tr>\n<td>project</td>\n<td>é…ç½®æŒ‡å®šå­æ¨¡å—è¡Œä¸º</td>\n</tr>\n</tbody></table>\n<p>ã€€ã€€å¯ä»¥æŸ¥é˜…ã€€<a href=\"https://docs.gradle.org/current/dsl/org.gradle.api.Project.html\">&gt; Project DSL &lt;</a> äº†è§£ Project æ¥å£çš„æ›´å¤šæ“ä½œã€‚</p>\n<p>ã€€ã€€æ­¤æ—¶å¯ä»¥é€šè¿‡æ‰§è¡Œ  <code> gradle build </code> æ¥è¿›è¡Œæ„å»ºï¼Œè¿™ä¼šæŒ‰ç…§ä¾èµ–çš„é¡ºåºæ„å»ºæ‰€æœ‰å­æ¨¡å—ï¼Œå¦‚æœè¦å•ç‹¬æ„å»ºæŸä¸ªå­æ¨¡å—é‚£ä¹ˆå¯ä»¥å‚ç…§ <code>gradle :main:build</code> çš„æ–¹å¼è¿›è¡Œå•ç‹¬æ„å»ºï¼Œæ­£å¦‚ä½ æ‰€è§ç”¨<code>:</code>åˆ†éš”é¡¹ç›®å’Œ<code>task</code>å³å¯ã€‚</p>\n<h3><span id=\"fen-chi-pei-zhi\">åˆ†ç¦»é…ç½®</span><a href=\"#fen-chi-pei-zhi\" class=\"header-anchor\">#</a></h3><p>ã€€ã€€å½“é¡¹ç›®è¶³å¤Ÿå¤æ‚çš„æ—¶å€™ï¼Œé‡‡ç”¨é›†ä¸­åŒ–é…ç½®æ˜¾ç„¶ä¸æ˜¯ä¸€ä¸ªå¥½è®¡è°‹ï¼Œå°¤å…¶æ˜¯å¦‚æœä½ æœ‰å‡ åä¸ªæ¨¡å—çš„çš„æ—¶å€™ï¼Œå½“ä½ æ‰“å¼€ä¸€ä¸ªå‡ ç™¾è¡Œçš„è„šæœ¬æ— ç–‘ä¼šæ„Ÿåˆ°ä¸€ç§ä¸ç”±è‡ªä¸»çš„æ¶å¿ƒåœ¨èƒŒåæ‹æ‹ä½ çš„è‚©è†€è¯´:â€å…„å¼Ÿ åå§â€â€¦.<br>ã€€ã€€æ­¤æ—¶ï¼Œå°†ä¸åŒé¡¹ç›®çš„å®šåˆ¶è¡Œä¸ºåˆ†ç¦»åˆ°å„è‡ªçš„è„šæœ¬é‡Œæ— ç–‘ä¼šæ˜¾è‘—çš„å‡è½»ä½ çš„é¥±è…¹æ„Ÿã€‚è¿™ä¸ä»…å¯ä»¥æ˜¯é¡¹ç›®ç»“æ„çœ‹èµ·æ¥æ›´åŠ æ¸…æ™°ï¼Œè„šæœ¬æ›´åŠ æ˜“è¯»ï¼Œåˆ†ç¦»åŒ–çš„é…ç½®è¿˜å¯ä»¥è®©ä½ æ›´å¥½çš„å…³æ³¨å­æ¨¡å—çš„ç‰¹å®šè¡Œä¸ºã€‚<br>ã€€ã€€è¦åˆ†ç¦»æ¨¡å—é…ç½®åªéœ€è¦å¾ˆç®€å•çš„ä¸¤æ­¥ï¼š</p>\n<ol>\n<li>åœ¨å­æ¨¡å—å»ºç«‹ <code>build.gradle</code> æ–‡ä»¶</li>\n<li>å°†åŸæ¥çš„ <code>project(&#39;:xxx&#39;)&#123;&#125;</code> å†…çš„è„šæœ¬ç§»åŠ¨åˆ°ä¸Šé¢å»ºç«‹çš„æ–‡ä»¶ä¸­å»</li>\n</ol>\n<p>ã€€ã€€ä¸‹é¢çš„å›¾å±•ç¤ºäº†ä¸€ä¸ªç¨å¾®å¤æ‚ä¸€ç‚¹çš„<code>åˆ†å±‚å¸ƒå±€çš„</code>ã€<code>å¤šæ¨¡å—çš„</code>ã€<code>åˆ†ç¦»é…ç½®çš„</code> çš„å¤šæ¨¡å—é¡¹ç›®ç¤ºä¾‹ï¼Œå…¶ä¸­æ‰€æœ‰çš„äºŒçº§æ¨¡å—éƒ½ä¾èµ–<code>base</code>ï¼Œæœ€ç»ˆçš„<code>weball</code>åˆä¾èµ–äºæ‰€æœ‰çš„äºŒçº§æ¨¡å—ã€‚<br> å…·ä½“ä»£ç å¯ä»¥æŸ¥çœ‹ <a href=\"https://github.com/GradleCN/GradleSide/tree/master/01-multi-project\">&gt; å°±æ˜¯è¿™é‡Œ &lt;</a><br><img src=\"multi.jpg\"></p>\n<h3><span id=\"shui-ping-bu-ju-he-fen-ceng-bu-ju\">æ°´å¹³å¸ƒå±€å’Œåˆ†å±‚å¸ƒå±€</span><a href=\"#shui-ping-bu-ju-he-fen-ceng-bu-ju\" class=\"header-anchor\">#</a></h3><p>ã€€ã€€å¦‚æœä½ é˜…è¯»äº†å‰é¢çš„å†…å®¹ï¼Œé‚£ä¹ˆä½ å·²ç»æŒæ¡äº†åˆ†å±‚å¸ƒå±€ã€‚æ²¡é”™ï¼ŒGradle é»˜è®¤å³æ˜¯é‡‡ç”¨çš„åˆ†å±‚å¸ƒå±€ã€‚åªéœ€è¦æ­£ç¡®çš„é…ç½® <code>settings</code> æ–‡ä»¶å³å¯ã€‚<br>ã€€ã€€æŸäº›æƒ…å†µä¸‹ï¼Œè‹¥æ˜¯å‡ºäºä¸€äº›ä¸å¯æè¿°çš„åŸå› éœ€è¦è¿›è¡Œæ°´å¹³å¸ƒå±€ï¼Œé‚£ä¹ˆ Gradle ä¹Ÿæä¾›äº†è‰¯å¥½çš„æ”¯æŒã€‚å¦‚æœä½ ä¹‹å‰æ›¾ç»ç¿»é˜…è¿‡ <code>Settings</code> æ¥å£çš„æ‰‹å†Œï¼Œé‚£ä¹ˆæˆ–è®¸ä½ å·²ç»å‘ç°<code>Settintgs</code>æ¥å£æä¾›äº†ä¸€ä¸ª<code>includeFlat</code>æ–¹æ³•ï¼Œå€ŸåŠ©æ­¤æ–¹æ³•å³å¯å®ç°æ°´å¹³å¸ƒå±€çš„å¤šæ¨¡å—é¡¹ç›®ã€‚<br>  <figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">includeFlat  <span class=\"string\">&#x27;base&#x27;</span></span><br></pre></td></tr></table></figure></p>\n<p>ç”±äºæ­¤å¤„<code>main</code>å³æ˜¯æ ¹é¡¹ç›®ï¼Œæ‰€ä»¥æ— éœ€å†åŒ…å«<code>main</code></p>\n<p>å®Œæ•´ç¤ºä¾‹ -&gt;ã€€<a href=\"https://github.com/GradleCN/GradleSide/tree/master/16-multi-project-flat\"> &gt; æ°´å¹³å¸ƒå±€çš„å¤šæ¨¡å—é¡¹ç›®ç¤ºä¾‹ &lt; </a></p>\n<p>å¿ƒæ³•åœ¨äºä¸¤ç‚¹:</p>\n<p> 1.æ ¹é¡¹ç›®ä¸è¢«ä¾èµ–çš„é¡¹ç›®(åœ¨æ°´å¹³æ„ä¹‰ä¸Šçš„å­é¡¹ç›®,è§†è§‰ä¸Šæ ¹é¡¹ç›®çš„å…„å¼Ÿé¡¹ç›®)ä¿æŒå¹³çº§ã€‚<br> 2.é…ç½®æ ¹é¡¹ç›®çš„  setting.gradle  ï¼Œ é‡‡ç”¨  includeFlat  æ¥æè¿°å­é¡¹ç›®è·¯å¾„(ç”±äºé‡‡ç”¨çš„æ˜¯æ°´å¹³å¸ƒå±€,é»˜è®¤æ ¹è·¯å¾„å°±æ˜¯å½“å‰æ ¹é¡¹ç›®çš„ä¸Šçº§è·¯å¾„,æ‰€ä»¥æ— éœ€ç”¨../ä¸Šè·³)</p>\n","categories":["Build Tools"],"tags":["Gradle"]},{"title":"å¤šæ¨¡å—é¡¹ç›®ä¹‹ -  spring boot + gradle + æ„å»ºå…¬å…±jspé¡µé¢çš„å¤šæ¨¡å—é¡¹ç›®","url":"https://pkaq.org/2016/12/02/sb-gradle-commonjsp/","content":"<p>æ ‡é¢˜å…š!!!!</p>\n<h4><span id=\"peng-zhi-yuan-li\">çƒ¹åˆ¶åŸç†</span><a href=\"#peng-zhi-yuan-li\" class=\"header-anchor\">#</a></h4><p>Servlet 3.1 è§„èŒƒé‡Œ jaråŒ…ä¸­<code>META-INF/resources/</code>ä¸‹çš„æ–‡ä»¶ä¼šè¢«è§†ä¸ºæ ¹ç›®å½•æ–‡ä»¶è¿›è¡Œæ­£å¸¸è®¿é—® , è¿™ä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å°†æŸäº› é™æ€é¡µé¢/å›¾ç‰‡/æ ·å¼/js ç­‰æ‰“åˆ°jaråŒ…é‡Œå½“åšä¾èµ–jaråŒ…å¼•ç”¨ , åƒ<code>webjars</code>åŸºæœ¬å°±æ˜¯è¿™ä¹ˆæçš„.å½“ç„¶ å¦‚æœä½ åœ¨æå‰åç«¯åˆ†ç¦»ã€gulpã€webpackä»€ä¹ˆçš„è¿™ç§æ–¹å¼åŸºæœ¬ä¹Ÿä¸ç”¨è€ƒè™‘äº†ã€‚   </p>\n<p>Servlet 3.1 ä¸­æ–‡è¯‘æœ¬ å¼ å¼€æ¶› ç¿»è¯‘ç‰ˆä¸‹è½½ <a href=\"http://jinnianshilongnian.iteye.com/blog/1912455\">&gt; ç‚¹ä¼ é€é—¨ &lt;</a></p>\n<a id=\"more\"></a> \n\n<ul>\n<li><p>å¼•ç”¨.1</p>\n<blockquote>\n<p>é™¤äº† é™æ€èµ„æºå’Œ WEB-INF/lib ç›®å½•ä¸‹æ‰“åŒ…åœ¨ JAR æ–‡ä»¶ä¸­ META-INF/resources ç›®å½•ä¸‹çš„ JSP æ–‡ä»¶ä¹‹å¤–ï¼ŒWEB-INF ç›®å½•ä¸‹åŒ…å«çš„å…¶ä»–ä»»ä½•æ–‡ä»¶éƒ½ä¸èƒ½ç”±å®¹å™¨ç›´æ¥æä¾›ç»™å®¢æˆ·ç«¯è®¿é—®ã€‚<br>serverlet 3.1 è§„èŒƒ - 10.5   </p>\n</blockquote>\n</li>\n<li><p>å¼•ç”¨.2</p>\n<blockquote>\n<ol start=\"4\">\n<li>æ·»åŠ äº†ä» JAR æ–‡ä»¶ä¸­åŠ è½½é™æ€èµ„æºå’Œ JSP çš„æ”¯æŒï¼Œå…¶åŒ…å«åœ¨ç»‘å®šåœ¨ WEB-INF/lib ç›®å½•ä¸­çš„ JAR æ–‡ä»¶çš„ META-INF/resources ç›®å½•ä¸­<br>å˜æ›´å†å² A.3   </li>\n</ol>\n</blockquote>\n</li>\n</ul>\n<h4><span id=\"peng-zhi-fang-fa\">çƒ¹åˆ¶æ–¹æ³•</span><a href=\"#peng-zhi-fang-fa\" class=\"header-anchor\">#</a></h4><ol>\n<li>æ·»åŠ spring boot ä¾èµ–,å¦‚æœä¸æƒ³ç”¨å˜é‡å®šä¹‰ç‰ˆæœ¬å·å¯ä»¥ç›´æ¥æ’¸ç‰ˆæœ¬å·<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">compile <span class=\"string\">&quot;org.springframework.boot:spring-boot-starter-web:$&#123;bootVersion&#125;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;org.apache.tomcat.embed:tomcat-embed-jasper:$&#123;tomcat_embed&#125;&quot;</span></span><br></pre></td></tr></table></figure></li>\n<li>ç¼–å†™controller<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Controller</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TigerCtrl</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping(&quot;/&quot;)</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ModelAndView <span class=\"title\">tiger</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;Soft kitty,warm kitty Little ball of fur .&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ModelAndView(<span class=\"string\">&quot;tiger&quot;</span>,<span class=\"string\">&quot;words&quot;</span>,<span class=\"string\">&quot;Roar ~ Roar ~ &quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n<li>ç¼–å†™é¡µé¢<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Title<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">alt</span>=<span class=\"string\">&quot;j2ee&quot;</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;static/duke.jpg&quot;</span> <span class=\"attr\">width</span>=<span class=\"string\">&quot;190&quot;</span> <span class=\"attr\">height</span>=<span class=\"string\">&quot;253&quot;</span>/&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    String words = String.valueOf(request.getAttribute(&quot;words&quot;));</span><br><span class=\"line\">    out.println(&quot;Tiger said : &quot; + words);</span><br><span class=\"line\">%&gt;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li>\n<li>æ·»åŠ å…¬å…±jspé¡µé¢æ¨¡å—ä¾èµ–<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">compile    project(<span class=\"string\">&quot;:webpage&quot;</span>)</span><br></pre></td></tr></table></figure>\n<h4><span id=\"wan-zheng-dai-ma\">å®Œæ•´ä»£ç </span><a href=\"#wan-zheng-dai-ma\" class=\"header-anchor\">#</a></h4></li>\n</ol>\n<p><a href=\"https://github.com/pkaq/GradleSide/tree/master/15-multi-project-springboot\"> &gt; ç‚¹å‡»è¿™é‡Œçœ‹å®Œæ•´ä»£ç  &lt; </a></p>\n","categories":["Build Tools","Spring"],"tags":["Gradle","Spring Boot"]},{"title":"RNï¼ˆreact nativeï¼‰å…¥å‘æŒ‡å—-10,ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ","url":"https://pkaq.org/2016/04/24/rn-lifecycle-10/","content":"<p><img src=\"rn-lifecycle-10/lifecycle.jpg\" alt=\"RNç»„ä»¶çš„å£°æ˜å‘¨æœŸ\"></p>\n<a id=\"more\"></a>\n\n<p><strong>åˆ›å»ºé˜¶æ®µ</strong><br>getDefaultProps : åœ¨åˆ›å»ºç±»çš„æ—¶å€™è°ƒç”¨,å¤„ç†propsçš„é»˜è®¤å€¼,getDefaultPropsä»…ä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œè¿™é‡Œçš„æ„æ€æ˜¯æ— è®ºä½ ä¼šåˆ›å»ºå¤šå°‘ä¸ªReactElementï¼Œè¿™ä¸ªå‡½æ•°éƒ½åªæ‰§è¡Œä¸€æ¬¡ï¼Œä¹‹åçš„é»˜è®¤propséƒ½ä¼šç›´æ¥ä½¿ç”¨æ”¹å‡½æ•°çš„è¿”å›å€¼ã€‚</p>\n<p><strong>å®ä¾‹åŒ–é˜¶æ®µ</strong></p>\n<ul>\n<li><p>constructor(getInitialState):åˆå§‹åŒ–ç»„ä»¶stateçš„å€¼,è¿”å›å€¼ä¼šèµ‹å€¼ç»™this.stateå±æ€§,è¿™æ˜¯ES6ç‰ˆæœ¬çš„å†™æ³•,ES5ä¸­ä½¿ç”¨çš„æ˜¯getInitialState.åœ¨ES6çš„ç‰ˆæœ¬ä¸­æœ‰äº›ä¸å¤ªä¸€æ ·ï¼Œç›¸å¯¹ä¸getDefaultPropsï¼ŒES6å°†é»˜è®¤å±æ€§å¯¹è±¡ä½œä¸ºäº†æ„é€ å‡½æ•°çš„ä¸€ä¸ªå±æ€§ï¼Œè€ŒgetInitialStateåˆ™å˜æˆäº†åœ¨å…¶æ„é€ å™¨å‡½æ•°ä¸­ç»™this.stateèµ‹å€¼.</p>\n</li>\n<li><p>componentWillMount:renderä¹‹å‰è°ƒç”¨</p>\n</li>\n<li><p>render:æ¸²æŸ“å¹¶è¿”å›ä¸€ä¸ªè™šæ‹Ÿdom</p>\n</li>\n<li><p>componentDidMount:renderä¹‹åè°ƒç”¨,åœ¨ç»„ä»¶æ¸²æŸ“å®Œæˆåè°ƒç”¨ä¸€æ¬¡.</p>\n</li>\n<li><p>p.s:stateå±æ€§,ä¸»è¦ç”¨æ¥å­˜å‚¨ç»„ä»¶è‡ªèº«éœ€è¦çš„æ•°æ®,æ¯æ¬¡æ•°æ®çš„æ›´æ–°éƒ½æ˜¯é€šè¿‡ä¿®æ”¹stateå±æ€§çš„å€¼,rnå†…éƒ¨ä¼šç›‘å¬stateå±æ€§,ä¸€æ—¦å˜åŒ–å³ä¼šè§¦å‘renderæ–¹æ³•æ›´æ–°dom</p>\n</li>\n</ul>\n<p><strong>è¿è¡Œé˜¶æ®µ</strong></p>\n<ul>\n<li>componentWillReceiveProps:ç”¨æˆ·æ“ä½œåæˆ–çˆ¶ç»„ä»¶æ›´æ–°å,æ ¹æ®ç”¨æˆ·çš„æ“ä½œè¡Œä¸ºå¯¹é¡µé¢è¿›è¡Œè°ƒæ•´</li>\n<li>shouldComponentUpdate:æ‹¦æˆªæ–°çš„propsæˆ–state</li>\n<li>componentWillUpdate:shouldComponentUpdateè¿”å›trueçš„æƒ…å†µä¸‹æ‰§è¡Œ</li>\n<li>componentDidUpdate:ç»„ä»¶æ›´æ–°åæ‰§è¡Œ</li>\n</ul>\n<p><strong>é”€æ¯é˜¶æ®µ</strong></p>\n<ul>\n<li><ul>\n<li>componentWillUnmount:é”€æ¯æ—¶è°ƒç”¨,é€šå¸¸åšä¸€äº›å–æ¶ˆç»‘å®š</li>\n</ul>\n</li>\n</ul>\n<p><strong>p.s</strong>ï¼šç»å¯¹ä¸è¦åœ¨componentWillUpdateå’ŒcomponentDidUpdateä¸­è°ƒç”¨this.setStateæ–¹æ³•ï¼Œå¦åˆ™å°†å¯¼è‡´æ— é™å¾ªç¯è°ƒç”¨ã€‚</p>\n","categories":["React Native"],"tags":["React Native"]},{"title":"RNï¼ˆreact nativeï¼‰å…¥å‘æŒ‡å—-12,æ‰“æ­£å¼ç­¾ååŒ…å’Œå‘å¸ƒ","url":"https://pkaq.org/2016/04/24/rn-pkq-12/","content":"<p><strong>0.å¯åŠ¨æ‰“åŒ…æœåŠ¡å™¨</strong><br>é¦–å…ˆæ‰§è¡Œ<br>react-native startå¯åŠ¨æ‰“åŒ…æœåŠ¡å™¨,æ­¤æ—¶å¯ä»¥é€šè¿‡chromeæ‰“å¼€<code>http://localhost:8081/index.android.bundle?platform=android</code>è¯·æ±‚è·å–æ‰“åŒ…åçš„jsæ–‡ä»¶,è¯¥æ–‡ä»¶æ˜¯é€šè¿‡åˆ†ærnä»£ç åŠ¨æ€ç”Ÿæˆçš„,åŒ…å«äº†åº”ç”¨ä¸­çš„å…¨éƒ¨é€»è¾‘.</p>\n<a id=\"more\"></a>\n<p><strong>1.ç”Ÿæˆç­¾åç§˜é’¥</strong><br>ç”¨JDKè‡ªå¸¦çš„keytoolå·¥å…·ç”Ÿæˆè¯ä¹¦ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">keytool -genkey -v -keystore app-key.keystore -alias app-alias -keyalg RSA -keysize 2048 -validity 10000</span><br></pre></td></tr></table></figure>\n\n<!-- more -->\n\n<blockquote>\n<p>Keytool æ˜¯ä¸€ä¸ªJava æ•°æ®è¯ä¹¦çš„ç®¡ç†å·¥å…· ,Keytool å°†å¯†é’¥ï¼ˆkeyï¼‰å’Œè¯ä¹¦ï¼ˆcertificatesï¼‰å­˜åœ¨ä¸€ä¸ªç§°ä¸ºkeystoreçš„æ–‡ä»¶ä¸­ã€‚<br>åœ¨keystoreé‡Œï¼ŒåŒ…å«ä¸¤ç§æ•°æ®ï¼š<br>(1)å¯†é’¥å®ä½“ï¼ˆKey entityï¼‰â€”â€”å¯†é’¥ï¼ˆsecret keyï¼‰åˆæˆ–è€…æ˜¯ç§é’¥å’Œé…å¯¹å…¬é’¥ï¼ˆé‡‡ç”¨éå¯¹ç§°åŠ å¯†ï¼‰<br>(2)å¯ä¿¡ä»»çš„è¯ä¹¦å®ä½“ï¼ˆtrusted certificate entriesï¼‰â€”â€”åªåŒ…å«å…¬é’¥</p>\n<p>|-v           |æ˜¾ç¤ºå¯†é’¥åº“ä¸­çš„è¯ä¹¦è¯¦ç»†ä¿¡æ¯|<br>|-alias       |äº§ç”Ÿåˆ«å,æ¯ä¸ªkeystoreéƒ½å…³è”è¿™ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„aliasï¼Œè¿™ä¸ªaliasé€šå¸¸ä¸åŒºåˆ†å¤§å°å†™|<br>|-keystore    |æŒ‡å®šå¯†é’¥åº“çš„åç§°(äº§ç”Ÿçš„å„ç±»ä¿¡æ¯å°†ä¸åœ¨.keystoreæ–‡ä»¶ä¸­)|<br>|-keyalg      |æŒ‡å®šå¯†é’¥çš„ç®—æ³• (å¦‚ RSA  DSAï¼ˆå¦‚æœä¸æŒ‡å®šé»˜è®¤é‡‡ç”¨DSAï¼‰)|<br>|-validity    |æŒ‡å®šåˆ›å»ºçš„è¯ä¹¦æœ‰æ•ˆæœŸå¤šå°‘å¤©|<br>|-keysize     |æŒ‡å®šå¯†é’¥é•¿åº¦|</p>\n</blockquote>\n<p>æ­¤æ—¶åœ¨ä½ æ‰§è¡Œå‘½ä»¤çš„æ‰€åœ¨ç›®å½•ä¼šç”Ÿæˆä¸€ä¸ª<code>app-key.keystore</code>çš„ç§˜é’¥æ–‡ä»¶</p>\n<p><strong>2.è½¬ç§»bundleæ–‡ä»¶</strong><br>æŸ¥çœ‹<code>android/app/src/main</code>æ˜¯å¦æœ‰assetsæ–‡ä»¶å¤¹,è‹¥ä¸å­˜åœ¨åˆ›å»ºä¹‹,ç„¶åæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤,å°†bundleæ–‡ä»¶ä¸‹è½½å¹¶å­˜å‚¨åˆ°assetsæ–‡ä»¶å¤¹å†…</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -k &quot;http://localhost:8081/index.android.bundle&quot; &gt; android/app/src/main/assets/index.android.bundle</span><br></pre></td></tr></table></figure>\n<p>p.s:ç”±äºwinä¸‹ä¸å­˜åœ¨crulå‘½ä»¤,å»ºè®®ç›´æ¥ç”¨å®‰è£…gitåè‡ªå¸¦çš„git bashæ‰§è¡Œ</p>\n<p><strong>3.é…ç½®gradleè„šæœ¬</strong><br>å°†å¦‚ä¸‹è„šæœ¬æ”¾ç½®åˆ°<code>android/build.gradle</code>ä¸­çš„defaultConfigä¸‹é¢.</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">signingConfigs&#123;</span><br><span class=\"line\">     release &#123;</span><br><span class=\"line\">         storeFile file(<span class=\"string\">&quot;/app-key.keystore&quot;</span>)</span><br><span class=\"line\">         storePassword <span class=\"string\">&quot;å¯†ç &quot;</span></span><br><span class=\"line\">         keyAlias <span class=\"string\">&quot;keyAliasçš„åå­—&quot;</span></span><br><span class=\"line\">         keyPassword <span class=\"string\">&quot;å¯†ç &quot;</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n<p>ç„¶ååœ¨buildTypesé‡Œæ·»åŠ </p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//å¼•ç”¨ç­¾åé…ç½®</span></span><br><span class=\"line\">signingConfig signingConfigs.release</span><br></pre></td></tr></table></figure>\n<p><strong>4.ä»£ç æ··æ·†</strong><br>ä¿®æ”¹<code>android/app/build.gradle</code>å¼€å¯æ··æ·†,å¦‚æœéœ€è¦é¢å¤–çš„æ··æ·†é…ç½®å¯ä»¥ä¿®æ”¹<code>proguard-rules.pro</code>æ–‡ä»¶.</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> enableProguardInReleaseBuilds = <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n<p>5.å¼€å§‹æ‰“åŒ…<br>æ­¤æ—¶,åˆ‡æ¢åˆ°<code>android/app</code>ç›®å½•ä¸‹,æ‰§è¡Œ<code>gradlew aR</code>,ç»è¿‡ä¸€æ®µä¸ä½ çš„æœºå™¨æ€§èƒ½ç›¸å…³çš„æ—¶é—´ç­‰å¾…å,ä½ å¯ä»¥åœ¨<code>android/pp/build/outputs/apk</code>ä¸‹æ‰¾åˆ°ä¸¤ä¸ªapkæ–‡ä»¶,æ­¤æ—¶ä½ å°±å¯ä»¥æŠŠapkæ–‡ä»¶äº¤ç»™å…¶ä»–äººè¿›è¡Œå®‰è£…äº†</p>\n<p><strong>p.s:</strong></p>\n<ul>\n<li><p>aRå³assembleReleaseçš„çŸ­ç®€å†™å½¢å¼,åœ¨gradleä¸­,å¯ä»¥é‡‡ç”¨é©¼å³°ä»»åŠ¡çš„é¦–å­—æ¯è°ƒç”¨ä»»åŠ¡,å‰ææ˜¯ä¸è¦å­˜åœ¨ç›¸åŒçš„.</p>\n</li>\n<li><p>å¦å¤–å¦‚æœä½ æœ¬åœ°å®‰è£…äº†gradleä¹Ÿå¯ä»¥é‡‡ç”¨ä½ æœ¬åœ°çš„gradle,ä½†éœ€è¦æ³¨æ„çš„æ˜¯<a href=\"http://tools.android.com/tech-docs/new-build-system/version-compatibility\">androidæ’ä»¶ç‰ˆæœ¬å’Œgradleä¹‹é—´çš„å¯¹åº”å…³ç³»</a>,å…·ä½“å¯ä»¥ç‚¹å‡»é“¾æ¥è¿›è¡Œäº†è§£.æ’ä»¶ç‰ˆæœ¬å¯ä»¥é€šè¿‡ä¿®æ”¹<code>android/build.gradle</code>ä¸­çš„<code> dependencies &#123;        classpath &#39;com.android.tools.build:gradle:1.3.1&#39;    &#125;</code><br>è¿›è¡Œä¿®æ”¹</p>\n</li>\n<li><p>å…³äºgradleç¯å¢ƒçš„é…ç½®å¯ä»¥å‚è€ƒ,<a href=\"http://gradlecn.coding.io/download/\">gradleä¸‹è½½å’Œå®‰è£…</a></p>\n</li>\n</ul>\n<p><strong>çƒ­æ›´æ–°</strong><br>å¦‚æœè¦å®ç°çƒ­éƒ¨ç½²,åœ¨ä»£ç ä¸­æ·»åŠ ä»£ç æ£€æŸ¥è¿œç¨‹æœåŠ¡å™¨,æ›´æ–°assetä¸­çš„bundleæ–‡ä»¶å³å¯å®ç°çƒ­æ›´æ–°</p>\n","categories":["React Native"],"tags":["React Native"]},{"title":"RNï¼ˆreact nativeï¼‰å…¥å‘æŒ‡å—-08,å¦‚ä½•åŠ è½½è¿œç¨‹æ•°æ®","url":"https://pkaq.org/2016/04/20/rn-fetch-08/","content":"<h4><span id=\"qian-yan\">å‰è¨€</span><a href=\"#qian-yan\" class=\"header-anchor\">#</a></h4><p>ã€€ã€€é€šè¿‡å‰é¢çš„ä¸€ç³»åˆ—è”ç³»ç°åœ¨é¡µé¢å¸ƒå±€æŠ€å·§å·²ç»æŒæ¡,é¡µé¢è·³è½¬å·²ç»æå®š,é¡µé¢ä¹‹é—´çš„å‚æ•°ä¼ é€’ä¹Ÿå·²ç»æå®š,æˆ‘ä»¬çš„ä»£ç ä¹Ÿè¿›è¡Œäº†åˆ†å±‚ç»„ç»‡,ä½†æˆ‘ä»¬çš„åº”ç”¨åˆ°ç°åœ¨ä¸ºæ­¢éƒ½æ˜¯æ­»çš„.å¦‚ä½•è®©åº”ç”¨æ´»èµ·æ¥è¯»å–è¿œç¨‹æ•°æ®å‘¢.æ­¤ç¯‡æˆ‘ä»¬ä¾¿æ˜¯ç”¨fetchæ¥æ‹‰å»è¿œç¨‹æ•°æ®<br>ã€€ã€€å½“ç„¶å¦‚æœä½ æƒ³äº†è§£æ›´å¤šæ–¹å¼å’Œå†…å®¹æ¬¢è¿<a href=\"http://reactnative.cn/docs/0.23/network.html#content\">é˜…è¯»å®˜æ–¹æ–‡æ¡£</a></p>\n<h4><span id=\"kai-shi\">å¼€å§‹</span><a href=\"#kai-shi\" class=\"header-anchor\">#</a></h4><a id=\"more\"></a>\n<p>fetchå¯ä»¥æ¥å—ä¸¤ä¸ªå‚æ•°,<code>fetch(string,object)</code>,ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¯·æ±‚çš„è¿œç¨‹åœ°å€;ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯é€‰å¯¹è±¡å¯ä»¥è®¾å®šheader,method,bodyç­‰</p>\n<p>ç°åœ¨åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç </p>\n<figure class=\"highlight less\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">_onRegister</span>()&#123;    </span><br><span class=\"line\">   <span class=\"selector-tag\">fetch</span>(<span class=\"string\">&#x27;http://192.168.191.1:8080/home/register&#x27;</span>, &#123;</span><br><span class=\"line\">      <span class=\"comment\">//è¯·æ±‚ç±»å‹ </span></span><br><span class=\"line\">      <span class=\"attribute\">method</span>: <span class=\"string\">&#x27;POST&#x27;</span>,      </span><br><span class=\"line\">      <span class=\"comment\">//è¯·æ±‚header</span></span><br><span class=\"line\">      <span class=\"attribute\">headers</span>: &#123;</span><br><span class=\"line\">        <span class=\"string\">&#x27;Accept&#x27;</span>: <span class=\"string\">&#x27;application/json&#x27;</span>,</span><br><span class=\"line\">        <span class=\"string\">&#x27;Content-Type&#x27;</span>: <span class=\"string\">&#x27;application/json&#x27;</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"comment\">// å‘é€è¯·æ±‚å‚æ•°</span></span><br><span class=\"line\">      <span class=\"attribute\">body</span>: JSON.stringify(&#123;</span><br><span class=\"line\">        <span class=\"attribute\">name</span>: <span class=\"string\">&#x27;tom&#x27;</span>        </span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    &#125;)<span class=\"selector-class\">.then</span>((response) =&gt; response.json())</span><br><span class=\"line\">      <span class=\"selector-class\">.then</span>((jsonData) =&gt; &#123;</span><br><span class=\"line\">        <span class=\"comment\">// å›å†™æ•°æ®</span></span><br><span class=\"line\">        <span class=\"selector-tag\">this</span><span class=\"selector-class\">.setState</span>(&#123;</span><br><span class=\"line\">          <span class=\"attribute\">text </span>: jsonData.text</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">      <span class=\"selector-class\">.catch</span>((error) =&gt; &#123;</span><br><span class=\"line\">         <span class=\"selector-tag\">this</span><span class=\"selector-class\">.setState</span>(&#123;</span><br><span class=\"line\">          <span class=\"attribute\">text </span>: <span class=\"string\">&#x27;è·å–æœåŠ¡å™¨æ•°æ®é”™è¯¯&#x27;</span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>æ”¾ç½®ä¸€ä¸ªåŒºåŸŸæ¥æ˜¾ç¤ºæ•°æ®æ–‡æœ¬å¹¶ä¸”åœ¨æ³¨å†ŒæŒ‰é’®ä¸Šæ·»åŠ ä¸€ä¸ªç‚¹å‡»äº‹ä»¶,è¿™æ ·ç‚¹å‡»çš„æ—¶å€™å°±å¯ä»¥çœ‹åˆ°æ•°æ®å˜åŒ–äº†</p>\n<figure class=\"highlight dust\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">Text</span> <span class=\"attr\">style</span>=</span></span><span class=\"template-variable\">&#123;styles.welcome&#125;</span><span class=\"xml\"><span class=\"tag\">&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">  </span><span class=\"template-variable\">&#123;this.state.text&#125;</span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;/<span class=\"name\">Text</span>&gt;</span>  </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\">&lt;TouchableHighlight</span></span><br><span class=\"line\"><span class=\"xml\">    style=</span><span class=\"template-variable\">&#123;styles.th&#125;</span></span><br><span class=\"line\"><span class=\"xml\">    underlayColor=&quot;rgb(210, 230, 255)&quot;</span></span><br><span class=\"line\"><span class=\"xml\">    onPress=</span><span class=\"template-variable\">&#123;this._onRegister.bind(this)&#125;</span><span class=\"xml\">&gt;</span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">Text</span>&gt;</span>æ³¨å†Œ<span class=\"tag\">&lt;/<span class=\"name\">Text</span>&gt;</span>               </span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;/<span class=\"name\">TouchableHighlight</span>&gt;</span></span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>","categories":["React Native"],"tags":["React Native"]},{"title":"RNï¼ˆreact nativeï¼‰å…¥å‘æŒ‡å—-07,ä½¿ç”¨navigatorå®ç°é¡µé¢è·³è½¬","url":"https://pkaq.org/2016/04/18/rn-navigator-07/","content":"<h4><span id=\"qian-yan\">å‰è¨€</span><a href=\"#qian-yan\" class=\"header-anchor\">#</a></h4><p>ã€€ã€€æ­¤æ–‡å®Œå…¨å‚è€ƒReact-Nativeä¸­æ–‡ç¤¾åŒºçš„åšå®¢<a href=\"http://reactnative.cn/post/20\">æ–°æ‰‹ç†è§£navigatorçš„æ•™ç¨‹</a>è€Œæ¥,å»ºè®®ç›´æ¥è·³è½¬é“¾æ¥è¿›è¡Œè¯¦ç»†å­¦ä¹ ,ä¸ºé˜²æ­¢é“¾æ¥å¤±æ•ˆæˆ–ä¸å¯æŠ—åŠ›å› ç´ æ— æ³•è®¿é—®,ä¸ªäººæ•´ç†ç®€å•è®°å½•å¦‚ä¸‹.</p>\n<h4><span id=\"kai-shi\">å¼€å§‹</span><a href=\"#kai-shi\" class=\"header-anchor\">#</a></h4><p>ç”±äºå‰ä¸€ç¯‡æ–‡ç« å°†ä»£ç è¿›è¡Œäº†åˆ†å±‚æ•´ç†,æ‰€ä»¥æˆ‘ä»¬çš„<code>index.android.js</code>å·²ç»å˜å¾—ç›¸å¯¹ç®€æ´</p>\n<a id=\"more\"></a>\n\n<p><code>index.android.js</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&#x27;use strict&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> React,&#123;Navigator,AppRegistry&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react-native&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;<span class=\"comment\">/**å¼•å…¥Loginç»„ä»¶ */</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">import</span> Login <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./src/login/Login.js&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TaraRn</span> <span class=\"keyword\">extends</span> <span class=\"title\">React</span>.<span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">render</span>(<span class=\"params\"></span>)</span> &#123;</span><br><span class=\"line\">    &#123;<span class=\"comment\">/** é»˜è®¤ç»„ä»¶åç§°ä»¥åŠé»˜è®¤ç»„ä»¶ */</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> defaultName = <span class=\"string\">&quot;Login&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> defaultComponent = Login;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> (</span><br><span class=\"line\">     &lt;Navigator          </span><br><span class=\"line\">          <span class=\"comment\">//åˆå§‹åŒ–ç»„ä»¶</span></span><br><span class=\"line\">          initialRoute=&#123;&#123; <span class=\"attr\">name</span>: defaultName, <span class=\"attr\">component</span>: defaultComponent &#125;&#125;    </span><br><span class=\"line\">          <span class=\"comment\">//é¡µé¢åˆ‡æ¢æ•ˆæœ </span></span><br><span class=\"line\">          configureScene=&#123;<span class=\"function\">(<span class=\"params\">route</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> Navigator.SceneConfigs.VerticalDownSwipeJump;</span><br><span class=\"line\">          &#125;&#125;</span><br><span class=\"line\">          renderScene=&#123;<span class=\"function\">(<span class=\"params\">route, navigator</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> Component = route.component;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">Component</span> &#123;<span class=\"attr\">...route.params</span>&#125; <span class=\"attr\">navigator</span>=<span class=\"string\">&#123;navigator&#125;</span> /&gt;</span></span></span><br><span class=\"line\">          &#125;&#125; /&gt;</span><br><span class=\"line\">    )</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">AppRegistry.registerComponent(<span class=\"string\">&#x27;TaraRn&#x27;</span>, <span class=\"function\">() =&gt;</span> TaraRn);</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œæ¥è§£é‡Šä¸€ä¸‹ä»£ç :</p>\n<p>ç¬¬ä¸‰è¡Œ: ä¸€ä¸ªåˆå§‹é¦–é¡µçš„componentåå­—ï¼Œæ¯”å¦‚æˆ‘å†™äº†ä¸€ä¸ªcomponentå«HomeComponentï¼Œé‚£ä¹ˆè¿™ä¸ªnameå°±æ˜¯è¿™ä¸ªç»„ä»¶çš„åå­—ã€HomeComponentã€‘äº†ã€‚</p>\n<p>ç¬¬å››è¡Œ: è¿™ä¸ªç»„ä»¶çš„Classï¼Œç”¨æ¥ä¸€ä¼šå„¿å®ä¾‹åŒ–æˆ <code>&lt;Component /&gt;</code>æ ‡ç­¾</p>\n<p>ç¬¬ä¸ƒè¡Œ:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">initialRoute=&#123;&#123; <span class=\"attr\">name</span>: defaultName, <span class=\"attr\">component</span>: defaultComponent &#125;&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™ä¸ªæŒ‡å®šäº†é»˜è®¤çš„é¡µé¢ï¼Œä¹Ÿå°±æ˜¯å¯åŠ¨appä¹‹åä¼šçœ‹åˆ°ç•Œé¢çš„ç¬¬ä¸€å±ã€‚ éœ€è¦å¡«å†™ä¸¤ä¸ªå‚æ•°: name è·Ÿ componentã€‚</p>\n<p>ç¬¬å…«ï¼Œä¹ï¼Œåè¡Œ: </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">configureScene=&#123;<span class=\"function\">() =&gt;</span> &#123;<span class=\"keyword\">return</span> Navigator.SceneConfigs.VerticalDownSwipeJump;&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™ä¸ªæ˜¯é¡µé¢ä¹‹é—´è·³è½¬æ—¶å€™çš„åŠ¨ç”»ï¼Œå…·ä½“æœ‰å“ªäº›ï¼Ÿ</p>\n<ul>\n<li>Navigator.SceneConfigs.PushFromRight (é»˜è®¤)</li>\n<li>Navigator.SceneConfigs.FloatFromRight</li>\n<li>Navigator.SceneConfigs.FloatFromLeft</li>\n<li>Navigator.SceneConfigs.FloatFromBottom</li>\n<li>Navigator.SceneConfigs.FloatFromBottomAndroid</li>\n<li>Navigator.SceneConfigs.FadeAndroid</li>\n<li>Navigator.SceneConfigs.HorizontalSwipeJump</li>\n<li>Navigator.SceneConfigs.HorizontalSwipeJumpFromRight</li>\n<li>Navigator.SceneConfigs.VerticalUpSwipeJump</li>\n<li>Navigator.SceneConfigs.VerticalDownSwipeJump</li>\n</ul>\n<p>æœ€åçš„å‡ è¡Œ: </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">renderScene=&#123;<span class=\"function\">(<span class=\"params\">route, navigator</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> Component = route.component;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">Component</span> &#123;<span class=\"attr\">...route.params</span>&#125; <span class=\"attr\">navigator</span>=<span class=\"string\">&#123;navigator&#125;</span> /&gt;</span></span></span><br><span class=\"line\">    &#125;&#125; /&gt;</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œæ˜¯æ¯ä¸ªäººæœ€ç–‘æƒ‘çš„ï¼Œæˆ‘ä»¬å…ˆçœ‹åˆ°å›è°ƒé‡Œçš„ä¸¤ä¸ªå‚æ•°:route, navigatorã€‚é€šè¿‡æ‰“å°æˆ‘ä»¬å‘ç°routeé‡Œå…¶å®å°±æ˜¯æˆ‘ä»¬ä¼ é€’çš„name,componentè¿™ä¸¤ä¸ªè´§ï¼Œnavigatoræ˜¯ä¸€ä¸ªNavigatorçš„å¯¹è±¡ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œå› ä¸ºå®ƒæœ‰push pop jumpâ€¦ç­‰æ–¹æ³•ï¼Œè¿™æ˜¯æˆ‘ä»¬ç­‰ä¸‹ç”¨æ¥è·³è½¬é¡µé¢ç”¨çš„é‚£ä¸ªnavigatorå¯¹è±¡ã€‚<br><code>return &lt;Component &#123;...route.params&#125; navigator=&#123;navigator&#125; /&gt;</code><br>è¿™é‡Œæœ‰ä¸€ä¸ªåˆ¤æ–­ï¼Œä¹Ÿå°±æ˜¯å¦‚æœä¼ é€’è¿›æ¥çš„componentå­˜åœ¨ï¼Œé‚£æˆ‘ä»¬å°±æ˜¯è¿”å›ä¸€ä¸ªè¿™ä¸ªcomponentï¼Œç»“åˆå‰é¢ initialRoute çš„å‚æ•°ï¼Œæˆ‘ä»¬å°±æ˜¯çŸ¥é“ï¼Œè¿™æ˜¯ä¸€ä¸ªä¼šè¢«renderå‡ºæ¥ç»™ç”¨æˆ·çœ‹åˆ°çš„componentï¼Œç„¶ånavigatorä½œä¸ºpropsä¼ é€’ç»™äº†è¿™ä¸ªcomponentã€‚</p>\n<ul>\n<li>getCurrentRoutes() - è·å–å½“å‰æ ˆé‡Œçš„è·¯ç”±ï¼Œä¹Ÿå°±æ˜¯pushè¿›æ¥ï¼Œæ²¡æœ‰popæ‰çš„é‚£äº›ã€‚</li>\n<li>jumpBack() - è·³å›ä¹‹å‰çš„è·¯ç”±ï¼Œå½“ç„¶å‰ææ˜¯ä¿ç•™ç°åœ¨çš„ï¼Œè¿˜å¯ä»¥å†è·³å›æ¥ï¼Œä¼šç»™ä½ ä¿ç•™åŸæ ·ã€‚</li>\n<li>jumpForward() - ä¸Šä¸€ä¸ªæ–¹æ³•ä¸æ˜¯è°ƒåˆ°ä¹‹å‰çš„è·¯ç”±äº†ä¹ˆï¼Œç”¨è¿™ä¸ªè·³å›æ¥å°±å¥½äº†ã€‚</li>\n<li>jumpTo(route) - è·³è½¬åˆ°å·²æœ‰çš„åœºæ™¯å¹¶ä¸”ä¸å¸è½½ã€‚</li>\n<li>push(route) - è·³è½¬åˆ°æ–°çš„åœºæ™¯ï¼Œå¹¶ä¸”å°†åœºæ™¯å…¥æ ˆï¼Œä½ å¯ä»¥ç¨åè·³è½¬è¿‡å»</li>\n<li>pop() - è·³è½¬å›å»å¹¶ä¸”å¸è½½æ‰å½“å‰åœºæ™¯</li>\n<li>replace(route) - ç”¨ä¸€ä¸ªæ–°çš„è·¯ç”±æ›¿æ¢æ‰å½“å‰åœºæ™¯</li>\n<li>replaceAtIndex(route, index) - æ›¿æ¢æ‰æŒ‡å®šåºåˆ—çš„è·¯ç”±åœºæ™¯</li>\n<li>replacePrevious(route) - æ›¿æ¢æ‰ä¹‹å‰çš„åœºæ™¯</li>\n<li>immediatelyResetRouteStack(routeStack) - ç”¨æ–°çš„è·¯ç”±æ•°ç»„æ¥é‡ç½®è·¯ç”±æ ˆ</li>\n<li>popToRoute(route) - popåˆ°è·¯ç”±æŒ‡å®šçš„åœºæ™¯ï¼Œå…¶ä»–çš„åœºæ™¯å°†ä¼šå¸è½½ã€‚</li>\n<li>popToTop() - popåˆ°æ ˆä¸­çš„ç¬¬ä¸€ä¸ªåœºæ™¯ï¼Œå¸è½½æ‰æ‰€æœ‰çš„å…¶ä»–åœºæ™¯ã€‚</li>\n</ul>\n<p><code>Login.js</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&#x27;use strict&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;<span class=\"comment\">/**å¼•å…¥æ ·å¼æ–‡ä»¶ */</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">import</span> styles <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./Login.style.js&#x27;</span>;</span><br><span class=\"line\">&#123;<span class=\"comment\">/**å¼•å…¥å›¾æ ‡å­—ä½“ */</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">import</span> Icon <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react-native-vector-icons/FontAwesome&#x27;</span>;</span><br><span class=\"line\">&#123;<span class=\"comment\">/**å¼•å…¥Homepage */</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">import</span> Home <span class=\"keyword\">from</span> <span class=\"string\">&#x27;../home/Home.js&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> React, &#123;</span><br><span class=\"line\">  Component, </span><br><span class=\"line\">  TouchableHighlight,</span><br><span class=\"line\">  Text,</span><br><span class=\"line\">&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react-native&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Login</span> <span class=\"keyword\">extends</span> <span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">constructor</span>(<span class=\"params\">props</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">super</span>(props);</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.state = &#123;</span><br><span class=\"line\">      name : <span class=\"literal\">null</span></span><br><span class=\"line\">    &#125;    </span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">_onLogin</span>(<span class=\"params\"></span>)</span>&#123;   </span><br><span class=\"line\">    <span class=\"comment\">// è¿›è¡Œè·³è½¬å¹¶ä¼ é€’å‚æ•°</span></span><br><span class=\"line\">    <span class=\"built_in\">this</span>.props.navigator.push(&#123;</span><br><span class=\"line\">      title : <span class=\"string\">&#x27;homepage&#x27;</span>,</span><br><span class=\"line\">      component:Home,</span><br><span class=\"line\">      params : &#123;</span><br><span class=\"line\">        name : <span class=\"string\">&#x27;Tom&#x27;</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">render</span>(<span class=\"params\"></span>)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (</span><br><span class=\"line\">      &lt;View style=&#123;styles.container&#125;&gt;        </span><br><span class=\"line\">        &lt;TouchableHighlight</span><br><span class=\"line\">            style=&#123;styles.th&#125;</span><br><span class=\"line\">            underlayColor=<span class=\"string\">&quot;rgb(210, 230, 255)&quot;</span></span><br><span class=\"line\">            onPress = &#123;<span class=\"built_in\">this</span>._onLogin.bind(<span class=\"built_in\">this</span>)&#125;&gt;</span><br><span class=\"line\">            &lt;View&gt;</span><br><span class=\"line\">              &lt;Text&gt;ç™»å½•&lt;/Text&gt;</span><br><span class=\"line\">            &lt;/View&gt;</span><br><span class=\"line\">        &lt;/TouchableHighlight&gt;      </span><br><span class=\"line\">      &lt;/View&gt;</span><br><span class=\"line\">    );</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n<p><code>Home.js</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&#x27;use strict&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> React,&#123;</span><br><span class=\"line\">    Component,</span><br><span class=\"line\">    TouchableOpacity,</span><br><span class=\"line\">    View,</span><br><span class=\"line\">    Text</span><br><span class=\"line\">&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react-native&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> styles <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./Home.style.js&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Home</span> <span class=\"keyword\">extends</span> <span class=\"title\">Component</span></span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">constructor</span>(<span class=\"params\">props</span>)</span>&#123;</span><br><span class=\"line\">      <span class=\"built_in\">super</span>(props);</span><br><span class=\"line\">      <span class=\"built_in\">this</span>.state = &#123;</span><br><span class=\"line\">          name : <span class=\"string\">&#x27;Frank&#x27;</span></span><br><span class=\"line\">      &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">/**æ¥æ”¶ä¼ é€’è¿‡æ¥çš„å‚æ•° */</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">componentDidMount</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">      <span class=\"built_in\">this</span>.setState(&#123;</span><br><span class=\"line\">          name : <span class=\"built_in\">this</span>.props.name</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">/**è¿”å›äº‹ä»¶ */</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">_onBack</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> &#123; navigator &#125; = <span class=\"built_in\">this</span>.props;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(navigator) &#123;</span><br><span class=\"line\">       navigator.pop();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">render</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (</span><br><span class=\"line\">            &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class=\"line\">                &lt;Text&gt;Hello.&#123;<span class=\"built_in\">this</span>.state.name&#125;&lt;/Text&gt;</span><br><span class=\"line\">                &lt;TouchableOpacity style=&#123;styles.th&#125; onPress=&#123;<span class=\"built_in\">this</span>._onBack.bind(<span class=\"built_in\">this</span>)&#125;&gt;</span><br><span class=\"line\">                    &lt;Text&gt;ç‚¹æˆ‘è¿”å›&lt;/Text&gt;                    </span><br><span class=\"line\">                &lt;/TouchableOpacity&gt; </span><br><span class=\"line\">            &lt;/View&gt;</span><br><span class=\"line\">        )</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","categories":["React Native"],"tags":["React Native"]},{"title":"RNï¼ˆreact nativeï¼‰å…¥å‘æŒ‡å—-é™„å½•A,å¸¸ç”¨å‘½ä»¤","url":"https://pkaq.org/2016/04/17/rn-command-a/","content":"<p>åˆ›å»ºä¸€ä¸ªå«AwesomeProjectçš„é¡¹ç›®</p>\n<figure class=\"highlight actionscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">react-<span class=\"keyword\">native</span> init AwesomeProject</span><br></pre></td></tr></table></figure>\n<p>å‡çº§react-nativeé¡¹ç›®åˆ°æœ€æ–°ç‰ˆæœ¬</p>\n<figure class=\"highlight actionscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">react-<span class=\"keyword\">native</span> upgrade</span><br></pre></td></tr></table></figure>\n<p>å¯åŠ¨æ‰“åŒ…æœåŠ¡</p>\n<figure class=\"highlight actionscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">react-<span class=\"keyword\">native</span> start</span><br></pre></td></tr></table></figure>\n<p>åœ¨å®‰å“ä¸Šè¿è¡Œdebugç¨‹åº</p>\n<a id=\"more\"></a>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">react-native <span class=\"keyword\">run</span><span class=\"bash\">-android</span></span><br></pre></td></tr></table></figure>\n<p>åœ¨å®‰å“ä¸Šè¿è¡Œdebugç¨‹åº</p>\n<figure class=\"highlight actionscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">react-<span class=\"keyword\">native</span> android</span><br></pre></td></tr></table></figure>\n<p>åœ¨è‹¹æœä¸Šè¿è¡Œdebugç¨‹åº</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">react-native <span class=\"keyword\">run</span><span class=\"bash\">-ios</span></span><br></pre></td></tr></table></figure>\n<p>æ‰“ç¦»çº¿åŒ…</p>\n<figure class=\"highlight actionscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">react-<span class=\"keyword\">native</span> bundle</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight actionscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">react-<span class=\"keyword\">native</span> unbundle</span><br></pre></td></tr></table></figure>\n<p>ä¸ºé¡¹ç›®æ·»åŠ ä¸‰æ–¹ä¾èµ–</p>\n<figure class=\"highlight actionscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">react-<span class=\"keyword\">native</span> link</span><br></pre></td></tr></table></figure>\n<p>generates a native library bridge</p>\n<figure class=\"highlight actionscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">react-<span class=\"keyword\">native</span> <span class=\"keyword\">new</span>-library</span><br></pre></td></tr></table></figure>","categories":["React Native"],"tags":["React Native"]},{"title":"RNï¼ˆreact nativeï¼‰å…¥å‘æŒ‡å—-06,é¡¹ç›®å¼€å‘ç»“æ„(ä»£ç åˆ†å±‚ç»„ç»‡)","url":"https://pkaq.org/2016/04/17/rn-structure-06/","content":"<p>éšç€ä»£ç å¤æ‚æ€§çš„æé«˜,å¯¹ä»£ç è¿›è¡Œåˆ†å±‚ä»¥åŠæŠ½è±¡æ˜¯ååˆ†å¿…è¦çš„.ä»Šå¤©æˆ‘ä»¬å°±å¯¹RNçš„é¡¹ç›®ç»“æ„è¿›è¡Œç®€å•çš„æ¢³ç†.<br>ã€€ã€€è¿™é‡Œä¸»è¦æ˜¯å¯¹æ ·å¼æ–‡ä»¶å’Œç»„ä»¶è¿›è¡Œåˆ†ç¦».å¯ä»¥ä»¥ä¸šåŠ¡æ¨¡å—æˆ–è€…ä»¥é¡µé¢çš„å½¢å¼åˆ’åˆ†å±‚çº§.å…·ä½“ç»“æ„å¦‚ä¸‹</p>\n<ul>\n<li><input disabled type=\"checkbox\"> Project ROOT<ul>\n<li><input disabled type=\"checkbox\"> index.ios.js</li>\n<li><input disabled type=\"checkbox\"> index.android.js</li>\n<li><input disabled type=\"checkbox\"> android</li>\n<li><input disabled type=\"checkbox\"> ios</li>\n<li><input disabled type=\"checkbox\"> resources     â€“ å­˜æ”¾å„ç±»é™æ€èµ„æºæ–‡ä»¶</li>\n<li><input disabled type=\"checkbox\"> src    â€“ æºä»£ç ç›®å½•<ul>\n<li><input disabled type=\"checkbox\"> module â€“ä¸šåŠ¡æ¨¡å—<ul>\n<li><input disabled type=\"checkbox\"> module.js    â€“ ä¸šåŠ¡æ¨¡å—ç»„ä»¶</li>\n<li><input disabled type=\"checkbox\"> module.style.js â€“ ä¸šåŠ¡æ¨¡å—æ ·å¼</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<a id=\"more\"></a>\n<p>ç›®å‰å…³äºRNçš„åˆ†å±‚ç»“æ„æ²¡æœ‰ç‰¹å®šçš„æœ€ä½³å®è·µ,å¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„ç†è§£è¿›è¡Œç»„ç»‡.<br>è¿™é‡Œä¹‹æ‰€ä»¥å°†æ ·å¼æ–‡ä»¶ä¸ä¸šåŠ¡æ¨¡å—åŒçº§å­˜æ”¾ä¸»è¦æ˜¯ç”±äºåœ¨importçš„æ—¶å€™fromè¯­å¥åé¢çš„å‚æ•°æ˜¯ä¾æ®å½“å‰æ–‡ä»¶æ‰€åœ¨çš„ç›¸å¯¹è·¯å¾„è¿›è¡ŒæŸ¥æ‰¾,å­˜æ”¾åœ¨åŒçº§ç›®å½•å¯ä»¥æ¯”è¾ƒæ–¹ä¾¿çš„è¿›è¡Œå¼•ç”¨.<code>Login.js</code>ä¸­å¦‚æœéœ€è¦å¼•å…¥<code>Login.style.js</code>å¯å¦‚ä¸‹ä¹¦å†™<br><code>Module.js</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&#x27;use strict&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> React,&#123;View,Text&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react-native&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">&#123;<span class=\"comment\">/**è¿™é‡Œstylesæ˜¯å¼•å…¥åçš„åˆ«å,å¯ä»¥åœ¨éœ€è¦çš„åœ°æ–¹ä»¥style.xxxxçš„æ–¹å¼å¼•ç”¨æ ·å¼ */</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">import</span> styles <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./Login.style.js&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Login</span> <span class=\"keyword\">extends</span> <span class=\"title\">React</span>.<span class=\"title\">Component</span></span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">render</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (</span><br><span class=\"line\">            &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class=\"line\">                &lt;Text&gt;Hello,Tom&lt;/Text&gt;</span><br><span class=\"line\">            &lt;/View&gt;</span><br><span class=\"line\">        )</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å…·ä½“æ ·å¼ç±»ä¹¦å†™çš„ä¾‹å­<br><code>Module.style.js</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&#x27;use strict&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> React, &#123;StyleSheet&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react-native&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> styles = StyleSheet.create(&#123;</span><br><span class=\"line\">  container: &#123;</span><br><span class=\"line\">    flex: <span class=\"number\">1</span>,</span><br><span class=\"line\">    justifyContent: <span class=\"string\">&#x27;center&#x27;</span>,</span><br><span class=\"line\">    alignItems: <span class=\"string\">&#x27;center&#x27;</span>,</span><br><span class=\"line\">    backgroundColor: <span class=\"string\">&#x27;#F5FCFF&#x27;</span>,</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = styles;</span><br></pre></td></tr></table></figure>\n<p>å¦‚æ­¤ä¸€æ¥æˆ‘ä»¬çš„å…¥å£æ–‡ä»¶ç›´æ¥å¼•ç”¨Moduleè¿›è¡Œå±•ç°å³å¯<br><code>index.android.js</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&#x27;use strict&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> React,&#123;AppRegistry&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react-native&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;<span class=\"comment\">/**Login */</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">import</span> Login <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./src/module/Login.js&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TaraRn</span> <span class=\"keyword\">extends</span> <span class=\"title\">React</span>.<span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">render</span>(<span class=\"params\"></span>)</span> &#123;  </span><br><span class=\"line\">    <span class=\"keyword\">return</span> (</span><br><span class=\"line\">     \t&lt;Login/&gt;</span><br><span class=\"line\">    )</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">AppRegistry.registerComponent(<span class=\"string\">&#x27;TaraRn&#x27;</span>, <span class=\"function\">() =&gt;</span> TaraRn);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>","categories":["React Native"],"tags":["React Native"]},{"title":"RNï¼ˆreact nativeï¼‰å…¥å‘æŒ‡å—-05,ä½¿ç”¨å›¾æ ‡å­—ä½“Fontawesome","url":"https://pkaq.org/2016/04/16/rn-icon-05/","content":"<h4><span id=\"xian-jue-tiao-jian\">å…ˆå†³æ¡ä»¶</span><a href=\"#xian-jue-tiao-jian\" class=\"header-anchor\">#</a></h4><ul>\n<li>rn 0.23</li>\n<li>npm 3.7.3</li>\n<li>node 5.9.1</li>\n<li>system winX</li>\n<li>python 2.7.x</li>\n</ul>\n<h4><span id=\"qian-yan\">å‰è¨€</span><a href=\"#qian-yan\" class=\"header-anchor\">#</a></h4><p>ã€€ã€€å¼€å‘è¿‡ç¨‹ä¸­å„å¼å„æ ·çš„å›¾æ ‡è‡ªç„¶å°‘ä¸äº†,å¦‚æœèƒ½ä½¿ç”¨fontawesomeç­‰å›¾æ ‡å­—ä½“,è‡ªç„¶å¯ä»¥å¸¦æ¥æå¤§çš„æ–¹ä¾¿,ç„¶è€Œåœ¨rnä¸­å¹¶æ— æ³•ç›´æ¥å¼•ç”¨,è¿˜å¥½å·²ç»æœ‰äººåšå¥½äº†ç›¸å…³ç»„ä»¶,react-native-vector-iconsä¾¿æ˜¯å…¶ä¸­çš„ä½¼ä½¼è€….<br>ã€€ã€€å¦‚æœä½ å¯¹æ­¤ç»„ä»¶æ„Ÿå…´è¶£å¯ä»¥å»githubé¡µé¢staræ­¤é¡¹ç›®<br>ã€€ã€€<a href=\"https://github.com/oblador/react-native-vector-icons\">https://github.com/oblador/react-native-vector-icons</a>   </p>\n<a id=\"more\"></a>\n<h4><span id=\"an-zhuang\">å®‰è£…</span><a href=\"#an-zhuang\" class=\"header-anchor\">#</a></h4><p>ã€€ã€€å®˜æ–¹READMEå¦‚ä½•ä½¿ç”¨å·²ç»å†™å¾—å¾ˆè¯¦ç»†,æ­¤å¤„éœ€è¦æŒ‡å‡ºçš„æ˜¯å‡ ä¸ªæ³¨æ„ç‚¹.<br>ã€€ã€€ç”±äºå®‰è£…æ—¶ä¾èµ–node-gyp,è€Œnode-gypåœ¨winä¸‹åˆä¼šæœ‰ä¸€å †ä¾èµ–è¿™é‡Œä»¥winXä¸ºä¾‹è¯´ä¸€ä¸‹winXä¸‹éœ€è¦å®‰è£…çš„ä¾èµ–   </p>\n<p>ã€€ã€€1.<a href=\"https://www.python.org/downloads/\">pythonç¯å¢ƒ</a>:æˆªæ­¢åšå®¢å‘è¡¨æ—¶ä»…æ”¯æŒåˆ°2.7.Xç‰ˆæœ¬,å¦‚æœæ˜¯ä¸‹è½½çš„zipåŒ…éœ€è¦å°†pythonè·¯å¾„æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­   </p>\n<p>ã€€ã€€2.vs c++:ä¸ºäº†æ–¹ä¾¿ æˆ‘ç›´æ¥å®‰è£…äº†<a href=\"https://www.visualstudio.com/en-us/downloads/download-visual-studio-vs.aspx\">Microsoft Visual Studio Express</a><br>npm install react-native-vector-icons â€“save   </p>\n<p>ã€€ã€€3.<a href=\"https://github.com/rnpm/rnpm\">rnpm</a>:<code>npm install rnpm -g</code></p>\n<h4><span id=\"shi-yong\">ä½¿ç”¨</span><a href=\"#shi-yong\" class=\"header-anchor\">#</a></h4><p>ç¡®ä¿ä»¥ä¸Šä¸‰ç‚¹æ²¡é—®é¢˜å,å¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤å®‰è£…æœ¬ç»„ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install react-native-vector-icons --save</span><br></pre></td></tr></table></figure>\n<p>ç”±äºæˆ‘æ˜¯å¼€å‘android App,æ‰€ä»¥ä¾æ®å®˜æ–¹æ–‡æ¡£ç»§ç»­æ‰§è¡Œ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rnpm link</span><br></pre></td></tr></table></figure>\n<p>åœ¨æ‰€éœ€ä½¿ç”¨å›¾æ ‡çš„åœ°æ–¹,è¿™é‡Œé‡‡ç”¨çš„æ˜¯es6çš„å†™æ³•,es5çš„å†™æ³•ä¹Ÿæ˜¯å¯ä»¥çš„</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import Icon from &#x27;react-native-vector-icons/FontAwesome&#x27;;</span><br></pre></td></tr></table></figure>\n<p>ä½¿ç”¨ç»„ä»¶</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;Icon name=<span class=\"string\">&quot;qq&quot;</span> size=&#123;<span class=\"number\">30</span>&#125; color=<span class=\"string\">&quot;#52C0FE&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>\n<h4><span id=\"bei-zhu\">å¤‡æ³¨</span><a href=\"#bei-zhu\" class=\"header-anchor\">#</a></h4><p><strong>å‚æ•°è¯´æ˜</strong>   </p>\n<p>|å‚æ•°|ç±»å‹|é»˜è®¤å€¼|è¯´æ˜|<br>|â€”â€”â€”â€”â€”â€”â€“|<br>|name|String|æ— |å›¾æ ‡åç§°,è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ å¦‚æœä½ ä½¿ç”¨font-awesomeçš„å›¾æ ‡,ä¾‹å¦‚qqä»…å†™qqå³å¯,æ— éœ€å†™fa fa-qq|<br>|size|æ•°å€¼|12|å›¾æ ‡çš„å¤§å°|<br>|color|<a href=\"http://reactnative.cn/docs/0.23/colors.html#content\">rnæ”¯æŒçš„é¢œè‰²æ ¼å¼</a>|è‡ªåŠ¨ç»§æ‰¿|å›¾æ ‡çš„é¢œè‰²|</p>\n<p><strong>æ”¯æŒçš„å›¾æ ‡</strong>    </p>\n<ul>\n<li><a href=\"http://entypo.com/\"><code>Entypo</code></a> by Daniel Bruce (<strong>411</strong> icons) </li>\n<li><a href=\"http://evil-icons.io/\"><code>EvilIcons</code></a> by Alexander Madyankin &amp; Roman Shamin (v1.8.0, <strong>71</strong> icons) </li>\n<li><a href=\"http://fortawesome.github.io/Font-Awesome/icons/\"><code>FontAwesome</code></a> by Dave Gandy (v4.5, <strong>605</strong> icons) </li>\n<li><a href=\"http://zurb.com/playground/foundation-icon-fonts-3\"><code>Foundation</code></a> by ZURB, Inc. (v3.0, <strong>283</strong> icons)</li>\n<li><a href=\"http://ionicons.com/\"><code>Ionicons</code></a> by Ben Sperry (v2.0.1, <strong>733</strong> icons)</li>\n<li><a href=\"https://www.google.com/design/icons/\"><code>MaterialIcons</code></a> by Google, Inc. (v2.1.1, <strong>893</strong> icons)</li>\n<li><a href=\"http://octicons.github.com/\"><code>Octicons</code></a> by Github, Inc. (v3.5.0, <strong>196</strong> icons)</li>\n<li><a href=\"http://zocial.smcllns.com/\"><code>Zocial</code></a> by Sam Collins (v1.0, <strong>100</strong> icons)</li>\n</ul>\n<p><strong>é”™è¯¯è®°å½•</strong><br>æœªæ­£ç¡®å®‰è£…pythonä¼šå‡ºç°</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-gyp ERR! configure error </span><br><span class=\"line\">gyp ERR! stack Error: Can&#x27;t find Python executable &quot;python&quot;, you can set the PYTHON env variable.</span><br><span class=\"line\">gyp ERR! stack  </span><br><span class=\"line\">```   </span><br><span class=\"line\"></span><br><span class=\"line\">æœªæ­£ç¡®å®‰è£…vs c++ä¼šå‡ºç°</span><br><span class=\"line\">```shell</span><br><span class=\"line\">æœªèƒ½åŠ è½½Visual C++ ç»„ä»¶VCBuild.exe â€ï¼Œè¦æ±‚å®‰è£….NET FramMS Build ã€.NET Framework 2.0 SDK ã€ Microsoft Visual Studio 2005ã€‚</span><br></pre></td></tr></table></figure>","categories":["React Native"],"tags":["React Native"]},{"title":"RNï¼ˆreact nativeï¼‰å…¥å‘æŒ‡å—-04,å¸ƒå±€å®¹å™¨","url":"https://pkaq.org/2016/04/12/rn-layout-04/","content":"<p>react native æ”¯æŒé‡‡ç”¨flexæ–¹å¼å¸ƒå±€ã€‚é»˜è®¤æƒ…å†µä¸‹å¦‚æœä¸è®¾ç½®flexå®¹å™¨çš„å®½åº¦ï¼Œé‚£ä¹ˆflexå®¹å™¨ä¼š100%è‡ªé€‚åº”å±å¹•å®½åº¦ã€‚<br>å­¦ä¹ flexå¸ƒå±€è¦æ˜ç™½ä¸¤ä¸ªæ¦‚å¿µï¼šä¸»è½´å’Œäº¤å‰è½´ã€‚æ‰€è°“ä¸»è½´å³å®¹å™¨å»¶ä¼¸æ–¹å‘ï¼Œé»˜è®¤æ˜¯row(æ¨ªå‘å»¶ä¼¸)ï¼Œæ­¤æ—¶ä¸æ°´å¹³å‚ç›´çš„è½´å³ä¸ºäº¤å‰è½´ï¼Œåä¹‹äº¦ç„¶ã€‚</p>\n<a id=\"more\"></a>\n<p>ä¼¸ç¼©å®¹å™¨æœ‰ä»¥ä¸‹ä¸ƒå¤§å±æ€§  ï¼š</p>\n<p><strong>1.flexDirection(ä¸»è½´æ–¹å‘,å­å…ƒç´ åœ¨çˆ¶å®¹å™¨ä¸­çš„æ’åˆ—ä½ç½®)</strong><br>  flexDirection:row | row-reverse | column(é»˜è®¤) | column-reverse   </p>\n<p><strong>2.flexWrap(å­å…ƒç´ è¶…å‡ºçˆ¶å®¹å™¨æ—¶æ˜¯å¦æ¢è¡Œ)</strong><br>  flexWrap:nowrap | wrap | wrap-reverse   </p>\n<p><strong>3.justifyContent(ä¸»è½´å†…å®¹å¯¹é½æ–¹å¼)</strong><br>  justifyContent:flex-start(é»˜è®¤å€¼) | flex-end | center | space-between | space-around    </p>\n<p><strong>4.alignItems(äº¤å‰è½´é¡¹ç›®å¯¹é½æ–¹å¼)</strong><br>  alignItems:flex-start(é»˜è®¤) | flex-end | center | stretch    </p>\n<p><strong>5.flex(flex-grow,flex-shrink,flex-basisçš„åˆä½“ï¼Œé»˜è®¤0 1 auto)</strong><br>    a.flex-grow(å…ƒç´ æ‰©å±•å æ¯”,é»˜è®¤0ï¼Œ0ä¸èµ·ä½œç”¨ï¼Œå€¼è¶Šå¤§æ‰©å±•èƒ½åŠ›è¶Šå¼ºï¼Œè¡¨ç¤ºåœ¨ item æ€»å®½åº¦æ¯”å®¹å™¨å°çš„æ—¶å€™ï¼Œä¸ºäº†è®© item å¡«æ»¡å®¹å™¨ï¼Œæ¯ä¸ª item å¢åŠ çš„å®½åº¦)<br>    b.flex-shrink(å…ƒç´ çš„æ”¶ç¼©èƒ½åŠ›ï¼Œé»˜è®¤1,å€¼è¶Šå¤§æ”¶ç¼©èƒ½åŠ›è¶Šå¤§ï¼Œshrink è¡¨ç¤ºåœ¨ item æ€»å®½åº¦æ¯”å®¹å™¨å¤§çš„æ—¶å€™ï¼Œä¸ºäº†è®© item å¡«æ»¡å®¹å™¨ï¼Œæ¯ä¸ª item å‡å°‘çš„å®½åº¦)<br>    c.flex-basis(å…ƒç´ ä¼¸ç¼©åŸºå‡†å€¼ é»˜è®¤auto)</p>\n<p><strong>6.alignSelf(æŒ‡å®šç‰¹å®šå…ƒç´ çš„å¯¹é½æ–¹å¼)</strong></p>\n<p>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæœ‰ä¸€æ®µæ–‡æœ¬è¦è®¾ç½®æ°´å¹³å‚ç›´å±…ä¸­ï¼Œå¹¶ä¸”è¶…å‡ºéƒ¨åˆ†æ¢è¡Œå¯ä»¥ä¹¦å†™ä¸º   </p>\n<figure class=\"highlight maxima\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">justifyContent:<span class=\"built_in\">center</span>;</span><br><span class=\"line\">alignItemsï¼š<span class=\"built_in\">center</span>;</span><br></pre></td></tr></table></figure>\n","categories":["React Native"],"tags":["React Native"]},{"title":"RNï¼ˆreact nativeï¼‰å…¥å‘æŒ‡å—-03,è¿è¡Œå®˜æ–¹ç¤ºä¾‹UIExplorer","url":"https://pkaq.org/2016/04/09/rn-examples-03/","content":"<p>å­¦ä¹ RNï¼Œå®˜æ–¹ç¤ºä¾‹æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œç ”ç©¶å’Œå­¦ä¹ å®˜æ–¹ç¤ºä¾‹ä¼šå¸¦æ¥è®¸å¤šå¸®åŠ©ã€‚<br>åœ¨æ­å»ºå¥½rnç¯å¢ƒä¹‹åå°±å¯ä»¥ç€æ‰‹å°è¯•è¿è¡Œå®˜æ–¹ç¤ºä¾‹æ¥çœ‹ä¸‹RNçš„å„ç±»ç»„ä»¶äº†ã€‚   </p>\n<h4><span id=\"xian-jue-tiao-jian\">å…ˆå†³æ¡ä»¶</span><a href=\"#xian-jue-tiao-jian\" class=\"header-anchor\">#</a></h4><ul>\n<li>node</li>\n<li>npm</li>\n<li>RN</li>\n<li>Git</li>\n<li>Gradle</li>\n<li>ADK/SDK</li>\n</ul>\n<h4><span id=\"kai-shi\">å¼€å§‹</span><a href=\"#kai-shi\" class=\"header-anchor\">#</a></h4><p>é¦–å…ˆä¸‹è½½RNä»£ç <br>Github: <a href=\"https://github.com/facebook/react-native\">https://github.com/facebook/react-native</a><br>ä¸‹è½½æˆåŠŸå å‘½ä»¤è¡Œåˆ‡æ¢åˆ°ç›®æ ‡ç›®å½• æ‰§è¡Œ<code>npm install</code>å®‰è£…æ‰€éœ€ä¾èµ–   </p>\n<a id=\"more\"></a>\n<h4><span id=\"pei-zhi-dk\">é…ç½®*DK</span><a href=\"#pei-zhi-dk\" class=\"header-anchor\">#</a></h4><p>è¿™é‡Œæœ‰ä¸¤ç§æ–¹å¼<br>æ³•1ï¼š<br>ã€€ã€€åˆ‡æ¢åˆ°react-nativeç›®å½•, æ–°å»ºlocal.properties</p>\n<figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">sdk.dir</span>=absolute_path_to_android_sdk</span><br><span class=\"line\"><span class=\"attr\">ndk.dir</span>=absolute_path_to_android_ndk</span><br></pre></td></tr></table></figure>\n<p>æ³•2:<br>ã€€ã€€ç¯å¢ƒå˜é‡æ·»åŠ ANDROID_NDK,ANDROID_SDKåˆ†åˆ«æŒ‡å‘NDKå’ŒSDKçš„ç›®å½•<br>æ›´å¤šè¯´æ˜è¯·å‚è€ƒ   <a href=\"https://facebook.github.io/react-native/docs/android-building-from-source.html\">å…³äºSDK/NDKé…ç½®çš„å®˜æ–¹æ–‡æ¡£</a></p>\n<h4><span id=\"zhen-ji-ce-shi\">çœŸæœºæµ‹è¯•</span><a href=\"#zhen-ji-ce-shi\" class=\"header-anchor\">#</a></h4><p>ã€€ã€€å¦‚æœæ˜¯windowså°ä¼™ä¼´ï¼Œä¸‹é¢çš„å‘½ä»¤å»ºè®®ç”¨å®‰è£…å®Œgitåè‡ªå¸¦çš„gitbashè¿è¡Œ</p>\n<p>1.æ‰§è¡Œå‘½ä»¤</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./<span class=\"selector-tag\">gradlew</span> <span class=\"selector-pseudo\">:ReactAndroid</span><span class=\"selector-pseudo\">:assembleDebug</span></span><br></pre></td></tr></table></figure>\n<p>2.ç„¶åæ‰§è¡Œ</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./<span class=\"selector-tag\">gradlew</span> <span class=\"selector-pseudo\">:ReactAndroid</span><span class=\"selector-pseudo\">:installArchives</span></span><br></pre></td></tr></table></figure>\n<p>3.å¯åŠ¨æœåŠ¡</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.<span class=\"regexp\">/packager/</span>packager.sh</span><br></pre></td></tr></table></figure>\n<p>4.æœ€åå®‰è£…åˆ°ä½ çš„æ‰‹æœº</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">../<span class=\"selector-tag\">gradlew</span> <span class=\"selector-pseudo\">:Examples</span><span class=\"selector-pseudo\">:UIExplorer</span><span class=\"selector-pseudo\">:android</span><span class=\"selector-pseudo\">:app</span><span class=\"selector-pseudo\">:installDebug</span></span><br></pre></td></tr></table></figure>\n<p>è¿™ä¸ªè¿‡ç¨‹ä¸­è¯·ä¸è¦éšæ„å…³é—­packagerè¿è¡Œçª—å£<br>5.è®¾ç½®ip<br>ç°åœ¨ï¼Œæ‰“å¼€UIExploreré¡¹ç›®ï¼Œæ‘‡ä¸€æ‘‡ä½ çš„æ‰‹æœºï¼Œåœ¨å¼¹å‡ºçš„èœå•ä¸­é€‰æ‹©<code>Dev settings</code>-&gt;<code>Debug server host &amp; port for device</code><br>è®¾ç½®ä¸€ä¸‹ä½ çš„æ— çº¿IP æ¯”å¦‚<code>192.168.1.1:8081</code>,æ³¨æ„ï¼šæ­¤å¤„çš„8081ä¸€å®šè¦æœ‰çš„å¦åˆ™æ— æ³•åŠ è½½</p>\n<p>æ›´å¤šå†…å®¹è¯·å‚è€ƒ<a href=\"http://facebook.github.io/react-native/docs/running-on-device-android.html#content\">å®˜æ–¹çš„çœŸæœºè°ƒè¯•æ–‡æ¡£</a></p>\n","categories":["React Native"],"tags":["React Native"]},{"title":"RNï¼ˆreact nativeï¼‰å…¥å‘æŒ‡å—-09,å•å…ƒå­¦ä¹ å°ç»“","url":"https://pkaq.org/2016/04/09/rn-summary-09/","content":"<p>ç°åœ¨æˆ‘ä»¬å·²ç»åšäº†ä¸€ä¸ªç®€å•çš„ç™»å½•ç¤ºä¾‹,å®ƒåŒ…å«çš„çŸ¥è¯†ç‚¹æœ‰é¡µé¢å¸ƒå±€ã€å›¾æ ‡å­—ä½“çš„ä½¿ç”¨ã€ç»“æ„åŒ–å¼€å‘ã€è¿œç¨‹æ•°æ®è·å–ç­‰ã€‚<br><a href=\"https://github.com/pkaq/TaraRn\">ä»£ç åœ¨è¿™é‡Œ</a></p>\n<p>é‚£ä¹ˆå¦‚æœæƒ³è®©è‡ªå·±çš„æ°´å¹³æé«˜ä¸€ä¸ªå±‚æ¬¡,æ­¤æ—¶ä½ åº”è¯¥æ³¨æ„åˆ°äº†è¦ç©è½¬RNä½ åº”è¯¥å‚¨å¤‡å¦‚ä¸‹æŠ€èƒ½<br><strong>1.Flexå¸ƒå±€</strong>:<a href=\"http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html?utm_source=tuicool\">Flex å¸ƒå±€æ•™ç¨‹</a><br><strong>2.ES6è¯­æ³•</strong>:è¿™é‡Œæœ‰ä¸€ä»½  <a href=\"http://reactnative.cn/post/15\">ES5 ES6å¯¹ç…§è¡¨</a><br>ä¸‹é¢æ˜¯ä¸€ç‚¹è¡¥å……è¯´æ˜ å®Œæ•´æ•™ç¨‹å¯ä»¥çœ‹é˜®ä¸€å³°çš„<a href=\"http://es6.ruanyifeng.com/\">es6 å…¥é—¨æ•™ç¨‹</a></p>\n<blockquote>\n<p>es6è¯­æ³•è¯´æ˜ â€¦Obj ,ä¸‰ä¸ªç‚¹éå†å¯¹è±¡æ‰€æœ‰å±æ€§å¹¶èµ‹å€¼ç»™xx,ä¸¾ä¸ªä¾‹å­</p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var Obj = &#123;&#125;;</span><br><span class=\"line\">Obj.<span class=\"attribute\">foo</span>=<span class=\"string\">&quot;1&quot;</span>;</span><br><span class=\"line\">Obj.<span class=\"attribute\">bar</span>=<span class=\"string\">&quot;2&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;H1 &#123;<span class=\"built_in\">..</span>.Obj&#125; <span class=\"attribute\">foo</span>=<span class=\"string\">&quot;2&quot;</span>&gt;&lt;/H1&gt;</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œ{â€¦Obj}ä¼šéå†Objçš„æ‰€æœ‰å±æ€§ç»™H1,åŒæ—¶ç”±äºåé¢å†æ¬¡åˆ¶å®šäº†foo=â€2â€ æ‰€ä»¥è¿™é‡Œä¼šè¦†ç›–å‰é¢çš„foo=â€1â€</p>\n</blockquote>\n<p>ç®­å¤´å‡½æ•°</p>\n<blockquote>\n<p>(a)=&gt;{alert(â€œaâ€)}<br>ç›¸å½“äº<br>function(a) {<br>    alert(â€œaâ€);<br>}</p>\n</blockquote>\n<p><strong>3.JSXè¯­æ³•</strong> : <a href=\"http://reactjs.cn/react/docs/jsx-in-depth.html\">æ·±å…¥äº†è§£JSXè¯­æ³•</a><br>è¿˜æ˜¯è¡¥å……è¯´æ˜</p>\n<blockquote>\n<p>JSXç»„ä»¶ç±»å’Œæ ‡ç­¾é¦–å­—æ¯éƒ½è¦å¤§å†™</p>\n</blockquote>\n<p><strong>4.å…³äºæ ·å¼</strong></p>\n<blockquote>\n<p>æ ·å¼è¦é‡‡ç”¨é©¼å³°è§„èŒƒä¹¦å†™</p>\n</blockquote>\n<p><strong>5.å…³äºäº‹ä»¶</strong></p>\n<blockquote>\n<p>äº‹ä»¶ç»‘å®š æ¯”å¦‚onClick={_onclickHandler.bind(this,â€aâ€)},è¿™é‡Œæ¥å—ä¸¤ä¸ªå‚æ•°,ç¬¬ä¸€ä¸ªè®¾å®šä½œç”¨åŸŸ,ç¬¬äºŒä¸ªæ¥æ”¶ä¸€ä¸ªå‚æ•°,åŒæ—¶onClickå¿…é¡»ç¬¦åˆé©¼å³°å‘½åè§„åˆ™</p>\n</blockquote>\n<p>ä¸‹ä¸€æ­¥æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ç†Ÿæ‚‰ç»„ä»¶ä½¿ç”¨,reduxç­‰æ›´å¤šå†…å®¹äº†.</p>\n","categories":["React Native"],"tags":["React Native"]},{"title":"grunt -- > gulp,ä»gruntè½¬å‘gulpç®¡ç†å‰ç«¯æ„å»º","url":"https://pkaq.org/2016/01/14/gulp/","content":"<h4><span id=\"xie-zai-qian-mian\">å†™åœ¨å‰é¢</span><a href=\"#xie-zai-qian-mian\" class=\"header-anchor\">#</a></h4><p>  åœ¨JavaScriptçš„ä¸–ç•Œé‡Œï¼ŒGrunt.jsæ˜¯åŸºäºNode.jsçš„è‡ªåŠ¨åŒ–ä»»åŠ¡è¿è¡Œå™¨ã€‚2013å¹´02æœˆ18æ—¥ï¼ŒGrunt v0.4.0 å‘å¸ƒã€‚Fractalå…¬å¸ç§¯æå‚ä¸äº†æ•°ä¸ªæµè¡ŒNode.jsæ¨¡å—çš„å¼€å‘ï¼Œå®ƒå»å¹´å‘å¸ƒäº†ä¸€ä¸ªæ–°çš„æ„å»ºç³»ç»ŸGulpï¼Œå¸Œæœ›èƒ½å¤Ÿå–å…¶ç²¾åï¼Œå¹¶å–ä»£Gruntï¼Œæˆä¸ºæœ€æµè¡Œçš„JavaScriptä»»åŠ¡è¿è¡Œå™¨ã€‚</p>\n<p>  ä¸å¥½æ„æ€ï¼Œä¸Šé¢ä¸€æ®µæ˜¯æŠ„çš„ï¼ŒåŸæ–‡è¯·çœ‹<a href=\"http://segmentfault.com/a/1190000002491282\">å‰ç«¯å·¥ç¨‹çš„æ„å»ºå·¥å…·å¯¹æ¯” Gulp vs Grunt</a>  </p>\n<p>  æ²¡é”™ï¼Œæ­£æ˜¯å› ä¸ºè¿™ç¯‡æ–‡ç« ï¼Œæ— æ„ä¸­å‘ç°äº†gulpï¼Œè¯•ç”¨ä¹‹åä¹Ÿå¤§æœ‰å½“å¹´ä»mavenåˆ‡æ¢åˆ°gradleçš„å¿«æ„Ÿ<br>  æ‰€ä»¥ï¼Œä»¥åçš„æ—¥å­è¿˜æ˜¯è®©gulpæ¥é™ªä¼´å§</p>\n<a id=\"more\"></a>\n\n<h4><span id=\"an-zhuang\">å®‰è£…</span><a href=\"#an-zhuang\" class=\"header-anchor\">#</a></h4><p>  <a href=\"http://www.gulpjs.com.cn/docs/getting-started/\">å®˜æ–¹å…¥é—¨æŒ‡å—</a></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install --global gulp</span><br></pre></td></tr></table></figure>\n<h4><span id=\"chu-shi-hua\">åˆå§‹åŒ–</span><a href=\"#chu-shi-hua\" class=\"header-anchor\">#</a></h4><p>  åŒæ ·çš„å®‰è£…å®Œåœ¨ä½ çš„é¡¹ç›®ç›®å½•ç”¨npm initåˆå§‹åŒ–ä¸€ä¸ªpackage.jsonæ–‡ä»¶ï¼Œå¹¶ä¸”åˆ›å»ºgulpfile.jsæ–‡ä»¶   </p>\n<h4><span id=\"xun-zhao-cha-jian\">å¯»æ‰¾æ’ä»¶</span><a href=\"#xun-zhao-cha-jian\" class=\"header-anchor\">#</a></h4><p> <a href=\"http://gulpjs.com/plugins/\">ç‚¹æˆ‘ä¼ é€</a></p>\n<h4><span id=\"ji-xu\">ç»§ç»­</span><a href=\"#ji-xu\" class=\"header-anchor\">#</a></h4><p>å› ä¸ºå®åœ¨å¤ªç®€å•ï¼Œæ‰€ä»¥æˆ‘æ‰“ç®—ç›´æ¥è´´è„šæœ¬å¹¶ä¸”é€šè¿‡åœ¨è„šæœ¬é‡ŒåŠ æ³¨é‡Šçš„æ–¹å¼æ¥è¯´æ˜å‰©ä¸‹çš„éƒ¨åˆ†<br>å› ä¸ºåŸºæœ¬å°±æ˜¯å¼•å…¥æ’ä»¶ç„¶åé…ç½®ä¸‹æ’ä»¶ç›¸å…³å±æ€§å°±è¡Œäº†ï¼Œè€Œè¿™ä¸€åˆ‡æ’ä»¶ä»‹ç»é‡Œä¹Ÿè¯´çš„å¾ˆæ˜ç™½äº†<br>å…³äºå¤åˆ¶ç›®å½•ç»“æ„çš„äº‹æƒ… ä¸‹é¢çš„å¤åˆ¶ä»»åŠ¡é‡Œæœ‰  </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> gulp = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;gulp&#x27;</span>),</span><br><span class=\"line\"><span class=\"comment\">//\tå›¾ç‰‡å‹ç¼©æ’ä»¶</span></span><br><span class=\"line\">\timagemin = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;gulp-imagemin&#x27;</span>),</span><br><span class=\"line\"><span class=\"comment\">//\tæ·±åº¦å‹ç¼©pngå›¾ç‰‡æ’ä»¶</span></span><br><span class=\"line\">\timageminPngquant = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;imagemin-pngquant&#x27;</span>),</span><br><span class=\"line\"><span class=\"comment\">//\tä½¿ç”¨â€gulp-cacheâ€åªå‹ç¼©ä¿®æ”¹çš„å›¾ç‰‡æ’ä»¶</span></span><br><span class=\"line\">\tcache = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;gulp-cache&#x27;</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">//å›¾ç‰‡å‹ç¼©ä»»åŠ¡</span></span><br><span class=\"line\">gulp.task(<span class=\"string\">&#x27;imagemin&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\"> \tgulp.src(<span class=\"string\">&#x27;image/*.&#123;png,jpg,gif,ico&#125;&#x27;</span>)</span><br><span class=\"line\">        .pipe(imagemin(&#123;</span><br><span class=\"line\">            progressive: <span class=\"literal\">true</span>,</span><br><span class=\"line\">            svgoPlugins: [&#123;<span class=\"attr\">removeViewBox</span>: <span class=\"literal\">false</span>&#125;],</span><br><span class=\"line\">            use: [imageminPngquant()] </span><br><span class=\"line\">        &#125;))</span><br><span class=\"line\">        <span class=\"comment\">//å›¾ç‰‡å‹ç¼©è´¨é‡</span></span><br><span class=\"line\">    \t.pipe(imageminPngquant(&#123;<span class=\"attr\">quality</span>: <span class=\"string\">&#x27;65-80&#x27;</span>, <span class=\"attr\">speed</span>: <span class=\"number\">2</span>&#125;)())</span><br><span class=\"line\">    \t.pipe(gulp.dest(<span class=\"string\">&#x27;dist/img&#x27;</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">//å¤åˆ¶ä»»åŠ¡</span></span><br><span class=\"line\">gulp.task(<span class=\"string\">&#x27;copy&#x27;</span>,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//å¤åˆ¶frozenUIç›¸å…³ä¾èµ–</span></span><br><span class=\"line\">\tgulp.src(<span class=\"string\">&#x27;bower_components/frozenui/dist/css/*&#x27;</span>)</span><br><span class=\"line\">\t    .pipe(gulp.dest(<span class=\"string\">&#x27;css/fronzenUI/css&#x27;</span>));</span><br><span class=\"line\">\t<span class=\"comment\">//å¤åˆ¶font-awesomeç›¸å…³ä¾èµ–</span></span><br><span class=\"line\">    <span class=\"comment\">//æƒ³å¤åˆ¶ç›®å½•ç»“æ„ï¼Ÿæ²¡é”™ï¼Œåœ¨ä½ æƒ³å¤åˆ¶çš„ç›®å½•åé¢åŠ *è¿™ä¸ªç›®å½•ä¼šè¢«ä¸€åŒå¤åˆ¶è¿‡å»</span></span><br><span class=\"line\">\tgulp.src([<span class=\"string\">&#x27;bower_components/font-awesome/css*/*.min.*&#x27;</span>,</span><br><span class=\"line\">\t<span class=\"string\">&#x27;bower_components/font-awesome/fonts*/*&#x27;</span>])</span><br><span class=\"line\">\t    .pipe(gulp.dest(<span class=\"string\">&#x27;css/font-awesome&#x27;</span>));</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h4><span id=\"the-end\">THE END</span><a href=\"#the-end\" class=\"header-anchor\">#</a></h4>","categories":["æ„å»ºå·¥å…·","å‰ç«¯"],"tags":["gulp","å‰ç«¯'","æ„å»ºå·¥å…·"]},{"title":"RNï¼ˆreact nativeï¼‰å…¥å‘æŒ‡å—_02,ä¸€ä¸ªç™»å½•ç¤ºä¾‹","url":"https://pkaq.org/2015/12/16/rn-login-02/","content":"<p>Githubä¸Šå‘ç°ä¸€åªç™»å½•ç¤ºä¾‹ï¼Œæ‹¿æ¥å°é²œ,è¿™é‡Œéœ€è¦æ³¨æ„çš„å‘æœ‰å¦‚ä¸‹ä¸¤ç‚¹<br>  1.å…³äºæ³¨é‡Šï¼Œæ©â€¦</p>\n<blockquote>\n<p>  // å•è¡Œ<br>  /*å¤šè¡Œ */</p>\n</blockquote>\n<p>è¿™ä¸ªè‡ªç„¶ä¸ç”¨è¯´ï¼Œéœ€è¦è¯´çš„æ˜¯ï¼Œä½ å¾—åœ¨å¤–é¢åŠ ä¸€å±‚{}ç»™åŒ…èµ·æ¥</p>\n<p>2.winä¸‹å¼•ç”¨é™æ€èµ„æºå›¾ç‰‡ä¼šå‡ºç°å¼•ç”¨åˆ°æ˜¾ç¤ºä¸å‡ºæ¥çš„Bugï¼Œå…³äºè¿™ä¸ªé—®é¢˜å‚è€ƒé“¾æ¥1,2é‡Œç»™å‡ºäº†ä¸åŒçš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘è¿™é‡Œé‡‡ç”¨çš„æ˜¯Stackoverflowçš„è§£å†³æ–¹å¼ã€‚</p>\n<a id=\"more\"></a>\n<p>å¦‚æœä½ æƒ³å¼•ç”¨æœ¬åœ°èµ„æºè¾£ä¹ˆæœ‰ä¸¤ç§æ–¹å¼<br>1.ä½¿ç”¨xcassets folder<br>2.ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œè¿™é‡Œçš„å‘ç‚¹åœ¨äºï¼Œå½“ä½ </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">require</span>(<span class=\"string\">&#x27;image!google&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<p>è¿™ä¹ˆå†™çš„æ—¶å€™ï¼Œå¾ˆå¯èƒ½çº¢å±æˆ–è€…å¼•ç”¨åˆ°äº†ä¸æ˜¾ç¤ºï¼Œæ‰€ä»¥å»ºè®®é‡‡ç”¨</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">source=&#123;&#123; <span class=\"attr\">uri</span>: <span class=\"string\">&quot;google&quot;</span>, <span class=\"attr\">isStatic</span>: <span class=\"literal\">true</span> &#125;&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™ç§æ–¹å¼å»å¼•ç”¨ï¼Œå¦‚æœä½ æ˜¯å®‰å¾·çŒ´çš„è¯ï¼ŒæŠŠä½ çš„å›¾ç‰‡æ”¾åˆ°drawableä¸‹é¢å°±å¥½äº†ã€‚ï¼šï¼‰</p>\n<p>åºŸè¯ä¸å¤šè¯´ ç›´æ¥æ’¸ä»£ç ,ä¸ºä»€ä¹ˆæ²¡æœ‰buttonå‘¢ å› ä¸ºTouchablexxxçš„å°±æ˜¯buttonå•Š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&#x27;use strict&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> React = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;react-native&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">//ç»„ä»¶æ³¨å†Œ</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> &#123;</span><br><span class=\"line\">    AppRegistry,</span><br><span class=\"line\">    StyleSheet,</span><br><span class=\"line\">    Image,</span><br><span class=\"line\">    TextInput,</span><br><span class=\"line\">    Text,</span><br><span class=\"line\">    ScrollView,</span><br><span class=\"line\">    TouchableOpacity,</span><br><span class=\"line\">    RCTImage,</span><br><span class=\"line\">    View</span><br><span class=\"line\">&#125; = React</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> react = React.createClass(&#123;</span><br><span class=\"line\">    <span class=\"comment\">//æ¸²æŸ“ç•Œé¢</span></span><br><span class=\"line\">    render: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (</span><br><span class=\"line\">            &lt;ScrollView</span><br><span class=\"line\">                contentContainerStyle=&#123;&#123;<span class=\"attr\">flex</span>:<span class=\"number\">1</span>&#125;&#125;</span><br><span class=\"line\">                keyboardDismissMode=<span class=\"string\">&#x27;on-drag&#x27;</span></span><br><span class=\"line\">                keyboardShouldPersistTaps=&#123;<span class=\"literal\">false</span>&#125;</span><br><span class=\"line\">            &gt;</span><br><span class=\"line\">                &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class=\"line\">                    &#123;<span class=\"comment\">/*LOGO*/</span>&#125;</span><br><span class=\"line\">                    &lt;Image</span><br><span class=\"line\">                        source=&#123;&#123; <span class=\"attr\">uri</span>: <span class=\"string\">&quot;logo&quot;</span>, <span class=\"attr\">isStatic</span>: <span class=\"literal\">true</span> &#125;&#125;</span><br><span class=\"line\">                        style=&#123;styles.logo&#125;/&gt;</span><br><span class=\"line\">                    &#123;<span class=\"comment\">/*ç”¨æˆ·å*/</span>&#125;</span><br><span class=\"line\">                    &lt;TextInput</span><br><span class=\"line\">                        ref=&#123;<span class=\"function\">(<span class=\"params\">username</span>) =&gt;</span> <span class=\"built_in\">this</span>.username = username&#125;</span><br><span class=\"line\">                        onFocus=&#123;<span class=\"function\">() =&gt;</span> <span class=\"built_in\">this</span>.username.focus()&#125;</span><br><span class=\"line\">                        style=&#123;styles.input&#125;</span><br><span class=\"line\">                        placeholder=<span class=\"string\">&#x27;è¯·è¾“å…¥ç”¨æˆ·å&#x27;</span>/&gt;</span><br><span class=\"line\">                    &#123;<span class=\"comment\">/*å¯†ç */</span>&#125;</span><br><span class=\"line\">                    &lt;TextInput</span><br><span class=\"line\">                        ref=&#123;<span class=\"function\">(<span class=\"params\">password</span>) =&gt;</span> <span class=\"built_in\">this</span>.password = password&#125;</span><br><span class=\"line\">                        onFocus=&#123;<span class=\"function\">() =&gt;</span> <span class=\"built_in\">this</span>.password.focus()&#125;</span><br><span class=\"line\">                        style=&#123;styles.input&#125;</span><br><span class=\"line\">                        placeholder=<span class=\"string\">&#x27;è¯·è¾“å…¥å¯†ç &#x27;</span></span><br><span class=\"line\">                        password=&#123;<span class=\"literal\">true</span>&#125;/&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">                    &lt;TouchableOpacity</span><br><span class=\"line\">                        style=&#123;styles.btn&#125;</span><br><span class=\"line\">                        onPress=&#123;<span class=\"function\">() =&gt;</span> <span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;press me&#x27;</span>)&#125;&gt;</span><br><span class=\"line\">                        &#123;<span class=\"comment\">/*ç™»å½•*/</span>&#125;</span><br><span class=\"line\">                        &lt;Text style=&#123;styles.text&#125;&gt;ç™»å½•&lt;/Text&gt;</span><br><span class=\"line\">                    &lt;/TouchableOpacity&gt;</span><br><span class=\"line\">                &lt;/View&gt;</span><br><span class=\"line\">            &lt;/ScrollView&gt;</span><br><span class=\"line\">        );</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> styles = StyleSheet.create(&#123;</span><br><span class=\"line\">    container: &#123;</span><br><span class=\"line\">        flex: <span class=\"number\">1</span>,</span><br><span class=\"line\">        paddingLeft: <span class=\"number\">10</span>,</span><br><span class=\"line\">        paddingRight: <span class=\"number\">10</span>,</span><br><span class=\"line\">        alignItems: <span class=\"string\">&#x27;center&#x27;</span>,</span><br><span class=\"line\">        backgroundColor: <span class=\"string\">&#x27;#F5FCFF&#x27;</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    logo: &#123;</span><br><span class=\"line\">        width: <span class=\"number\">160</span>,</span><br><span class=\"line\">        height: <span class=\"number\">160</span>,</span><br><span class=\"line\">        marginTop: <span class=\"number\">100</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    input: &#123;</span><br><span class=\"line\">        marginTop: <span class=\"number\">10</span>,</span><br><span class=\"line\">        height: <span class=\"number\">40</span>,</span><br><span class=\"line\">        borderRadius: <span class=\"number\">5</span>,</span><br><span class=\"line\">        borderWidth: <span class=\"number\">1</span>,</span><br><span class=\"line\">        borderColor: <span class=\"string\">&#x27;lightblue&#x27;</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    text: &#123;</span><br><span class=\"line\">        fontWeight: <span class=\"string\">&#x27;bold&#x27;</span>,</span><br><span class=\"line\">        fontSize: <span class=\"number\">14</span>,</span><br><span class=\"line\">        color: <span class=\"string\">&#x27;#FFF&#x27;</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    btn: &#123;</span><br><span class=\"line\">        alignSelf: <span class=\"string\">&#x27;stretch&#x27;</span>,</span><br><span class=\"line\">        alignItems: <span class=\"string\">&#x27;center&#x27;</span>,</span><br><span class=\"line\">        justifyContent: <span class=\"string\">&#x27;center&#x27;</span>,</span><br><span class=\"line\">        backgroundColor: <span class=\"string\">&#x27;#3333FF&#x27;</span>,</span><br><span class=\"line\">        height: <span class=\"number\">40</span>,</span><br><span class=\"line\">        borderRadius: <span class=\"number\">5</span>,</span><br><span class=\"line\">        marginTop: <span class=\"number\">10</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">AppRegistry.registerComponent(<span class=\"string\">&#x27;react&#x27;</span>, <span class=\"function\">() =&gt;</span> react);</span><br></pre></td></tr></table></figure>\n\n\n<p>å‚è€ƒæŒ‡å—:<br>   <a href=\"https://github.com/hufeng/iThink/issues/3\">React Nativeç™»å½•ç¤ºä¾‹</a><br>   <a href=\"http://stackoverflow.com/questions/29308937/trouble-requiring-image-module-in-react-native/33472934#33472934\">Winä¸‹RNçš„å›¾ç‰‡å‘</a><br>   <a href=\"http://bbs.react-native.cn/topic/17/0-14-0-16-%E5%9C%A8windows%E4%B8%8B%E5%BC%80%E5%8F%91-%E5%9B%BE%E7%89%87%E6%98%BE%E7%A4%BA%E4%B8%8D%E5%87%BA%E6%9D%A5\">Winä¸‹RNçš„å›¾ç‰‡å‘ä¹‹æ”¹æºç è§£å†³æ–¹æ¡ˆ</a></p>\n","categories":["React Native"],"tags":["React Native"]},{"title":"RNï¼ˆreact nativeï¼‰å…¥å‘æŒ‡å—-01,Hello RN","url":"https://pkaq.org/2015/12/16/rn-hello-01/","content":"<h4><span id=\"xie-zai-qian-mian\">å†™åœ¨å‰é¢</span><a href=\"#xie-zai-qian-mian\" class=\"header-anchor\">#</a></h4><p>  ç›®å‰æœ€çƒ­çš„æ¡†æ¶ä¹‹ä¸€,å¯ä»¥é€šè¿‡æ›´æ–°è¿œç«¯JSï¼Œç›´æ¥æ›´æ–°app, ç”¨ JavaScript è°ƒèµ· native ç»„ä»¶ï¼Œå°†å¢å¼ºä¸é«˜æ€§èƒ½ç»„ä»¶äº¤ç»™ native æ¥å¤„ç† ï¼Œç›¸æ¯”å…¶ä»–hybridæ¡†æ¶è€Œè¨€å¹¶éé€šè¿‡webviewæ¥è°ƒç”¨åŸç”Ÿç»„ä»¶,è€Œæ˜¯ç›´æ¥è°ƒç”¨æ“ä½œç³»ç»Ÿè‡ªå¸¦çš„javascriptCore<br>  React Native only supports Android 4.1 and above</p>\n<p>  ç”±äºFacebookåŸºæœ¬äººæ‰‹mac+iphoneï¼Œæ‰€ä»¥ç”¨win+androidæ¥æçš„åŒå­¦ å¦‚æœä½ åœ¨å­¦ä¹ ä½¿ç”¨çš„è¿‡ç¨‹ä¸­å‡ºç°äº†å„ç§è«åå…¶å¦™çš„æ„æƒ³ä¸åˆ°çš„é—®é¢˜ï¼Œè¾£ä¹ˆ è¿™ä¸€åˆ‡éƒ½åœ¨æƒ…ç†ä¹‹ä¸­ï¼Œæœ‰æ¡ä»¶çš„åŒå­¦å»ºè®®å®æ„¿linuxä¹Ÿä¸è¦winä¸‹æï¼Œæ­¤å¤„é€ä½ å‰äººè¸©å‘å®å…¸ä¸¤å†Œ<br>   <a href=\"https://github.com/pkaq/react-native-android-lession/blob/master/react-android-lession2.%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB.md/\">ç‚¹æˆ‘ä¼ é€ - è¸©å‘å®å…¸&lt;ä¸Š&gt;</a></p>\n<p>   <a href=\"http://bbs.react-native.cn/category/3/blogs\">ç‚¹æˆ‘ä¼ é€ - è¸©å‘å®å…¸&lt;ä¸‹&gt;</a></p>\n<p>   â€“ 2018/07/31æ›´æ–°</p>\n<a id=\"more\"></a>\n\n<h4><span id=\"0-huan-jing\">0.ç¯å¢ƒ</span><a href=\"#0-huan-jing\" class=\"header-anchor\">#</a></h4><pre><code>0.rnï¼š0.56\n1.windows : 10\n2.node : 10.0.4\n3.npm : 6.1.0\n4.yarn 1.7</code></pre>\n<h4><span id=\"1-an-zhuang\">1.å®‰è£…</span><a href=\"#1-an-zhuang\" class=\"header-anchor\">#</a></h4><p>  å®‰è£…æ¯”è¾ƒç®€å• åŸºæœ¬æŒ‰ç…§å®˜ç½‘è¯´æ˜èµ°å°±è¡Œäº†,å”¯ä¸€éœ€è¦æ³¨æ„çš„å°±æ˜¯<br><strong><em>è¯·æ—¶åˆ»ä¿æŒç¿»å¢™çŠ¶æ€</em></strong><br><strong><em>è¯·æ—¶åˆ»ä¿æŒç¿»å¢™çŠ¶æ€</em></strong><br><strong><em>è¯·æ—¶åˆ»ä¿æŒç¿»å¢™çŠ¶æ€</em></strong></p>\n<p>å½“ç„¶æœ€å¥½ä½¿ç”¨å®‰è£…gitåè‡ªå¸¦çš„git bash ä¸è¦ç”¨cmdäº†ã€‚   </p>\n<p>   <a href=\"https://facebook.github.io/react-native/docs/getting-started.html#content\">å®˜ç½‘è¯´æ˜ä¼ é€é—¨</a></p>\n<p>ä¸ºäº†æ–¹ä¾¿å°è¯­ç§çš„åŒå­¦ï¼Œè¿™é‡Œç®€å•èµ˜è¿°ä¸€ä¸‹<br>1.ä½ éœ€è¦å®‰è£…nodejs 10.0 ä»¥ä¸Šçš„ç‰ˆæœ¬</p>\n<p>ç„¶åä½ å°±å¯ä»¥å¼€å§‹å®‰è£…RNäº†,è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯winä¸‹å¯èƒ½ä¼šæç¤ºä½ ç¼ºå°‘å„ç§ä¾èµ–çš„æ¨¡å—åŒ…ï¼Œè€å¿ƒå®‰è£…ï¼Œå¹¶ä¸æ˜¯æ²¡æœ‰å°½å¤´â€¦</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install -g create-react-native-app</span><br></pre></td></tr></table></figure>\n<h4><span id=\"2-hello-world\">2.Hello World</span><a href=\"#2-hello-world\" class=\"header-anchor\">#</a></h4><p>æŠ˜è…¾å®Œäº†ç°åœ¨å¼€å§‹åˆ›å»ºä½ çš„é¡¹ç›®å§ï¼Œç”¨ä¸‹é¢çš„å‘½ä»¤(AwesomeProject(è¶…å±Œçš„é¡¹ç›®),åå­—ä½ å¯ä»¥éšä¾¿èµ·ï¼ˆå…¶å®ä¸èƒ½éšä¾¿èµ·ï¼Œåƒä¸‡ä¸è¦å¸¦æœ‰reactè¿™ä¸ªå•è¯ï¼Œå¦åˆ™ä¼šå‡ºç°è«åå…¶å¦™çš„é—®é¢˜ï¼‰ï¼Œè¿™æ˜¯å®˜æ–¹ç¤ºä¾‹ç»™çš„ä¸€ä¸ªåå­—)</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">create-react-native-app AwesomeProject</span><br></pre></td></tr></table></figure>\n<p>åˆ›å»ºå®Œæˆåè·³åˆ°é¡¹ç›®è·Ÿç›®å½•è®©ä»–åœ¨ä½ çš„å®‰å“æœºä¸Šè·‘èµ·æ¥å§ï¼šï¼‰<br><a href=\"https://facebook.github.io/react-native/docs/getting-started.html\">å®˜æ–¹æ–‡æ¡£ä¼ é€é—¨</a></p>\n<p>å®‰è£…Expo , å¹¶ä¸”ä¿è¯ä½ çš„æœºå™¨æ‰€ç”¨çš„ç½‘ç»œè·Ÿpcåœ¨åŒä¸€ä¸ªå±€åŸŸç½‘æ®µ,å¯ä»¥ä½¿ç”¨ <code>set REACT_NATIVE_PACKAGER_HOSTNAME</code> æ¥è®¾ç½®ä½¿ç”¨å“ªä¸ªip</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd AwesomeProject</span><br><span class=\"line\">yarn start</span><br></pre></td></tr></table></figure>\n<p>çœŸæœºæˆ–è€…ç”¨æ¨¡æ‹Ÿå™¨è¿è¡Œç¨‹åº</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yarn android</span><br></pre></td></tr></table></figure>\n<p>ç°åœ¨ ä½ åº”è¯¥å·²ç»çœ‹åˆ°å®˜æ–¹ä¸ºä½ å‡†å¤‡çš„Welcomeé¡µé¢äº†ï¼Œè¿™ä¸ªé¡µé¢åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„app.jsä¸‹</p>\n<p>å‚è€ƒé“¾æ¥:<br>  <a href=\"https://facebook.github.io/react-native/docs/getting-started.html\">ç‚¹æˆ‘ä¼ é€ - å®˜æ–¹æ–‡æ¡£</a><br>  <a href=\"https://github.com/pkaq/react-native-android-lession/blob/master/react-android-lession2.%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB.md/\">ç‚¹æˆ‘ä¼ é€ - è¸©å‘å®å…¸&lt;ä¸Š&gt;</a><br>  <a href=\"http://bbs.react-native.cn/category/3/blogs\">ç‚¹æˆ‘ä¼ é€ - è¸©å‘å®å…¸&lt;ä¸‹&gt;</a></p>\n","categories":["React Native","Hybrid"],"tags":["React Native","Hybrid"]},{"title":"cordovaç¬”è®°-é…ç½®å®‰è£…ä»¥åŠhello world","url":"https://pkaq.org/2015/11/24/cordova-1/","content":"<p><a href=\"http://segmentfault.com/a/1190000002560220\">&gt;&gt;è¯·ç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹åŸæ–‡&lt;&lt;</a></p>\n<a id=\"more\"></a>\n<p>1.å®‰è£…nodejs </p>\n<p>2.å®‰è£…coordovaæ¨¡å—</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install -g cordova</span><br></pre></td></tr></table></figure>\n<p>è¿™ä¸ªå®‰è£…è¿‡ç¨‹éœ€è¦èŠ±è´¹å¾ˆé•¿çš„æ—¶é—´ï¼Œæ¨èé‡‡ç”¨ <a href=\"http://segmentfault.com/a/1190000000471219\">æ·˜å®çš„npmé•œåƒ</a></p>\n<p>3.å®‰è£…androidå¼€å‘ç¯å¢ƒå¹¶ä¸”é…ç½®ç¯å¢ƒå˜é‡ï¼Œåœ¨Terminalé‡Œé¢è¾“å…¥androidçœ‹çœ‹æœ‰æ²¡æœ‰androidçš„ç‰ˆæœ¬ç®¡ç†å™¨å‡ºæ¥å°±è¯´æ˜é…ç½®æœ‰æ²¡æœ‰åšå¥½ï¼Œå…³äºå¦‚ä½•é…ç½®ç¯å¢ƒå˜é‡æœç´ ä¸€ä¸‹ï¼Œ<a href=\"http://www.micmiu.com/lang/java/set-javahome-on-mac-os-x/\">macçš„çœ‹è¿™é‡Œ</a>  </p>\n<p>4.å®‰è£…antï¼Œcordovaé‡‡ç”¨antæ¥åšçš„æŒç»­é›†æˆï¼Œéœ€è¦é…ç½®antç¯å¢ƒï¼Œæœç´ ä¸€ä¸‹ï¼Œ<br><a href=\"http://blog.csdn.net/crazybigfish/article/details/18215439\">macçš„çœ‹è¿™é‡Œ</a></p>\n<p>5.åˆ›å»ºHelloWorldæ‰§è¡Œå‘½ä»¤</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cordova create hello com.example.hello HelloWorld</span><br></pre></td></tr></table></figure>\n<p>è¿™ä¸ªè¿‡ç¨‹å¼‚å¸¸çš„è‰°éš¾ï¼Œå¸Œæœ›ä½ æœ‰ä¸ªå¥½ç½‘ç»œ</p>\n<p>6.é…ç½®å¼€å‘å¹³å°ï¼Œè¿›å…¥helloç›®å½•ï¼Œæ‰§è¡Œ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cordova platform add android</span><br></pre></td></tr></table></figure>\n<p>7.ç¼–è¯‘</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cordova build</span><br></pre></td></tr></table></figure>\n<p>8.å®‰è£…ï¼Œéå¸¸ä¸å–œæ¬¢è™šæ‹Ÿæœºï¼Œæ‰€ä»¥ç›´æ¥æ’ä¸Šandroidè¿è¡Œ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cordova run android</span><br></pre></td></tr></table></figure>\n<p>å¦‚æœå¸Œæœ›å¯åŠ¨è™šæ‹Ÿæœº</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cordova emulate android</span><br></pre></td></tr></table></figure>\n<p>ç„¶åä¸€ä¸ªå¾ˆå‚»çš„ï¼Œæ²¡æœ‰ä»€ä¹ˆåŠŸèƒ½çš„åº”ç”¨å°±è£…åœ¨æ‰‹æœºä¸Šäº†</p>\n<p>9.è¿›ä¸€æ­¥å¼€å‘ï¼Œç”¨Android Studioå¯¼å…¥å·¥ç¨‹ï¼Œåœ¨\\hello\\wwwç›®å½•ä¸‹å°±æ˜¯htmlå¼€å‘å†…å®¹ï¼Œhybridçš„å¼€å‘å°±åœ¨è¿™é‡Œåš<br>åœ¨è¿™ä¸ªé˜¶æ®µä¸­å¯¹ç¯å¢ƒå˜é‡çš„ä¿®æ”¹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export PATH=&quot;$PATH:/Users/xxx/android-sdk-macosx/platform-tools&quot;</span><br><span class=\"line\">export PATH=&quot;$PATH:/Users/xxx/android-sdk-macosx/tools&quot;</span><br><span class=\"line\">export PATH=&quot;$PATH:/Users/xxx/android-sdk-macosx&quot;</span><br><span class=\"line\">export PATH=&quot;$PATH:/Users/xxx/apache-ant-1.9.4/bin&quot;</span><br><span class=\"line\">export JAVA_HOME=`/usr/libexec/java_home`</span><br></pre></td></tr></table></figure>\n\n\n","categories":[],"tags":["Cordova","Android"]},{"title":"MongoDB 3.x ç¬”è®° - 2ï¼šç”¨æˆ·åˆ›å»ºå’Œé‰´æƒé…ç½®","url":"https://pkaq.org/2015/10/26/mongo1/","content":"<p>MongoDBé»˜è®¤å®‰è£…åæ˜¯ä¸éœ€è¦å¯†ç çš„ã€‚<br>æ­¤æ—¶ä½  show dbs ä¼šçœ‹åˆ°åªæœ‰ä¸€ä¸ªlocalæ•°æ®åº“ï¼Œé‚£ä¸ªæ‰€è°“çš„adminæ˜¯ä¸å­˜åœ¨çš„ã€‚</p>\n<p>mongoDB æ²¡æœ‰rootï¼Œåªæœ‰èƒ½ç®¡ç†ç”¨æˆ·çš„ç”¨æˆ· userAdminAnyDatabaseã€‚</p>\n<a id=\"more\"></a>\n<h4><span id=\"1-she-zhi-jian-quan-mo-shi\">1.è®¾ç½®é‰´æƒæ¨¡å¼</span><a href=\"#1-she-zhi-jian-quan-mo-shi\" class=\"header-anchor\">#</a></h4><p>è¿™é‡Œç”±äºMongo3ä»¥åé»˜è®¤çš„é‰´æƒæœºåˆ¶æ›´æ”¹ä¸ºSCRAM-SHA-1,è€Œspring-bootç›´åˆ° 1.3.0 rc ä»ç„¶ä¸æ”¯æŒMongo3 çš„æ–°é»˜è®¤é‰´æƒæ–¹å¼ æ‰€ä»¥è¿™é‡ŒæŒ‡å®šä¸ºæ—§ç‰ˆæœ¬æ–¹å¼MONGODB-CR</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">åˆ‡æ¢åˆ°adminåº“</span></span><br><span class=\"line\">use admin</span><br><span class=\"line\"><span class=\"meta\">   #</span><span class=\"bash\">æŸ¥è¯¢authSchema</span></span><br><span class=\"line\">   var schema = db.system.version.findOne(&#123;â€œ_idâ€ : â€œauthSchemaâ€&#125;) </span><br><span class=\"line\"><span class=\"meta\">   #</span><span class=\"bash\">è®¾ç½®ä¸ºMONGODB-CR</span></span><br><span class=\"line\">   schema.currentVersion = 3 </span><br><span class=\"line\"><span class=\"meta\">   #</span><span class=\"bash\"><span class=\"comment\">#ä¿å­˜</span></span></span><br><span class=\"line\">   db.system.version.save(schema) </span><br></pre></td></tr></table></figure>\n<p>å®šä¹‰ï¼š<br>åˆ›å»ºä¸€ä¸ªæ•°æ®åº“æ–°ç”¨æˆ·ç”¨db.createUser()æ–¹æ³•ï¼Œå¦‚æœç”¨æˆ·å­˜åœ¨åˆ™è¿”å›ä¸€ä¸ªç”¨æˆ·é‡å¤é”™è¯¯ã€‚</p>\n<h4><span id=\"2-yong-hu-chuang-jian\">2ã€ç”¨æˆ·åˆ›å»º</span><a href=\"#2-yong-hu-chuang-jian\" class=\"header-anchor\">#</a></h4><p>è¯­æ³•ï¼š<br>db.createUser(user, writeConcern)<br>    userè¿™ä¸ªæ–‡æ¡£åˆ›å»ºå…³äºç”¨æˆ·çš„èº«ä»½è®¤è¯å’Œè®¿é—®ä¿¡æ¯ï¼›<br>    writeConcernè¿™ä¸ªæ–‡æ¡£æè¿°ä¿è¯MongoDBæä¾›å†™æ“ä½œçš„æˆåŠŸæŠ¥å‘Šã€‚</p>\n<p>Â· useræ–‡æ¡£ï¼Œå®šä¹‰äº†ç”¨æˆ·çš„ä»¥ä¸‹å½¢å¼ï¼š<br>{ user: â€œ<name>â€œ,<br>  pwd: â€œ<cleartext password>â€œ,<br>  customData: { <any information> },<br>  roles: [<br>    { role: â€œ<role>â€œ, db: â€œ<database>â€œ } | â€œ<role>â€œ,<br>    â€¦<br>  ]<br>}</role></database></role></any></cleartext></name></p>\n<p>useræ–‡æ¡£å­—æ®µä»‹ç»ï¼š<br>    userå­—æ®µï¼Œä¸ºæ–°ç”¨æˆ·çš„åå­—ï¼›<br>    pwdå­—æ®µï¼Œç”¨æˆ·çš„å¯†ç ï¼›<br>    cusomDataå­—æ®µï¼Œä¸ºä»»æ„å†…å®¹ï¼Œä¾‹å¦‚å¯ä»¥ä¸ºç”¨æˆ·å…¨åä»‹ç»ï¼›<br>    roleså­—æ®µï¼ŒæŒ‡å®šç”¨æˆ·çš„è§’è‰²ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªç©ºæ•°ç»„ç»™æ–°ç”¨æˆ·è®¾å®šç©ºè§’è‰²ï¼›<br>    åœ¨roleså­—æ®µ,å¯ä»¥æŒ‡å®šå†…ç½®è§’è‰²å’Œç”¨æˆ·å®šä¹‰çš„è§’è‰²ã€‚</p>\n<pre><code>Built-In Rolesï¼ˆå†…ç½®è§’è‰²ï¼‰ï¼š\n1. æ•°æ®åº“ç”¨æˆ·è§’è‰²ï¼šreadã€readWrite;\n2. æ•°æ®åº“ç®¡ç†è§’è‰²ï¼šdbAdminã€dbOwnerã€userAdminï¼›\n3. é›†ç¾¤ç®¡ç†è§’è‰²ï¼šclusterAdminã€clusterManagerã€clusterMonitorã€hostManagerï¼›\n4. å¤‡ä»½æ¢å¤è§’è‰²ï¼šbackupã€restoreï¼›\n5. æ‰€æœ‰æ•°æ®åº“è§’è‰²ï¼šreadAnyDatabaseã€readWriteAnyDatabaseã€userAdminAnyDatabaseã€dbAdminAnyDatabase\n6. è¶…çº§ç”¨æˆ·è§’è‰²ï¼šroot  \n// è¿™é‡Œè¿˜æœ‰å‡ ä¸ªè§’è‰²é—´æ¥æˆ–ç›´æ¥æä¾›äº†ç³»ç»Ÿè¶…çº§ç”¨æˆ·çš„è®¿é—®ï¼ˆdbOwner ã€userAdminã€userAdminAnyDatabaseï¼‰\n7. å†…éƒ¨è§’è‰²ï¼š__system\nPSï¼šå…³äºæ¯ä¸ªè§’è‰²æ‰€æ‹¥æœ‰çš„æ“ä½œæƒé™å¯ä»¥ç‚¹å‡»ä¸Šé¢çš„å†…ç½®è§’è‰²é“¾æ¥æŸ¥çœ‹è¯¦æƒ…ã€‚</code></pre>\n<p>Â· writeConcernæ–‡æ¡£ï¼ˆå®˜æ–¹è¯´æ˜ï¼‰<br>    wé€‰é¡¹ï¼šå…è®¸çš„å€¼åˆ†åˆ«æ˜¯ 1ã€0ã€å¤§äº1çš„å€¼ã€â€majorityâ€ã€<tag set>ï¼›<br>    jé€‰é¡¹ï¼šç¡®ä¿mongodå®ä¾‹å†™æ•°æ®åˆ°ç£ç›˜ä¸Šçš„journalï¼ˆæ—¥å¿—ï¼‰ï¼Œè¿™å¯ä»¥ç¡®ä¿mongdä»¥å¤–å…³é—­ä¸ä¼šä¸¢å¤±æ•°æ®ã€‚è®¾ç½®trueå¯ç”¨ã€‚<br>    wtimeoutï¼šæŒ‡å®šä¸€ä¸ªæ—¶é—´é™åˆ¶,ä»¥æ¯«ç§’ä¸ºå•ä½ã€‚wtimeoutåªé€‚ç”¨äºwå€¼å¤§äº1ã€‚</tag></p>\n<p>ä¾‹å¦‚ï¼šåœ¨productsæ•°æ®åº“åˆ›å»ºç”¨æˆ·accountAdmin01ï¼Œå¹¶ç»™è¯¥ç”¨æˆ·adminæ•°æ®åº“ä¸ŠclusterAdminå’ŒreadAnyDatabaseçš„è§’è‰²ï¼Œproductsæ•°æ®åº“ä¸ŠreadWriteè§’è‰²ã€‚<br>use products<br>db.createUser( { â€œuserâ€ : â€œaccountAdmin01â€,<br>                 â€œpwdâ€: â€œcleartext passwordâ€,<br>                 â€œcustomDataâ€ : { employeeId: 12345 },<br>                 â€œrolesâ€ : [ { role: â€œclusterAdminâ€, db: â€œadminâ€ },<br>                             { role: â€œreadAnyDatabaseâ€, db: â€œadminâ€ },<br>                             â€œreadWriteâ€<br>                             ] },<br>               { w: â€œmajorityâ€ , wtimeout: 5000 } )</p>\n<h4><span id=\"pei-zhi-an-quan-yan-zheng\">é…ç½®å®‰å…¨éªŒè¯</span><a href=\"#pei-zhi-an-quan-yan-zheng\" class=\"header-anchor\">#</a></h4><p>è¿™é‡Œç”±äºMongo3ä»¥åé»˜è®¤çš„é‰´æƒæœºåˆ¶æ›´æ”¹ä¸ºSCRAM-SHA-1,è€Œspring-bootç›´åˆ° 1.3.0 rc ä»ç„¶ä¸æ”¯æŒMongo3 çš„æ–°é»˜è®¤é‰´æƒæ–¹å¼ æ‰€ä»¥è¿™é‡ŒæŒ‡å®šä¸ºæ—§ç‰ˆæœ¬æ–¹å¼MONGODB-CR</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">security:</span></span><br><span class=\"line\">    <span class=\"attr\">authorization:</span> <span class=\"string\">enabled</span></span><br><span class=\"line\"><span class=\"attr\">setParameter:</span></span><br><span class=\"line\">    <span class=\"attr\">authenticationMechanisms:</span> <span class=\"string\">MONGODB-CR,SCRAM-SHA-1</span></span><br><span class=\"line\">    <span class=\"attr\">enableLocalhostAuthBypass:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">    <span class=\"attr\">logLevel:</span> <span class=\"number\">4</span>      </span><br></pre></td></tr></table></figure>","categories":[],"tags":["MongoDB"]},{"title":"MongoDB 3.x ç¬”è®° - 1ï¼šå®‰è£…","url":"https://pkaq.org/2015/10/24/mongo0/","content":"<p>MongoDB Version : 3.0.x</p>\n<p>  å…³äºmongodbçš„å¥½å¤„ï¼Œä¼˜ç‚¹ä¹‹ç±»çš„è¿™é‡Œå°±ä¸è¯´äº†ï¼Œå”¯ä¸€è¦è®²çš„ä¸€ç‚¹å°±æ˜¯mongodbä¸­æœ‰ä¸‰å…ƒç´ ï¼šæ•°æ®åº“ï¼Œé›†åˆï¼Œæ–‡æ¡£<br>å…¶ä¸­â€œé›†åˆâ€å°±æ˜¯å¯¹åº”å…³ç³»æ•°æ®åº“ä¸­çš„â€œè¡¨â€ï¼Œâ€œæ–‡æ¡£â€å¯¹åº”â€œè¡Œâ€ã€‚</p>\n<p>å®‰è£…æ¯”è¾ƒç®€å•ï¼Œæ¯”å¦‚</p>\n<p>Archä¸‹å¯é€šè¿‡pacman -Sy mongodbè¿›è¡Œå®‰è£…<br>Windowsä¸‹å¯ä¸‹è½½msiè¿›è¡Œå®‰è£…</p>\n<p>æ›´å¤šå¯ä»¥å‚è€ƒå®˜ç½‘DOCæœ‰ååˆ†è¯¦ç»†çš„è¯´æ˜ï¼Œå®‰è£…å®ŒæˆåæŠŠbinç›®å½•åŠ å…¥pathå³å¯ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸‹è°ƒç”¨mongoï¼Œmongodç­‰å‘½ä»¤äº†</p>\n<a id=\"more\"></a>\n\n<p>å¯åŠ¨æ—¶å¯ä»¥é€šè¿‡æŒ‡å®šyamlæ ¼å¼çš„å‚æ•°æ–‡ä»¶è®¾ç½®ä¸€äº›å‚æ•°</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mongod mongocfg/mongodb.conf</span><br></pre></td></tr></table></figure>\n<p>ä¾‹å¦‚å¦‚ä¸‹é…ç½®</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">systemLog:</span></span><br><span class=\"line\">    <span class=\"attr\">destination:</span> <span class=\"string\">file</span></span><br><span class=\"line\">    <span class=\"attr\">path:</span> <span class=\"string\">/opt/mongoHome/log/mongod.log</span></span><br><span class=\"line\"><span class=\"attr\">storage:</span></span><br><span class=\"line\">    <span class=\"attr\">dbPath:</span> <span class=\"string\">/opt/mongoHome/db</span></span><br></pre></td></tr></table></figure>\n<p>Winä¸‹å¯ä»¥ç”¨å¦‚ä¸‹å‘½ä»¤å°†mongodbå®‰è£…ä¸ºç³»ç»ŸæœåŠ¡</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mongod --config &quot;mongod.cfg&quot; --install</span><br></pre></td></tr></table></figure>\n<p>å¯ä»¥è¾“å…¥services.mscé€šè¿‡æœåŠ¡ç®¡ç†å™¨å¯åŠ¨æˆ–è€…ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯åŠ¨</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">net start MongoDB</span><br></pre></td></tr></table></figure>\n\n<p>å¯åŠ¨åå¯é€šè¿‡è¾“å…¥mongoï¼ˆå¦‚æœé…ç½®äº†ç¯å¢ƒå˜é‡ï¼‰ï¼Œæˆ–è€…è¿›å…¥å®‰è£…ç›®å½•\\binä¸‹è¿è¡Œmongoè¿›å…¥mongoæ§åˆ¶å°</p>\n<p>è¾“å…¥helpå¯ä»¥çœ‹åˆ°åŸºæœ¬æ“ä½œå‘½ä»¤ï¼š<br>show dbs:æ˜¾ç¤ºæ•°æ®åº“åˆ—è¡¨<br>show collectionsï¼šæ˜¾ç¤ºå½“å‰æ•°æ®åº“ä¸­çš„é›†åˆï¼ˆç±»ä¼¼å…³ç³»æ•°æ®åº“ä¸­çš„è¡¨ï¼‰<br>show usersï¼šæ˜¾ç¤ºç”¨æˆ·</p>\n<p>use <db name>ï¼šåˆ‡æ¢å½“å‰æ•°æ®åº“ï¼Œè¿™å’ŒMS-SQLé‡Œé¢çš„æ„æ€ä¸€æ ·<br>db.help()ï¼šæ˜¾ç¤ºæ•°æ®åº“æ“ä½œå‘½ä»¤ï¼Œé‡Œé¢æœ‰å¾ˆå¤šçš„å‘½ä»¤<br>db.foo.help()ï¼šæ˜¾ç¤ºé›†åˆæ“ä½œå‘½ä»¤ï¼ŒåŒæ ·æœ‰å¾ˆå¤šçš„å‘½ä»¤ï¼ŒfooæŒ‡çš„æ˜¯å½“å‰æ•°æ®åº“ä¸‹ï¼Œä¸€ä¸ªå«fooçš„é›†åˆï¼Œå¹¶éçœŸæ­£æ„ä¹‰ä¸Šçš„å‘½ä»¤<br>db.foo.find()ï¼šå¯¹äºå½“å‰æ•°æ®åº“ä¸­çš„fooé›†åˆè¿›è¡Œæ•°æ®æŸ¥æ‰¾ï¼ˆç”±äºæ²¡æœ‰æ¡ä»¶ï¼Œä¼šåˆ—å‡ºæ‰€æœ‰æ•°æ®ï¼‰<br>db.foo.find( { a : 1 } )ï¼šå¯¹äºå½“å‰æ•°æ®åº“ä¸­çš„fooé›†åˆè¿›è¡ŒæŸ¥æ‰¾ï¼Œæ¡ä»¶æ˜¯æ•°æ®ä¸­æœ‰ä¸€ä¸ªå±æ€§å«aï¼Œä¸”açš„å€¼ä¸º1</db></p>\n<p>æ›´å¤šå‚æ•°é…ç½®è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£(<a href=\"https://docs.mongodb.org/manual/reference/parameters/\">https://docs.mongodb.org/manual/reference/parameters/</a>)</p>\n","categories":[],"tags":["mongoDB"]},{"title":"WebSphereå®‰è£…","url":"https://pkaq.org/2015/01/27/2015-01-27-websphereinstall/","content":"<h3><span id=\"xia-zai-yu-an-zhuang\">ä¸‹è½½ä¸å®‰è£…</span><a href=\"#xia-zai-yu-an-zhuang\" class=\"header-anchor\">#</a></h3><p>é¦–å…ˆéœ€è¦ä¸‹è½½install manager :<br><a href=\"https://jazz.net/downloads/ibm-installation-manager/\">https://jazz.net/downloads/ibm-installation-manager/</a></p>\n<p>ç„¶åä¸‹è½½websphere<br><a href=\"http://www.ibm.com/developerworks/cn/downloads/ws/wasdevelopers/\">http://www.ibm.com/developerworks/cn/downloads/ws/wasdevelopers/</a></p>\n<p>å®‰è£…install managerå,è§£å‹WebSphere,é€šè¿‡install manageré€‰æ‹©WebSphereè§£å‹ç›®å½•ä½œä¸ºå®‰è£…æº,æ ¹æ®å‘å¯¼å®‰è£…å®Œæˆå³å¯.</p>\n<a id=\"more\"></a>\n<h3><span id=\"bu-shu\">éƒ¨ç½²</span><a href=\"#bu-shu\" class=\"header-anchor\">#</a></h3><p>å®‰è£…å®Œæ¯•åä¼šå¯åŠ¨ä¸€ä¸ªtoolboxå‘å¯¼,åˆ›å»ºä¸€ä¸ªåº”ç”¨æœåŠ¡å™¨çš„æ¦‚è¦æ–‡ä»¶å³å¯,å¯åŠ¨ä¸åœæ­¢å¯ä»¥é€šè¿‡webaphere application serveræ§åˆ¶å°çª—å£è¿›è¡Œæ§åˆ¶<br>å…·ä½“éƒ¨ç½²åº”ç”¨å¯é€šè¿‡åº”ç”¨ç¨‹åº-&gt;æ–°å»ºåº”ç”¨ç¨‹åº,æŒ‰ç…§å‘å¯¼æç¤ºè¿›è¡Œéƒ¨ç½²<br><img src=\"/images/2015/WebSphere/deploy.png\" alt=\"é¡¹ç›®éƒ¨ç½²\"> </p>\n<h3><span id=\"pei-zhi-ssl\">é…ç½®SSL</span><a href=\"#pei-zhi-ssl\" class=\"header-anchor\">#</a></h3><p>æˆ‘ä»¬è¿™é‡Œä»‹ç»çš„WAS SSLé…ç½®æ˜¯åŸºäºWASçš„Application ServeråŸºç¡€ä¹‹ä¸Šï¼Œå¦‚æœè¦åŸºäºWASçš„Http Serverè¯·å‚è€ƒå…¶å®ƒç« èŠ‚ã€‚è¿™é‡Œä»‹ç»çš„æ˜¯åœ¨å·²å®‰è£…å¥½çš„WAS Application Serverä¸Šé…ç½®SSLï¼Œå› ä¸ºWASæä¾›äº†å®Œå–„çš„å¯è§†åŒ–é…ç½®ç•Œé¢ï¼Œæ‰€ä»¥æ•´ä¸ªé…ç½®è¿‡ç¨‹ç›¸æ¯”Tomcatè¦ç®€å•å’Œç›´è§‚å¾ˆå¤šï¼Œå…·ä½“é…ç½®æ­¥éª¤å¦‚ä¸‹ã€‚<br>1.é¦–å…ˆè¿›å…¥WASçš„ç®¡ç†æ§åˆ¶å°ï¼Œå±•å¼€å·¦è¾¹èœå•å½“ä¸­â€å®‰å…¨æ€§ä¸€æ â€ï¼Œç‚¹å‡»å…¶ä¸­çš„â€è¯ä¹¦å’Œå¯†é’¥ç®¡ç†â€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src=\"/images/2015/WebSphere/1.png\" alt=\"é¡¹ç›®éƒ¨ç½²\"><br>ç‚¹å‡»ä¹‹åï¼Œåœ¨å³è¾¹å‡ºç°çš„é¡µé¢å½“ä¸­ç‚¹å‡»â€ç®¡ç†ç«¯ç‚¹å®‰å…¨é…ç½®â€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src=\"/images/2015/WebSphere/2.png\" alt=\"é¡¹ç›®éƒ¨ç½²\"><br>åœ¨å‡ºç°çš„â€ç®¡ç†ç«¯ç‚¹å®‰å…¨é…ç½®â€å‡ºç°çš„é…ç½®é¡µé¢å½“ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆé€‰æ‹©â€å…¥ç«™â€é…ç½®ï¼Œç‚¹å‡»å¦‚ä¸‹å›¾æ‰€ç¤ºçš„é“¾æ¥ï¼š<br><img src=\"/images/2015/WebSphere/3.png\" alt=\"é¡¹ç›®éƒ¨ç½²\"><br>åœ¨å½“å‰èŠ‚ç‚¹é…ç½®é¡µé¢å½“ä¸­ï¼Œç‚¹å‡»â€ç®¡ç†è¯ä¹¦â€æŒ‰é’®ï¼Œå°†æˆ‘ä»¬åˆ›å»ºçš„åä¸ºserver.keystoreçš„è¯ä¹¦æ–‡ä»¶æ·»åŠ åˆ°WASå½“ä¸­ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src=\"/images/2015/WebSphere/4.png\" alt=\"é¡¹ç›®éƒ¨ç½²\"><br>åœ¨å‡ºç°çš„è¯ä¹¦ç®¡ç†çª—å£å½“ä¸­ï¼Œé€šè¿‡ç‚¹å‡»â€å¯¼å…¥â€æŒ‰é’®ï¼Œå°†æˆ‘ä»¬åˆ›å»ºçš„åä¸ºserver.keystoreè¯ä¹¦æ–‡ä»¶å¯¼å…¥åˆ°è¯ä¹¦åº“ä¸­ã€‚<br><img src=\"/images/2015/WebSphere/5.png\" alt=\"é¡¹ç›®éƒ¨ç½²\"><br>å½“ç„¶ï¼Œå¦‚æœæ‚¨æ²¡æœ‰è¿™ä¸ªserver.keystoreæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¿™ä¸ªçª—å£å½“ä¸­çš„æä¾›çš„åä¸ºâ€åˆ›å»ºè‡ªç­¾ç½²è¯ä¹¦â€æŒ‰é’®æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„è¯ä¹¦ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªåˆ›å»ºç•Œé¢ä¸JDKå½“ä¸­æä¾›çš„åŠŸèƒ½ç›¸åŒï¼Œåªæ˜¯å®ƒæ˜¯ä»¥å¯è§†åŒ–çš„æ–¹å¼ä¾›æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè¯ä¹¦ã€‚<br>é€‰æ‹©å¯¼å…¥è¯ä¹¦åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºç•Œé¢ï¼š<br><img src=\"/images/2015/WebSphere/6.png\" alt=\"é¡¹ç›®éƒ¨ç½²\"><br>å¯†é’¥æ–‡ä»¶åï¼šæ˜¯æŒ‡åŒ…å«å®Œæ•´è·¯å¾„çš„æœ¬åœ°å’Œserver.keystoreçš„ä½ç½®ï¼Œæ¯”å¦‚ï¼šE:\\cas\\server.keystoreç­‰<br>ç±»å‹:æˆ‘ä»¬çš„server.keystoreåŠ å¯†ç±»å‹ä¸ºJKSï¼Œæ‰€ä»¥éœ€è¦ä»ä¸‹æ‹‰æ¡†ä¸­é€‰æ‹©JKSå³å¯ã€‚<br>å¯†é’¥æ–‡ä»¶å¯†ç :æˆ‘ä»¬åœ¨ç”Ÿæˆè¿™ä¸ªserver.keystoreè¯ä¹¦æ—¶ä½¿ç”¨çš„å¯†ç ï¼Œæˆ‘ä»¬è¿™é‡Œæ˜¯changeitï¼Œæ‰€ä»¥è¾“å…¥changeitå³å¯ã€‚<br>ä¸€æ—¦è¿™ä¸‰ä¸ªå±æ€§è¾“å…¥å®Œæˆï¼Œå¯ä»¥ç‚¹å‡»â€å¯†é’¥æ–‡ä»¶å¯†ç â€å±æ€§è¾¹ä¸Šçš„â€è·å–å¯†é’¥æ–‡ä»¶åˆ«åâ€æŒ‰é’®ï¼Œå¦‚æœæˆ‘ä»¬å‰ä¸‰ä¸ªå±æ€§è¾“å…¥æ­£ç¡®ï¼Œå°±å¯ä»¥åœ¨ä¸‹é¢çš„â€è¦å¯¼å…¥çš„è¯ä¹¦åˆ«åâ€å±æ€§åˆ—è¡¨ä¸­çœ‹åˆ°server.keystoreè¯ä¹¦çš„åˆ«åï¼Œæˆ‘ä»¬è¿™é‡Œä¸ºâ€tomcatâ€ï¼Œæœ€åç‚¹å‡»ç¡®å®šä¿å­˜å³å¯ï¼Œè¾“å…¥å¥½çš„ä¿¡æ¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src=\"/images/2015/WebSphere/7.png\" alt=\"é¡¹ç›®éƒ¨ç½²\"><br>è¿”å›åˆ°â€ç®¡ç†ç«¯ç‚¹å®‰å…¨é…ç½®â€çª—å£ï¼Œç‚¹å‡»å…¥ç«™NodeèŠ‚ç‚¹ï¼Œè¿›å…¥åˆ°è¯¥èŠ‚ç‚¹çš„å…·ä½“é…ç½®ç•Œé¢ï¼Œå°†å…¶â€å¯†é’¥åº“ä¸­çš„è¯ä¹¦åˆ«åâ€å±æ€§å€¼ä¿®æ”¹ä¸ºæˆ‘ä»¬ä¹‹å‰æ·»åŠ çš„server.keystoreè¯ä¹¦ï¼Œå®ƒçš„åˆ«åä¸ºtomcatï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src=\"/images/2015/WebSphere/8.png\" alt=\"é¡¹ç›®éƒ¨ç½²\"><br>å†æ¬¡å›åˆ°â€ç®¡ç†ç«¯ç‚¹å®‰å…¨é…ç½®â€çª—å£ï¼Œç‚¹å‡»å‡ºç«™NodeèŠ‚ç‚¹ï¼Œè¿›å…¥åˆ°è¯¥èŠ‚ç‚¹çš„å…·ä½“é…ç½®ç•Œé¢,åŒæ ·å°†å…¶â€å¯†é’¥åº“ä¸­çš„è¯ä¹¦åˆ«åâ€å±æ€§å€¼ä¿®æ”¹ä¸ºæˆ‘ä»¬ä¹‹å‰æ·»åŠ çš„server.keystoreè¯ä¹¦ï¼Œå®ƒçš„åˆ«åä¸ºtomcatï¼Œè¿™äº›å·¥ä½œåšå®Œä¹‹åï¼Œæˆ‘ä»¬å°±å°†å½“å‰WAS Application Serverçš„SSLé‡‡ç”¨çš„è¯ä¹¦ä¿®æ”¹æˆæˆ‘ä»¬è‡ªå®šä¹‰çš„åä¸ºserver.keystoreçš„è¯ä¹¦ã€‚<br>WAS Application Serverè¯ä¹¦é…ç½®å®Œæˆä¹‹åï¼Œä¸ºäº†éªŒè¯å½“å‰è¯ä¹¦é…ç½®çš„æ­£ç¡®æ€§ï¼Œå¯ä»¥ç‚¹å‡»æµè§ˆå™¨çš„åœ°å€æ ä¸­çš„è¯ä¹¦ä¿¡æ¯è¿›è¡ŒæŸ¥çœ‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src=\"/images/2015/WebSphere/9.png\" alt=\"é¡¹ç›®éƒ¨ç½²\"><br>æœ€åå¯ä»¥å°†æˆ‘ä»¬çš„CAS Serveréƒ¨ç½²åˆ°WAS application Serverå½“ä¸­ï¼Œå¹¶é…ç½®å¥½ç›¸åº”çš„åº”ç”¨å®¢æˆ·ç«¯ï¼Œæµ‹è¯•å…¶è¿è¡Œæ˜¯å¦æ­£å¸¸ã€‚</p>\n","categories":[],"tags":[]},{"title":"Webloigc 12 zipå®‰è£…","url":"https://pkaq.org/2015/01/26/2015-01-26-installweblogic/","content":"<h3><span id=\"an-zhuang\">å®‰è£…</span><a href=\"#an-zhuang\" class=\"header-anchor\">#</a></h3><p>0.ä»oracleå®˜ç½‘ä¸‹è½½webloigcçš„zipåŒ…/jarå®‰è£…æ–‡ä»¶  </p>\n<p>a.jarå®‰è£…æ–¹å¼<br>    æ­¤ç§æ–¹å¼æ¯”è¾ƒç®€å•ç›´æ¥æ‰§è¡Œjava -jar fmw_xxx.jarå³å¯<br>    p.s:é»˜è®¤æƒ…å†µä¸‹javaå‘½ä»¤è°ƒç”¨çš„æ˜¯jreä¸‹é¢çš„,éœ€è¦æ˜¾ç¤ºæŒ‡å®šjdk/binç›®å½•ä¸‹çš„javaç¨‹åºæ¥æ‰§è¡Œæ­¤jaræ–‡ä»¶æ‰å¯ä»¥,å…·ä½“å®‰è£…è¿‡ç¨‹æœ‰å›¾å½¢ç•Œé¢åŸºæœ¬éƒ½æ˜¯ä¸‹ä¸€æ­¥ä¹‹ç±»çš„æ“ä½œ,è¿™é‡Œä¸å†èµ˜è¿°.  </p>\n<p>b.zipå®‰è£…æ–¹å¼<br>    1.è§£å‹zipåŒ…åˆ°ä¸€ä¸ªè·¯å¾„ä¸‹,å¹¶æŒ‡å®šMW_HOMEä¸ºè¯¥è§£å‡ºç›®å½•<br>    2.è¿è¡Œconfigure.sh,æ­¤æ—¶ä¼šè¿›å…¥å®‰è£…ç¨‹åº,ä¸­é—´è¿‡ç¨‹ä¼šè¯¢é—®æ˜¯å¦åˆ›å»ºæ–°çš„domain,å¯ä»¥æŒ‰ç…§æ­¥éª¤è¿›è¡Œåˆ›å»º    </p>\n<p><img src=\"/images/2015/weblogic/1.png\" alt=\"åˆ›å»ºdomain\">  </p>\n<a id=\"more\"></a>  \n\n<p><img src=\"/images/2015/weblogic/2.png\" alt=\"å¯åŠ¨\">  </p>\n<p>3.å®‰è£…æˆåŠŸåå¦‚å›¾,è®¿é—®<br><a href=\"http://localhost:7001/console\">http://localhost:7001/console</a><br>ç”¨ä¸­é€”åˆ›å»ºçš„ç”¨æˆ·å/å¯†ç ç™»é™†å³å¯<br> <img src=\"/images/2015/weblogic/3.png\" alt=\"ç™»é™†ç•Œé¢\"><br> <img src=\"/images/2015/weblogic/4.png\" alt=\"ç™»é™†æˆåŠŸ\"> </p>\n<p>p.s: å®‰è£…è¿‡ç¨‹ä¸­è¯·ä¿è¯ä½ æ‰€æœ‰ç”¨åˆ°çš„è·¯å¾„ä¸­ä¸è¦æœ‰ä¸­æ–‡æˆ–è€…ç©ºæ ¼</p>\n<h2><span id=\"qi-dong-yu-ting-zhi\">å¯åŠ¨ä¸åœæ­¢</span><a href=\"#qi-dong-yu-ting-zhi\" class=\"header-anchor\">#</a></h2><p>è®¿é—®ä½ çš„domainç›®å½•,æ‰§è¡ŒstartWeblogic.shå³å¯;<br>domainç›®å½•åœ¨ $MW_HOME/user_projects/domain/domain_name</p>\n<h2><span id=\"xiang-mu-fa-bu\">é¡¹ç›®å‘å¸ƒ</span><a href=\"#xiang-mu-fa-bu\" class=\"header-anchor\">#</a></h2><p>å¯ä»¥ç›´æ¥å°†waråŒ…ä¿å­˜åˆ°$MW_HOME/user_projects/domain/domain_name/autodeployä¸‹ä¼šè‡ªåŠ¨éƒ¨ç½²<br>æˆ–è€…é€šè¿‡æ§åˆ¶é¢æ¿-&gt;éƒ¨ç½²-&gt;å®‰è£…,æŒ‰ç…§ç•Œé¢æç¤ºæ“ä½œ</p>\n<h2><span id=\"ssl-pei-zhi\">SSLé…ç½®</span><a href=\"#ssl-pei-zhi\" class=\"header-anchor\">#</a></h2><p>ä»¥å‚è€ƒæ­¤æ–‡ç« :<br><a href=\"http://www.wosign.com/Docdownload/WeblogicSSL%E8%AF%81%E4%B9%A6%E9%83%A8%E7%BD%B2%E6%8C%87%E5%8D%97.pdf\">http://www.wosign.com/Docdownload/WeblogicSSLè¯ä¹¦éƒ¨ç½²æŒ‡å—.pdf</a></p>\n<p>æ­¤æ–‡æ¡£ç»™å‡ºçš„æ˜¯weblogic 9çš„ä¸­æ–‡ç‰ˆé…ç½®,ä¸ºäº†æ–¹ä¾¿ä¸­æ–‡ä¸å¥½çš„åŒå­¦,ä¸‹é¢æˆ‘å¤è¿°ä¸€ä¸‹ weblogic 12 è‹±æ–‡ç‰ˆçš„é…ç½®</p>\n<h3><span id=\"jin-ru-pei-zhi\">è¿›å…¥é…ç½®</span><a href=\"#jin-ru-pei-zhi\" class=\"header-anchor\">#</a></h3><p>0.ç™»é™† Weblogic æˆåŠŸåï¼Œæ¥åˆ°æ­¤é¡µé¢ç‚¹å‡»â€œenvironmentâ€ä¸­çš„â€œserversâ€<br><img src=\"/images/2015/weblogic/0-ssl1.png\" alt=\"ç™»é™†æœåŠ¡å™¨\"> </p>\n<p>1.ç‚¹å‡»å›¾ä¸­çº¢åœˆä½ç½®,è¿›å…¥è®¾å¤‡ç®¡ç†å™¨<br><img src=\"/images/2015/weblogic/1-ssl2.png\" alt=\"ç™»é™†æœåŠ¡å™¨\"> </p>\n<h3><span id=\"qi-yong-ssl-duan-kou\">å¯ç”¨SSLç«¯å£</span><a href=\"#qi-yong-ssl-duan-kou\" class=\"header-anchor\">#</a></h3><p>å°†å·²å¯ç”¨ SSL ç›‘å¬ç«¯å£æ‰“å‹¾å¯åŠ¨ï¼Œç„¶åå°†é»˜è®¤â€œ 7002â€æ”¹ä¸ºâ€œ 443â€ï¼›<br>ä¿®æ”¹å®Œæˆåï¼Œè®°å¾—è¦ç‚¹å‡»â€œä¿å­˜â€ï¼Œè¿™æ ·åŸºæœ¬çš„ç«¯å£è®¾å¤‡å®Œæˆï¼›<br>å†ç‚¹å‡»â€œå¯†é’¥åº“â€æ¥è¿›è¡Œé…ç½®è¯ä¹¦è·¯å¾„æ–‡ä»¶ï¼›<br><img src=\"/images/2015/weblogic/enableport.png\" alt=\"å¯ç”¨ç«¯å£\"> </p>\n<h3><span id=\"pei-zhi-keystore\">é…ç½®keystore</span><a href=\"#pei-zhi-keystore\" class=\"header-anchor\">#</a></h3><p>ç¬¬ä¸€ï¼š å¯†é’¥åº“ï¼šå¿…é¡»é€‰æ‹©â€œè‡ªå®šä¹‰æ ‡ç¤ºå’Œ JAVA æ ‡å‡†ä¿¡ä»»â€ï¼›<br>ç¬¬äºŒï¼šæŒ‡å®šæ‚¨çš„ JKS è¯ä¹¦æ–‡ä»¶è·¯åŠ²(ä¾‹å¦‚ï¼š C:\\SSL.jks)ï¼›å¹¶ä¸”æ ‡ç¤ºå¯†é’¥åº“ç±»å‹ï¼š JKSï¼›<br>ç¬¬ä¸‰ï¼š è¾“å…¥æ‚¨çš„ JKS å¯†ç å’Œå†æ¬¡è¾“å…¥ç¡®è®¤æ‚¨çš„å¯†ç ï¼›<br>ç¬¬å››ï¼šä¿¡ä»»åŒºåŸŸä¸­ï¼Œå¯ä»¥ä¸åšä»»ä½•æ”¹åŠ¨ï¼›<br>ç¬¬äº”ï¼šä¿®æ”¹å®Œæˆåï¼Œè®°å¾—è¦ç‚¹å‡»â€œä¿å­˜â€ï¼›<br>æ³¨é‡Šï¼šï¼ˆä¸Šå›¾é•¿æ–¹å½¢åœˆèµ·çš„éƒ¨åˆ†ï¼Œé»˜è®¤å¯†ç æ ç›®ä¸ºç©ºã€‚æ­¤å¤„å¯†ç å¯ä»¥å’Œè‡ªå·±çš„ JKS ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥ä¸åšä»»ä½•æ”¹åŠ¨ï¼Œæ­¤å¤„æ˜¯ä¸å½±å“è¯ä¹¦æ­£å¸¸ä½¿ç”¨ã€‚ï¼‰<br><img src=\"/images/2015/weblogic/keystore.png\" alt=\"é…ç½®keystore\">  </p>\n<h3><span id=\"pei-zhi-ssl\">é…ç½®SSL</span><a href=\"#pei-zhi-ssl\" class=\"header-anchor\">#</a></h3><p>ç¬¬ä¸€ï¼šæ ‡è¯†å’Œä¿¡ä»»ä½ç½®ï¼šé€‰æ‹©å¯†é’¥åº“ï¼›<br>ç¬¬äºŒï¼šç§é’¥åˆ«åï¼šä¹Ÿå°±æ˜¯ JKS çš„åˆ«å (WoSign é¢å‘çš„ JKS è¯ä¹¦æ–‡ä»¶ä¸­åˆ«åé»˜è®¤ä¸ºï¼š 1)ï¼›<br>ç¬¬ä¸‰ï¼š ç§é’¥å¯†ç ï¼šè¾“å…¥æ‚¨ç”³è¯·æ—¶å€™è®¾ç½®çš„å¯†ç ï¼Œä»¥åŠå†æ¬¡è¾“å…¥ç¡®è®¤å¯†ç ï¼›<br>ç¬¬å››ï¼šä¿®æ”¹å®Œæˆåï¼Œè®°å¾—è¦ç‚¹å‡»â€œä¿å­˜â€ï¼›<br><img src=\"/images/2015/weblogic/ssl.png\" alt=\"é…ç½®SSL\">  </p>\n<p>é‡å¯SSLä½¿é…ç½®ç”Ÿæ•ˆ</p>\n<p>ç‚¹å‡»â€œenvironmentâ€ä¸­çš„â€œserversâ€ ,åˆ‡æ¢åˆ°controlæ ‡ç­¾,é€‰ä¸­ä½ çš„domain ç‚¹å‡»restartSSL<br><img src=\"/images/2015/weblogic/restartssl.png\" alt=\"é…ç½®SSL\">  </p>\n<p>æ‰©å±•é˜…è¯»:<br>weblogicçš„åŸºæœ¬æ¦‚å¿µ</p>\n<h3><span id=\"oracle-weblogic-server-domain\">Oracle Weblogic Server Domain</span><a href=\"#oracle-weblogic-server-domain\" class=\"header-anchor\">#</a></h3><p>Weblogic Server Domainï¼ˆåŸŸï¼‰æ˜¯ä¸€ä¸ªé€»è¾‘çš„ç®¡ç†å•å…ƒï¼Œä¸€ä¸ªOracle WebLogic ServeråŸŸæ˜¯å¤šä¸ªJavaç»„ä»¶çš„é€»è¾‘ç›¸å…³ç»„ã€‚Domainæ˜¯weblogicä¸­æœ€å¤§çš„æ¦‚å¿µï¼Œä¸€ä¸ªåŸŸä¸‹é¢åŒ…å«ç€weblogicåº”ç”¨æœåŠ¡å™¨ä¸­çš„æ‰€æœ‰ä¸œè¥¿ï¼Œweblogicåº”ç”¨æœåŠ¡å™¨çš„å¯åŠ¨ï¼Œåœæ­¢éƒ½æ˜¯ä»¥domainä¸ºå•ä½è¿›è¡Œç®¡ç†çš„ã€‚åŸŸæ˜¯ç”±å•ä¸ªç®¡ç†æœåŠ¡å™¨ç®¡ç†çš„WebLogic Serverå®ä¾‹çš„é›†åˆã€‚<br>ä¸€ä¸ªweblogic domainåŒ…å«äº†ä¸€ä¸ªç‰¹å®šweblogic æœåŠ¡å™¨å®ä¾‹ï¼šAdministration Serverï¼ŒAdministration Serveræ˜¯æ•´ä¸ªdomainçš„é…ç½®ä»¥åŠç®¡ç†æ‰€æœ‰èµ„æºçš„ä¸­å¿ƒç‚¹ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿˜ä¼šåœ¨è¿™ä¸ªdomainä¸­é€šè¿‡é…ç½®æ¥æ‰©å±•å‡ºå…¶ä»–çš„weblogicæœåŠ¡å™¨å®ä¾‹ï¼Œæ‰©å±•å‡ºæ¥çš„æœåŠ¡å™¨å®ä¾‹å«åšManaged Serverã€‚å¯ä»¥å°†javaç»„ä»¶ï¼Œä¾‹å¦‚EJBåº”ç”¨ï¼ŒWeb Serviceï¼Œå„ç§JAVAEEåº”ç”¨éƒ¨ç½²åˆ°Managed Serverä¸Šï¼Œä¸æ­¤åŒæ—¶Administration Serveråªæ˜¯ç”¨æ¥è¿›è¡Œé…ç½®ä»¥åŠç®¡ç†çš„ã€‚åœ¨ä¸€ä¸ªdomainä¸­ï¼Œæˆç»„çš„managed serverä¼šä½œä¸ºé›†ç¾¤ã€‚<br>Weblogic domainçš„ç›®å½•å’Œweblogicå®‰è£…ç›®å½•æ˜¯åŒºåˆ†å¼€çš„ï¼Œdomainçš„ç›®å½•å¯ä»¥æ”¾ç½®äºä»»ä½•åœ°æ–¹ï¼Œä¹Ÿå¯ä»¥ä¸åœ¨Middleware Homeé‡Œé¢ã€‚<br>Domainä¸Oracle instanceæ˜¯åŒçº§çš„ï¼Œæ‰€æœ‰çš„ç›¸å…³é…ç½®æ–‡ä»¶éƒ½åœ¨ oracle homeå¤–é¢ã€‚</p>\n<h3><span id=\"administration-server\">Administration Server</span><a href=\"#administration-server\" class=\"header-anchor\">#</a></h3><p>Administration serveræ˜¯ä½œä¸ºæ•´ä¸ªdomainé…ç½®çš„ä¸­å¿ƒæ§åˆ¶å®ä½“ã€‚Admin Serverç»´æŠ¤ç€domainçš„é…ç½®æ–‡ä»¶ä»¥åŠå°†é…ç½®åˆ†é…åˆ°æ¯ä¸ªmanaged serverä¸­ã€‚Admin Serverä½œä¸ºæ•´ä¸ªdomainæ‰€æœ‰èµ„æºçš„ç›‘è§†ä¸­å¿ƒã€‚æ¯ä¸ªdomainéƒ½å¿…é¡»å­˜åœ¨ç€ä¸€ä¸ªAdmin Serverã€‚<br>ä¸Admin Serveräº¤äº’ï¼Œå¯ä»¥é€šè¿‡ä¸‰ç§æ–¹å¼ï¼šAdmin Server consoleï¼ŒOracle WebLogic Scripting Tool (WLST)ï¼Œæˆ–è€…åˆ›å»ºJava Management Extension (JMX) å®¢æˆ·ç«¯ã€‚å¦å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨fusion middlewareçš„æ§åˆ¶consoleï¼ˆEMï¼‰æ¥è¿›è¡Œå…¶ä¸­çš„æŸäº›äº‹æƒ…ã€‚Consoleä¸EMéƒ½æ˜¯è¿è¡Œåœ¨Admin Serverä¸Šçš„ã€‚Consoleæ˜¯åŸºäºWebç”¨æ¥å¯¹æ•´ä¸ªdomainçš„èµ„æºè¿›è¡Œç®¡ç†çš„ï¼ŒåŒ…å«äº†Admin Serverä»¥åŠManaged Serverã€‚EMä¹Ÿæ˜¯åŸºäºWebçš„ç®¡ç†æ§åˆ¶å°ï¼Œç”¨ä»¥ç®¡ç†æ‰€æœ‰çš„ä¸­é—´ä»¶ç»„ä»¶ï¼Œä¾‹å¦‚webcenterï¼Œsoaï¼Œhttp serverç­‰ã€‚</p>\n<h3><span id=\"managed-servers-he-managed-server-clusters\">Managed Serverså’ŒManaged Server Clusters</span><a href=\"#managed-servers-he-managed-server-clusters\" class=\"header-anchor\">#</a></h3><p>Managed Serverä¸ŠåŒ…å«äº†å•†ä¸šåº”ç”¨ï¼Œåº”ç”¨ç»„ä»¶ï¼ŒWeb Serviceï¼Œå…¶ä»–ç›¸å…³èµ„æºç­‰ç­‰ã€‚ä¸ºäº†ä¼˜åŒ–æ€§èƒ½ï¼Œmanaged serverç»´æŠ¤ç€ä¸€ä¸ªåªè¯»çš„domainé…ç½®æ–‡ä»¶ã€‚å½“ä¸€ä¸ªmanaged serverå¯åŠ¨çš„æ—¶å€™ï¼Œå®ƒä¼šè¿æ¥åˆ°Admin Serverå»åŒæ­¥çš„é…ç½®æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶æ˜¯ç”±Admin Serverè¿›è¡Œç»´æŠ¤çš„ã€‚<br>å½“åˆ›å»ºä¸€ä¸ªdomainçš„æ—¶å€™ï¼Œä½ å¯ä»¥å»é€‰æ‹©ç‰¹å®šçš„æ¨¡æ¿å»è¿›è¡Œåˆ›å»ºï¼Œè¿™ä¸ªæ¨¡æ¿ä¼šåŒ…å«äº†æ‰€æœ‰ä½ çš„domainçš„é…ç½®ä¿¡æ¯ã€‚æ¨¡æ¿å¯ä»¥é’ˆå¯¹ä¸åŒçš„ä½¿ç”¨è¿›è¡Œé¢å¤–çš„å®‰è£…ã€‚æ¨¡æ¿ä¼šæ”¯æŒç‰¹å®šçš„ç»„ä»¶æˆ–è€…æ˜¯æ”¯æŒç‰¹å®šçš„æŸç»„ç»„ä»¶ï¼Œä¾‹å¦‚Oracle SOA Suitã€‚ä¸€èˆ¬ä¼šé’ˆå¯¹ä¸åŒçš„ç»„ä»¶å»åˆ›å»ºè‚šå­çš„managed serverã€‚<br>Oracleä¸­é—´ä»¶çš„javaç»„ä»¶ï¼ˆä¾‹å¦‚Oracle SOA, Webcenterï¼ŒUCMç­‰ï¼‰ä»¥åŠè‡ªå·±å¼€å‘çš„åº”ç”¨éƒ½æ˜¯éƒ¨ç½²åˆ°managed serverä¸Šçš„ã€‚Managed Serveræ˜¯java virtrual machineï¼ˆJVMï¼‰è¿›ç¨‹ã€‚<br>å¦‚æœä½ æƒ³æ·»åŠ æŸä¸ªç»„ä»¶åˆ°domainä¸­ï¼Œä¾‹å¦‚webcenterï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ç›¸åº”æ¨¡æ¿å»æ‰©å±•ï¼Œåˆ›å»ºæ–°çš„managed serverã€‚<br>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç”Ÿäº§ç¯å¢ƒä¸ºäº†æé«˜åº”ç”¨çš„æ€§èƒ½ï¼Œååä»¥åŠé«˜å¯ç”¨ï¼Œä¼šå»é…ç½®ä¸¤ä¸ªæˆ–è€…å¤šä¸ªmanaged serverä½œä¸ºé›†ç¾¤æ¥ä½¿ç”¨ã€‚é›†ç¾¤å°±æ˜¯å¤šä¸ªåŒæ—¶è¿è¡Œï¼Œä¸€èµ·å·¥ä½œçš„weblogic æœåŠ¡å™¨å®ä¾‹çš„é›†åˆï¼Œé›†ç¾¤æé«˜äº†å¯æ‰©å±•æ€§ä»¥åŠå¯é æ€§ã€‚åœ¨é›†ç¾¤ä¸­ï¼Œå¤§å¤šæ•°èµ„æºä»¥åŠæœåŠ¡ä¼šå¯¹ç­‰çš„éƒ¨ç½²åˆ°æ¯ä¸€ä¸ªmanaged serverä¸­ï¼Œå¯ç”¨æ•…éšœåˆ‡æ¢ä»¥åŠè´Ÿè½½å‡è¡¡ã€‚ä¸€ä¸ªdomainå¯ä»¥åŒ…å«å¤šä¸ªé›†ç¾¤ã€‚åšé›†ç¾¤å’Œä¸åšé›†ç¾¤æœ€ä¸»è¦çš„å·®åˆ«æ˜¯æ•…éšœåˆ‡æ¢ä¸è´Ÿè½½å‡è¡¡ã€‚</p>\n<h3><span id=\"node-manager\">Node Manager</span><a href=\"#node-manager\" class=\"header-anchor\">#</a></h3><p>èŠ‚ç‚¹ç®¡ç†å™¨æ˜¯åŒºåˆ†äºweblogicæœåŠ¡å™¨çš„ä¸€ä¸ªç‹¬ç«‹è¿è¡Œçš„javaå·¥å…·è¿›ç¨‹ï¼ŒèŠ‚ç‚¹ç®¡ç†å™¨ä½¿ä½ èƒ½å¤Ÿå»å¯¹managed serverè¿›è¡Œé€šå¸¸çš„æ“ä½œï¼Œè€Œä¸ç”¨å»ç®¡ç›¸å…³çš„Admin Serveråœ¨å“ªé‡Œã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œéœ€è¦å¯¹åº”ç”¨å¯¹é«˜å¯ç”¨é…ç½®çš„æ—¶å€™ï¼Œå°±ä¼šå¯ç”¨èŠ‚ç‚¹ç®¡ç†å™¨ã€‚èŠ‚ç‚¹ç®¡ç†å™¨å¯ä»¥å¯¹managed serveræ‰§è¡Œå¦‚ä¸‹æ“ä½œï¼š<br>Start<br>Stop<br>Process Monitoring<br>Death Detection<br>Restart<br>å¦‚æœå¯åŠ¨äº†èŠ‚ç‚¹ç®¡ç†å™¨å¯¹managed serverè¿›è¡Œç®¡ç†ï¼Œä½ å°±å¯ä»¥é€šè¿‡weblogic consoleæˆ–è€…å‘½ä»¤è¡Œæ¥é’ˆå¯¹è¢«ç®¡ç†çš„managed serverè¿›è¡Œç›¸åº”çš„æ“ä½œã€‚èŠ‚ç‚¹ç®¡ç†å™¨è¿˜å¯ä»¥åœ¨å‡ºç°æœªå¯é¢„æ–™çš„é”™è¯¯çš„æ—¶å€™å»è‡ªåŠ¨é‡å¯managed serverã€‚</p>\n<p> __å‚è€ƒèµ„æ–™<br> *<a href=\"http://www.oracle.com/technetwork/middleware/ias/downloads/wls1033-dev-readme-131493.txt\">WebLogic 12 å®˜æ–¹å®‰è£…æŒ‡å¯¼</a></p>\n","categories":["Web server"],"tags":["webloigc"]},{"title":"CASå•ç‚¹ç™»é™†(SSO)å¼€å‘æŒ‡å—","url":"https://pkaq.org/2015/01/14/2015-01-14-CAS/","content":"<p>æœ¬æ•™ç¨‹ä½¿ç”¨çš„SSOæœåŠ¡å™¨æ˜¯Yeluå¤§å­¦ç ”å‘çš„CAS(Central Authentication Server)ï¼Œ<br>å®˜ç½‘ï¼š<a href=\"http://www.jasig.org/cas\">http://www.jasig.org/cas</a><br>ä¸‹è½½åœ°å€:<a href=\"http://downloads.jasig.org/\">http://downloads.jasig.org/</a><br>æ–‡æ¡£åœ°å€:<a href=\"http://jasig.github.io/cas/4.0.x/index.html\">http://jasig.github.io/cas/4.0.x/index.html</a><br>æœ¬æ–‡ä¿®æ”¹çš„cas-serveré¡¹ç›®ä»£ç æˆ‘å·²ç»æ”¾åˆ°äº†githubä¸Š <a href=\"https://github.com/pkaq/cas-server-3.5.2\">https://github.com/pkaq/cas-server-3.5.2</a></p>\n<h3><span id=\"huan-jing-pei-zhi\">ç¯å¢ƒé…ç½®</span><a href=\"#huan-jing-pei-zhi\" class=\"header-anchor\">#</a></h3><p>JDK:1.7.45<br>CASç‰ˆæœ¬:4.0.0</p>\n<h2><span id=\"mu-lu\">ç›®å½•</span><a href=\"#mu-lu\" class=\"header-anchor\">#</a></h2><ol>\n<li> <a href=\"#env\">ç¯å¢ƒå‡†å¤‡</a><br>___A.  <a href=\"#cert\">è¯ä¹¦ç”Ÿæˆ</a><br>______1.  <a href=\"#export\">å¯¼å‡ºè¯ä¹¦</a><br>______2.  <a href=\"#import\">å¯¼å…¥æœåŠ¡ç«¯ä¿¡ä»»è¯ä¹¦</a><br>______3.  <a href=\"#importclient\">é¢å‘ç»™å®¢æˆ·æœº</a><br>___B.  <a href=\"#webserver\">WEBæœåŠ¡å™¨é…ç½®</a><br>______1.  <a href=\"#tomcat\">tomcaté…ç½®</a><br>______2.  <a href=\"#jboss\">jbossé…ç½®</a><br>______3.  <a href=\"#weblogic\">webloigcé…ç½®</a><br>______4.  <a href=\"#websphere\">websphereé…ç½®</a></li>\n<li> <a href=\"#server\">æœåŠ¡ç«¯æ­å»º</a></li>\n<li> <a href=\"#client\">å®¢æˆ·ç«¯æ­å»º</a><br>___a.  <a href=\"#withjava\">JAVAå®¢æˆ·ç«¯åº”ç”¨æ­å»º</a></li>\n<li> <a href=\"#adv\">è¿›é˜¶åº”ç”¨</a><br>___a.  <a href=\"#adv_1\">é…ç½®è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™</a><br>___b.  <a href=\"#adv_2\">é…ç½®è‡ªå®šä¹‰è®¤è¯è¿”å›å‚æ•°</a><br>___c.  <a href=\"#adv_3\">é…ç½®è‡ªå®šä¹‰ç•Œé¢</a></li>\n</ol>\n<a id=\"more\"></a>\n\n<h2><span id=\"yi-cas-huan-jing-zhun-bei\"></span><a href=\"#yi-cas-huan-jing-zhun-bei\" class=\"header-anchor\">#</a></h2><h3><span id=\"a-zheng-shu-sheng-cheng\"></span><a href=\"#a-zheng-shu-sheng-cheng\" class=\"header-anchor\">#</a></h3><p>ç”¨JDKè‡ªå¸¦çš„keytoolå·¥å…·ç”Ÿæˆè¯ä¹¦ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">keytool -genkey -alias wsria -keyalg RSA -keystore /home/mykey</span><br></pre></td></tr></table></figure>\n<p> å‚æ•°è¯´æ˜å¦‚å›¾:<br> <img src=\"/images/2015/01/use-keytool-create-key.gif\" alt=\"ç”Ÿæˆç§˜é’¥\"> </p>\n<p>p.s:<br>1.ä¹Ÿå¯ä»¥ç”³è¯·å…è´¹çš„startsslè¯ä¹¦,å…·ä½“ç”³è¯·è¿‡ç¨‹è¯·ç§»æ­¥<br><a href=\"https://www.startssl.com/?app=11&amp;action=regform\">https://www.startssl.com/?app=11&amp;action=regform</a><br>å½“ç„¶å›½å†…ä¹Ÿæœ‰ä¸€å®¶wosignå¯ä»¥ç”³è¯·,ç”³è¯·é€Ÿåº¦æ¯”startsslè¦å¿«ä¸€äº›,è€Œä¸”åœ¨çº¿å®¢æœæ€åº¦å¾ˆå¥½å¯ä»¥æä¾›å¾ˆå¥½çš„å¸®åŠ©<br><a href=\"http://www.wosign.com/\">www.wosign.com</a>  </p>\n<p>2.å…·ä½“çš„è¾“å…¥é¡¹å›¾ç‰‡ä¸­éƒ½æœ‰è¯´æ˜ï¼Œæœ‰ä¸€ç‚¹æˆ‘è¦è§£é‡Šä¸€ä¸‹ï¼›åœ¨è¾“å…¥å®Œå¯†ç åæç¤ºè¾“å…¥åŸŸåæ˜¯æˆ‘è¾“å…¥çš„æ˜¯sso.wsria.comï¼Œå…¶å®è¿™ä¸ªåŸŸåæ˜¯ä¸å­˜åœ¨çš„ï¼Œä½†æ˜¯æˆ‘ä¸ºäº†æ¼”ç¤ºæ‰€ä»¥è™šæ‹Ÿäº†è¿™ä¸ªåŸŸåï¼ŒæŠ€å·§åœ¨äºä¿®æ”¹</p>\n<p>C:\\Windows\\System32\\drivers\\etc\\hosts<br>æ·»åŠ å†…å®¹å¦‚ä¸‹ï¼š</p>\n<p>127.0.0.1  sso.wsria.com<br>è¿™æ ·åœ¨è®¿é—®sso.wsria.comçš„æ—¶å€™å…¶å®æ˜¯è®¿é—®çš„127.0.0.1ä¹Ÿå°±æ˜¯æœ¬æœº</p>\n<h4><span id=\"1-dao-chu-zheng-shu\"></span><a href=\"#1-dao-chu-zheng-shu\" class=\"header-anchor\">#</a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">keytool -export -file /home/my.crt -alias wsria -keystore /home/mykey</span><br></pre></td></tr></table></figure>\n<h4><span id=\"2-jia-ru-fu-wu-duan-xin-ren\"></span><a href=\"#2-jia-ru-fu-wu-duan-xin-ren\" class=\"header-anchor\">#</a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">keytool -import -trustcacerts -alias [keyEntry_name] -file mycert.crt -keystore [keystore_name]</span><br></pre></td></tr></table></figure>\n<h4><span id=\"3-ban-fa-zheng-shu-gei-ke-hu-ji-bing-jia-ru-jdk-xin-ren\"></span><a href=\"#3-ban-fa-zheng-shu-gei-ke-hu-ji-bing-jia-ru-jdk-xin-ren\" class=\"header-anchor\">#</a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">keytool -import -file /opt/name.cer -keystore $JAVA_HOME/jre7/lib/security/cacerts -alias server</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œé»˜è®¤å¯†ç æ˜¯changeit</p>\n<h3><span id=\"b-web-fu-wu-qi-pei-zhi\"></span><a href=\"#b-web-fu-wu-qi-pei-zhi\" class=\"header-anchor\">#</a></h3><h5><span id=\"a-tomcat\"></span><a href=\"#a-tomcat\" class=\"header-anchor\">#</a></h5><p>é¦–å…ˆè¦å¯ç”¨WebæœåŠ¡å™¨(Tomcat)çš„SSLï¼Œä¹Ÿå°±æ˜¯HTTPSåŠ å¯†åè®®;<br>æ‰“å¼€tomcatç›®å½•çš„conf/server.xmlæ–‡ä»¶ï¼Œæ‰¾åˆ°å¦‚ä¸‹è¡Œå¹¶è®¾ç½®keystoreFileã€keystorePassä¿®æ”¹ç»“æœå¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Connector</span> <span class=\"attr\">port</span>=<span class=\"string\">&quot;8443&quot;</span> <span class=\"attr\">protocol</span>=<span class=\"string\">&quot;org.apache.coyote.http11.Http11Protocol&quot;</span> <span class=\"attr\">SSLEnabled</span>=<span class=\"string\">&quot;true&quot;</span> <span class=\"attr\">maxThreads</span>=<span class=\"string\">&quot;150&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"attr\">scheme</span>=<span class=\"string\">&quot;https&quot;</span> <span class=\"attr\">secure</span>=<span class=\"string\">&quot;true&quot;</span> <span class=\"attr\">clientAuth</span>=<span class=\"string\">&quot;false&quot;</span> <span class=\"attr\">sslProtocol</span>=<span class=\"string\">&quot;TLS&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"attr\">keystoreFile</span>=<span class=\"string\">&quot;/home/mykey&quot;</span> <span class=\"attr\">keystorePass</span>=<span class=\"string\">&quot;xxxx&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>\n<p>å‚æ•°è¯´æ˜:<br>keystoreFileï¼šåœ¨ç¬¬ä¸€æ­¥åˆ›å»ºçš„keyå­˜æ”¾ä½ç½®<br>keystorePassï¼šåˆ›å»ºè¯ä¹¦æ—¶çš„å¯†ç </p>\n<p>p.s<br>æŒ‰åŒæ ·çš„æ–¹æ³•æ¥é…ç½®Tomcat 7å´å¯åŠ¨ä¸èµ·æ¥ï¼ŒæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p>\n<p>ä¸¥é‡: Failed to initialize end point associated with ProtocolHandler [â€œhttp-apr-8443â€]<br>java.lang.Exception: Connector attribute SSLCertificateFile must be defined when using SSL with APR</p>\n<p>ä»”ç»†çœ‹ä¸Šé¢çš„å¼‚å¸¸ä¿¡æ¯å‘ç°è¿™æ˜¯APRæŠ¥çš„é”™è¯¯ã€‚Tomcat 6ä¹Ÿæœ‰APRåŒ…ä½†æˆ‘ä»æ¥éƒ½æ²¡ç”¨è¿‡ã€‚ä¸ºæ­¤æŸ¥çœ‹äº†Tomcatçš„ssl-howï¼Œåœ¨â€œEdit the Tomcat Configuration Fileâ€ä¸€èŠ‚ä¸­è¯´åˆ°ï¼š<br>Tomcatæä¾›äº†ä¸¤ä¸ªSSLå®ç°ï¼Œä¸€ä¸ªæ˜¯JSSEå®ç°ï¼Œå¦ä¸€ä¸ªæ˜¯APRå®ç°ã€‚<br>Tomcatå°†è‡ªåŠ¨é€‰æ‹©ä½¿ç”¨å“ªä¸ªå®ç°ï¼Œå³å¦‚æœå®‰è£…äº†APRåˆ™è‡ªåŠ¨é€‰æ‹©APRï¼Œå¦åˆ™é€‰æ‹©JSSEã€‚<br>å¦‚æœä¸å¸Œæœ›è®©Tomcatè‡ªåŠ¨é€‰æ‹©ï¼Œè€Œæ˜¯æˆ‘ä»¬è‡ªå·±æŒ‡å®šä¸€ä¸ªå®ç°åˆ™å¯é€šè¿‡protocolå®šä¹‰ï¼Œå¦‚ä¸‹ï¼š</p>\n<connector protocol=\"...\">\n\n<p>æˆ‘åˆæŸ¥çœ‹äº†6.0çš„ç›¸åŒè¯´æ˜ï¼Œé‡Œé¢ä¸7.0çš„è¯´æ˜ä¸€æ¨¡ä¸€æ ·ã€‚å› æ­¤é—®é¢˜åªå¯èƒ½æ˜¯ï¼šæ˜¯å¦å®‰è£…äº†APRåŒ…ã€‚</p>\n<p>ä»¥å‰åªå¬è¯´è¿‡APRä½†æ²¡å¼„è¿‡ã€‚APRæ˜¯ä»€ä¹ˆæ–‡ä»¶ï¼Ÿåæ¥æ‰å‘ç°APRæ–‡ä»¶åä¸ºtcnative-1.dllã€‚è¿›ä¸€æ­¥æ£€æŸ¥6.0å’Œ7.0çš„å®‰è£…ç›®å½•ï¼Œç»“æœå‘ç°6.0é‡Œæ²¡è¿™ä¸ªdllæ–‡ä»¶ï¼Œè€Œ7.0é‡Œæœ‰ã€‚æ¢å¥è¯è¯´ï¼Œ6.0é»˜è®¤ä½¿ç”¨JSSEå®ç°ï¼Œè€Œ7.0é»˜è®¤ä½¿ç”¨APRå®ç°ã€‚</p>\n<p>å¼„æ˜ç™½ç¼˜ç”±å°±å¥½åŠäº†ã€‚ç”±äºä¹ æƒ¯ä½¿ç”¨6.0çš„é…ç½®æ–¹å¼ï¼ˆå³JSEEå®ç°ï¼‰ï¼Œå› æ­¤åªè¦æŠŠä¸Šé¢conf\\server.xmlé‡Œçš„protocolä¿®æ”¹ä¸€ä¸‹å°±è¡Œäº†ï¼š</p>\n<pre><code>&lt;Connector port=&quot;8443&quot; protocol=&quot;org.apache.coyote.http11.Http11Protocol&quot; SSLEnabled=&quot;true&quot;\n           maxThreads=&quot;150&quot; scheme=&quot;https&quot; secure=&quot;true&quot;\n           clientAuth=&quot;false&quot; sslProtocol=&quot;TLS&quot;\n           keystoreFile=&quot;$&#123;user.home&#125;/.keystore&quot;\n           keystorePass=&quot;changeit&quot; /&gt;</code></pre>\n<p>é‡æ–°å¯åŠ¨ï¼Œä¸€åˆ‡æ­£å¸¸ã€‚</p>\n<h5><span id=\"b-jboss\"></span><a href=\"#b-jboss\" class=\"header-anchor\">#</a></h5><h6><span id=\"1-ssl-pei-zhi\">1.SSLé…ç½®</span><a href=\"#1-ssl-pei-zhi\" class=\"header-anchor\">#</a></h6><p>æ‰¾åˆ°standalone-&gt;configuration-&gt;standalone.xml<br>ä¿®æ”¹<connector name=\"https\" protocol=\"HTTP/1.1\" scheme=\"https\" socket-binding=\"https\">èŠ‚ç‚¹ä¸ºå¦‚ä¸‹å†…å®¹</connector></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">connector</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;https&quot;</span> <span class=\"attr\">protocol</span>=<span class=\"string\">&quot;HTTP/1.1&quot;</span> <span class=\"attr\">scheme</span>=<span class=\"string\">&quot;https&quot;</span> <span class=\"attr\">socket-binding</span>=<span class=\"string\">&quot;https&quot;</span> <span class=\"attr\">secure</span>=<span class=\"string\">&quot;true&quot;</span> <span class=\"attr\">enabled</span>=<span class=\"string\">&quot;true&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">ssl</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;https&quot;</span> <span class=\"attr\">key-alias</span>=<span class=\"string\">&quot;1&quot;</span> <span class=\"attr\">password</span>=<span class=\"string\">&quot;Masterfrank099&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">             <span class=\"attr\">certificate-key-file</span>=<span class=\"string\">&quot;D:/key/domainname.jks&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">             <span class=\"attr\">protocol</span>=<span class=\"string\">&quot;all&quot;</span> <span class=\"attr\">verify-client</span>=<span class=\"string\">&quot;false&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">connector</span>&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>key-aliasï¼šè¯ä¹¦åˆ«å<br>passwordï¼šè¯ä¹¦å¯†ç <br>certificate-key-fileï¼šè¯ä¹¦æ”¾ä½ç½®</p>\n<p>p.s:JBOSS 4.2ä»¥ä¸Šç‰ˆæœ¬æœåŠ¡å¯åŠ¨å¦‚æœä¸åŠ ä»»ä½•å‚æ•°çš„è¯,åªç›‘å¬127.0.0.1,å°±æ˜¯è¯´åªèƒ½ç”¨127.0.0.1æˆ–è€…localhostè®¿é—®ï¼Œç”¨æœ¬æœºçš„å¯¹å¤–åœ°å€æ˜¯è®¿é—®ä¸äº†ï¼ŒåŒä¸€ç½‘ç»œå†…åˆ«çš„æœºå­æ— æ³•è®¿é—®ã€‚</p>\n<p>è§£å†³æ–¹æ¡ˆï¼šæ‰“å¼€jboss7/standalone/configuration/standalone.xmlï¼Œæ‰¾åˆ°å¦‚ä¸‹ä»£ç </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">interface</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;public&quot;</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">inet-address</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;$&#123;jboss.bind.address:127.0.0.1&#125;&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">interface</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>å°†127.0.0.1æ”¹ä¸º0.0.0.0å³å¯è§£å†³jbossæ— æ³•ä½¿ç”¨IPåœ°å€è®¿é—®çš„é—®é¢˜ã€‚</p>\n<h6><span id=\"2-cas-bu-shu\">2.caséƒ¨ç½²</span><a href=\"#2-cas-bu-shu\" class=\"header-anchor\">#</a></h6><p>1ã€å°†waråŒ…æ”¾åˆ°jboss7/standalone/ deploymentsç›®å½•ä¸‹ï¼Œå¯åŠ¨jbossï¼Œå¦‚å¯æ­£å¸¸è®¿é—®ï¼Œè¯´æ˜éƒ¨ç½²æˆåŠŸã€‚<br>2ã€  è‹¥ç›´æ¥å°†car.waréƒ¨ç½²åˆ°jbossä¸­ï¼Œåœ¨å¯åŠ¨æ—¶å°±ä¼šæŠ¥é”™ï¼Œå¼•èµ·é”™è¯¯çš„åŸå› ï¼š</p>\n<ol>\n<li> ç”±äºjbossè‡ªå¸¦æœ‰log4jæ—¥å¿—ï¼Œè¿™å°±ä¼šå¼•èµ·jbossçš„log4jä¸casçš„log4jå‘ç”Ÿå†²çªï¼Œå°†casä¸­å¼•å…¥log4j.xmlçš„ä»£ç åˆ é™¤å³å¯ã€‚</li>\n<li> æœªæŒ‡å®šhibernateçš„æ–¹è¨€ï¼Œæ‰“å¼€cas.war\\WEB-INF\\classes\\META-INF\\ persistence.xml,å°†å¦‚ä¸‹ä»£ç </li>\n</ol>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;hibernate.dialect&quot;</span><span class=\"attr\">value</span>=<span class=\"string\">&quot;org.hibernate.dialect.HSQLDialect&quot;</span>/&gt;</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\">//æ”¾åˆ°</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">persistence-unit</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;CasPersistence&quot;</span> <span class=\"attr\">transaction-type</span>=<span class=\"string\">&quot;RESOURCE_LOCAL&quot;</span>&gt;</span>ä¸‹ã€‚</span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\">##### <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;weblogic&quot;</span>&gt;</span>c.WebLogic<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">Weblogicé»˜è®¤ç«¯å£ä¸º7001</span><br><span class=\"line\">è¯·ç§»æ­¥:[\\[weblogic 12cå®‰è£…\\] - sslé…ç½®/caséƒ¨ç½²](\\2015\\01\\26\\installweblogic\\index.html)  </span><br><span class=\"line\">p.s:</span><br><span class=\"line\">1.å®˜æ–¹æä¾›çš„zipå‹ç¼©ç‰ˆç»æµ‹è¯•æ— æ³•æ­£å¸¸è®¿é—®ssl,å¯èƒ½å°‘ä¸œè¥¿</span><br><span class=\"line\">2.æ‰“æˆwaråŒ…éƒ¨ç½²ä¼šæŠ¥log4j.xmlæ‰¾ä¸åˆ°é”™è¯¯,ç›´æ¥ä»¥ç›®å½•å½¢å¼éƒ¨ç½²æ²¡é—®é¢˜,å‡ºç°è¯¥é—®é¢˜çš„åŸå› åº”è¯¥æ˜¯åŠ è½½å†²çªæ‰€è‡´,å¯è€ƒè™‘ç”¨serverletæ–¹å¼åŠ è½½springçš„log4j listener</span><br><span class=\"line\"></span><br><span class=\"line\">#####<span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;websphere&quot;</span>&gt;</span>d.WebSphere<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">Weblogicé»˜è®¤ç«¯å£ä¸º9080</span><br><span class=\"line\">è¯·ç§»æ­¥:[\\[websphere 8.5.5å®‰è£…\\] - sslé…ç½®/caséƒ¨ç½²](\\2015\\01\\27\\websphereinstall\\index.html)  </span><br><span class=\"line\"></span><br><span class=\"line\">## <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;server&quot;</span>&gt;</span>äºŒã€CASæœåŠ¡ç«¯æ­å»º<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">\t1.CASæœåŠ¡ç«¯ä¸‹è½½ï¼šhttp://www.jasig.org/cas/download</span><br><span class=\"line\">\t2.è§£å‹cas-server-xxx/modules/cas-server-webapp-xxx.warï¼Œæ”¹åä¸ºcasï¼Œç„¶åå¤åˆ¶casç›®å½•åˆ°ä½ çš„tomcat/webappç›®å½•ä¸‹</span><br><span class=\"line\">\t3.è®¿é—®http://localhost:8080/caså³å¯çœ‹åˆ°é¡¹ç›®é¦–é¡µ,è¾“å…¥casuser/Mellonç‚¹å‡»ç™»å½•ï¼ˆè¿™æ˜¯4.0.xä¹‹åç‰ˆæœ¬çš„ç”¨æˆ·åå¯†ç ,3.5.xç‰ˆæœ¬CASé»˜è®¤çš„éªŒè¯è§„åˆ™åªè¦ç”¨æˆ·åå’Œå¯†ç ç›¸åŒå°±é€šè¿‡ï¼‰</span><br><span class=\"line\">\tæ‰€ä»¥å¦‚æœä½ çœ‹åˆ°ä¸‹é¢çš„è¿™å¼ å›¾ç‰‡ä½ å°±æˆåŠŸäº†</span><br><span class=\"line\">![ç™»é™†æˆåŠŸ](/images/2015/01/cas-login-success.gif)</span><br><span class=\"line\"></span><br><span class=\"line\">## <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;client&quot;</span>&gt;</span>ä¸‰ã€CASå®¢æˆ·ç«¯<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">### <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;withjava&quot;</span>&gt;</span>A.Javaå®¢æˆ·ç«¯é›†æˆ<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">1.åœ¨å®¢æˆ·ç«¯æ·»åŠ  &quot;org.jasig.cas.client:cas-client-core:+&quot;,ä¾èµ–</span><br><span class=\"line\">2.é…ç½®å®¢æˆ·ç«¯web.xmlæ–‡ä»¶</span><br><span class=\"line\"></span><br><span class=\"line\">```xml</span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- å•ç‚¹ç™»é™†é…ç½®å¼€å§‹ --&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- ç”¨äºå•ç‚¹é€€å‡ºï¼Œè¯¥è¿‡æ»¤å™¨ç”¨äºå®ç°å•ç‚¹ç™»å‡ºåŠŸèƒ½ï¼Œå¯é€‰é…ç½®--&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">listener</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">listener-class</span>&gt;</span>org.jasig.cas.client.session.SingleSignOutHttpSessionListener<span class=\"tag\">&lt;/<span class=\"name\">listener-class</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">listener</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- è¯¥è¿‡æ»¤å™¨ç”¨äºå®ç°å•ç‚¹ç™»å‡ºåŠŸèƒ½ï¼Œå¯é€‰é…ç½®ã€‚ --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">filter</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-name</span>&gt;</span>CAS Single Sign Out Filter<span class=\"tag\">&lt;/<span class=\"name\">filter-name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-class</span>&gt;</span>org.jasig.cas.client.session.SingleSignOutFilter<span class=\"tag\">&lt;/<span class=\"name\">filter-class</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">filter</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">filter-mapping</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-name</span>&gt;</span>CAS Single Sign Out Filter<span class=\"tag\">&lt;/<span class=\"name\">filter-name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">url-pattern</span>&gt;</span>/*<span class=\"tag\">&lt;/<span class=\"name\">url-pattern</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">filter-mapping</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- è¯¥è¿‡æ»¤å™¨è´Ÿè´£ç”¨æˆ·çš„è®¤è¯å·¥ä½œï¼Œå¿…é¡»å¯ç”¨å®ƒ --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">filter</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-name</span>&gt;</span>CASFilter<span class=\"tag\">&lt;/<span class=\"name\">filter-name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-class</span>&gt;</span>org.jasig.cas.client.authentication.AuthenticationFilter<span class=\"tag\">&lt;/<span class=\"name\">filter-class</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- æœåŠ¡å™¨ç™»é™†é¡µé¢url </span></span><br><span class=\"line\"><span class=\"comment\">       casServerUrlPrefix  å‚æ•°çš„å€¼æ˜¯cas æœåŠ¡çš„è®¿é—®åœ°å€ã€‚cas client éªŒè¯ticket çš„æ—¶å€™ï¼Œ</span></span><br><span class=\"line\"><span class=\"comment\">      è¦è®¿é—®cas æœåŠ¡çš„/serviceValidate æ¥å£ï¼Œä½¿ç”¨çš„url å°±æ˜¯$&#123; casServerUrlPrefix &#125;serviceValidate ï¼Œ</span></span><br><span class=\"line\"><span class=\"comment\">      å› ä¸ºå®¢æˆ·web åº”ç”¨è¦éªŒè¯cas çš„è¯ä¹¦ï¼Œæ‰€ä»¥è¯ä¹¦cn å­—æ®µçš„å€¼å¿…é¡»å’ŒcasServerUrlPrefix é‡Œè®¾ç½®çš„cas æœåŠ¡å™¨çš„åŸŸåä¿æŒä¸€è‡´ï¼Œ</span></span><br><span class=\"line\"><span class=\"comment\">      å¹¶ä¸”åœ¨web åº”ç”¨çš„æœåŠ¡å™¨ä¸Šé…ç½®cas æœåŠ¡çš„è®¿é—®åŸŸåã€‚ </span></span><br><span class=\"line\"><span class=\"comment\">  --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>casServerLoginUrl<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>https://www.sifenggu.com:8443/cas/login<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--è¿™é‡Œçš„serveræ˜¯æœåŠ¡ç«¯çš„IP--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>serverName<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>http://localhost:9090<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">filter</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">filter-mapping</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-name</span>&gt;</span>CASFilter<span class=\"tag\">&lt;/<span class=\"name\">filter-name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">url-pattern</span>&gt;</span>/*<span class=\"tag\">&lt;/<span class=\"name\">url-pattern</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">filter-mapping</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- è¯¥è¿‡æ»¤å™¨è´Ÿè´£å¯¹Ticketçš„æ ¡éªŒå·¥ä½œï¼Œå¿…é¡»å¯ç”¨å®ƒ ,å¦‚æœè¦ä»æœåŠ¡å™¨è·å–ç”¨æˆ·åä¹‹å¤–çš„æ›´å¤šä¿¡æ¯åº”è¯¥é‡‡ç”¨cas20è¿™ä¸ª2.0åè®®çš„ä»£ç†--&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">filter</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-name</span>&gt;</span>CAS Validation Filter<span class=\"tag\">&lt;/<span class=\"name\">filter-name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-class</span>&gt;</span>org.jasig.cas.client.validation.Cas20ProxyReceivingTicketValidationFilter<span class=\"tag\">&lt;/<span class=\"name\">filter-class</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--  casServerUrlPrefix  å‚æ•°çš„å€¼æ˜¯cas æœåŠ¡çš„è®¿é—®åœ°å€ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">          cas client éªŒè¯ticket çš„æ—¶å€™ï¼Œè¦è®¿é—®cas æœåŠ¡çš„/serviceValidate æ¥å£ï¼Œ</span></span><br><span class=\"line\"><span class=\"comment\">          ä½¿ç”¨çš„url å°±æ˜¯$&#123; casServerUrlPrefix &#125;serviceValidate ï¼Œå› ä¸ºå®¢æˆ·web åº”ç”¨è¦éªŒè¯cas çš„è¯ä¹¦ï¼Œ</span></span><br><span class=\"line\"><span class=\"comment\">          æ‰€ä»¥è¯ä¹¦cn å­—æ®µçš„å€¼å¿…é¡»å’ŒcasServerUrlPrefix é‡Œè®¾ç½®çš„cas æœåŠ¡å™¨çš„åŸŸåä¿æŒä¸€è‡´ï¼Œå¹¶ä¸”åœ¨web åº”ç”¨çš„æœåŠ¡å™¨ä¸Šé…ç½®cas æœåŠ¡çš„è®¿é—®åŸŸåã€‚  --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>casServerUrlPrefix<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>https://www.sifenggu.com:8443/cas<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--serverName å‚æ•°ï¼Œcas client ä¼šç”¨æ¥ç”Ÿæˆservice å‚æ•°ï¼Œå¹¶ä¸”cas æœåŠ¡å™¨åœ¨è®¤è¯é€šè¿‡ã€ticket éªŒè¯é€šè¿‡åï¼Œ</span></span><br><span class=\"line\"><span class=\"comment\">      ä¼šredirect åˆ°web åº”ç”¨ï¼Œredirect çš„url å°±æ˜¯service å‚æ•°çš„å€¼ã€‚serverName å‚æ•°å¯ä»¥æ˜¯IP ï¼Œä¹Ÿå¯ä»¥æ˜¯åŸŸåï¼Œåªè¦ä¿è¯æµè§ˆå™¨èƒ½è®¿é—®åˆ°å³å¯ã€‚ --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>serverName<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>http://localhost:9090<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">filter</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">filter-mapping</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-name</span>&gt;</span>CAS Validation Filter<span class=\"tag\">&lt;/<span class=\"name\">filter-name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">url-pattern</span>&gt;</span>/*<span class=\"tag\">&lt;/<span class=\"name\">url-pattern</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">filter-mapping</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!--</span></span><br><span class=\"line\"><span class=\"comment\">  è¯¥è¿‡æ»¤å™¨è´Ÿè´£å®ç°HttpServletRequestè¯·æ±‚çš„åŒ…è£¹ï¼Œ</span></span><br><span class=\"line\"><span class=\"comment\">  æ¯”å¦‚å…è®¸å¼€å‘è€…é€šè¿‡HttpServletRequestçš„getRemoteUser()æ–¹æ³•è·å¾—SSOç™»å½•ç”¨æˆ·çš„ç™»å½•åï¼Œå¯é€‰é…ç½®ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">  --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">filter</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-name</span>&gt;</span>CAS HttpServletRequest Wrapper Filter<span class=\"tag\">&lt;/<span class=\"name\">filter-name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-class</span>&gt;</span>org.jasig.cas.client.util.HttpServletRequestWrapperFilter<span class=\"tag\">&lt;/<span class=\"name\">filter-class</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">filter</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">filter-mapping</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-name</span>&gt;</span>CAS HttpServletRequest Wrapper Filter<span class=\"tag\">&lt;/<span class=\"name\">filter-name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">url-pattern</span>&gt;</span>/*<span class=\"tag\">&lt;/<span class=\"name\">url-pattern</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">filter-mapping</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!--</span></span><br><span class=\"line\"><span class=\"comment\">  è¯¥è¿‡æ»¤å™¨ä½¿å¾—å¼€å‘è€…å¯ä»¥é€šè¿‡org.jasig.cas.client.util.AssertionHolderæ¥è·å–ç”¨æˆ·çš„ç™»å½•åã€‚</span></span><br><span class=\"line\"><span class=\"comment\">  æ¯”å¦‚AssertionHolder.getAssertion().getPrincipal().getName()ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">   --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">filter</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-name</span>&gt;</span>CAS Assertion Thread Local Filter<span class=\"tag\">&lt;/<span class=\"name\">filter-name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-class</span>&gt;</span>org.jasig.cas.client.util.AssertionThreadLocalFilter<span class=\"tag\">&lt;/<span class=\"name\">filter-class</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">filter</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">filter-mapping</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-name</span>&gt;</span>CAS Assertion Thread Local Filter<span class=\"tag\">&lt;/<span class=\"name\">filter-name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">url-pattern</span>&gt;</span>/*<span class=\"tag\">&lt;/<span class=\"name\">url-pattern</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">filter-mapping</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- è‡ªåŠ¨æ ¹æ®å•ç‚¹ç™»å½•çš„ç»“æœè®¾ç½®æœ¬ç³»ç»Ÿçš„ç”¨æˆ·ä¿¡æ¯ --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">filter</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">display-name</span>&gt;</span>AutoSetUserAdapterFilter<span class=\"tag\">&lt;/<span class=\"name\">display-name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-name</span>&gt;</span>AutoSetUserAdapterFilter<span class=\"tag\">&lt;/<span class=\"name\">filter-name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-class</span>&gt;</span>demo.frank.wu.sso.cas.AutoSetUserAdapterFilter<span class=\"tag\">&lt;/<span class=\"name\">filter-class</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">filter</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">filter-mapping</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-name</span>&gt;</span>AutoSetUserAdapterFilter<span class=\"tag\">&lt;/<span class=\"name\">filter-name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">url-pattern</span>&gt;</span>/*<span class=\"tag\">&lt;/<span class=\"name\">url-pattern</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">filter-mapping</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- å•ç‚¹ç™»é™†é…ç½®ç»“æŸ --&gt;</span></span><br><span class=\"line\">  ```  </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">## <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;adv&quot;</span>&gt;</span>å››ã€è¿›é˜¶åº”ç”¨<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">### <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;adv_1&quot;</span>&gt;</span>A.é…ç½®è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">æ‰“å¼€cas-server-webappé¡¹ç›®,æ‰¾åˆ°src/main/webapp/WEB-INF/deployerConfigContext.xml,å°†primaryAuthenticationHandlerè¿™ä¸ªbeanæ³¨é‡Šæ‰,ç”¨å¦‚ä¸‹beanæ›¿ä»£</span><br><span class=\"line\">```xml  </span><br><span class=\"line\"><span class=\"comment\">&lt;!-- è‡ªå®šä¹‰æ•°æ®åº“é‰´æƒ --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;primaryAuthenticationHandler&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;org.jasig.cas.adaptors.jdbc.QueryDatabaseAuthenticationHandler&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span> = <span class=\"string\">&quot;dataSource&quot;</span> <span class=\"attr\">ref</span>=<span class=\"string\">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span> = <span class=\"string\">&quot;sql&quot;</span>  <span class=\"attr\">value</span>=<span class=\"string\">&quot;select upper(password) from itsm_user where loginname= ?&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span> = <span class=\"string\">&quot;passwordEncoder&quot;</span> <span class=\"attr\">ref</span>=<span class=\"string\">&quot;MD5PasswordEncoder&quot;</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\">```  </span><br><span class=\"line\">åœ¨å…¶å®ƒä½ç½®é…ç½®æ•°æ®æºä»¥åŠè‡ªå®šä¹‰åŠ å¯†çš„bean  </span><br><span class=\"line\">```xml   </span><br><span class=\"line\"><span class=\"comment\">&lt;!-- datasourceæ•°æ®æº,é‡‡ç”¨æ­¤æ•°æ®æºéœ€è¦å°†druidå’Œojdbcä¾èµ–æ·»åŠ åˆ°é¡¹ç›®ä¸­ --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;dataSource&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;username&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;xxx&quot;</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;password&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;xxx&quot;</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;url&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;jdbc:oracle:thin:@xxx.xxx.xxx.xx:1521:xxx&quot;</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- é…ç½®åˆå§‹åŒ–å¤§å°ã€æœ€å°ã€æœ€å¤§ --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;initialSize&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;10&quot;</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;minIdle&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;10&quot;</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;maxActive&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;120&quot;</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- MD5åŠ å¯† --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;MD5PasswordEncoder&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;org.jasig.cas.util.MD5Encoder&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n<p>å…³äºè‡ªå®šä¹‰å¯†ç åŠ å¯†çš„MD5Encoderç±»,åªè¦è‡ªå·±å†™ä¸€ä¸ªç±»å®ç°org.jasig.cas.authentication.handler.PasswordEncoderæ¥å£ä¸­çš„<br>  public String encode(String password)<br>æ–¹æ³•å³å¯,è¯¥æ–¹æ³•çš„è¿”å›å€¼æ˜¯åŠ å¯†å¤„ç†åçš„å¯†ç ã€‚ å½“ç„¶å¦‚æœä½ ç”¨MD5åŠ å¯†å¯ä»¥é‡‡ç”¨å†…ç½®çš„MD5PasswordEncoder;</p>\n<p>ä¿®æ”¹å®Œæˆåé‡æ–°æ‰“åŒ…cas-server-webappé¡¹ç›®<br>P.S 1:è¿æ¥æ•°æ®åº“éœ€è¦å¢åŠ å¯¹cas-server-support-jdbcé¡¹ç›®å’Œæ•°æ®æºä»¥åŠæ•°æ®åº“é©±åŠ¨çš„ä¾èµ–ï¼Œå…³äºå¦‚ä½•å‘pomæ·»åŠ ä¾èµ–ï¼Œè¯·è‡ªè¡¥ï¼›å½“ç„¶æœ€å¥½ç»™æ ¹POMé…ç½®ä¸€ä¸‹å›½å†…çš„mavenåº“ï¼ˆä¾‹å¦‚å¼€æºä¸­å›½çš„ï¼‰ï¼Œå¦åˆ™ä¸ä»…ä¼šå¾ˆæ…¢ï¼Œå¾ˆå¤šä¾èµ–ä¹Ÿæ— æ³•ä¸‹è½½ã€‚</p>\n<p>2:ç”±äºOracleçš„åŸå›  mavenåº“ä¸­å¹¶æœªæä¾›oracleé©±åŠ¨ï¼Œè€Œmavenåˆä¸åƒgradleé‚£æ ·å¯ä»¥ç®€æ˜“å‹å¥½çš„åŠ è½½æœ¬åœ°ä¾èµ–ï¼Œæ‰€ä»¥éœ€è¦ä½ æ‰¾åˆ°oracleé©±åŠ¨å¹¶ä¸” æ³¨ å†Œ åˆ° æœ¬ åœ° ä»“ åº“<br>mvn install:install-file -Dfile={Path/to/your/ojdbc.jar} -DgroupId=com.oracle -DartifactId=ojdbc6 -Dversion=11.2.0 -Dpackaging=jar</p>\n<p>éƒ¨ç½²åˆ°tomcatä¹‹åä¾¿å¯ä»¥é€šè¿‡æ•°æ®åº“ä¸­çš„æ­£å¼ç”¨æˆ·è¿›è¡Œç™»é™†äº†.å¦‚æœé¡µé¢æç¤ºâ€æ‚¨æä¾›çš„å‡­è¯æœ‰è¯¯â€å¤šåŠä¸ºæ•°æ®æºé…ç½®æˆ–å¯†ç ä¸åŒ¹é…æ‰€è‡´ã€‚å»ºè®®æ£€æŸ¥æ•°æ®æºæ˜¯å¦é…ç½®æ­£ç¡®ä»¥åŠencoderåŠ å¯†è¿”å›çš„å¯†ç ä¸æ•°æ®åº“å­˜å‚¨çš„åŠ å¯†å¯†ç ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰æ˜¯å¦ä¸€è‡´ã€‚</p>\n<p>ä¿®æ”¹å®Œæˆåé‡‡ç”¨mavenpackgeå‘½ä»¤æˆ–è€…ç›´æ¥å†eclipseä¸­æ‰§è¡Œmaven installè¿›è¡Œæ„å»ºå³å¯.</p>\n<h3><span id=\"b-pei-zhi-zi-ding-yi-ren-zheng-fan-hui-can-shu\"></span><a href=\"#b-pei-zhi-zi-ding-yi-ren-zheng-fan-hui-can-shu\" class=\"header-anchor\">#</a></h3><p>é»˜è®¤æƒ…å†µä¸‹casè®¤è¯å®Œæˆååªä¼šè¿”å›usernameç»™å®¢æˆ·ç«¯,å¦‚æœéœ€è¦è¿”å›æ›´å¤šä¿¡æ¯éœ€è¦ä¿®æ”¹deployerConfigContext.xmlæ–‡ä»¶ï¼ŒåŒæ—¶é…ç½®attributeRepositoryå¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;attributeRepository&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">\t<span class=\"attr\">class</span>=<span class=\"string\">&quot;org.jasig.services.persondir.support.jdbc.SingleRowJdbcPersonAttributeDao&quot;</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"comment\">&lt;!--æŒ‡å®šæ•°æ®æº--&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">constructor-arg</span> <span class=\"attr\">index</span>=<span class=\"string\">&quot;0&quot;</span> <span class=\"attr\">ref</span>=<span class=\"string\">&quot;dataSource&quot;</span> /&gt;</span></span><br><span class=\"line\">\t<span class=\"comment\">&lt;!--æŒ‡å®šæŸ¥è¯¢sql--&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">constructor-arg</span> <span class=\"attr\">index</span>=<span class=\"string\">&quot;1&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;select  username,loginname from ITSM_USER  where &#123;0&#125;&quot;</span> /&gt;</span>  </span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">&lt;!-- ç»„è£…sqlç”¨çš„æŸ¥è¯¢æ¡ä»¶å±æ€§ --&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;queryAttributeMapping&quot;</span>&gt;</span></span><br><span class=\"line\">\t    <span class=\"tag\">&lt;<span class=\"name\">map</span>&gt;</span></span><br><span class=\"line\">\t        <span class=\"comment\">&lt;!-- keyå¿…é¡»æ˜¯uernameè€Œä¸”æ˜¯å°å†™å¦åˆ™ä¼šå¯¼è‡´å–ä¸åˆ°ç”¨æˆ·çš„å…¶å®ƒä¿¡æ¯ï¼Œvalueå¯¹åº”æ•°æ®åº“ç”¨æˆ·åå­—æ®µ,ç³»ç»Ÿä¼šè‡ªå·±åŒ¹é… --&gt;</span></span><br><span class=\"line\">\t        <span class=\"tag\">&lt;<span class=\"name\">entry</span> <span class=\"attr\">key</span>=<span class=\"string\">&quot;username&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;loginname&quot;</span> /&gt;</span></span><br><span class=\"line\">\t    <span class=\"tag\">&lt;/<span class=\"name\">map</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;resultAttributeMapping&quot;</span>&gt;</span></span><br><span class=\"line\">\t    <span class=\"tag\">&lt;<span class=\"name\">map</span>&gt;</span></span><br><span class=\"line\">\t        <span class=\"comment\">&lt;!-- keyä¸ºå¯¹åº”çš„æ•°æ®åº“å­—æ®µåç§°ï¼Œvalueä¸ºæä¾›ç»™å®¢æˆ·ç«¯è·å–çš„å±æ€§åå­—ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¡«å……å€¼ --&gt;</span></span><br><span class=\"line\">\t        <span class=\"tag\">&lt;<span class=\"name\">entry</span> <span class=\"attr\">key</span>=<span class=\"string\">&quot;loginname&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;loginname&quot;</span>/&gt;</span></span><br><span class=\"line\">\t        <span class=\"tag\">&lt;<span class=\"name\">entry</span> <span class=\"attr\">key</span>=<span class=\"string\">&quot;username&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;username&quot;</span>/&gt;</span></span><br><span class=\"line\">\t    <span class=\"tag\">&lt;/<span class=\"name\">map</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;serviceRegistryDao&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;org.jasig.cas.services.InMemoryServiceRegistryDaoImpl&quot;</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;registeredServices&quot;</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">list</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;org.jasig.cas.services.RegexRegisteredService&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;id&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;0&quot;</span> /&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;name&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;HTTP and IMAP&quot;</span> /&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;description&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;Allows HTTP(S) and IMAP(S) protocols&quot;</span> /&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;serviceId&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;^(https?|imaps?)://.*&quot;</span> /&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;evaluationOrder&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;10000001&quot;</span> /&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"comment\">&lt;!-- æ­¤å±æ€§ç›¸å½“å…³é”®,å¿…é¡»é…ç½®åå®¢æˆ·ç«¯æ‰èƒ½è·å–ä¿¡æ¯ --&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;allowedAttributes&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">list</span>&gt;</span></span><br><span class=\"line\">\t\t\t        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>username<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">\t\t\t        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>loginname<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">\t\t\t    <span class=\"tag\">&lt;/<span class=\"name\">list</span>&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">list</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>æ‰¾åˆ°casServiceValidationSuccess.jspã€‚æ­¤æ–‡ä»¶ä½œç”¨æ˜¯åœ¨serveréªŒè¯æˆåŠŸåï¼Œè¿™ä¸ªé¡µé¢è´Ÿè´£ç”Ÿæˆä¸å®¢æˆ·ç«¯äº¤äº’çš„xmlä¿¡æ¯ï¼Œåœ¨é»˜è®¤çš„casServiceValidationSuccess.jspä¸­ï¼ŒåªåŒ…æ‹¬ç”¨æˆ·ç™»å½•åï¼Œå¹¶ä¸æä¾›å…¶ä»–çš„å±æ€§ä¿¡æ¯ï¼Œå› æ­¤éœ€è¦å¯¹é¡µé¢è¿›è¡Œæ‰©å±•ã€‚</p>\n<figure class=\"highlight jsp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page session=<span class=\"string\">&quot;false&quot;</span> %&gt;</span><br><span class=\"line\">&lt;%@ taglib prefix=<span class=\"string\">&quot;c&quot;</span> uri=<span class=\"string\">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> %&gt;</span><br><span class=\"line\">&lt;%@ taglib uri=<span class=\"string\">&quot;http://java.sun.com/jsp/jstl/functions&quot;</span> prefix=<span class=\"string\">&quot;fn&quot;</span> %&gt;</span><br><span class=\"line\">&lt;cas:serviceResponse xmlns:cas=<span class=\"string\">&#x27;http://www.yale.edu/tp/cas&#x27;</span>&gt;</span><br><span class=\"line\">\t&lt;cas:authenticationSuccess&gt;</span><br><span class=\"line\">\t\t&lt;cas:user&gt;$&#123;fn:escapeXml(assertion.chainedAuthentications[fn:length(assertion.chainedAuthentications)-1].principal.id)&#125;&lt;/cas:user&gt;</span><br><span class=\"line\">\t\t&lt;c:<span class=\"keyword\">if</span> test=<span class=\"string\">&quot;$&#123;not empty pgtIou&#125;&quot;</span>&gt;</span><br><span class=\"line\">\t\t\t&lt;cas:proxyGrantingTicket&gt;$&#123;pgtIou&#125;&lt;/cas:proxyGrantingTicket&gt;</span><br><span class=\"line\">\t\t&lt;/c:if&gt;</span><br><span class=\"line\">\t\t&lt;c:<span class=\"keyword\">if</span> test=<span class=\"string\">&quot;$&#123;fn:length(assertion.chainedAuthentications) &gt; 1&#125;&quot;</span>&gt;</span><br><span class=\"line\">\t\t\t&lt;cas:proxies&gt;</span><br><span class=\"line\">\t\t\t\t&lt;c:forEach <span class=\"keyword\">var</span>=<span class=\"string\">&quot;proxy&quot;</span> items=<span class=\"string\">&quot;$&#123;assertion.chainedAuthentications&#125;&quot;</span> varStatus=<span class=\"string\">&quot;loopStatus&quot;</span> begin=<span class=\"string\">&quot;0&quot;</span> end=<span class=\"string\">&quot;$&#123;fn:length(assertion.chainedAuthentications)-2&#125;&quot;</span> step=<span class=\"string\">&quot;1&quot;</span>&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;cas:proxy&gt;$&#123;fn:escapeXml(proxy.principal.id)&#125;&lt;/cas:proxy&gt;</span><br><span class=\"line\">\t\t\t\t&lt;/c:forEach&gt;</span><br><span class=\"line\">\t\t\t&lt;/cas:proxies&gt;</span><br><span class=\"line\">\t\t&lt;/c:if&gt;</span><br><span class=\"line\">\t   &lt;!-- åœ¨serveréªŒè¯æˆåŠŸåï¼Œè¿™ä¸ªé¡µé¢è´Ÿè´£ç”Ÿæˆä¸å®¢æˆ·ç«¯äº¤äº’çš„xmlä¿¡æ¯ï¼Œåœ¨é»˜è®¤çš„casServiceValidationSuccess.jspä¸­ï¼ŒåªåŒ…æ‹¬ç”¨æˆ·åï¼Œå¹¶ä¸æä¾›å…¶ä»–çš„å±æ€§ä¿¡æ¯ï¼Œå› æ­¤éœ€è¦å¯¹é¡µé¢è¿›è¡Œæ‰©å±• --&gt;  </span><br><span class=\"line\">       &lt;c:<span class=\"keyword\">if</span>  test=<span class=\"string\">&quot;$&#123;fn:length(assertion.chainedAuthentications[fn:length(assertion.chainedAuthentications)-1].principal.attributes) &gt; 0&#125;&quot;</span>&gt;</span><br><span class=\"line\">\t        &lt;cas:attributes&gt;</span><br><span class=\"line\">\t            &lt;c:forEach <span class=\"keyword\">var</span>=<span class=\"string\">&quot;attr&quot;</span></span><br><span class=\"line\">\t               items=<span class=\"string\">&quot;$&#123;assertion.chainedAuthentications[fn:length(assertion.chainedAuthentications)-1].principal.attributes&#125;&quot;</span>&gt;</span><br><span class=\"line\">\t                &lt;cas:$&#123;fn:escapeXml(attr.key)&#125;&gt;$&#123;fn:escapeXml(attr.value)&#125;&lt;/cas:$&#123;fn:escapeXml(attr.key)&#125;&gt;</span><br><span class=\"line\">\t            &lt;/c:forEach&gt;</span><br><span class=\"line\">\t        &lt;/cas:attributes&gt;</span><br><span class=\"line\">   \t\t&lt;/c:if&gt;</span><br><span class=\"line\">\t&lt;/cas:authenticationSuccess&gt;</span><br><span class=\"line\">&lt;/cas:serviceResponse&gt;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>å®¢æˆ·ç«¯è·å–ç”¨æˆ·ä¿¡æ¯</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">AttributePrincipal principal = (AttributePrincipal) request.getUserPrincipal();</span><br><span class=\"line\">String loginName = principal.getName();</span><br><span class=\"line\">System.out.println(<span class=\"string\">&quot;loginName:&quot;</span> + loginName);</span><br><span class=\"line\">Map&lt;String, Object&gt; attributes = principal.getAttributes();</span><br><span class=\"line\">System.out.println(<span class=\"string\">&quot;username:&quot;</span> + attributes.get(<span class=\"string\">&quot;username&quot;</span>));</span><br></pre></td></tr></table></figure>\n<h3><span id=\"c-cas-jie-mian-xiu-gai\"></span><a href=\"#c-cas-jie-mian-xiu-gai\" class=\"header-anchor\">#</a></h3><p>1.casç»Ÿä¸€è®¤è¯çš„ç™»é™†é¡µé¢ä½äºï¼šcasç›®å½•/WEB-INF/view/jsp/default æ–‡ä»¶å¤¹é‡Œï¼Œå…¶ä¸­ui/casLoginView.jspä¸ºç™»é™†é¡µé¢</p>\n<p>2.é¦–å…ˆå¤åˆ¶ä¸€ä»½defaultæ–‡ä»¶å¤¹ é‡å‘½åä¸ºmyview</p>\n<p>3.ç„¶åå¤åˆ¶classes/default.properties  åˆ° classes/mytheme.properties æ‰“å¼€mytheme.properties ä¿®æ”¹ç™»é™†é¡µé¢çš„è·¯å¾„ä¸ºæˆ‘ä»¬å¤åˆ¶çš„myview æ–‡ä»¶å¤¹ã€‚</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## ä¿®æ”¹ç™»é™†é¡µé¢ä¸ºè‡ªå®šä¹‰é¡µé¢</span></span><br><span class=\"line\"><span class=\"comment\">## mod by wuf 2015/1/16</span></span><br><span class=\"line\"><span class=\"meta\">casLoginView.url</span>=<span class=\"string\">/WEB-INF/view/jsp/myview/ui/casLoginView.jsp</span></span><br></pre></td></tr></table></figure>\n<p>4 ä¿®æ”¹ casç›®å½•/cas.properties ä¸­ cas.viewResolver.basename =mytheme</p>\n<p>åˆ°è¿™ä¸€æ­¥æˆ‘ä»¬åªæ˜¯å°†ç™»é™†é¡µé¢æ‹·è´äº†ä¸€ä»½ç„¶åæŒ‡å‘è¿™ä»½æ‹·è´ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥éšæ„ä¿®æ”¹æˆ‘ä»¬æ‹·è´çš„é¡µé¢ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯å¦‚æœä»¥åæƒ³è¿˜åŸå›æ¥æ¯”è¾ƒæ–¹ä¾¿ï¼Œåªéœ€è¦ä¿®æ”¹å¼•ç”¨å°±è¡Œã€‚</p>\n<p>æ¥ä¸‹æ¥æˆ‘ä»¬ä¿®æ”¹casLoginView.jspé¡µé¢ï¼š</p>\n<p>ä¿®æ”¹çš„è¦æ±‚æ˜¯ï¼šéœ€è¦ä¿ç•™ç™»é™†formè¡¨å•ï¼ˆä½†å¯ä»¥ä¿®æ”¹æ ·å¼ï¼Œè™½ç„¶è¡¨å•æ ‡ç­¾æ˜¯å¸¦å‰ç¼€çš„ï¼Œä½†å’Œæ™®é€šhtmlæ ‡ç­¾ä¸€æ ·ä¿®æ”¹å…¶æ ·å¼ï¼Œä¹Ÿå¯ä»¥å°†æ‰€æœ‰çš„ä¿¡æ¯è¾“å‡ºåˆ é™¤ å¦‚&lt;spring:message code=â€screen.welcome.label.netid.accesskeyâ€ var=â€userNameAccessKeyâ€ /&gt;ï¼‰ä½†å¿…é¡»ä¿ç•™ä¿å•ä¸­çš„ç”¨æˆ·åã€å¯†ç è¾“å…¥æ¡†ï¼Œç¡®è®¤æŒ‰é’®ï¼Œè€Œä¸”æœ€å¥½å¤åˆ¶å…¶æ ‡ç­¾ï¼Œä¿®æ”¹å…¶classå±æ€§æ¥ä¿®æ”¹æ ·å¼.</p>\n<p>__å‚è€ƒèµ„æ–™<br>*<a href=\"http://www.liferay.com/community/wiki/-/wiki/Main/JBoss+AS7+tips#section-JBoss+AS7+tips-Installing+cas-web\">Jboss as 7 wiki - Installing cas-web</a><br>*<a href=\"http://wiki.bsdn.org/pages/viewpage.action?pageId=2326779\">WebLogicä¸ŠCASæœåŠ¡å™¨æ­å»º</a><br>*<a href=\"http://wiki.bsdn.org/pages/viewpage.action?pageId=2326775\">WebSphereä¸Šæ­å»ºCAS Server</a><br>*<a href=\"http://www.coin163.com/java/cas/cas.html\">CASå®ç°å•ç‚¹ç™»é™†çš„åŸç†</a><br>*<a href=\"http://blog.csdn.net/frinder/article/details/7969925\">CASå•ç‚¹ç™»é™†(SSO)å®Œæ•´æ•™ç¨‹</a><br>*<a href=\"http://blog.csdn.net/alonesword/article/details/17692269\">ä¿®æ”¹casç™»é™†é¡µé¢-æœåŠ¡å™¨ç«¯</a><br>*<a href=\"http://exceptioneye.iteye.com/blog/1886131\">å•ç‚¹ç™»å½• - CASã€å››ã€‘è·å–æ›´å…¨é¢çš„ç”¨æˆ·ä¿¡æ¯</a></p>\n</connector>","categories":["SSO"],"tags":["cas"]},{"title":"installarchwithaui","url":"https://pkaq.org/2014/09/19/2014-09-18-installarchwithaui/","content":"<p>æœ€è¿‘åœ¨Githubä¸Šå‘ç°ä¸€Archè„šæœ¬,å¯ä»¥æå¤§ç®€åŒ–Archå®‰è£…,ä»Šæ—¥å·²åœ¨å®ä½“æœºäº²æµ‹,éå¸¸å¥½ä½¿<br> <a href=\"https://github.com/helmuthdu/aui\">archlinuxå®‰è£…è„šæœ¬</a>  </p>\n<h2><span id=\"xian-jue-tiao-jian\">å…ˆå†³æ¡ä»¶</span><a href=\"#xian-jue-tiao-jian\" class=\"header-anchor\">#</a></h2><p> 1.ç½‘ç»œç•…é€š<br> 2.ä»¥rootç”¨æˆ·ç™»é™†</p>\n<h2><span id=\"ru-he-huo-qu\">å¦‚ä½•è·å–</span><a href=\"#ru-he-huo-qu\" class=\"header-anchor\">#</a></h2><h3><span id=\"cai-yong-git-fang-shi-huo-qu\">é‡‡ç”¨Gitæ–¹å¼è·å–</span><a href=\"#cai-yong-git-fang-shi-huo-qu\" class=\"header-anchor\">#</a></h3><p>â€¢å®‰è£…Git</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\tpacman -Sy git  </span><br><span class=\"line\">```  </span><br><span class=\"line\">â€¢è·å–è„šæœ¬</span><br><span class=\"line\">```shell  </span><br><span class=\"line\">\tgit clone git://github.com/helmuthdu/aui   </span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">## é‡‡ç”¨éGitæ–¹å¼</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">```shell  </span><br><span class=\"line\">\twget --no-check-certificate https://github.com/helmuthdu/aui/tarball/master -O - | tar xz  </span><br><span class=\"line\">```  </span><br><span class=\"line\">æˆ–è€…é‡‡ç”¨çŸ­åœ°å€</span><br><span class=\"line\">```shell  </span><br><span class=\"line\">\twget --no-check-certificate http://bit.ly/NoUPC6 -O - | tar xz  </span><br></pre></td></tr></table></figure>\n<p>æˆ–è€…é‡‡ç”¨æ›´çŸ­çš„:)  </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget ow.ly/wnFgh -o aui.zip  </span><br></pre></td></tr></table></figure>\n<h2><span id=\"ru-he-shi-yong\">å¦‚ä½•ä½¿ç”¨</span><a href=\"#ru-he-shi-yong\" class=\"header-anchor\">#</a></h2><p>åˆ‡æ¢åˆ°è„šæœ¬æ‰€åœ¨ç›®å½•æ‰§è¡Œ./fifoæˆ–è€…./liloç„¶åæŒ‰æç¤ºæ­¥éª¤æ“ä½œå³å¯,å…³äºä¸¤ä¸ªè„šæœ¬çš„åŒºåˆ«è¯·å‚é˜…githubä»‹ç».è¿™é‡Œä¸å†ç¿»è¯‘.~~:},<br>å¦‚æœé‡‡ç”¨fifoè„šæœ¬å®‰è£…å¯ä»¥å†å®‰è£…å®Œæˆåè‡ªè¡Œå®‰è£…å›¾å½¢ç•Œé¢ç­‰,å…·ä½“å¯å‚è€ƒ<a href=\"/2014/06/19/installarch\">æ‹¥æŠ±Arch Linux-å®‰è£…é…ç½®å°è®°</a><br>â€¢FIFO [system base]:  cd <dir> &amp;&amp; ./fifo<br>â€¢LILO [the restâ€¦]:  cd <dir> &amp;&amp; ./lilo</dir></dir></p>\n","categories":["archlinux"],"tags":["Arch"]},{"title":"ArchLinuxé…ç½®alias","url":"https://pkaq.org/2014/07/18/2014-07-18-aliasonarch/","content":"<p>ç›´æ¥ç”¨å¦‚ä¸‹å‘½ä»¤å¯ä»¥è®¾ç½®alias,ä½†æ­¤ç§æ–¹å¼é‡å¯åä¼šä¸¢å¤±,å¯é€šè¿‡å°†å¦‚ä¸‹å‘½ä»¤åŠ åˆ°profileæ–‡ä»¶çš„æ–¹å¼æ¥ä½¿å…¶æ°¸ä¹…ç”Ÿæ•ˆ</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">alias ll=&#x27;ls -l&#x27;</span><br><span class=\"line\">alias ..=&#x27;cd ..&#x27;</span><br></pre></td></tr></table></figure>\n<p>ç¼–è¾‘<del>/.bashrc,å°†æ‰€éœ€aliasæ·»åŠ åˆ°æ­¤æ–‡ä»¶ä¸­å³å¯.<br>å¦:æœ‰çš„å‘è¡Œç‰ˆå¯ä»¥é€šè¿‡æ·»åŠ </del>/.bash_aliasesæ–‡ä»¶æ¥è¿›è¡ŒæŒ‡å®š,åœ¨archä¸­æ²¡æœ‰è¿›è¡Œå°è¯•.ä¸çŸ¥é“æ˜¯å¦å¯è¡Œ.  </p>\n<pre class=\" language-shell\"><code class=\"language-shell\">    vim ~/.bashrc  </code></pre>\n","categories":["archlinux"],"tags":["Arch"]},{"title":"ArchLinuxé…ç½®SSH publickeyç™»å½•","url":"https://pkaq.org/2014/07/18/2014-07-18-sshonarch/","content":"<h3><span id=\"1-an-zhuang-openssh\">1.å®‰è£…OpenSSH</span><a href=\"#1-an-zhuang-openssh\" class=\"header-anchor\">#</a></h3><pre class=\" language-shell\"><code class=\"language-shell\">    #å®‰è£…\n    pacman -S openssh\n    #å¯åŠ¨\n    systemctl start sshd.service\n    #æ·»åŠ åˆ°å®ˆæŠ¤è¿›ç¨‹\n    systemctl enable sshd.service</code></pre>\n<h3><span id=\"2-pei-zhi\">2.é…ç½®</span><a href=\"#2-pei-zhi\" class=\"header-anchor\">#</a></h3><pre class=\" language-shell\"><code class=\"language-shell\">    vim /etc/ssh/sshd_config</code></pre>\n<p>ä¿®æ”¹å¦‚ä¸‹ä¸¤ä¸ªå‚æ•°ä¸º<br>UsePAM no<br>PubkeyAuthentication yes<br>è®¾ç½®å®Œæˆåé‡å¯æœåŠ¡  </p>\n<pre class=\" language-shell\"><code class=\"language-shell\">    systemctl restart sshd.service  </code></pre>\n<h3><span id=\"3-sheng-cheng-key\">3.ç”Ÿæˆkey</span><a href=\"#3-sheng-cheng-key\" class=\"header-anchor\">#</a></h3><pre class=\" language-shell\"><code class=\"language-shell\">    ssh-keygen -t rsa  </code></pre>\n<p>è¯¥è¿‡ç¨‹ä¸­ä¼šæç¤ºè¾“å…¥å¯†ç ,ç›´æ¥å›è½¦ç•¥è¿‡å³å¯å¿½ç•¥å¯†ç <br>æ·»åŠ è®¤è¯</p>\n<pre class=\" language-shell\"><code class=\"language-shell\">    cat ~/.ssh/id_rsa.pub>>authorized_keys  </code></pre>\n<a id=\"more\"></a>\n<p>çŸ¥è¯†æ™®åŠ:  </p>\n<ol>\n<li><p>PublicKeyè®¤è¯åŸºæœ¬åŸç†<br> Public Keyï¼ˆéå¯¹ç§°ï¼Œasymmetricï¼‰è®¤è¯ä½¿ç”¨ä¸€å¯¹ç›¸å…³è”çš„Key Pairï¼ˆä¸€ä¸ªå…¬é’¥Public Keyï¼Œä¸€ä¸ªç§é’¥Private Keyï¼‰æ¥ä»£æ›¿ä¼ ç»Ÿçš„å¯†ç ï¼ˆæˆ–æˆ‘ä»¬å¸¸è¯´çš„å£ä»¤ï¼ŒPasswordï¼‰ã€‚é¡¾åæ€ä¹‰ï¼ŒPublicKeyæ˜¯ç”¨æ¥å…¬å¼€çš„ï¼Œå¯ä»¥å°†å…¶æ”¾åˆ°SSHæœåŠ¡å™¨è‡ªå·±çš„å¸å·ä¸­ï¼Œè€ŒPrivateKeyåªèƒ½ç”±è‡ªå·±ä¿ç®¡ï¼Œç”¨æ¥è¯æ˜è‡ªå·±èº«ä»½ã€‚<br>ä½¿ç”¨PublicKeyåŠ å¯†è¿‡çš„æ•°æ®åªæœ‰ç”¨ä¸ä¹‹ç›¸å¯¹åº”çš„PrivateKeyæ‰èƒ½è§£å¯†ã€‚è¿™æ ·åœ¨è®¤è¯çš„è¿‡ç¨‹ä¸­ï¼ŒPublicKeyæ‹¥æœ‰è€…ä¾¿å¯ä»¥é€šè¿‡PublicKeyåŠ å¯†ä¸€äº›ä¸œè¥¿å‘é€ç»™å¯¹åº”çš„PrivateKeyæ‹¥æœ‰è€…ï¼Œå¦‚æœåœ¨é€šä¿¡çš„åŒæ–¹éƒ½æ‹¥æœ‰å¯¹æ–¹çš„PublicKeyï¼ˆè‡ªå·±çš„PrivateKeyåªç”±è‡ªå·±ä¿ç®¡ï¼‰ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡è¿™å¯¹Key Pairæ¥å®‰å…¨åœ°äº¤æ¢ä¿¡æ¯ï¼Œä»è€Œå®ç°ç›¸äº’è®¤è¯ã€‚åœ¨ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬æŠŠè‡ªå·±çš„PublicKeyæ”¾åœ¨é€šè¿‡å®‰å…¨æ¸ é“æ”¾åˆ°æœåŠ¡å™¨ä¸Šï¼ŒPrivateKeyè‡ªå·±ä¿ç®¡ï¼ˆç”¨ä¸€ä¸ªå£ä»¤æŠŠPrivateKeyåŠ å¯†åå­˜æ”¾ï¼‰ï¼Œè€ŒæœåŠ¡å™¨çš„PublicKeyä¸€èˆ¬ä¼šåœ¨ç¬¬ä¸€æ¬¡ç™»å½•æœåŠ¡å™¨çš„æ—¶å€™å­˜æ”¾åˆ°æœ¬åœ°å®¢æˆ·ç«¯ï¼ˆä¸¥æ ¼åœ°è¯´æ¥æœåŠ¡å™¨çš„PublicKeyä¹Ÿåº”è¯¥é€šè¿‡å®‰å…¨æ¸ é“æ”¾åˆ°æœ¬åœ°å®¢æˆ·ç«¯ï¼Œä»¥é˜²æ­¢åˆ«äººç”¨ä»–è‡ªå·±çš„PublicKeyæ¥æ¬ºéª—ç™»å½•ï¼‰ã€‚</p>\n</li>\n<li><p>Public Keyè®¤è¯ç›¸å¯¹äºå…¶å®ƒSSHè®¤è¯çš„ä¼˜ç‚¹<br>åœ¨ä¼—å¤šSSHç™»å½•è®¤è¯ä¸­ï¼Œä¼ ç»Ÿçš„å•å£ä»¤ï¼ˆPasswordï¼‰è®¤è¯ç”¨å¾—æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä»¬ä¸»è¦å¯¹æ¯”ä¸€ä¸‹SSHè®¤è¯ä¸­çš„å£ä»¤ï¼ˆPasswordï¼‰è®¤è¯å’ŒPublicKeyè®¤è¯çš„åŒºåˆ«ã€‚<br>a. åŸºäºä¸»æœºIPï¼ˆrhostï¼‰çš„è®¤è¯ï¼šå¯¹äºæŸä¸ªä¸»æœºï¼ˆIPï¼‰ä¿¡ä»»å¹¶è®©ä¹‹ç™»å½•ï¼Œè¿™ç§è®¤è¯å®¹æ˜“å—åˆ°IPæ¬ºéª—æ”»å‡»ã€‚ b. Kerberosè®¤è¯ï¼šä¸€ä¸ªå¤§å‹çš„åŸºäºåŸŸçš„è®¤è¯ï¼Œè¿™ç§è®¤è¯å®‰å…¨æ€§é«˜ï¼Œä½†æ˜¯å¤ªå¤§ã€å¤ªå¤æ‚ä¸æ–¹ä¾¿éƒ¨ç½²ã€‚<br>c. PAMè®¤è¯ï¼šç±»ä¼¼äºä¼ ç»Ÿçš„å¯†ç è®¤è¯ï¼Œæ˜¯ç»å¤§å¤šæ•°Unix/Linuxç³»ç»Ÿè‡ªå¸¦çš„ä¸€ä¸ªè®¤è¯å’Œè®°å¸çš„æ¨¡å—ï¼Œå®ƒçš„åŠŸèƒ½æ¯”è¾ƒå¤æ‚ï¼Œé…ç½®èµ·æ¥æ¯”è¾ƒéº»çƒ¦ã€‚è€Œä¸”ï¼Œå®¹æ˜“ç”±äºé…ç½®å¤±è¯¯è€Œå¼•èµ·å®‰å…¨é—®é¢˜ã€‚ æ±—ç»´<br>d. ä¼ ç»Ÿçš„Unix/Linuxå£ä»¤ï¼ˆæˆ–å¯†ç Passwordï¼‰è®¤è¯ï¼šåœ¨å®¢æˆ·ç«¯ç›´æ¥è¾“å…¥å¸å·å¯†ç ï¼Œç„¶åè®©SSHåŠ å¯†ä¼ è¾“åˆ°æœåŠ¡å™¨ç«¯éªŒè¯ã€‚è¿™ç§è®¤è¯æ–¹å¼æœ‰ç€å¦‚ä¸‹æ˜æ˜¾çš„ç¼ºç‚¹ï¼š<br>1ï¼‰ä¸ºäº†ç¡®ä¿å¯†ç å®‰å…¨ï¼Œå¯†ç å¿…é¡»å¾ˆé•¿å¾ˆå¤æ‚ï¼Œä½†æ˜¯è¿™æ ·çš„å¯†ç å¾ˆéš¾è®°å¿†ï¼›<br>2ï¼‰å¯¹äºè‡ªå·±æ‰€æ‹¥æœ‰çš„æ¯ä¸ªå¸å·ï¼Œä¸ºäº†å®‰å…¨ï¼Œä¸åŒçš„å¸å·éƒ½è¦è®¾ç½®ä¸åŒçš„å¯†ç ï¼Œç®¡ç†èµ·æ¥å¾ˆä¸æ–¹ä¾¿ï¼›<br>3ï¼‰ å¯¹äºé»˜è®¤å¸å·ï¼Œé»˜è®¤å¯†ç ï¼Œä¾‹å¦‚è£…æœºæ—¶ç”¨çš„å¸å·ï¼Œå¦‚æœä¸€æ—¶ç–å¿½æ²¡æœ‰æ”¹å¯†ç ï¼Œè¢«å…¶å®ƒä¸æ€€å¥½æ„çš„äººæ‰«æåˆ°å¸å·å’Œå¯†ç ï¼Œå¯èƒ½ä¼šé€ æˆå®‰å…¨æ¼æ´ï¼›<br>4ï¼‰å¦‚æœè¿œç¨‹ä¸»æœºå·²ç»è¢«æ”»å‡»ï¼Œå³ä½¿ä½¿ç”¨SSHå®‰å…¨é€šé“è¿›è¡Œä¿æŠ¤ï¼Œåœ¨ç½‘ç»œä¸Šå‘é€çš„å¯†ç åœ¨åˆ°è¾¾è¿œç¨‹ä¸»æœºæ—¶ä¹Ÿå¯èƒ½è¢«æˆªè·ï¼›<br>5ï¼‰å¯¹äºæ¯ä¸ªå¸å·çš„ä¿®æ”¹éƒ½è¦äººå·¥ç™»å½•ï¼ˆä¸ºäº†å®‰å…¨ï¼Œä¸èƒ½æŠŠPasswordæ”¾åˆ°è„šæœ¬é‡Œï¼‰ï¼Œéšç€æœåŠ¡å™¨æ•°é‡å¢å¤šï¼Œè¿™é¡¹å·¥ä½œä¼šå˜å¾—ååˆ†çƒ¦çã€‚</p>\n</li>\n<li><p>Public Keyé…ç½®<br>ä½¿ç”¨ä¸€ç§è¢«ç§°ä¸ºâ€å…¬ç§é’¥â€è®¤è¯çš„æ–¹å¼æ¥è¿›è¡Œsshç™»å½•. â€œå…¬ç§é’¥â€è®¤è¯æ–¹å¼ç®€å•çš„è§£é‡Š:é¦–å…ˆåœ¨å®¢æˆ·ç«¯ä¸Šåˆ›å»ºä¸€å¯¹å…¬ç§é’¥ ï¼ˆå…¬é’¥æ–‡ä»¶ï¼š<del>/.ssh/id_rsa.pubï¼› ç§é’¥æ–‡ä»¶ï¼š</del>/.ssh/id_rsaï¼‰<br>ç„¶åæŠŠå…¬é’¥æ”¾åˆ°æœåŠ¡å™¨ä¸Šï¼ˆ~/.ssh/authorized_keysï¼‰, è‡ªå·±ä¿ç•™å¥½ç§é’¥.åœ¨ä½¿ç”¨sshç™»å½•æ—¶,sshç¨‹åºä¼šå‘é€ç§é’¥å»å’ŒæœåŠ¡å™¨ä¸Šçš„å…¬é’¥åšåŒ¹é….å¦‚æœåŒ¹é…æˆåŠŸå°±å¯ä»¥ç™»å½•äº†</p>\n</li>\n</ol>\n","categories":["archlinux"],"tags":["Arch"]},{"title":"åœ¨ArchLinuxä¸Šå®‰è£…Oracle12C","url":"https://pkaq.org/2014/07/08/2014-07-08-installoracleforarch/","content":"<p>å…³äºè¿™ä¸ªé—®é¢˜,æŒ‰ç…§å®˜æ–¹WikiåŸºæœ¬å¯ä»¥èµ°é€š,ä½†ä¸­é—´ä¼šæœ‰äº›è®¸é—®é¢˜.  </p>\n<h3><span id=\"0-an-zhuang-qian-zhun-bei\">0.å®‰è£…å‰å‡†å¤‡</span><a href=\"#0-an-zhuang-qian-zhun-bei\" class=\"header-anchor\">#</a></h3><p>1.é¦–å…ˆä½ å¾—ä¿è¯å¯ä»¥pingé€šè‡ªå·±çš„ä¸»æœºå,å…³äºè¿™ç‚¹å¯ä»¥å‚é˜…ä¸Šä¸€ç¯‡æ–‡ç« <a href=\"/2014/06/19/installarch\">æ‹¥æŠ±Arch Linux-å®‰è£…é…ç½®å°è®°</a><br>2.å…¶æ¬¡éœ€è¦æœ‰æ¡Œé¢ç¯å¢ƒ,å¯ä»¥å‚è€ƒ<a href=\"/2014/06/19/installarch/#installx\">å®‰è£…Xç¯å¢ƒ</a>å’Œ<a href=\"/2014/06/19/installarch/#xfce4\">å®‰è£…XFCE4</a><br>3.ä¿è¯ç½‘ç»œç•…é€š(netctlä½¿ç”¨ä»¥åŠåŒç½‘å¡é…ç½®åç»­è¡¥å……</p>\n<a id=\"more\"></a>\n\n<h3><span id=\"1-an-zhuang-ruan-jian-bao\">1.å®‰è£…è½¯ä»¶åŒ…</span><a href=\"#1-an-zhuang-ruan-jian-bao\" class=\"header-anchor\">#</a></h3><p>å®‰è£…Oracleæ•°æ®åº“å¿…éœ€çš„è½¯ä»¶åŒ…</p>\n<p>Arch i686:<br>â—¾base-devel<br>â—¾java-runtime (openjdk6 or jre jdk)<br>â—¾ksh, rpm, gawk, gdb, libaio, libelf, sysstat, unixodbc, libstdc++5<br>â—¾unzip, sudo </p>\n<p>Arch x86_64:<br>â—¾base-devel<br>â—¾java-runtime (openjdk6 or jre jdk)<br>â—¾ksh, rpm, gawk, gdb, libaio, libelf, sysstat, libstdc++5<br>â—¾unzip, sudo<br>æ‰§è¡Œ </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\t pacman -S unzip sudo java-runtime base-devel</span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\">Oracle32ä½æ•°æ®åº“éœ€è¦unixodbcã€‚ </span><br><span class=\"line\">```shell  </span><br><span class=\"line\">\tpacman -S unixodbc</span><br></pre></td></tr></table></figure>\n\n<p>å¯é€‰çš„lib32 è½¯ä»¶åŒ… x86_64: </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pacman -S lib32-libstdc++5 </span><br><span class=\"line\">pacman -S lib32-glibc </span><br><span class=\"line\">pacman -S lib32-gcc-libs</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œå¯èƒ½ä¼šæ‰¾ä¸åˆ°lib32çš„åŒ…,æ˜¯å› ä¸ºæ²¡æœ‰å¼€å¯multilib<br>ç¼–è¾‘/etc/pacman.d/mirrorlisté‡ŒæŠŠmultilibçš„å‡ è¡Œè§£é™¤æ³¨é‡Š</p>\n<p>Oracleæ•°æ®åº“éœ€è¦32ä½çš„libaioå’Œunixodbcåœ¨x86_64ä¸Šï¼Œä½†åœ¨32ä½ä¸Šæ˜¯ä¸å¿…è¦çš„ã€‚ </p>\n<p>Oracle Universal Installeréœ€è¦çš„ä¸€äº›è½¯é“¾æ¥ã€‚ </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ln -s /usr/bin/rpm /bin/rpm</span><br><span class=\"line\">ln -s /usr/bin/ksh /bin/ksh</span><br><span class=\"line\">ln -s /bin/awk /usr/bin/awk</span><br><span class=\"line\">ln -s /bin/tr /usr/bin/tr</span><br><span class=\"line\">ln -s /usr/bin/basename /bin/basename</span><br></pre></td></tr></table></figure>\n\n<p>Arch x86_64: </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\tln -s /usr/lib /usr/lib64</span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">## 2.å®‰è£…KSH</span></span></span><br><span class=\"line\">ç”±äºè¿™ä¸ªéœ€è¦é€šè¿‡AURå®‰è£…æ‰€ä»¥ä½ éœ€è¦ä¸€ä¸ªyaourt,å‚é˜…[å®‰è£…yaourt](/2014/06/19/installarch/#yaourt)å®‰è£…yaourt</span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tyaourt ksh</span><br><span class=\"line\">```  </span><br><span class=\"line\">ç„¶åæ ¹æ®ç•Œé¢æç¤ºè¿›è¡Œæ— è„‘æ“ä½œå³å¯.  </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">## 3.é…ç½®</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">ä¸ºOrcaleæ•°æ®åº“åˆ›å»ºç”¨æˆ·å’Œç»„ï¼š </span><br><span class=\"line\">```shell  </span><br><span class=\"line\">\tgroupadd oinstall</span><br><span class=\"line\">\tgroupadd dba</span><br><span class=\"line\">\tuseradd -m -g oinstall -G dba oracle</span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\">ä¸ºç”¨æˆ·oracleè®¾ç½®å¯†ç ï¼š </span><br><span class=\"line\">```shell  </span><br><span class=\"line\">\tpasswd oracle</span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">å¯é€‰: Add oracle to the sshd_config file. </span><br><span class=\"line\">```shell  </span><br><span class=\"line\">\tpacman -S openssh</span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">æ·»åŠ å¦‚ä¸‹å†…å®¹åˆ° /etc/ssh/sshd_config: </span><br><span class=\"line\">```shell  </span><br><span class=\"line\">\tAllowUsers oracle</span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\">æ·»åŠ å¦‚ä¸‹å†…å®¹åˆ° /etc/sudoers.</span><br><span class=\"line\">```shell  </span><br><span class=\"line\">\toracle    ALL=(ALL) ALL</span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\">åœ¨99-sysctl.confæ·»åŠ å¦‚ä¸‹å†…å®¹ /etc/sysctl.d/99-sysctl.conf</span><br><span class=\"line\">```shell  </span><br><span class=\"line\"><span class=\"meta\">\t#</span><span class=\"bash\"> oracle kernel settings</span></span><br><span class=\"line\">\tfs.file-max = 6553600</span><br><span class=\"line\">\tkernel.shmall = 2097152</span><br><span class=\"line\">\tkernel.shmmax = 2147483648</span><br><span class=\"line\">\tkernel.shmmni = 4096</span><br><span class=\"line\">\tkernel.sem = 250 32000 100 128</span><br><span class=\"line\">\tnet.ipv4.ip_local_port_range = 1024 65535</span><br><span class=\"line\">\tnet.core.rmem_default = 4194304</span><br><span class=\"line\">\tnet.core.rmem_max = 4194304</span><br><span class=\"line\">\tnet.core.wmem_default = 262144</span><br><span class=\"line\">\tnet.core.wmem_max = 262144</span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">åœ¨limits.conf æ·»åŠ å¦‚ä¸‹å†…å®¹ /etc/security/limits.conf</span><br><span class=\"line\">```shell  </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> oracle settings</span></span><br><span class=\"line\">\toracle           soft    nproc   2047</span><br><span class=\"line\">\toracle           hard    nproc   16384</span><br><span class=\"line\">\toracle           soft    nofile  1024</span><br><span class=\"line\">\toracle           hard    nofile  65536</span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\">å¯é€‰: æƒ³ä½¿å˜åŒ–ç”Ÿæ•ˆæ‚¨å¯ä»¥é‡å¯ç”µè„‘ã€‚ </span><br><span class=\"line\"></span><br><span class=\"line\">ä¸ºOcaleæ•°æ®åº“åˆ›å»ºä¸€äº›ç›®å½•ã€‚æ‚¨å¯ä»¥é€‰æ‹©ç›®å½•è·¯å¾„ã€‚ä¸‹é¢æ˜¯å‚è€ƒä¾‹å­ã€‚ </span><br><span class=\"line\">```shell  </span><br><span class=\"line\">\tmkdir -p /oracle</span><br><span class=\"line\">\tmkdir -p /oracle/inventory</span><br><span class=\"line\">\tmkdir -p /oracle/recovery</span><br><span class=\"line\">\tmkdir -p /oracle/product/db</span><br><span class=\"line\">```  </span><br><span class=\"line\">&lt;font color=&quot;red&quot;&gt;æ³¨æ„:æ ¹æ®å®˜æ–¹å»ºè®®è¿™é‡Œçš„è·¯å¾„æœ€å¥½ä¸è¦æ”¹&lt;/font&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">ä¸ºç›®å½•è®¾å®šæƒé™ã€‚ </span><br><span class=\"line\">```shell  </span><br><span class=\"line\">\tchown -R oracle:dba /oracle</span><br><span class=\"line\">\tchmod 777 /tmp</span><br></pre></td></tr></table></figure>\n\n\n<p>æ›´æ”¹.bashrcæ–‡ä»¶ /home/oracle/.bashrc.</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export ORACLE_BASE=/oracle</span><br><span class=\"line\">export ORACLE_HOME=/oracle/product/db</span><br><span class=\"line\">export ORACLE_SID=xdb</span><br><span class=\"line\">export ORACLE_INVENTORY=/oracle/inventory</span><br><span class=\"line\">export ORACLE_BASE ORACLE_SID ORACLE_HOME</span><br><span class=\"line\">export PATH=$ORACLE_HOME/bin:$PATH</span><br><span class=\"line\">export LD_LIBRARY_PATH=$ORACLE_HOME/lib:$LD_LIBRARY_PATH</span><br><span class=\"line\">export EDITOR=VIM</span><br><span class=\"line\">export VISUAL=nano</span><br></pre></td></tr></table></figure>\n<h3><span id=\"4-an-zhuang\">4.å®‰è£…</span><a href=\"#4-an-zhuang\" class=\"header-anchor\">#</a></h3><p>åˆ‡æ¢åˆ°å®‰è£…ç›®å½•æ‰§è¡Œ./runInstaller å³å¯</p>\n<p>å®‰è£…è¿‡ç¨‹ä¸­å¯èƒ½(åŸºæœ¬æ˜¯å¿…ç„¶)å‡ºç°å¦‚ä¸‹é—®é¢˜</p>\n<p>a.å®‰è£…è¿‡ç¨‹è¿›è¡Œåˆ°80%å¤š(æ‰€æœ‰æ–‡ä»¶å¤åˆ¶å®Œæ¯•,å¹¶å¼€å§‹é“¾æ¥å), æŠ¥é”™<br>ins_precomp.mk<br>INFO: /usr/bin/ld: <oracle_home>/lib//libnls12.a(lxhlang.o): undefined reference to symbol â€˜__tls_get_addr@@GLIBC_2.3â€²<br>è¿™æ˜¯å› ä¸ºoracleå®‰è£…æ–‡ä»¶è‡ªå¸¦çš„ åº“æ–‡ä»¶å¤ªè€äº†</oracle_home></p>\n<p>éœ€è¦åˆ é™¤ {ORACLE_HOME}/lib/stubs è¿™ä¸ªç›®å½• (å¯¹äºæˆ‘çš„è®¾ç½®,å°±æ˜¯ /opt/oracle/product/12.1.0.1.0/lib/stubs</p>\n<pre class=\" language-shell\"><code class=\"language-shell\">    cd /opt/oracle/product/12.1.0.1.0/lib\n    rm -rf stubs</code></pre>\n<p>2.åœ¨å›¾å½¢å®‰è£…ç•Œé¢ ç‚¹å‡»Retryç»§ç»­, å†æ¬¡æŠ¥é”™</p>\n<p>ins_rdbms.mk<br>libclient12.a(kpue.o): undefined reference to symbol â€˜ons_subscriber_closeâ€™<br>â€¦.<br>libons.so: could not read symbols: Invalid operation<br>ä¿®æ”¹ rdbms/lib/ins_rdbms.mk çš„ 883è¡Œ å’Œ 901 è¡Œ</p>\n<pre class=\" language-shell\"><code class=\"language-shell\">$(PLSHPROF) : $(ALWAYS) $(PLSHPROF_DEPS)\n        $(SILENT)$(ECHO)\n        $(SILENT)$(ECHO) \" - Linking hierarchical profiler utility (plshprof)\"\n        $(RMF) $@\n        $(PLSHPROF_LINKLINE) -lons\n\n....\n    897 $(RMAN) : $(ALWAYS) $(RMAN_DEPS)\n    898         $(SILENT)$(ECHO)\n    899         $(SILENT)$(ECHO) \" - Linking recovery manager (rman)\"\n    900         $(RMF) $@\n    901         $(RMAN_LINKLINE) -lons</code></pre>\n<p>3.åœ¨å›¾å½¢èŠ‚ç›® Retry, ç¬¬3æ¬¡æŠ¥é”™</p>\n<p>ins_rdbms.mk<br>houzi.o: undefined reference to symbol â€˜ztcshâ€™<br>libnnz12.so: could not read symbols: Invalid operation<br>ä¿®æ”¹ ins_rdbms.mk çš„ 1067è¡Œ</p>\n<pre class=\" language-shell\"><code class=\"language-shell\">   1063 $(TG4PWD) : $(ALWAYS) $(TG4PWD_DEPS)\n   1064         $(SILENT)$(ECHO)\n   1065         $(SILENT)$(ECHO) \" - Linking $(TG4DG4)pwd utility\"\n   1066         $(RMF) $@\n   1067         $(TG4PWD_LINKLINE) -lnnz12</code></pre>\n<p> 4.å®‰è£…å®Œæˆåå¯èƒ½ä¼šé‡åˆ°æ— æ³•åˆ›å»ºæ•°æ®åº“ã€æ— æ³•å¯åŠ¨ç­‰è¯¸å¤šå¥‡è‘©é—®é¢˜ï¼Œä¸€èˆ¬é‡å¯å¯è§£å†³ã€‚ã€‚ã€‚   </p>\n<p> __å‚è€ƒèµ„æ–™<br> *<a href=\"http://bbs.csdn.net/topics/390743335\">oracle12c archlinux å®‰è£…å‡ºé”™</a></p>\n<p> *Arch wiki - oracle å®‰è£…<br> <a href=\"https://wiki.archlinux.org/index.php/Oracle_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)\">https://wiki.archlinux.org/index.php/Oracle_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)</a></p>\n<p> *<a href=\"http://tieba.baidu.com/p/2494225213\">lib32åŒ…æ‰¾ä¸åˆ°çš„é—®é¢˜</a></p>\n","categories":[],"tags":["Arch"]},{"title":"æ‹¥æŠ±Arch Linux-å®‰è£…é…ç½®å°è®°","url":"https://pkaq.org/2014/06/19/2014-06-19-installarch/","content":"<h2><span id=\"mu-lu\">ç›®å½•</span><a href=\"#mu-lu\" class=\"header-anchor\">#</a></h2><ol>\n<li><p>   <a href=\"#startvirtualbox\">å¯åŠ¨è™šæ‹Ÿæœº</a>   </p>\n</li>\n<li><p>   <a href=\"#disk\">ç£ç›˜è§„åˆ’</a>   </p>\n</li>\n<li><p>   <a href=\"#filesystem\">åˆ›å»ºç£ç›˜æ–‡ä»¶ç³»ç»Ÿ</a>  </p>\n</li>\n<li><p>   <a href=\"#mount\">æŒ‚è½½ç£ç›˜</a>  </p>\n</li>\n<li><p>   <a href=\"#mirrorlist\">é€‰æ‹©é•œåƒ-è®¾ç½®æ›´æ–°æº</a>  </p>\n</li>\n<li><p>   <a href=\"#install\">å®‰è£…åŸºæœ¬ç³»ç»Ÿ</a>  </p>\n</li>\n<li><p><a href=\"#basicsetup\">åŸºæœ¬ç³»ç»Ÿè®¾ç½®</a><br> a.    <a href=\"#language\">è®¾ç½®è¯­è¨€</a><br> b.    <a href=\"#hostname\">è®¾ç½®ä¸»æœºå</a><br> c.    <a href=\"#timezone\">è®¾ç½®æ—¶åŒº</a><br> d.    <a href=\"#ramdisk\">åˆ›å»ºramdisk</a><br> e.    <a href=\"#checksyslinux\">æ£€æŸ¥syslinuxçš„é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®</a><br> f.    <a href=\"#syslinux\">å®‰è£…syslinuxå¯åŠ¨ç®¡ç†å™¨,ä»¥ä¾¿å®ç°ArchLinuxçš„é¡ºåˆ©å¯åŠ¨</a><br> g.    <a href=\"#root\">ä¸ºrootè¶…çº§ç”¨æˆ·æ·»åŠ å¯†ç </a><br> h.    <a href=\"#exit\">é€€å‡ºå½“å‰ç³»ç»Ÿç¯å¢ƒ</a><br> i.    <a href=\"#adduser\">æ·»åŠ ç”¨æˆ·</a><br> j.    <a href=\"#network\">é…ç½®ç½‘ç»œ</a><br> k.    <a href=\"#installx\">å®‰è£…Xæ¡Œé¢ç¯å¢ƒ</a><br> l.    <a href=\"#xfce4\">å®‰è£…XFCE4 æ¡Œé¢å¥—ä»¶</a><br> m.    <a href=\"#xfce4auto\">è®¾ç½®xfce4è‡ªå¯åŠ¨</a>ã€€ã€€<br> n.    <a href=\"#inputmethod\">å®‰è£…æµè§ˆå™¨å’Œè¾“å…¥æ³•</a><br> o.    <a href=\"#yaourt\">å®‰è£…yaourt</a>       </p>\n</li>\n<li><p>   <a href=\"#vbaddition\">ä¸ºVBOXå®‰è£…å¢å¼ºåŠŸèƒ½</a>   </p>\n</li>\n<li><p><a href=\"#adv\">é™„å½•</a><br> a.<a href=\"#slimthemes\">ä¸ºslimå®‰è£…ä¸»é¢˜</a><br> b.<a href=\"#feh\">çœ‹å›¾è½¯ä»¶</a><br> c.<a href=\"#zsh\">zsh</a><br> d.<a href=\"#ksh\">ksh</a><br> e.<a href=\"#office\">office</a><br> f.<a href=\"#sublime\">æ–‡æœ¬ç¼–è¾‘å·¥å…·sublime</a><br> j.<a href=\"#wicd\">ç½‘ç»œç®¡ç†å·¥å…·wicd</a><br>  h.<a href=\"#netctl\">ä½¿ç”¨netctl</a></p>\n</li>\n</ol>\n<a id=\"more\"></a>\n<h2><span id=\"yi-qi-dong-xu-ni-ji\"></span><a href=\"#yi-qi-dong-xu-ni-ji\" class=\"header-anchor\">#</a></h2><p>å¯åŠ¨è™šæ‹Ÿæœº,é€‰æ‹©å¯¹åº”çš„é€‰é¡¹,å¯ä»¥åœ¨è™šæ‹Ÿæœºé‡Œé¢å®‰è£…64ä½ç³»ç»Ÿåˆæœ‰è¿™ä¸ªæ¬²æœ›çš„ï¼Œé€‰ç¬¬äºŒä¸ªè¿›å»ã€‚<br><img src=\"/images/2014/archinstall/1.png\" alt=\"å¯åŠ¨\"></p>\n<h2><span id=\"er-ci-pan-gui-hua\"></span><a href=\"#er-ci-pan-gui-hua\" class=\"header-anchor\">#</a></h2><p>ä»å…‰é©±å¯åŠ¨å®Œæ¯•åé¦–å…ˆè¿›è¡Œç£ç›˜è§„åˆ’<br>é”®å…¥  </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\tcfdisk</span><br><span class=\"line\">```  </span><br><span class=\"line\">![åˆ†åŒº](/images/2014/archinstall/2.png)  </span><br><span class=\"line\"></span><br><span class=\"line\">å¼¹å‡ºçš„ç•Œé¢é€‰ New  </span><br><span class=\"line\">![æ–°å»ºåˆ†åŒº](/images/2014/archinstall/3.png)  </span><br><span class=\"line\"></span><br><span class=\"line\">æ–°æ‰‹å¯ä»¥ä¸ç”¨åˆ†åŒºï¼Œå¦‚æœéœ€è¦åˆ†å¤šä¸ªåŒºï¼Œå»ºè®®ä¸€ä¸ª / ä¸€ä¸ª/homeï¼Œå¦‚æœå†…å­˜å¤§ï¼Œä¸éœ€è¦swapåˆ†åŒºã€‚ä½¿ç”¨cfdiskåˆ†åŒºæ¯”è¾ƒç›´è§‚ã€‚</span><br><span class=\"line\">Â·æ³¨æ„ã€Bootableã€‘ï¼Œ/ åˆ†åŒºä¸€å®šè¦Bootable</span><br><span class=\"line\"></span><br><span class=\"line\">å› ä¸ºè¿™é‡Œç£ç›˜è§„åˆ’åªæœ‰ä¸‰ä¸ªåˆ†åŒº,æ‰€ä»¥æ¥ä¸‹æ¥ç»Ÿä¸€ç”¨ä¸»åˆ†åŒºçš„å½¢å¼,é€‰Primary,å¦‚æœç£ç›˜è§„åˆ’è¶…è¿‡4ä¸ªåˆ†åŒºçš„,è§„åˆ’å®Œ3ä¸ªä¸»åˆ†åŒºä¹‹åè‡ªè¡Œè°ƒæ•´å‰©ä¸‹çš„ç©ºé—´ä¸ºæ‰©å±•åˆ†åŒº,ç„¶ååœ¨æ‰©å±•åˆ†åŒºé‡Œé¢å†è¿›è¡Œå‰©ä½™ç£ç›˜è§„åˆ’æ“ä½œ</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">![ä¸»åˆ†åŒº](/images/2014/archinstall/4.png)   </span><br><span class=\"line\"></span><br><span class=\"line\">boot è§„åˆ’100Må°±å¾ˆå¤Ÿäº†</span><br><span class=\"line\"></span><br><span class=\"line\">![ä¸»åˆ†åŒº](/images/2014/archinstall/5.png)   </span><br><span class=\"line\"></span><br><span class=\"line\">é€‰Beginning  </span><br><span class=\"line\"></span><br><span class=\"line\">![ä¸»åˆ†åŒº](/images/2014/archinstall/6.png)   </span><br><span class=\"line\"></span><br><span class=\"line\">æŒ‰ä¸€ä¸‹Bootable,æ¿€æ´»å½“å‰bootæ‰€åœ¨åˆ†åŒº/dev/sda1,ä¹‹åå¯ä»¥çœ‹åˆ°sda1çš„flagsæ ‡è®°ä¸‹é¢æœ‰ä¸ªboot  </span><br><span class=\"line\"></span><br><span class=\"line\">![ä¸»åˆ†åŒº](/images/2014/archinstall/7.png)  </span><br><span class=\"line\"></span><br><span class=\"line\">![ä¸»åˆ†åŒº](/images/2014/archinstall/8.png)  </span><br><span class=\"line\"></span><br><span class=\"line\">å…‰æ ‡ç§»åŠ¨åˆ°free space ,é€‰ New è§„åˆ’swap äº¤æ¢åˆ†åŒº  </span><br><span class=\"line\"></span><br><span class=\"line\">![äº¤æ¢åˆ†åŒº](/images/2014/archinstall/9.png)  </span><br><span class=\"line\"></span><br><span class=\"line\">ç±»å‹ä¸»åˆ†åŒº,åŸå› ä¸Šé¢å·²ç»è¯´è¿‡,ä¸å–œæ¬¢çš„å¯ä»¥é€‰é€»è¾‘åˆ†åŒº,å¤§å°ç»™1Gå·®ä¸å¤š,å¤šäº†ä¹Ÿæ²¡ä»€ä¹ˆå¤ªå¤§çš„ç”¨å¤„  </span><br><span class=\"line\">\t</span><br><span class=\"line\">![ä¸»åˆ†åŒº](/images/2014/archinstall/10.png)  </span><br><span class=\"line\">![ä¸»åˆ†åŒº](/images/2014/archinstall/11.png)  </span><br><span class=\"line\"></span><br><span class=\"line\">é€‰Beginning  </span><br><span class=\"line\"></span><br><span class=\"line\">![Beginning](/images/2014/archinstall/12.png)   </span><br><span class=\"line\"></span><br><span class=\"line\">ç§»åŠ¨åˆ°Typeé€‰é¡¹å›è½¦  </span><br><span class=\"line\"></span><br><span class=\"line\">![Type](/images/2014/archinstall/13.png)    </span><br><span class=\"line\"></span><br><span class=\"line\">ç£ç›˜ç±»å‹é€‰æ‹©82  </span><br><span class=\"line\">![ç£ç›˜ç±»å‹](/images/2014/archinstall/14.png)    </span><br><span class=\"line\">![ç£ç›˜ç±»å‹](/images/2014/archinstall/15.png)  </span><br><span class=\"line\">![ç£ç›˜ç±»å‹](/images/2014/archinstall/16.png)   </span><br><span class=\"line\"></span><br><span class=\"line\">å…‰æ ‡ç§»åŠ¨åˆ°free space æŠŠå‰©ä¸‹çš„ç©ºé—´å…¨éƒ¨ç»™æ ¹èŠ‚ç‚¹  </span><br><span class=\"line\">   </span><br><span class=\"line\">![æ ¹åˆ†åŒº](/images/2014/archinstall/17.png)     </span><br><span class=\"line\">![æ ¹åˆ†åŒº](/images/2014/archinstall/18.png)   </span><br><span class=\"line\">![æ ¹åˆ†åŒº](/images/2014/archinstall/19.png)   </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">ç§»åŠ¨åˆ°writeé€‰é¡¹å›è½¦  </span><br><span class=\"line\"></span><br><span class=\"line\">![Write](/images/2014/archinstall/20.png)  </span><br><span class=\"line\"></span><br><span class=\"line\">è¾“å…¥yesä¿å­˜åˆšæ‰æ‰€åšçš„åˆ†åŒºæ›´æ”¹  </span><br><span class=\"line\">![Write yes](/images/2014/archinstall/21.png)  </span><br><span class=\"line\"></span><br><span class=\"line\">ç§»åŠ¨åˆ°quité€‰é¡¹å®Œæˆç£ç›˜åˆ†åŒºè§„åˆ’æ“ä½œ  </span><br><span class=\"line\">![Quit](/images/2014/archinstall/22.png)  </span><br><span class=\"line\">![Quit](/images/2014/archinstall/23.png)    </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\"># &lt;a name=&quot;filesystem&quot;&gt;ä¸‰ã€åˆ›å»ºç£ç›˜æ–‡ä»¶ç³»ç»Ÿ&lt;/a&gt;</span></span></span><br><span class=\"line\">boot æ‰€åœ¨çš„ç£ç›˜åˆ†åŒºsda1 ç”¨ext4æ–‡ä»¶ç³»ç»Ÿ,å½“ç„¶ç”¨å…¶ä»–æ–‡ä»¶ç³»ç»Ÿä¹Ÿå¯ä»¥</span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tmkfs.ext4 /dev/sda1  </span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\">![åˆ›å»ºåˆ†åŒº](/images/2014/archinstall/24.png)  </span><br><span class=\"line\">![åˆ›å»ºåˆ†åŒº](/images/2014/archinstall/25.png)    </span><br><span class=\"line\"></span><br><span class=\"line\">æ ¹èŠ‚ç‚¹æ‰€åœ¨åˆ†åŒºsda3 ç”¨ä¸»æµçš„ext4æ–‡ä»¶ç³»ç»Ÿå³å¯ </span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tmkfs.ext4 /dev/sda3</span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\">![åˆ›å»ºåˆ†åŒº](/images/2014/archinstall/26.png)  </span><br><span class=\"line\">![åˆ›å»ºåˆ†åŒº](/images/2014/archinstall/27.png)    </span><br><span class=\"line\"></span><br><span class=\"line\">äº¤æ¢åˆ†åŒº </span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tmkswap /dev/sda2</span><br><span class=\"line\">```   </span><br><span class=\"line\">![åˆ›å»ºåˆ†åŒº](/images/2014/archinstall/28.png)    </span><br><span class=\"line\"></span><br><span class=\"line\">æ¿€æ´»äº¤æ¢åˆ†åŒº</span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tswapon /dev/sda2</span><br><span class=\"line\">```   </span><br><span class=\"line\">![æ¿€æ´»](/images/2014/archinstall/29.png)    </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\"># &lt;a name=&quot;mount&quot;&gt;å››ã€æŒ‚è½½ç£ç›˜&lt;/a&gt;</span></span>  </span><br><span class=\"line\">æŒ‚è½½ç£ç›˜åˆ°AIS Bashå®‰è£…è„šæœ¬æ”¯æŒçš„ mnt ç›®å½•:</span><br><span class=\"line\"></span><br><span class=\"line\">å…ˆæŒ‚è½½æ ¹èŠ‚ç‚¹</span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tmount /dev/sda3 /mnt</span><br><span class=\"line\">```  </span><br><span class=\"line\">![æŒ‚è½½](/images/2014/archinstall/30.png)    </span><br><span class=\"line\"></span><br><span class=\"line\">mnt ç›®å½•ä¸‹é¢åˆ›å»ºbootç›®å½•ç”¨æ¥æŒ‚è½½ bootæ‰€åœ¨çš„åˆ†åŒº   </span><br><span class=\"line\">![æŒ‚è½½](/images/2014/archinstall/31.png)    </span><br><span class=\"line\"></span><br><span class=\"line\">æŒ‚è½½bootæ‰€åœ¨åˆ†åŒºåˆ° mntä¸‹é¢çš„bootç›®å½•</span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tmount /dev/sda1 /mnt/boot</span><br><span class=\"line\">```  </span><br><span class=\"line\">![æŒ‚è½½](/images/2014/archinstall/32.png)    </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\"># &lt;a name=&quot;mirrorlist&quot;&gt;äº”ã€é€‰æ‹©é•œåƒ-è®¾ç½®æ›´æ–°æº&lt;/a&gt;</span></span>  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tnano /etc/pacman.d/mirrorlist</span><br><span class=\"line\">```   </span><br><span class=\"line\">p.s:æ‰¾å¸¦Chinaçš„ï¼ŒPageDown PageUp æ»šå±ï¼ŒCtrl+V å‘ä¸‹ç¿»é¡µï¼ŒCtrl+Y å‘ä¸Šç¿»é¡µï¼Œ Alt+6 å¤åˆ¶å½“å‰è¡Œï¼ŒCtrl+u ç²˜è´´ï¼ŒCtrl+x é€€å‡ºï¼Œä¿å­˜æŒ‰Yï¼Œå›è½¦ã€‚</span><br><span class=\"line\">163ç«™ç‚¹åœ¨æœ€ä¸‹é¢ä¸è¿œå¤„ï¼Œæˆ‘å¤åˆ¶äº†2ä¸ªï¼Œæ”¾åœ¨æœ€ä¸Šé¢ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚   </span><br><span class=\"line\">æ¨èä½¿ç”¨   [ä¸­å›½ç§‘æŠ€å¤§å­¦çš„æº ](http://mirrors.ustc.edu.cn/archlinux/,&quot;ä¸­å›½ç§‘æŠ€å¤§å­¦çš„æº&quot;)  ,å…¶ä½™çš„å‡å¯ä»¥åˆ é™¤ã€‚  </span><br><span class=\"line\"></span><br><span class=\"line\">![è®¾ç½®æº](/images/2014/archinstall/33.jpg)    </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\"># &lt;a name=&quot;install&quot;&gt;å…­ã€å®‰è£…åŸºæœ¬ç³»ç»Ÿ&lt;/a&gt;</span></span>  </span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tpacstrap /mnt base base-devel syslinux vim</span><br><span class=\"line\">```   </span><br><span class=\"line\">p.s:è¿™é‡Œéœ€è¦è¯´æ˜ä¸€ä¸‹,ä¸€èˆ¬æ¥è¯´baseå°±å¤Ÿäº†,ä¸è¿‡åæœŸå®‰è£…è½¯ä»¶åŸºæœ¬ä¸Šä¼šç”¨åˆ°base-devel,æ‰€ä»¥æŠŠè¿™ä¸ªç³»ç»Ÿè½¯ä»¶åŒ…ç»„ä¹Ÿé€‰ä¸Š;syslinuxæ˜¯å¼•å¯¼ç¨‹åºåŒ…(å¯ä»¥æ ¹æ®ä¹ æƒ¯è°ƒæ•´ä¸ºgrub2),åŒç³»ç»Ÿæƒ…å†µä¸‹,å¦‚æœç‰©ç†æœºå™¨ä¸Šä¸æƒ³ç”¨syslinuxè¦†ç›–ç£ç›˜mbræ¥å¼•å¯¼çš„,å¯ä»¥é€šè¿‡grub4dosä¹‹ç±»çš„å¼•å¯¼linux,å…·ä½“googleä¸€å¤§æŠŠ;vimæ˜¯ç¼–è¾‘è½¯ä»¶,ä»…ä»…æ˜¯ä¸ºäº†æ–¹ä¾¿å®‰è£…å®ŒåŸºæœ¬ç³»ç»Ÿåç¼–è¾‘é…ç½®æ–‡ä»¶,å¦‚æœä¸å–œæ¬¢çš„å¯ä»¥ç”¨nano æˆ–è€…å®‰è£…å…¶ä»–ç¼–è¾‘å·¥å…·</span><br><span class=\"line\"></span><br><span class=\"line\">![å®‰è£…åŸºæœ¬ç³»ç»Ÿ](/images/2014/archinstall/34.png)    </span><br><span class=\"line\"></span><br><span class=\"line\">å›è½¦åä¼šè‡ªåŠ¨æŸ¥æ‰¾æº,ä¸‹è½½è½¯ä»¶åŒ…,å®‰è£…  </span><br><span class=\"line\">![å®‰è£…åŸºæœ¬ç³»ç»Ÿ](/images/2014/archinstall/35.png)    </span><br><span class=\"line\"></span><br><span class=\"line\">é”®å…¥   </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tpacstrap -i /mnt net-tools</span><br><span class=\"line\">```    </span><br><span class=\"line\">p.s:ä¹Ÿè®¸å¤§å¤šæ•°äººå¯¹ifconfigè¿™ç§ç½‘ç»œé…ç½®å‘½ä»¤æ¯”è¾ƒä¹ æƒ¯,é‚£ä¹ˆè¯·å®‰è£…net-toolsè½¯ä»¶åŒ…,è€Œä¸”å®‰è£…å¯ä»¥æ·»åŠ  i å‚æ•°å®ç°ä¸€å®šç¨‹åº¦ä¸Šçš„äº¤äº’å¼å®‰è£…,è¿™æ ·å°±ä¸ä¼šåƒä¸Šé¢ä¸€æ ·è‡ªåŠ¨ä¸‹è½½å®‰è£…,è¿™é‡Œå¯ä»¥ä¸æ‰§è¡Œ,ä¸å½±å“ç³»ç»Ÿæ­å»º  </span><br><span class=\"line\">![å®‰è£…åŸºæœ¬ç³»ç»Ÿ](/images/2014/archinstall/36.png)   </span><br><span class=\"line\">![å®‰è£…åŸºæœ¬ç³»ç»Ÿ](/images/2014/archinstall/37.png)   </span><br><span class=\"line\"></span><br><span class=\"line\">ç”¨AISè„šæœ¬è‡ªåŠ¨ç”Ÿæˆfstab,ä¹Ÿå°±æ˜¯å½“å‰ç£ç›˜æŒ‚è½½æƒ…å†µçš„æ–‡ä»¶</span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tgenfstab -p /mnt &gt;&gt; /mnt/etc/fstab</span><br><span class=\"line\">```  </span><br><span class=\"line\">\\&gt;&gt; æ˜¯Unix Likeä¸‹é¢å¸¸è§çš„é‡å®šå‘ç¬¦å·  </span><br><span class=\"line\">![å®‰è£…åŸºæœ¬ç³»ç»Ÿ](/images/2014/archinstall/38.png)   </span><br><span class=\"line\"></span><br><span class=\"line\">chrootåˆ°åˆšæ‰å®‰è£…å®Œæ¯•çš„åŸºæœ¬ç³»ç»Ÿ,è¿›è¡Œæœ€åŸºç¡€çš„ç³»ç»Ÿé…ç½®</span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tarchroot /mnt</span><br><span class=\"line\">```  </span><br><span class=\"line\">![å®‰è£…åŸºæœ¬ç³»ç»Ÿ](/images/2014/archinstall/39.png)   </span><br><span class=\"line\"></span><br><span class=\"line\">è¿›å…¥åˆ°æ–°ç¯å¢ƒä»¥åçš„æƒ…å†µ,å¯ä»¥çœ‹åˆ°ç»ˆç«¯å‰é¢çš„æç¤ºç¬¦å·²ç»å‘ç”Ÿäº†å˜åŒ–  </span><br><span class=\"line\">![å®‰è£…åŸºæœ¬ç³»ç»Ÿ](/images/2014/archinstall/40.png)   </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\"># &lt;a name=&quot;basicsetup&quot;&gt;ä¸ƒã€åŸºæœ¬ç³»ç»Ÿé…ç½®&lt;/a&gt;</span></span>  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">## &lt;a name=&quot;language&quot;&gt;A.è®¾ç½®è¯­è¨€&lt;/a&gt;</span></span>  </span><br><span class=\"line\">è®¾ç½®ç³»ç»Ÿæ”¯æŒçš„locale,åªéœ€è¦æ‰¾åˆ°en_US ä»¥åŠzh_CNå¼€å¤´çš„,ç„¶åæŠŠæ³¨é‡Šç¬¦å·#å»æ‰å³å¯</span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tvim /etc/locale.gen</span><br><span class=\"line\">```  </span><br><span class=\"line\">![è¯­è¨€è®¾ç½®](/images/2014/archinstall/41.png)   </span><br><span class=\"line\">![è¯­è¨€è®¾ç½®](/images/2014/archinstall/42.png)   </span><br><span class=\"line\">![è¯­è¨€è®¾ç½®](/images/2014/archinstall/43.png)    </span><br><span class=\"line\">ä¿å­˜é€€å‡º  </span><br><span class=\"line\">![è¯­è¨€è®¾ç½®](/images/2014/archinstall/44.png)   </span><br><span class=\"line\"></span><br><span class=\"line\">æ‰§è¡Œ</span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tlocale-gen</span><br><span class=\"line\">```  </span><br><span class=\"line\">![è¯­è¨€è®¾ç½®](/images/2014/archinstall/45.png)   </span><br><span class=\"line\"></span><br><span class=\"line\">è®¾ç½®ç³»ç»Ÿé»˜è®¤çš„locale,è¿™é‡Œå†³å®šäº†è¿›å…¥æ¡Œé¢åæ˜¯è‹±æ–‡ç•Œé¢è¿˜æ˜¯ä¸­æ–‡ç•Œé¢,æˆ‘ä¹ æƒ¯äº†è‹±æ–‡ç•Œé¢,æ‰€ä»¥è®¾ç½®å¦‚ä¸‹å›¾2æ‰€ç¤º,å–œæ¬¢ä¸­æ–‡ç•Œé¢çš„å¯ä»¥ç®€å•è®¾ç½®ä¸ºLANG=zh_CN.UTF-8</span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tvim /etc/locale.conf  </span><br><span class=\"line\">```  </span><br><span class=\"line\">æ·»åŠ é€‚åˆè‡ªå·±çš„locale</span><br><span class=\"line\">![è¯­è¨€è®¾ç½®](/images/2014/archinstall/46.png)  </span><br><span class=\"line\">![è¯­è¨€è®¾ç½®](/images/2014/archinstall/47.png)     </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">## &lt;a name=&quot;hostname&quot;&gt;B.è®¾ç½®ä¸»æœºå&lt;/a&gt;</span></span>  </span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tvim /etc/hostname  </span><br><span class=\"line\">```  </span><br><span class=\"line\">é‡Œé¢æ·»åŠ è‡ªå·±å–œæ¬¢çš„åç§°,è¿™é‡Œæ¼”ç¤ºè¾“å…¥zhongguoyidou,è¯·æ ¹æ®è‡ªå·±çš„å–œå¥½æ›´æ”¹ </span><br><span class=\"line\">![è®¾ç½®ä¸»æœºå](/images/2014/archinstall/48.png)  </span><br><span class=\"line\">![è®¾ç½®ä¸»æœºå](/images/2014/archinstall/49.png)  </span><br><span class=\"line\"></span><br><span class=\"line\">ä¿®æ”¹ hostsæ–‡ä»¶,æ·»åŠ åˆšæ‰è®¾ç½®çš„ä¸»æœºå</span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tvim /etc/hosts</span><br><span class=\"line\">```  </span><br><span class=\"line\">![è®¾ç½®ä¸»æœºå](/images/2014/archinstall/50.png)  </span><br><span class=\"line\">![è®¾ç½®ä¸»æœºå](/images/2014/archinstall/51.png)  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">## &lt;a name=&quot;timezone&quot;&gt;C.è®¾ç½®æ—¶åŒº&lt;/a&gt;</span></span></span><br><span class=\"line\">è®¾ç½®æ—¶åŒºä¸ºäºšæ´²/ä¸Šæµ·,åˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥å³å¯</span><br><span class=\"line\">é”®å…¥ </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tln -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime  </span><br><span class=\"line\">```   </span><br><span class=\"line\"></span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tvim /etc/timezone</span><br><span class=\"line\">```  </span><br><span class=\"line\">æ·»åŠ Asia/Shanghai è¿™ä¸€è¡Œåä¿å­˜é€€å‡º</span><br><span class=\"line\"></span><br><span class=\"line\">å¤šç³»ç»Ÿçš„å¯ä»¥è®¾ç½®ä¸ºæœ¬åœ°æ—¶é—´,é¿å…å‡ºç°ç³»ç»Ÿåˆ‡æ¢æ—¶é—´8å°æ—¶ä¹‹å·®çš„æƒ…å†µ</span><br><span class=\"line\">é”®å…¥   </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\thwclock --systohc --localtime</span><br><span class=\"line\">```  </span><br><span class=\"line\">![è®¾ç½®æ—¶åŒº](/images/2014/archinstall/52.png)  </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">## &lt;a name=&quot;ramdisk&quot;&gt;D.åˆ›å»ºramdisk&lt;/a&gt;</span></span></span><br><span class=\"line\">é”®å…¥   </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tmkinitcpio -p linux </span><br><span class=\"line\">```  </span><br><span class=\"line\">å¦‚æœä¸æ»¡æ„é»˜è®¤é…åˆ¶çš„è‡ªè¡Œæ ¹æ®éœ€è¦ä¿®æ”¹ /etc/mkinitcpio.conf å†æ‰§è¡Œæ­¤å‘½ä»¤åˆ›å»º,ä¸€èˆ¬æ¥è¯´é»˜è®¤å³å¯  </span><br><span class=\"line\">![åˆ›å»ºramdisk](/images/2014/archinstall/53.png)  </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">##&lt;a name=&quot;checksyslinux&quot;&gt;E.æ£€æŸ¥syslinuxçš„é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®&lt;/a&gt;</span></span>  </span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tvim /boot/syslinux/syslinux.cfg  </span><br><span class=\"line\">```  </span><br><span class=\"line\">å¦‚æœåˆ†åŒºè§„åˆ’è·Ÿæˆ‘ä¸€æ ·çš„å¯ä»¥ä¸æ£€æŸ¥ä¹Ÿè¡Œ,é»˜è®¤çš„å°±å¯ä»¥.å…¶ä»–è‡ªè¡Œæ£€æŸ¥append root=/dev/sdax è¿™è¡Œçš„sdax ----- è®¾ç½®ä¸ºæ­£ç¡®çš„æ ¹èŠ‚ç‚¹æ‰€åœ¨åˆ†åŒºå³å¯  </span><br><span class=\"line\"></span><br><span class=\"line\">![æ£€æŸ¥syslinuxçš„é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®](/images/2014/archinstall/54.png)  </span><br><span class=\"line\">![æ£€æŸ¥syslinuxçš„é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®](/images/2014/archinstall/55.png)  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">## &lt;a name=&quot;syslinux&quot;&gt;F.å®‰è£…syslinuxå¯åŠ¨ç®¡ç†å™¨,ä»¥ä¾¿å®ç°ArchLinuxçš„é¡ºåˆ©å¯åŠ¨&lt;/a&gt;</span></span></span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tsyslinux-install_update -iam</span><br><span class=\"line\">```  </span><br><span class=\"line\">![æ£€æŸ¥syslinuxçš„é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®](/images/2014/archinstall/56.png)  </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">##&lt;a name=&quot;root&quot;&gt;G.ä¸ºrootè¶…çº§ç”¨æˆ·æ·»åŠ å¯†ç &lt;/a&gt;</span></span></span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tpasswd  </span><br></pre></td></tr></table></figure>\n<p>è¾“å…¥å¯†ç éœ€è¦ä¸¤éä»¥ç¡®è®¤æ˜¯å¦ä¸€è‡´,ä¸”å¯†ç ä¸ä¼šæ˜¾ç¤ºåœ¨å±å¹•ä¸Š<br><img src=\"/images/2014/archinstall/57.png\" alt=\"ä¸ºrootè¶…çº§ç”¨æˆ·æ·»åŠ å¯†ç \">  </p>\n<h3><span id=\"h-tui-chu-dang-qian-xi-tong-huan-jing\"></span><a href=\"#h-tui-chu-dang-qian-xi-tong-huan-jing\" class=\"header-anchor\">#</a></h3><p>é”®å…¥  </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">exit</span><br></pre></td></tr></table></figure>\n<p><img src=\"/images/2014/archinstall/58.png\" alt=\"é€€å‡ºå½“å‰ç³»ç»Ÿç¯å¢ƒ\">  </p>\n<p>è¿”å›åˆ°å®‰è£…é•œåƒå¯åŠ¨æ‰€åœ¨çš„ç³»ç»Ÿç¯å¢ƒ<br>é”®å…¥  </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\tumount /mnt/boot</span><br><span class=\"line\">\tumount /mnt/</span><br><span class=\"line\">\treboot</span><br><span class=\"line\">```  </span><br><span class=\"line\">å…³æœºå¹¶ä¸”ä»ç£ç›˜å¼•å¯¼ç³»ç»Ÿ  </span><br><span class=\"line\">![å…³æœºå¹¶ä¸”ä»ç£ç›˜å¼•å¯¼ç³»ç»Ÿ](/images/2014/archinstall/59.png)  </span><br><span class=\"line\"></span><br><span class=\"line\">é‡èµ·åçš„ç³»ç»Ÿåˆå§‹é€‰æ‹©ç•Œé¢   </span><br><span class=\"line\">![é‡èµ·åçš„ç³»ç»Ÿåˆå§‹é€‰æ‹©ç•Œé¢](/images/2014/archinstall/60.png)  </span><br><span class=\"line\"></span><br><span class=\"line\">å¯åŠ¨ç³»ç»Ÿåè¦æ±‚è¾“å…¥ç”¨æˆ·åä»¥åŠå¯†ç </span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\troot</span><br><span class=\"line\">```  </span><br><span class=\"line\">è¾“å…¥å¯†ç   </span><br><span class=\"line\">![ç™»å½•ç³»ç»Ÿ](/images/2014/archinstall/61.png)  </span><br><span class=\"line\"></span><br><span class=\"line\">é¡ºåˆ©è¿›å…¥ç³»ç»Ÿ  </span><br><span class=\"line\">![ç™»å½•ç³»ç»Ÿ](/images/2014/archinstall/62.png)    </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">## &lt;a name=&quot;adduser&quot;&gt;I.æ·»åŠ ç”¨æˆ·&lt;/a&gt;</span></span>  </span><br><span class=\"line\">æ·»åŠ ä¸€ä¸ªæ™®é€šç”¨æˆ·,æ¯”å¦‚è¿™é‡Œçš„kafan_zhongguoyidou,å…·ä½“çš„å…¶ä»–å‚æ•°è‡ªå·±google</span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tuseradd -m -s /bin/bash kafan_zhongguoyidou</span><br><span class=\"line\">```  </span><br><span class=\"line\">![æ·»åŠ ä¸€ä¸ªæ™®é€šç”¨æˆ·](/images/2014/archinstall/63.jpg) </span><br><span class=\"line\">æ·»åŠ å®Œæ¯•ä¸ºæ™®é€šç”¨æˆ·è®¾å®šä¸€ä¸ªå¯†ç </span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tpasswd kafan_zhongguoyidou</span><br><span class=\"line\">```  </span><br><span class=\"line\">ä¸ºåˆšæ‰æ·»åŠ çš„æ™®é€šç”¨æˆ·æ·»åŠ sudoçš„ç›¸å…³æƒé™,è¿™é‡Œåªåšä¸€ç‚¹ç®€è¦è®¾ç½®,å…¶ä»–è‡ªå·±å‚é˜…</span><br><span class=\"line\">é”®å…¥ visudo</span><br><span class=\"line\">æ‰¾åˆ°å›¾ç¤ºä¸­rooté‚£è¡Œ,æ·»åŠ å›¾ç¤ºä¸€è¡Œ  </span><br><span class=\"line\">![æ·»åŠ ä¸€ä¸ªæ™®é€šç”¨æˆ·](/images/2014/archinstall/64.png)  </span><br><span class=\"line\">![æ·»åŠ ä¸€ä¸ªæ™®é€šç”¨æˆ·](/images/2014/archinstall/65.png) </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">## &lt;a name=&quot;network&quot;&gt;J.é…ç½®ç½‘ç»œ&lt;/a&gt;</span></span>  </span><br><span class=\"line\">```shell</span><br><span class=\"line\"><span class=\"meta\">\t#</span><span class=\"bash\"><span class=\"comment\">#æŸ¥çœ‹å¯ç”¨ç½‘å¡</span></span></span><br><span class=\"line\">\tifconfig -a</span><br><span class=\"line\"><span class=\"meta\">\t#</span><span class=\"bash\"><span class=\"comment\">#å¯åŠ¨ç½‘å¡</span></span></span><br><span class=\"line\">\tifconfig eth0 up</span><br><span class=\"line\"><span class=\"meta\">\t#</span><span class=\"bash\"><span class=\"comment\">#è·å–ip</span></span></span><br><span class=\"line\">\tdhcpcd  eth0</span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">## &lt;a name=&quot;xdestop&quot;&gt;K.å®‰è£…Xæ¡Œé¢ç¯å¢ƒ&lt;/a&gt;</span></span>  </span><br><span class=\"line\">è¿™é‡Œä»¥xfce4è¿™ä¸ªæŠ˜ä¸­çš„æ¡Œé¢å¥—ä»¶æ¥æ¼”ç¤º,å¯ä»¥æ ¹æ®è‡ªå·±çš„çˆ±å¥½é€‰æ‹©å…¶ä»–æ¡Œé¢å¥—ä»¶æˆ–è€…çª—å£ç®¡ç†å™¨,æ¥ä¸‹æ¥ä¸é…è¿‡å¤šçš„å›¾,ä¸»è¦å™è¿°ä¸€ä¸‹è½¯ä»¶åŒ…å®‰è£…ç›¸å…³æŒ‡ä»¤</span><br><span class=\"line\">è¿›å…¥ç³»ç»Ÿåé¦–å…ˆæ›´æ–°è½¯ä»¶åŒ…ç›¸å…³æ•°æ®,å¦‚æœæç¤ºæœ‰æ›´æ–°å…ˆæ›´æ–°ä¸€ä¸‹è½¯ä»¶</span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tpacman -Syu</span><br><span class=\"line\">```  </span><br><span class=\"line\">![æ·»åŠ ä¸€ä¸ªæ™®é€šç”¨æˆ·](/images/2014/archinstall/66.png)</span><br><span class=\"line\"></span><br><span class=\"line\">å¦‚æœä½ ä¸çŸ¥é“è‡ªå·±æ˜¯ä»€ä¹ˆæ˜¾å¡ï¼Œå°±ç”¨ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹ä¸‹ï¼š  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tlspci | grep VGA</span><br><span class=\"line\">```  </span><br><span class=\"line\">ç„¶åæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æœç´¢ä¸‹åŒ¹é…ä½ æ˜¾å¡çš„é©±åŠ¨  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tpacman -Ss xf86-video | less</span><br><span class=\"line\">```  </span><br><span class=\"line\">æˆ‘æ˜¯VirtualBoxï¼Œæ‰€ä»¥æˆ‘å°±å®‰è£…ä¸€ä¸ªä¸‡èƒ½çš„ï¼Œä½ ä»¬å®‰è£…åŒ¹é…çš„ï¼Œæ¯”å¦‚ä½ æ˜¯Intelé›†æˆçš„å°±æ‰§è¡Œï¼š  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tpacman -S xf86-video-intel</span><br><span class=\"line\">```  </span><br><span class=\"line\">è™šæ‹Ÿæœºå°±æ‰§è¡Œ  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tpacman -S xf86-video-vesa</span><br><span class=\"line\">```  </span><br><span class=\"line\">ç¬”è®°æœ¬è¿˜å¯ä»¥è£…ä¸‹è§¦æ‘¸æ¿é©±åŠ¨  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tpacman -S xf86-input-synaptics</span><br><span class=\"line\">```  </span><br><span class=\"line\">å®‰è£…å£°å¡é©±åŠ¨</span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tpacman -S alsa-utils</span><br><span class=\"line\">```  </span><br><span class=\"line\">æµ‹è¯•Xç¯å¢ƒæ˜¯å¦å®‰è£…å¥½äº†ï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå…¶å®ä¸ç”¨æµ‹è¯•ã€‚  </span><br><span class=\"line\">```shell  </span><br><span class=\"line\">\tpacman -S xorg-twm xorg-xclock xterm </span><br><span class=\"line\">\tstartx </span><br><span class=\"line\">\texit </span><br><span class=\"line\">\tpkill X</span><br><span class=\"line\">```  </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">##&lt;a name=&quot;xfce4&quot;&gt;L.å®‰è£…XFCE4 æ¡Œé¢å¥—ä»¶&lt;/a&gt;</span></span></span><br><span class=\"line\">å…ˆå®‰è£…slimï¼Œè¿™æ˜¯ä¸€ä¸ªå›¾åƒã€ç™»å½•ç®¡ç†å™¨ï¼Œå¯ç”¨äºxfce4çš„è‡ªå¯åŠ¨ã€‚  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tpacman -S slim</span><br></pre></td></tr></table></figure>\n<p>å®‰è£…å®Œæˆåéœ€è¦æ‰§è¡Œæ¥è‡ªå¯åŠ¨</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\tsystemctl enable slim.service   </span><br><span class=\"line\">```  </span><br><span class=\"line\">é”®å…¥</span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tpacman -S xfce4</span><br><span class=\"line\">```  </span><br><span class=\"line\">å‡ºç°çš„è½¯ä»¶åŒ…ç»„é€‰æ‹©å…¨éƒ¨å³å¯</span><br><span class=\"line\"></span><br><span class=\"line\">å®‰è£…sudo,è®©æ™®é€šç”¨æˆ·æ— éœ€åˆ‡æ¢æ‰§è¡Œä¸€äº›rootç”¨æˆ·æŒ‡ä»¤</span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tpacman -S sudo</span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\">å®‰è£…ä¸­æ–‡å­—ä½“</span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tpacman -S wqy-microhei wqy-zenhei wqy-bitmapfont</span><br><span class=\"line\">```  </span><br><span class=\"line\">è‡³äºç¾åŒ–ï¼Œéƒ½æ˜¯é€šè¿‡ç•Œé¢æ“ä½œçš„ï¼Œsystem-settingå¯ä»¥è®¾ç½®å­—ä½“ï¼Œå¦å¤–terminalçš„preferenceå¯ä»¥è®¾ç½®å®ƒç”¨çš„å­—ä½“ã€‚</span><br><span class=\"line\"></span><br><span class=\"line\">ç°åœ¨ï¼Œå¤§åŠŸå‘Šæˆï¼ï¼å¯åŠ¨ï¼ï¼ï¼</span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tstartxfce4</span><br><span class=\"line\">```  </span><br><span class=\"line\">![æ·»åŠ ä¸€ä¸ªæ™®é€šç”¨æˆ·](/images/2014/archinstall/67.jpg)   </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">## &lt;a name=&quot;xfce4auto&quot;&gt;M.è®¾ç½®xfce4è‡ªå¯åŠ¨&lt;/a&gt;</span></span>ã€€ã€€</span><br><span class=\"line\">è¦å°†SLiMé…ç½®ä¸ºåŠ è½½æŸä¸ªç‰¹å®šçš„ç¯å¢ƒï¼Œåªéœ€ç¼–è¾‘~/.xinitrcå¦‚ä¸‹ï¼š  </span><br><span class=\"line\">```shell</span><br><span class=\"line\"><span class=\"meta\">\t#</span><span class=\"bash\">!/bin/sh</span></span><br><span class=\"line\">\t</span><br><span class=\"line\"><span class=\"meta\">\t#</span></span><br><span class=\"line\"><span class=\"bash\">\t<span class=\"comment\"># ~/.xinitrc</span></span></span><br><span class=\"line\"><span class=\"meta\">\t#</span></span><br><span class=\"line\"><span class=\"bash\">\t<span class=\"comment\"># Executed by startx (run your window manager from here)</span></span></span><br><span class=\"line\"><span class=\"meta\">\t#</span></span><br><span class=\"line\"><span class=\"bash\">\t</span></span><br><span class=\"line\">\texec [session-command]</span><br><span class=\"line\">```  </span><br><span class=\"line\">æ³¨æ„ï¼šå¦‚æœä½ æ²¡æœ‰~/.xinitrcæ–‡ä»¶ï¼Œå¯ä»¥ä»ç³»ç»Ÿä¸­å¤åˆ¶ä¸€ä¸ªï¼š  </span><br><span class=\"line\">```shell</span><br><span class=\"line\"><span class=\"meta\">\t$</span><span class=\"bash\"> cp /etc/skel/.xinitrc ~</span></span><br><span class=\"line\">```  </span><br><span class=\"line\">å°†[session-command]æ›¿æ¢ä¸ºé€‚å½“çš„ä¼šè¯å‘½ä»¤ã€‚ä¾‹å¦‚ï¼š</span><br><span class=\"line\"></span><br><span class=\"line\">è¦å¯åŠ¨Xfce:  </span><br><span class=\"line\">```shell</span><br><span class=\"line\"><span class=\"meta\">\t#</span><span class=\"bash\"> Xfce</span></span><br><span class=\"line\">\texec startxfce4</span><br><span class=\"line\">```  </span><br><span class=\"line\">è¦å¯åŠ¨Openboxï¼š  </span><br><span class=\"line\">```shell</span><br><span class=\"line\"><span class=\"meta\">\t#</span><span class=\"bash\"> Openbox</span></span><br><span class=\"line\">\texec openbox-session</span><br><span class=\"line\">```  </span><br><span class=\"line\">è¦å¯åŠ¨Fluxbox:  </span><br><span class=\"line\">```shell</span><br><span class=\"line\"><span class=\"meta\">\t#</span><span class=\"bash\"> Fluxbox</span></span><br><span class=\"line\">\texec fluxbox</span><br><span class=\"line\"><span class=\"meta\">\t#</span><span class=\"bash\"> Either fluxbox or startfluxbox is acceptable</span></span><br><span class=\"line\">```  </span><br><span class=\"line\">è¦å¯åŠ¨GNOME:  </span><br><span class=\"line\">```shell</span><br><span class=\"line\"><span class=\"meta\">\t#</span><span class=\"bash\"> GNOME</span></span><br><span class=\"line\">\texec gnome-session</span><br><span class=\"line\">```  </span><br><span class=\"line\">è¦å¯åŠ¨KDE:  </span><br><span class=\"line\">```shell</span><br><span class=\"line\"><span class=\"meta\">\t#</span><span class=\"bash\"> KDE</span></span><br><span class=\"line\">\texec startkde</span><br><span class=\"line\">```  </span><br><span class=\"line\">å¦‚æœä½ çš„æ¡Œé¢ç¯å¢ƒä¸åœ¨ä¸Šè¿°åˆ—è¡¨ä¸­ï¼Œè¯·å‚è€ƒä½ çš„è½¯ä»¶æ–‡æ¡£  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">##&lt;a name=&quot;inputmethod&quot;&gt;N.å®‰è£…æµè§ˆå™¨å’Œè¾“å…¥æ³•&lt;/a&gt;</span></span>  </span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tpacman -S firefox</span><br><span class=\"line\">```  </span><br><span class=\"line\">å®‰è£…ç«ç‹æµè§ˆå™¨  </span><br><span class=\"line\"></span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tpacman -S fcitx fcitx-gtk fcitx-gtk2 fcitx-gtk3 fcitx-qt fcitx-configtool  </span><br><span class=\"line\">```  </span><br><span class=\"line\">å®‰è£…å°ä¼é¹…è¾“å…¥æ³•  </span><br><span class=\"line\">p.s:è¿™é‡Œå¦‚æœä¸å®‰è£…gtkå’Œconfigtoolçš„è¯çš„æ˜¯æ²¡æœ‰å›¾å½¢é…ç½®ç•Œé¢çš„  </span><br><span class=\"line\"></span><br><span class=\"line\">ç„¶åç¼–è¾‘~/.profile  è®¾ç½®ä¸€äº›å‚æ•°</span><br><span class=\"line\">```shell</span><br><span class=\"line\">\texport GTK_IM_MODULE=fcitx</span><br><span class=\"line\"> \texport QT_IM_MODULE=fcitx</span><br><span class=\"line\">\texport XMODIFIERS=&quot;@im=fcitx&quot;</span><br><span class=\"line\">\tkillall fcitx</span><br><span class=\"line\">\tfcitx &amp;</span><br><span class=\"line\">```   </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">## &lt;a name=&quot;yaourt&quot;&gt;O.å®‰è£…yaourt&lt;/a&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">Yaourtæ˜¯archlinuxæ–¹ä¾¿ä½¿ç”¨çš„å…³é”®éƒ¨ä»¶ä¹‹ä¸€ï¼Œä½†æ²¡æœ‰è¢«æ•´åˆåˆ°ç³»ç»Ÿå®‰è£…ä¸­çš„å·¥å…·ã€‚å»ºè®®åœ¨è£…å®Œç³»ç»Ÿé‡å¯ä¹‹åï¼Œæ›´æ–°å®Œpacmanå’ŒåŸºæœ¬ç³»ç»Ÿä¹‹åï¼Œå°±å®‰è£…è¿™ä¸ªå·¥å…·ã€‚   </span><br><span class=\"line\"></span><br><span class=\"line\">å®‰è£…æ–¹æ³•æœ‰ä¸‹é¢ä¸¤ç§ï¼šå»ºè®®ä½¿ç”¨ç¬¬ä¸€ç§ï¼Œå¦‚æœè¦ä½“éªŒAURçš„æ“ä½œè¿‡ç¨‹å’Œä½¿ç”¨æ–¹æ³•ï¼Œå»ºè®®ä½¿ç”¨ç¬¬äºŒç§æ–¹æ³•å®‰è£…ã€‚   </span><br><span class=\"line\"></span><br><span class=\"line\">ç®€ä¾¿çš„å®‰è£…  </span><br><span class=\"line\"></span><br><span class=\"line\">æœ€ç®€å•å®‰è£…Yaourtçš„æ–¹å¼æ˜¯æ·»åŠ Yaourtæºè‡³æ‚¨çš„ /etc/pacman.conf:  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\t[archlinuxcn]</span><br><span class=\"line\"><span class=\"meta\">\t#</span><span class=\"bash\">The Chinese Arch Linux communities packages.</span></span><br><span class=\"line\">\tSigLevel = Optional TrustAll</span><br><span class=\"line\">\tServer   = http://repo.archlinuxcn.org/$arch</span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\">æˆ–è€… </span><br><span class=\"line\">```shell</span><br><span class=\"line\">[archlinuxfr]</span><br><span class=\"line\">Server = http://repo.archlinux.fr/$arch</span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\">æˆ–è€… </span><br><span class=\"line\">```shell</span><br><span class=\"line\"> [archlinuxfr]</span><br><span class=\"line\"> Server = http://repo-fr.archlinuxcn.org/$arch</span><br><span class=\"line\">```  </span><br><span class=\"line\">P.S:æ³¨æ„ å¿…é¡»è¦åŠ ä¸Š SigLevel = Optional TrustAll,å¦åˆ™ä¼šæŠ¥package-query: missing required signatureé”™è¯¯</span><br><span class=\"line\"></span><br><span class=\"line\">åŒæ­¥å¹¶å®‰è£…ï¼š </span><br><span class=\"line\">```shell</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> pacman -Syu yaourt</span></span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\"># &lt;a name=&quot;vbaddition&quot;&gt;å…«ã€ä¸ºVBOXå®‰è£…å¢å¼ºåŠŸèƒ½&lt;/a&gt;</span></span>  </span><br><span class=\"line\">é”®å…¥</span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tpacman -S virtualbox-guest-utils</span><br><span class=\"line\">```   </span><br><span class=\"line\">é‡å¯å³å¯</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\"># 9.&lt;a name=&quot;adv&quot;&gt;é™„å½•&lt;/a&gt;</span></span>  </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">## a.&lt;a name=&quot;slimthemes&quot;&gt;ä¸ºslimå®‰è£…ä¸»é¢˜&lt;/a&gt;</span></span></span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tcd /usr/share/slim/themes</span><br><span class=\"line\">\tls</span><br><span class=\"line\">```   </span><br><span class=\"line\">å¯ä»¥æŸ¥çœ‹å½“å‰æ‰€æœ‰å¯ç”¨ä¸»é¢˜   </span><br><span class=\"line\">é”®å…¥   </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tpacman -S slim-themes</span><br><span class=\"line\">```  </span><br><span class=\"line\">å®‰è£…å…¶å®ƒä¸»é¢˜,é€‰æ‹©ä¸€ä¸ªå–œæ¬¢çš„ç„¶åé”®å…¥   </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tvim /etc/slim.conf</span><br></pre></td></tr></table></figure>\n<p>æ‰¾åˆ°current themeé…ç½®é¡¹ä¿®æ”¹å³å¯  </p>\n<h3><span id=\"b-kan-tu-ruan-jian-feh\">b.</span><a href=\"#b-kan-tu-ruan-jian-feh\" class=\"header-anchor\">#</a></h3><p>é”®å…¥  </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\tpacman -S feh</span><br><span class=\"line\">```  </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">## c.&lt;a name=&quot;zsh&quot;&gt;zsh&lt;/a&gt;</span></span></span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell  </span><br><span class=\"line\">\tpacman -S zsh</span><br><span class=\"line\">```  </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">## d.&lt;a name=&quot;ksh&quot;&gt;ksh&lt;/a&gt;</span></span></span><br><span class=\"line\">é”®å…¥  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tyaourt -S ksh</span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">## e.&lt;a name=&quot;office&quot;&gt;office&lt;/a&gt;</span></span></span><br><span class=\"line\">é”®å…¥ </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tpacman -S libreoffice</span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">## f.&lt;a name=&quot;sublime&quot;&gt;æ–‡æœ¬ç¼–è¾‘å·¥å…·sublime&lt;/a&gt;</span></span></span><br><span class=\"line\">é”®å…¥   </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tyaourt -S sublime-text-dev</span><br></pre></td></tr></table></figure>\n<h3><span id=\"j-wang-luo-guan-li-gong-ju-wicd\">j.</span><a href=\"#j-wang-luo-guan-li-gong-ju-wicd\" class=\"header-anchor\">#</a></h3><p>é”®å…¥   </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\tpacman -Sy wicd wicd-gtk</span><br><span class=\"line\">```  </span><br><span class=\"line\">ä½ å¾ˆå¯èƒ½è¿˜è¦å®‰è£…DHCPå’Œæ— çº¿å®‰å…¨ç®¡ç†ç¨‹åºã€‚</span><br><span class=\"line\">é”®å…¥   </span><br><span class=\"line\">```shell  </span><br><span class=\"line\">\tpacman -S dhclient wpa_supplicant</span><br></pre></td></tr></table></figure>\n<p>ç¼–è¾‘/etc/rc.confæ–‡ä»¶</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\tvim /etc/rc.conf</span><br><span class=\"line\">\tDAEMONS = (syslog-ng !network wicd dbus alsa)</span><br><span class=\"line\">```  </span><br><span class=\"line\">åœ¨networkå‰é¢åŠ ä¸Š ! å¹¶åœ¨networkååŠ ä¸Š wicd</span><br><span class=\"line\"></span><br><span class=\"line\">ä¸ºç”¨æˆ·æ·»åŠ ç»„æƒé™  </span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tgpasswd -a USERNAME users</span><br><span class=\"line\">\tgpasswd -a USERNAME network</span><br><span class=\"line\">```  </span><br><span class=\"line\">å¯åŠ¨æœåŠ¡</span><br><span class=\"line\">```shell  </span><br><span class=\"line\">\tsystemctl start wicd</span><br><span class=\"line\">```  </span><br><span class=\"line\">è¿è¡Œ  </span><br><span class=\"line\">```shell  </span><br><span class=\"line\">\twicd-client</span><br><span class=\"line\">```   </span><br><span class=\"line\">é€šçŸ¥æ æŒ‰é’®  </span><br><span class=\"line\">```shell  </span><br><span class=\"line\">\twicd-client --tray</span><br><span class=\"line\">```  </span><br><span class=\"line\">æ¸…é™¤é€šçŸ¥æ æŒ‰é’®  </span><br><span class=\"line\">```shell  </span><br><span class=\"line\">\twicd-client -n</span><br><span class=\"line\">```   </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\">## h.&lt;a name=&quot;netctl&quot;&gt;ä½¿ç”¨netctl&lt;/a&gt;</span></span>  </span><br><span class=\"line\">ç»è¿‡ä¸€æ®µæ—¶é—´çš„ä½¿ç”¨å‘ç°wicdæœ‰äº›ä¸å°½å¦‚äººæ„çš„åœ°æ–¹,æ‰€ä»¥å·²ç»æ¢æˆäº†netctlæ¥ç®¡ç†</span><br><span class=\"line\">å…·ä½“è®¾ç½®å¯ä»¥å®Œå…¨å‚è€ƒwiki,è¦æ³¨æ„çš„æ˜¯éœ€è¦æŠŠdhcpcdå…³æ‰ä¸ç„¶ä¼šå¯åŠ¨å¤±è´¥</span><br><span class=\"line\">```shell</span><br><span class=\"line\">\tsystemctl disable dhcpcd@ethX.service</span><br></pre></td></tr></table></figure>\n<p>ç”±äºæˆ‘æ˜¯é‡‡ç”¨åŒç½‘å¡æ¨¡å¼,Aç½‘å¡æ˜¯è‡ªåŠ¨è·å–IP,Bç½‘å¡æ˜¯é‡‡ç”¨é™æ€IP<br>æ‰€ä»¥åªéœ€è¦ç¦ç”¨æ‰Bç½‘å¡çš„dhcpcdå³å¯,å¹¶ä¸”å‚è€ƒwikiå°†é™æ€ipçš„profileæ–‡ä»¶æ·»åŠ åˆ°è‡ªå¯åŠ¨å³å¯<br>å¸¸ç”¨å‘½ä»¤å¦‚ä¸‹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">å¤åˆ¶é…ç½®æ–‡ä»¶</span></span><br><span class=\"line\">cp /etc/netctl/examples/wireless-wpa /etc/netctl/profile</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">ä¿®æ”¹é…ç½®æ–‡ä»¶</span></span><br><span class=\"line\">vim profile</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">æ‰‹åŠ¨å¯åŠ¨é…ç½®æ–‡ä»¶</span></span><br><span class=\"line\">netctl start profile</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">æŸ¥çœ‹é…ç½®æ–‡ä»¶çŠ¶æ€</span></span><br><span class=\"line\">netctl status profile</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">è®¾ç½®é…ç½®æ–‡ä»¶è‡ªå¯åŠ¨</span></span><br><span class=\"line\">netctl enable profile</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">å»é™¤é…ç½®æ–‡ä»¶è‡ªå¯åŠ¨</span></span><br><span class=\"line\">netctl disable profile</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶</span></span><br><span class=\"line\">netctl reenable profile</span><br></pre></td></tr></table></figure>\n<p>p.s:éœ€è¦æ³¨æ„çš„æ˜¯é…ç½®æ–‡ä»¶ä¸­<br>IPå’ŒRoutesèŠ‚ç‚¹ä¸å¯åŒæ—¶æ”¾å¼€,å¦åˆ™ä¼šå› ä¸ºå†²çªè€Œå¯¼è‡´åŠ è½½é…ç½®æ–‡ä»¶å¤±è´¥</p>\n<p>__å‚è€ƒèµ„æ–™<br>*<a href=\"http://www.cnblogs.com/mad/p/3280041.html\">Archlinuxç½‘ç»œé…ç½®</a>  </p>\n<p>*<a href=\"http://blog.csdn.net/helloanyone/article/details/7012487\">å¦‚ä½•å®‰è£…ArchLinux</a>  </p>\n<p>*<a href=\"http://bbs.kafan.cn/thread-1371928-1-1.html\">å¤§é“è‡³ç®€,åŸæ¥ä½ å°±æ˜¯è¿™ä¹ˆKISSâ€”ArchLinuxåŸºæœ¬ç³»ç»Ÿåˆ°XFCE4æ¡Œé¢æ­å»º</a>   </p>\n<p>*<a href=\"https://www.archlinux.org/mirrors/status\">Arché•œåƒåˆ—è¡¨</a>   </p>\n<p>*Arch wiki - slimå®‰è£…<br><a href=\"https://wiki.archlinux.org/index.php?title=SLiM_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=212382\">https://wiki.archlinux.org/index.php?title=SLiM_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=212382</a>  </p>\n<p>*Arch wiki - yaourtå®‰è£…<br><a href=\"https://wiki.archlinux.org/index.php/Yaourt_%28%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%29\">https://wiki.archlinux.org/index.php/Yaourt_%28%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%29</a></p>\n<p>*Arch wiki - wicdå®‰è£…<br><a href=\"https://wiki.archlinux.org/index.php/Wicd\">https://wiki.archlinux.org/index.php/Wicd</a></p>\n<p>*Arch wiki - netctlä½¿ç”¨<br><a href=\"https://wiki.archlinux.org/index.php/Netctl_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)\">https://wiki.archlinux.org/index.php/Netctl_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)</a></p>\n","categories":["POSIX"],"tags":["Arch"]},{"title":"Jenkins+Gradleæ­å»ºCIç¯å¢ƒ","url":"https://pkaq.org/2013/12/03/2013-12-03-gradleforjenkins/","content":"<h4><span id=\"ban-ben-shuo-ming\">ç‰ˆæœ¬è¯´æ˜</span><a href=\"#ban-ben-shuo-ming\" class=\"header-anchor\">#</a></h4><ul>\n<li>jenkins 1.542</li>\n<li>jdk 1.6u45</li>\n<li>gradle 1.9</li>\n</ul>\n<h4><span id=\"bi-yao-tiao-jian\">å¿…è¦æ¡ä»¶</span><a href=\"#bi-yao-tiao-jian\" class=\"header-anchor\">#</a></h4><ul>\n<li>éœ€è¦å®‰è£…JDKå¹¶é…ç½®é…ç½®å¥½JAVA_HOMEå’ŒJRE_HOMEçš„ç¯å¢ƒå˜é‡</li>\n</ul>\n<ol>\n<li><p>ä¸‹è½½jenkins.war<br>å»<a href=\"%22http://www.jenkins-ci.org/%22\">Jenkinså®˜æ–¹ç½‘ç«™</a>ä¸‹è½½ç›¸åº”waråŒ…å³å¯</p>\n</li>\n<li><p>ä½¿ç”¨å‘½ä»¤è¡Œè·³è½¬åˆ°jenkinsæ‰€åœ¨ç›®å½•<br>å¯ä»¥æœ‰ä¸¤ç§æ–¹æ³•è¿›è¡Œè¿è¡Œ jenkins<br> a)    ç›´æ¥é€šè¿‡å‘½ä»¤è¡Œ<br> è½¬åˆ°hudson.waræ‰€åœ¨çš„ç›®å½•ï¼Œå½“å‰ä¸º<br> java -jar jenkins.war â€“httpPort=8080<br> è¯´æ˜ï¼šhttpPortä¸ºjenkinsè¿è¡Œçš„ç«¯å£ï¼Œé»˜è®¤ç«¯å£ä¸º8080ï¼Œä¸Šè¿°å‘½ä»¤å…¶å®jenkinsè¿è¡Œåœ¨Winstoneå®¹å™¨ä¸­ï¼›<br> b)    åœ¨Webå®¹å™¨ä¸­è¿è¡Œ<br> jenkinså¯ä»¥è¿è¡Œåœ¨æ ‡å‡†çš„WebæœåŠ¡å™¨ä¸­ï¼Œæ”¯æŒTomcatã€Jbossã€WebLogicä¸­ï¼Œåªéœ€è¦å°†jenkins.waræ”¾ç½®åˆ°ç›¸åº”ç›®å½•ï¼Œå¯åŠ¨æœåŠ¡å°±å¯ä»¥è¿›è¡Œè®¿é—®ï¼›</p>\n</li>\n<li><p>è®¿é—®jenkins <a href=\"http://localhost:8080/\">http://localhost:8080/</a></p>\n<a id=\"more\"></a></li>\n<li><p>å®‰è£…gradleæ’ä»¶<br> ç‚¹å‡»ç³»ç»Ÿç®¡ç†-&gt;æ’ä»¶ç®¡ç†<br> é€‰æ‹©â€å¯å®‰è£…æ’ä»¶â€tabé¡µ,è¿‡æ»¤å‡ºgradle pluginç„¶åå‹¾é€‰ç‚¹å‡»ç›´æ¥å®‰è£…å³å¯<br> å¦‚æœéœ€è¦è‡ªåŠ¨éƒ¨ç½²è¿˜éœ€è¦å®‰è£…deploy plugin</p>\n</li>\n<li><p>é…ç½®</p>\n<ul>\n<li>é‰´æƒé…ç½®<br>  ç‚¹å‡»ç³»ç»Ÿç®¡ç† é€‰æ‹©Configure Global Security ç‚¹å‡»â€å¯ç”¨å®‰å…¨â€<br>  åœ¨è®¿é—®æ§åˆ¶ä¸‹çš„å®‰å…¨åŸŸ å‹¾é€‰ jenkinsä¸“æœ‰ç”¨æˆ·æ•°æ®åº“<br>  åœ¨è®¿é—®æ§åˆ¶ä¸‹çš„æˆæƒç­–ç•¥é‡Œ æ›´æ”¹ä¸º â€œç™»å½•ç”¨æˆ·å¯ä»¥åšä»»ä½•äº‹â€<br>  ç‚¹å‡»ä¿å­˜ä¼šè·³è½¬åˆ°ç™»é™†ç•Œé¢,ç‚¹å‡»åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·æ³¨å†Œä¸€ä¸ªæ–°ç”¨æˆ·å³å¯</li>\n<li>ç³»ç»Ÿé…ç½®<br>  ç³»ç»Ÿç®¡ç†-&gt;ç³»ç»Ÿé…ç½®-&gt;æ‰¾åˆ°gradleé¡¹ç›®,æŠŠè‡ªåŠ¨å®‰è£…å‰é¢çš„å‹¾å»æ‰å³å¯è®¾ç½®æœ¬åœ°gradleç›®å½•<br>  <img src=\"/images/2013/12/03/6.png\" alt=\"gradle config\"></li>\n</ul>\n</li>\n<li><p>åˆ›å»ºä»»åŠ¡<br> 6.1. ç‚¹å‡»ç•Œé¢çš„â€åˆ›å»ºä¸€ä¸ªæ„å»ºä»»åŠ¡â€è¿›è¡Œåˆ›å»º;å¡«å…¥jobåç§° é€‰æ‹©æ„å»ºä¸€ä¸ªè‡ªç”±é£æ ¼çš„é¡¹ç›®<br> <img src=\"/images/2013/12/03/1.png\" alt=\"project config\"></p>\n<p> 6.2. ç‚¹å‡»ä¸‹ä¸€æ­¥,åœ¨â€æºç ç®¡ç†â€é€‰é¡¹ä¸‹é€‰æ‹© subversion repository URLè¾“å…¥ä½ çš„é¡¹ç›®svnåœ°å€,ç¬¬ä¸€æ¬¡è¾“å…¥å®Œä¹‹åä¼šç»™å‡ºçº¢è‰²æç¤ºè¯´é‰´æƒä¸é€šè¿‡,ç‚¹å‡»enter authority,ç„¶åé€‰æ‹©username/passwordè¾“å…¥é‰´æƒä¿¡æ¯å³å¯(å¦‚æœä½ æ˜¯é‡‡ç”¨username/passwordæ–¹å¼çš„è¯),å…¶ä½™çš„ä¿æŒé»˜è®¤å³å¯<br> <img src=\"/images/2013/12/03/2.png\" alt=\"subversion config\"></p>\n<p> 6.3. å¦‚æœå¸Œæœ›å®šæ—¶æ„å»ºå¯ä»¥åœ¨â€æ„å»ºè§¦å‘å™¨â€é€‰é¡¹ä¸‹ é€‰æ‹©build periodicallyå¡«å†™cronè¡¨è¾¾å¼æ¥æ§åˆ¶æ„å»ºå‘¨æœŸ æ¯”å¦‚æ¯å¤©20:00æ„å»º H 20 * * *<br> <img src=\"/images/2013/12/03/3.png\" alt=\"cron config\"></p>\n<p> 6.4. åœ¨â€æ„å»ºâ€é€‰é¡¹ä¸‹ ç‚¹å‡» å¢åŠ æ„å»ºæ­¥éª¤ é€‰æ‹© invoke gradle script åœ¨tasksä¸‹å¡«å…¥è¦æ‰§è¡Œçš„ä»»åŠ¡å³å¯<br> <img src=\"/images/2013/12/03/4.png\" alt=\"gradlescript config\"></p>\n<p> 6.5. è‡ªåŠ¨éƒ¨ç½²<br> åœ¨â€æ„å»ºåæ“ä½œâ€é€‰é¡¹ä¸‹,ç‚¹å‡» å¢åŠ æ„å»ºæ­¥éª¤ é€‰æ‹© delply war/ear to a container</p>\n<p> åœ¨war/ear filesä¸‹å¡«å…¥waråŒ…æ‰€åœ¨ä½ç½® å¦‚target/libs/CIMS.war<br> context pathå¡«å†™é¡¹ç›®åç§° å¦‚ CIMS<br> containeré€‰æ‹©å®¹å™¨ç‰ˆæœ¬ å¦‚tomcat<br> è¿™é‡Œéœ€è¦æ›´æ”¹ç›®æ ‡tomcaté…ç½® æ·»åŠ ç›¸åº”ç”¨æˆ· ç„¶åå¡«å…¥ç›¸åº”å†…å®¹å³å¯<br> <img src=\"/images/2013/12/03/5.png\" alt=\"deploy config\"></p>\n<p> p.s:æ­¤æ­¥éœ€è¦ä¿®æ”¹ç›®æ ‡tomcatçš„é…ç½®</p>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi $tomcat/conf/tomcat-usres.xml</span><br><span class=\"line\">&lt;!-- å¿…é¡»å¼€å¯è¿™ä¸¤ä¸ªæƒé™,ä¸ç„¶ä¼šå‡ºç° å¦‚ä¸‹é”™è¯¯,åŒæ—¶è¯¥é”™è¯¯ä¹Ÿå¯èƒ½ç”±äºå†…å­˜æº¢å‡ºè€Œå¯¼è‡´ERROR: Publisher hudson.plugins.deploy.DeployPublisher aborted due to exception   --&gt;</span><br><span class=\"line\">&lt;role rolename=&quot;manager-script&quot;/&gt;</span><br><span class=\"line\">&lt;role rolename=&quot;manager-gui&quot;/&gt;\t</span><br><span class=\"line\">&lt;user username=&quot;jenkins&quot; password=&quot;jenkins&quot; roles=&quot;tomcat,manager-script,manager-gui&quot;/&gt;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>ç‚¹å‡»ä¿å­˜,æ­å»ºå®Œæˆ</p>\n</li>\n</ol>\n","categories":["Build Tools","DevOps"],"tags":["Gradle","Jenkins"]},{"title":"ä½¿ç”¨gradleä¸‹è½½jaråŒ…","url":"https://pkaq.org/2013/11/26/2013-11-26-gradledownloadjar/","content":"<p>å¦‚é¢˜ å»ºç«‹build.gradleæ–‡ä»¶å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apply <span class=\"attr\">plugin:</span> <span class=\"string\">&#x27;java&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">repositories &#123;</span><br><span class=\"line\">    mavenCentral()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">dependencies &#123;</span><br><span class=\"line\"><span class=\"comment\">/**springç‰ˆæœ¬å·**/</span></span><br><span class=\"line\">   <span class=\"keyword\">def</span> springVersion = <span class=\"string\">&quot;3.2.4.RELEASE&quot;</span></span><br><span class=\"line\">   compile  <span class=\"string\">&quot;org.springframework:spring-webmvc:$&#123;springVersion&#125;&quot;</span>,</span><br><span class=\"line\">             <span class=\"string\">&quot;org.springframework:spring-jdbc:$&#123;springVersion&#125;&quot;</span>,</span><br><span class=\"line\">             <span class=\"string\">&quot;org.springframework:spring-tx:$&#123;springVersion&#125;&quot;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">task copyJars(<span class=\"attr\">type:</span> Copy) &#123;</span><br><span class=\"line\">  from configurations.runtime</span><br><span class=\"line\">  into <span class=\"string\">&#x27;lib&#x27;</span> <span class=\"comment\">// ç›®æ ‡ä½ç½®</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<p>ç„¶åæ§åˆ¶å°æ‰§è¡Œ</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gradle -q copyJars</span><br></pre></td></tr></table></figure>\n<p>å¥½äº†å»å¯»æ‰¾å§ æ³°ç½—</p>\n","categories":["Build Tools"],"tags":["Gradle"]},{"title":"Centos 6.4å®‰è£…oracle 11G","url":"https://pkaq.org/2013/11/07/2013-11-07-installoracle11goncentos/","content":"<h3><span id=\"1-an-zhuang-centos\">1.å®‰è£…centos</span><a href=\"#1-an-zhuang-centos\" class=\"header-anchor\">#</a></h3><h3><span id=\"2-pei-zhi-sshd\">2.é…ç½®sshd</span><a href=\"#2-pei-zhi-sshd\" class=\"header-anchor\">#</a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi etc/ssh/sshd_config </span><br><span class=\"line\">PasswordAuthentication yes</span><br><span class=\"line\">PermitRootLogin yes</span><br><span class=\"line\">service sshd restart</span><br></pre></td></tr></table></figure>\n<h3><span id=\"3-an-zhuang-ftp\">3.å®‰è£…ftp</span><a href=\"#3-an-zhuang-ftp\" class=\"header-anchor\">#</a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install vsftpd</span><br></pre></td></tr></table></figure>\n<p>å…è®¸rootç™»å½•</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/vsftpd/ftpusers</span><br><span class=\"line\">vi /etc/vsftpd/userlist</span><br></pre></td></tr></table></figure>\n<p>æŠŠé‡Œé¢rootå‰é¢åŠ #<br>å¯åŠ¨ftp</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service vsftpd start</span><br></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<h3><span id=\"4-guan-bi-selinux\">4.å…³é—­SELINUX</span><a href=\"#4-guan-bi-selinux\" class=\"header-anchor\">#</a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/selinux/config   </span><br></pre></td></tr></table></figure>\n<p> ä¿®æ”¹SELINUX=disabledï¼Œç„¶å:wqä¿å­˜é€€å‡ºåï¼Œè¾“å…¥setenforce 0 ä½¿ä¿®æ”¹ç”Ÿæ•ˆï¼Œæˆ–è€…é‡å¯ä¸‹ç”µè„‘ </p>\n<h3><span id=\"5-fang-kai-fang-huo-qiang-dui-ftp-he-1521-de-xian-zhi\">5.æ”¾å¼€é˜²ç«å¢™å¯¹ftpå’Œ1521çš„é™åˆ¶</span><a href=\"#5-fang-kai-fang-huo-qiang-dui-ftp-he-1521-de-xian-zhi\" class=\"header-anchor\">#</a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/sysconfig/iptables </span><br><span class=\"line\">-A INPUT -m state --state NEW -m tcp -p tcp --dport 21 -j ACCEPT</span><br><span class=\"line\">-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT</span><br><span class=\"line\">-A INPUT -m state --state NEW -m tcp -p tcp --dport 1521 -j ACCEPT</span><br></pre></td></tr></table></figure>\n<h3><span id=\"6-shi-yong-lan-ren-bao\">6.ä½¿ç”¨æ‡’äººåŒ…</span><a href=\"#6-shi-yong-lan-ren-bao\" class=\"header-anchor\">#</a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sh Oracle11gPreInstaller.sh</span><br></pre></td></tr></table></figure>\n<h3><span id=\"7-an-zhuang-oracle\">7.å®‰è£…oracle</span><a href=\"#7-an-zhuang-oracle\" class=\"header-anchor\">#</a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./runInstaller</span><br></pre></td></tr></table></figure>\n<h3><span id=\"8-pei-zhi-bash-profile\">8.é…ç½®.bash_profile</span><a href=\"#8-pei-zhi-bash-profile\" class=\"header-anchor\">#</a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi.bash_profile </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> .bash_profile</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> Get the aliases and <span class=\"built_in\">functions</span></span></span><br><span class=\"line\">if [ -f ~/.bashrc ]; then</span><br><span class=\"line\">\t. ~/.bashrc</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> User specific environment and startup programs</span></span><br><span class=\"line\"></span><br><span class=\"line\">PATH=$PATH:$HOME/bin</span><br><span class=\"line\"></span><br><span class=\"line\">export PATH</span><br><span class=\"line\"></span><br><span class=\"line\">ORACLE_BASE=/opt/app/oracle</span><br><span class=\"line\">ORACLE_HOME=/opt/app/oracle/product</span><br><span class=\"line\">ORACLE_SID=mord</span><br><span class=\"line\">TMP=/tmp</span><br><span class=\"line\">TMPDIR=/tmp</span><br><span class=\"line\">NLS_DATE_FORMAT=&#x27;YYYY-MM-DD HH24:MI:SS&#x27;</span><br><span class=\"line\">export ORACLE_BASE ORACLE_HOME ORACLE_SID TMP TMPDIR NLS_DATE_FORMAT</span><br><span class=\"line\">export NLS_LANG=AMERICAN_AMERICA.AL32UTF8</span><br><span class=\"line\">export ORA_NLS33=$ORACLE_HOME/nls/data</span><br><span class=\"line\">export ORACLE_BASE</span><br><span class=\"line\">export ORACLE_HOME</span><br><span class=\"line\">export ORACLE_SID</span><br><span class=\"line\">export LANG=en_US.UTF-8</span><br><span class=\"line\"></span><br><span class=\"line\">PATH=$PATH:$HOME/bin:$ORACLE_HOME/bin</span><br><span class=\"line\"></span><br><span class=\"line\">export PATH</span><br><span class=\"line\"></span><br><span class=\"line\">/bin/dbstart </span><br><span class=\"line\">/bin/emctl start dbconsole</span><br></pre></td></tr></table></figure>\n<h3><span id=\"9-dbca-pei-zhi-chuang-jian-shu-ju-ku\">9.dbcaé…ç½®åˆ›å»ºæ•°æ®åº“</span><a href=\"#9-dbca-pei-zhi-chuang-jian-shu-ju-ku\" class=\"header-anchor\">#</a></h3><h3><span id=\"10-netca-she-zhi-jian-ting-fu-wu-ming\">10.netcaè®¾ç½®ç›‘å¬æœåŠ¡å</span><a href=\"#10-netca-she-zhi-jian-ting-fu-wu-ming\" class=\"header-anchor\">#</a></h3><p><a href=\"/files/Oracle11gPreInstaller.sh\">æ‡’äººåŒ…ä¸‹è½½</a></p>\n","categories":["linux"],"tags":["linux","oracle"]},{"title":"ä½¿ç”¨Gradleè°ƒç”¨CMD","url":"https://pkaq.org/2013/10/18/2013-10-18-graldewithcmd/","content":"<p>å…³äºå¦‚ä½•ä½¿ç”¨gradleè°ƒç”¨å‘½ä»¤è¡Œæ¥æ‰§è¡Œä¸€äº›å‘½ä»¤å¯ä»¥å‚è€ƒå¦‚ä¸‹è„šæœ¬è¿›è¡Œä¿®æ”¹æ‰©å±•</p>\n<p>build.gradle</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">task javaVersion(<span class=\"attr\">type:</span>Exec) &#123;</span><br><span class=\"line\">  <span class=\"comment\">//è¿™é‡Œåœ¨windowsä¸‹ä¸€å®šè¦åŠ /cå‚æ•° ,å¦åˆ™ä¼šæŠ¥é”™,/cæ˜¯ æ‰§è¡Œå­—ç¬¦ä¸²æŒ‡å®šçš„å‘½ä»¤ç„¶åç»ˆæ­¢</span></span><br><span class=\"line\">  commandLine <span class=\"string\">&#x27;cmd&#x27;</span>, <span class=\"string\">&#x27;/c&#x27;</span>, <span class=\"string\">&#x27;java -version&#x27;</span></span><br><span class=\"line\">  <span class=\"comment\">//æ‰§è¡Œç»“æœ</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span>(<span class=\"literal\">null</span> == execResult)&#123;</span><br><span class=\"line\">\tprintln <span class=\"string\">&#x27;exec failed&#x27;</span></span><br><span class=\"line\">  &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\tprintln <span class=\"string\">&#x27;exec successed&#x27;</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">//store the output instead of printing to the console:</span></span><br><span class=\"line\">  standardOutput = <span class=\"keyword\">new</span> ByteArrayOutputStream()</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">//extension method stopTomcat.output() can be used to obtain the output:</span></span><br><span class=\"line\">  ext.output = &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> standardOutput.toString()</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<p>æ§åˆ¶å°è°ƒç”¨</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gradle -q jV</span><br></pre></td></tr></table></figure>\n<p>å…·ä½“å¯ä»¥æŸ¥çœ‹å®˜æ–¹API<br><a href=\"http://www.gradle.org/docs/current/dsl/org.gradle.api.tasks.Exec.html\">è°ƒç”¨å‘½ä»¤è¡Œ</a></p>\n<p>P.S:æ„Ÿè°¢gradleç¾¤ä¸­çš„ å°å’Œå°š æå‡ºå’Œå‘ç°äº†æ­¤é—®é¢˜çš„è§£å†³æ–¹å¼</p>\n","categories":["Build Tools"],"tags":["Gradle"]},{"title":"å€ŸåŠ©Libreoffice/Openofficeå®ç°Excelåœ¨çº¿é¢„è§ˆ","url":"https://pkaq.org/2013/10/16/2013-10-16-previewexcelwithsoffice/","content":"<p>æœ‰æ—¶å€™ä½ å¯èƒ½éœ€è¦å¯¹å®¢æˆ·ä¸Šä¼ çš„excelæ–‡ä»¶æä¾›åœ¨çº¿é¢„è§ˆçš„æ–¹å¼,ç±»ä¼¼å¾ˆå¤šé‚®ç®±ç›´æ¥ç‚¹å‡»å°±å¯ä»¥åœ¨çº¿æŸ¥çœ‹.ä½†å¾ˆå¤šç¬¬ä¸‰æ–¹å·¥å…·éƒ½æ˜¯æ”¶è´¹çš„è€Œè‡ªå·±éå†excelé‡ç»˜ç•Œé¢åˆæ¯”è¾ƒéº»çƒ¦;<br>å½“ç„¶å¦‚æœè¦æ±‚äº‹å…ˆå°†excelå¦å­˜ä¸ºhtmlç„¶åä¸Šä¼ ç›´æ¥æ˜¾ç¤ºæ˜¯æ²¡é—®é¢˜çš„,ä½†æ˜¾ç„¶è¿™ä¸å¤Ÿç§‘å­¦;é‚£å¦‚ä½•æ‰èƒ½å®ç°ç§‘å­¦é¢„è§ˆå‘¢.å…¶å®ç›´æ¥å€ŸåŠ©Libreoffice/Openofficeåœ¨ç‚¹å‡»é¢„è§ˆå,åå°æ‚„æ‚„æŠŠexcelå¦å­˜æˆhtmlå°±å¥½äº†;å…·ä½“æ–¹å¼å¦‚ä¸‹</p>\n<p>ä»¥Centos 6.4ä¸ºä¾‹;</p>\n<h3><span id=\"1-an-zhuang-zhuo-mian-huan-jing-he-office-ru-guo-yi-jing-an-zhuang-de-ke-yi-hu-lue-ci-bu-zou\">1.å®‰è£…æ¡Œé¢ç¯å¢ƒå’Œoffice(å¦‚æœå·²ç»å®‰è£…çš„å¯ä»¥å¿½ç•¥æ­¤æ­¥éª¤)</span><a href=\"#1-an-zhuang-zhuo-mian-huan-jing-he-office-ru-guo-yi-jing-an-zhuang-de-ke-yi-hu-lue-ci-bu-zou\" class=\"header-anchor\">#</a></h3><p>å¦‚æœæ²¡æœ‰å®‰è£…æ¡Œé¢ç¯å¢ƒçš„è¯éœ€è¦å…ˆæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å®‰è£…</p>\n<p><strong>å®‰è£…x window</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum groupinstall &#x27;X Window System&#x27; -y </span><br></pre></td></tr></table></figure>\n<p><strong>å®‰è£…æ¡Œé¢</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum groupinstall &#x27;Desktop&#x27; -y </span><br></pre></td></tr></table></figure>\n<p><strong>å®‰è£…office</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum groupinstall &#x27;Office Suite and Productivity&#x27; -y </span><br></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n\n<p>P.S:ä¸åŒç‰ˆæœ¬çš„ç³»ç»Ÿå¯èƒ½åç§°ä¼šæœ‰äº›è®¸å·®å¼‚,è¿™æ—¶å¯ä»¥ç”¨yum grouplist | more æ¥æŸ¥çœ‹è¦å®‰è£…çš„å…·ä½“åç§°</p>\n<h3><span id=\"2-qi-dong-openoffice-fu-wu\">2.å¯åŠ¨openoffice æœåŠ¡</span><a href=\"#2-qi-dong-openoffice-fu-wu\" class=\"header-anchor\">#</a></h3><p>è¿›è¡Œè¿™ä¸€æ­¥ä¹‹å‰,å¦‚æœä½ è¿›è¡Œäº†æ­¥éª¤1,å®‰è£…å®Œæˆåéœ€è¦startx è¿›å…¥æ¡Œé¢ç¯å¢ƒ,å¦åˆ™ä¼šæŠ¥å¦‚ä¸‹é”™è¯¯</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/program/soffice.bin X11 error: Can&#x27;t open display: </span><br><span class=\"line\">  Set DISPLAY environment variable, use -display option </span><br><span class=\"line\">  or check permissions of your X-Server </span><br><span class=\"line\">  (See &quot;man X&quot; resp. &quot;man xhost&quot; for details) </span><br></pre></td></tr></table></figure>\n<p>å¯ä»¥ä¿®æ”¹/etc/inittab,è®¾ç½®é»˜è®¤ä»æ¡Œé¢å¯åŠ¨</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/inittab</span><br></pre></td></tr></table></figure>\n<p>æ‰¾åˆ°é‡Œé¢çš„ </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">id:3:initdefault:</span><br></pre></td></tr></table></figure>\n<p>å°†é‡Œé¢çš„3æ”¹æˆ5,3æ˜¯æ–‡æœ¬æ¨¡å¼,5æ˜¯æ¡Œé¢æ¨¡å¼;</p>\n<p>è¿è¡Œå¦‚ä¸‹å‘½ä»¤å¯åŠ¨openofficeæœåŠ¡</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">soffice --headless --accept=&quot;socket,host=127.0.0.1,port=8100;urp;&quot; --nofirststartwizard &amp;</span><br></pre></td></tr></table></figure>\n<h3><span id=\"3-cheng-xu-diao-yong\">3.ç¨‹åºè°ƒç”¨</span><a href=\"#3-cheng-xu-diao-yong\" class=\"header-anchor\">#</a></h3><p>å…¶å®å°±æ˜¯é€šè¿‡ç¨‹åºè°ƒç”¨officeæœåŠ¡,ç„¶åå¾ˆçŒ¥ççš„å°†excelå·å·è½¬åŒ–æˆhtmlè¾“å‡ºåˆ°é¡¹ç›®ä¸‹çš„æŸä¸ªæ–‡ä»¶å¤¹é‡Œ,ç„¶åé¡µé¢ç›´æ¥åŠ è½½è¿™ä¸ªhtmlæ–‡ä»¶å°±å¯ä»¥äº†,ä»¥ä¸‹æ˜¯æˆ‘å½“å‰é¡¹ç›®çš„è°ƒç”¨ç¤ºä¾‹,ä¾èµ–çš„jaræˆ‘æ”¾åˆ°ç½‘ç›˜äº† éœ€è¦å¯ä»¥ä¸‹è½½.</p>\n<p><a href=\"http://url.cn/MG3Lwn\">ä¸‹è½½ä¾èµ–jar</a></p>\n<pre class=\" language-java\"><code class=\"language-java\">        String fileID <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"fileID\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        FileUpDown fileUpDown <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>fileUpDownManager<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>fileID<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        String filePath <span class=\"token operator\">=</span> fileUpDown<span class=\"token punctuation\">.</span><span class=\"token function\">getFilePath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        String fileName <span class=\"token operator\">=</span> fileUpDown<span class=\"token punctuation\">.</span><span class=\"token function\">getFileName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\" spellcheck=\"true\">//å¤„ç†æ–‡ä»¶æ‰©å±•å</span>\n        String<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> fileNameArr <span class=\"token operator\">=</span> fileName<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\\\.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        String extendName <span class=\"token operator\">=</span> fileNameArr<span class=\"token punctuation\">[</span>fileNameArr<span class=\"token punctuation\">.</span>length<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        extendName <span class=\"token operator\">=</span> extendName<span class=\"token punctuation\">.</span><span class=\"token function\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\" spellcheck=\"true\">/**æµè§ˆå™¨æ”¯æŒæ ¼å¼*/</span>\n        String<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> browserFormatArr <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>#<span class=\"token number\">123</span><span class=\"token punctuation\">;</span><span class=\"token string\">\"txt\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"jpg\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"jpeg\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"bmp\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"gif\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"png\"</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">125</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\" spellcheck=\"true\">/**Openofficeæ”¯æŒæ ¼å¼*/</span>\n        String<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> officeFormatArr <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>#<span class=\"token number\">123</span><span class=\"token punctuation\">;</span><span class=\"token string\">\"doc\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"docx\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"xls\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"xlsx\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"ppt\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"pptx\"</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">125</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">boolean</span> browserFormatFlag <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">boolean</span> officeFormatFlag <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span>officeFormatArr<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">123</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>extendName<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>browserFormatArr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">123</span><span class=\"token punctuation\">;</span>\n                browserFormatFlag <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n            <span class=\"token operator\">&amp;</span>#<span class=\"token number\">125</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>extendName<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>officeFormatArr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">123</span><span class=\"token punctuation\">;</span>\n                officeFormatFlag <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n            <span class=\"token operator\">&amp;</span>#<span class=\"token number\">125</span><span class=\"token punctuation\">;</span>\n        <span class=\"token operator\">&amp;</span>#<span class=\"token number\">125</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\" spellcheck=\"true\">//å¤„ç†è¾“å…¥çš„æ–‡ä»¶</span>\n        String fullRelativePath <span class=\"token operator\">=</span> filePath<span class=\"token operator\">+</span><span class=\"token string\">\"/\"</span><span class=\"token operator\">+</span>fileName<span class=\"token punctuation\">;</span>\n        String realPath <span class=\"token operator\">=</span> ServletActionContext<span class=\"token punctuation\">.</span><span class=\"token function\">getServletContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRealPath</span><span class=\"token punctuation\">(</span>fullRelativePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        File inFile <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>realPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\" spellcheck=\"true\">//å¤„ç†è¾“å‡ºç›®å½•</span>\n        UserView userView <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>UserView<span class=\"token punctuation\">)</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getSession</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span>Constants<span class=\"token punctuation\">.</span>USER_VIEW<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        String outFileParentRelativePath <span class=\"token operator\">=</span> <span class=\"token string\">\"tmpUploadFile/preview/\"</span><span class=\"token operator\">+</span>userView<span class=\"token punctuation\">.</span><span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        String outFileParentRealPath <span class=\"token operator\">=</span> ServletActionContext<span class=\"token punctuation\">.</span><span class=\"token function\">getServletContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRealPath</span><span class=\"token punctuation\">(</span>outFileParentRelativePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\" spellcheck=\"true\">//è¾“å‡ºæ–‡ä»¶å¤„ç†å‰  å…ˆæ¸…ç©ºè¾“å‡ºç›®å½•</span>\n        File outFileParent <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>outFileParentRealPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>outFileParent<span class=\"token punctuation\">.</span><span class=\"token function\">exists</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">123</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">deleteFiles</span><span class=\"token punctuation\">(</span>outFileParent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token operator\">&amp;</span>#<span class=\"token number\">125</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\" spellcheck=\"true\">//åˆ†è¾¨æ–‡ä»¶ç±»å‹  æ‰§è¡Œä¸åŒå¤„ç†</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>browserFormatFlag<span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">123</span><span class=\"token punctuation\">;</span>                      <span class=\"token comment\" spellcheck=\"true\">//æµè§ˆå™¨å¯ç›´æ¥æ‰“å¼€çš„æ–‡ä»¶ï¼Œå¤åˆ¶æ–‡ä»¶åˆ°é¢„è§ˆç›®å½•å¹¶é‡å‘½åä¸ºpreview.(extendName)</span>\n            String outFileRelativePath <span class=\"token operator\">=</span> outFileParentRelativePath <span class=\"token operator\">+</span> <span class=\"token string\">\"/preview\"</span><span class=\"token operator\">+</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\".\"</span> <span class=\"token operator\">+</span> extendName <span class=\"token punctuation\">;</span>\n            String outFileRealPath <span class=\"token operator\">=</span> ServletActionContext<span class=\"token punctuation\">.</span><span class=\"token function\">getServletContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRealPath</span><span class=\"token punctuation\">(</span>outFileRelativePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            File outFile <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>outFileRealPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"txt\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>extendName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">123</span><span class=\"token punctuation\">;</span>\n                <span class=\"token comment\" spellcheck=\"true\">//æ–‡æœ¬æ–‡ä»¶è¦ç‰¹æ®Šå¤„ç†ä¸€ä¸‹   å…¨éƒ¨è½¬æ¢ä¸ºweb.xmlä¸­è®¾ç½®çš„ç¼–ç æ ¼å¼  UTF-8   å¦åˆ™ä¼šä¹±ç </span>\n                FileUtils<span class=\"token punctuation\">.</span><span class=\"token function\">writeLines</span><span class=\"token punctuation\">(</span>outFile<span class=\"token punctuation\">,</span> <span class=\"token string\">\"UTF-8\"</span><span class=\"token punctuation\">,</span> FileUtils<span class=\"token punctuation\">.</span><span class=\"token function\">readLines</span><span class=\"token punctuation\">(</span>inFile<span class=\"token punctuation\">,</span> <span class=\"token string\">\"GBK\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n            <span class=\"token operator\">&amp;</span>#<span class=\"token number\">125</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">else</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">123</span><span class=\"token punctuation\">;</span>\n                FileUtils<span class=\"token punctuation\">.</span><span class=\"token function\">copyFile</span><span class=\"token punctuation\">(</span>inFile<span class=\"token punctuation\">,</span> outFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    \n            <span class=\"token operator\">&amp;</span>#<span class=\"token number\">125</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&amp;#123;success:true,previewPath:'\"</span><span class=\"token operator\">+</span>outFileRelativePath<span class=\"token operator\">+</span><span class=\"token string\">\"'&amp;#125;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token operator\">&amp;</span>#<span class=\"token number\">125</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>officeFormatFlag<span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">123</span><span class=\"token punctuation\">;</span>     <span class=\"token comment\" spellcheck=\"true\">//Officeæ–‡æ¡£ï¼Œä½¿ç”¨Openofficeå¤„ç†æˆhtml</span>\n            String outFileRealPath <span class=\"token operator\">=</span> outFileParentRealPath <span class=\"token operator\">+</span> <span class=\"token string\">\"/preview.html\"</span> <span class=\"token punctuation\">;</span>\n            File outFile <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>outFileRealPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">convertDocToHtml</span><span class=\"token punctuation\">(</span>inFile<span class=\"token punctuation\">,</span>outFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">123</span><span class=\"token punctuation\">;</span>\n                <span class=\"token comment\" spellcheck=\"true\">//æ›´æ”¹æ‰©å±•åhtml -> htm   åŸå› ï¼šhtmlå·²ç»è¢«è®¾ç½®ä¸ºstrutsçš„Actionåç¼€å</span>\n                String jspFileRelativePath <span class=\"token operator\">=</span> outFileParentRelativePath <span class=\"token operator\">+</span> <span class=\"token string\">\"/preview.htm\"</span> <span class=\"token punctuation\">;</span>\n                File jspFile <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>outFileParentRealPath <span class=\"token operator\">+</span> <span class=\"token string\">\"/preview.htm\"</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                outFile<span class=\"token punctuation\">.</span><span class=\"token function\">renameTo</span><span class=\"token punctuation\">(</span>jspFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&amp;#123;success:true,previewPath:'\"</span><span class=\"token operator\">+</span>jspFileRelativePath<span class=\"token operator\">+</span><span class=\"token string\">\"'&amp;#125;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token operator\">&amp;</span>#<span class=\"token number\">125</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">else</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">123</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&amp;#123;success:false,msg:'æ–‡ä»¶è½¬æ¢å‡ºç°é”™è¯¯ï¼Œé¢„è§ˆå¤±è´¥ã€‚'&amp;#125;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token operator\">&amp;</span>#<span class=\"token number\">125</span><span class=\"token punctuation\">;</span>\n        <span class=\"token operator\">&amp;</span>#<span class=\"token number\">125</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">else</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">123</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&amp;#123;success:false,msg:'ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼(\"</span><span class=\"token operator\">+</span>extendName<span class=\"token operator\">+</span><span class=\"token string\">\")ï¼Œè¯·ä¸‹è½½åˆ°æœ¬åœ°è®¡ç®—æœºä¸Šé¢„è§ˆã€‚'&amp;#125;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token operator\">&amp;</span>#<span class=\"token number\">125</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> NONE<span class=\"token punctuation\">;</span></code></pre>\n","categories":["Java"],"tags":["Java"]},{"title":"ä¸è‰¯çš„ç¼–ç¨‹æ–‡åŒ–","url":"https://pkaq.org/2013/09/13/2013-09-13-codecultureproblem/","content":"<p><img src=\"/images/2013/09/12073258_ufYN.jpg\" alt=\"WTF\"><br><strong>â€œè¿™ä»£ç çœŸåƒåœ¾â€</strong>ï¼Œå½“æˆ‘ä»¬ç¿»æŸ¥ä¸€äº›ä»£ç å¯»æ‰¾ä¸€ä¸ªç‰¹åˆ«è®¨åŒçš„bugæ—¶ï¼ŒåŒäº‹å¤§å£°è¿™æ ·è¯´ã€‚â€œæ˜¯å—â€ï¼Œæˆ‘å›ç­”åˆ°ã€‚</p>\n<p>åƒ è¿™æ ·çš„è°´è´£ï¼Œä»¥åŠå…¶å®ƒä¸€äº›ç±»ä¼¼çš„è¯ï¼Œåœ¨åŠå…¬å®¤é‡Œç»å¸¸ä¼šå¬åˆ°ï¼Œè€Œä¸”é¢‘ç‡åœ¨å¢åŠ ã€‚è€Œæœ€ä»¤äººä¸å®‰çš„æ˜¯ï¼Œè¿™ä»£ç å¹¶ä¸æ˜¯ç‰¹åˆ«çš„ç³Ÿç³•ã€‚æˆ‘è¿™è¯æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿä¸èƒ½æŠŠå®ƒä»¬å†™ çš„æ›´å¥½å—ï¼Ÿå½“ç„¶ï¼å¤§å¤šæ•°çš„ä»£ç éƒ½æœ‰æ”¹å–„çš„ç©ºé—´â€”â€”åªè¦æœ‰è¶³å¤Ÿçš„æ—¶é—´å’Œèµ„æºã€‚åƒåœ¾ä»£ç ç¡®å®æœ‰ï¼Œæˆ‘ä»¬éƒ½çœ‹å¾—è§ï¼Œè€Œä¸”éƒ½æ˜¯æˆ‘ä»¬è‡ªå·±å†™çš„ï¼Œä½†è¿™å¹¶ä¸æ˜¯é—®é¢˜ã€‚</p>\n<h3><span id=\"wen-ti-shi-wo-men-you-yi-ge-bu-liang-de-zhe-dai-ma-zhen-la-ji-wen-hua\">é—®é¢˜æ˜¯æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸è‰¯çš„â€œè¿™ä»£ç çœŸåƒåœ¾â€æ–‡åŒ–ã€‚</span><a href=\"#wen-ti-shi-wo-men-you-yi-ge-bu-liang-de-zhe-dai-ma-zhen-la-ji-wen-hua\" class=\"header-anchor\">#</a></h3><p>è¿™æ˜¯ä¸€ç§æˆ‘æ„Ÿè§‰åœ¨webå¼€å‘ç¤¾åŒºä¸­è¶Šæ¥è¶Šå¸¸è§çš„æ–‡åŒ–ã€‚æ¥ç€ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘è¯·åŒäº‹è§£é‡Šä¸€ä¸‹ï¼Œè§£é‡Šä¸ºä»€ä¹ˆè¿™ä»£ç å¾ˆåƒåœ¾ï¼Œæˆ‘å¾—ä¸åˆ°ä¸€ä¸ªç›´æ¥çš„ç­”å¤ã€‚</p>\n<p>â€œè¿™è¿˜ä¸åƒåœ¾ï¼Œä½ çœ‹è¿™ä»£ç â€ï¼Œä»–å›ç­”è¯´ï¼Œé‚£ç§è¶¾é«˜æ°”æ‰¬æˆ‘éœ€è¦ä»°å¤´æ‰èƒ½çœ‹åˆ°ä»–ï¼Œç´§é‚¹çš„çœ‰å¤´å°±å¥½è±¡æ˜¯è¯´ï¼Œå¦‚æœä¸èƒ½çœ‹å‡ºè¿™ä»£ç æœ‰å¤šçƒ‚ï¼Œé‚£å°±æ˜¯ä¸ªå‚»å­ã€‚ç»“æœä½ çŸ¥é“æ€ä¹ˆç€ï¼Ÿæˆ‘å¼€å§‹æ„Ÿè§‰æœ‰ç‚¹å‚»äº†ã€‚æˆ‘å·®ç‚¹å°±å¿ä¸ä½å¼€å§‹è·Ÿç€ä»–ä¸€èµ·å˜²ç¬‘ï¼Œè®¤å®šè¿™ä»£ç çœŸçš„æœ‰å¤šçƒ‚ï¼Œå¤šç³Ÿç³•ã€‚</p>\n<p>åœ¨ æˆ‘ç»§ç»­ä¸‹é¢çš„å†…å®¹ä¹‹å‰ï¼Œæˆ‘å‘ç°ä¸Šé¢çš„å†…å®¹å¹¶æ²¡æœ‰åœ¨æœ€å¥½çš„å…‰çº¿ä¸‹æç»˜æˆ‘çš„åŒäº‹ã€‚æ‰€ä»¥ï¼Œè®©æˆ‘å¼¥è¡¥ä¸€ä¸‹ã€‚ä»–æ˜¯ä¸ªéå¸¸å¥½çš„å°ä¼™ã€‚å¦ç™½çš„è¯´ï¼Œä»–æ˜¯æˆ‘è§è¿‡çš„æœ€å’Œå–„çš„å° ä¼™ä¹‹ä¸€ã€‚ä»–å‹å–„ï¼Œæœ‰ä¸€ä¸ªä»–å¾ˆçˆ±çš„å®¶åº­ï¼Œä»–è·‘é©¬æ‹‰æ¾ï¼Œä¹äºåŠ©äººï¼Œèªæ˜ï¼Œç­‰ç­‰ç­‰ç­‰ã€‚è¿˜æœ‰ä¸€ç‚¹è¦è¯´æ˜ï¼šä»–æ˜¯ä¸€ä¸ªç»éªŒä¸å¤šçš„æ–°æ‰‹ã€‚ä»–è¿˜åœ¨å­¦ä¸€äº›åŸºç¡€çš„å¼€å‘çŸ¥è¯†ã€‚è¿™ æ²¡ä»€ä¹ˆå¥½ç¾æ„§çš„ï¼Œæˆ‘ä»¬éƒ½ç»å†è¿‡è¿™ä¸ªé˜¶æ®µã€‚é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆè¿™æ ·ä¸€ä¸ªå‹å–„ã€èªæ˜çš„å°ä¼™ï¼Œåœ¨ä»–å‚ä¸çš„ç¬¬ä¸€ä¸ªå¤§å‹webé¡¹ç›®ä¸Šï¼Œä»–çš„ç¬¬ä¸€ååº”å°±æ˜¯å»æŒ‡è´£ä¸€äº›ä»£ç å¾ˆåƒ åœ¾ï¼Ÿâ€”â€”ä»–ç”šè‡³è¿˜æ²¡æœ‰çœŸæ­£çš„å»ç†è§£å®ƒã€‚</p>\n<a id=\"more\"></a>\n\n<h3><span id=\"sheng-huo-gui-lu-la-ji-wang-xia-dao\">ç”Ÿæ´»è§„å¾‹ï¼šåƒåœ¾å¾€ä¸‹å€’ã€‚</span><a href=\"#sheng-huo-gui-lu-la-ji-wang-xia-dao\" class=\"header-anchor\">#</a></h3><p>è¿™ä¸ªé—®é¢˜å¹¶ä¸å•ç‹¬å‡ºç°åœ¨ç¨‹åºå‘˜æ–°æ‰‹ä¸­ã€‚å¾ˆå¤šç²¾æ˜äººå£«éƒ½æœ‰è¿™ ä¹ æƒ¯ã€‚ä½ ä¹Ÿè®¸æ˜¯ä¸€ä¸ªå¥‡æ‰ï¼Œä¸€ä¸ªä¹…ç»è€ƒéªŒçš„ç¨‹åºå‘˜ï¼Œä½†å¦‚æœæœ‰è¿™æ ·ä¸€ç§ä¹ æƒ¯ï¼Œæ•´ä¸ªå›¢é˜Ÿå’Œé¡¹ç›®éƒ½ä¼šå—åˆ°è´Ÿé¢å½±å“ã€‚å› ä¸ºæ–°æ‰‹ä»¬æŠŠä½ å½“ä½œçŸ¥è¯†å’Œç»éªŒçš„æºæ³‰ã€‚è¶Šå¤šçš„äºº æ‹¥æŠ±è¿™ç§â€œè¿™ä»£ç çœŸåƒåœ¾â€æ–‡åŒ–ï¼Œè¿™ç§æ–‡åŒ–å°±ä¼šè¶Šè¢«è®¤å¯ï¼Œè¶Šæˆä¸ºæ¨¡ä»¿çš„å¯¹è±¡ã€‚å¾ˆå¿«ï¼Œç¨‹åºå‘˜å¼€å§‹å˜çš„ä¸æ˜¯ç§¯æåœ¨é¡¹ç›®ä¸Šå‡ºåŠ›ï¼Œè€Œæ˜¯å»è´¬ä½åˆ«äººåœ¨é¡¹ç›®ä¸Šçš„è´¡çŒ®ã€‚æœ€ å¤§å˜´ã€æœ€åé¢çš„ç¨‹åºå‘˜å¾ˆå¿«å°±æˆäº†æœ€å—å°Šæ•¬çš„äººã€‚æ‰€æœ‰äººéƒ½å—æŠ˜ç£¨ï¼Œé¡¹ç›®å—å½±å“ï¼Œè€Œä¸€éƒ¨åˆ†äººå´èƒ½èƒ½å¾—åˆ°èµç¾ï¼Œä¸ºå€’æ˜¯éƒ½æ˜¯åƒåœ¾è€Œæ„Ÿåˆ°å¿ƒæ»¡æ„è¶³ã€‚</p>\n<h3><span id=\"wo-men-ying-gai-zen-me-zuo\">æˆ‘ä»¬åº”è¯¥æ€ä¹ˆåšï¼Ÿ</span><a href=\"#wo-men-ying-gai-zen-me-zuo\" class=\"header-anchor\">#</a></h3><p>æ²¡æœ‰äººæƒ³æ˜¾å¾—æ„šè ¢ï¼Œæ²¡æœ‰äººæƒ³è‡ªå·±çš„å·¥ä½œè¢«è®¤ä¸ºåŠ£è´¨ã€‚ä¸€æ—¦â€œè¿™ä»£ç çœŸåƒåœ¾â€æ–‡åŒ–å¼€å§‹ä¼ æ’­ï¼Œå”¯ä¸€èƒ½ç¡®ä¿è‡ªå·±åœ¨åˆ«äººä¹‹ä¸Šçš„åŠæ³•å°±æ˜¯è´¬ä½åˆ«äººã€‚æœ€ç»ˆï¼Œè¿™å˜æˆäº†ä¸€ç§è´Ÿèƒ½é‡ï¼Œè€Œä¸æ˜¯æƒ³ç€å»è§£å†³é—®é¢˜ã€‚</p>\n<p>é‚£ ä¹ˆï¼Œå¯¹è¿™æ ·çš„ä¸€ç§ç‰¹æ®Šç°è±¡æœ‰ä»€ä¹ˆè§£å†³æ–¹æ³•ï¼Ÿé˜»æ­¢å®ƒã€‚ä¸è¦ä¸åŠ æ€ç´¢çš„å¦å®šåˆ«äººçš„ä»£ç â€”â€”åœ¨æ²¡æœ‰åŸå› ã€æ²¡æœ‰ç†è§£çš„æƒ…å†µä¸‹ã€‚æœ‰å¾ˆå¤šçš„æ–¹å¼å¯ä»¥å¤„ç†é‚£äº›çœ‹èµ·æ¥æœ‰é—® é¢˜çš„ä»£ç ã€‚å¦‚æœå‘ç°ä»£ç ä¸­æœ‰å¼‚å‘³ï¼Œæƒ³åŠæ³•æ”¹è¿›å®ƒã€‚ä»ç†è§£è¿™äº›ä»£ç å¼€å§‹ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šä¿®æ­£ã€‚å¦‚æœä½ å‘ç°é¡¹ç›®ä¸­æœ‰ä¸€äº›ä¸è‰¯é£æ°”ï¼Œä¸è¦è·Ÿéšã€‚å¦‚æœæœ‰äººå¯¹ä½ è¯´â€œè¿™ä»£ ç çœŸåƒåœ¾â€ï¼Œé—®ä»–ä¸ºä»€ä¹ˆï¼Œç„¶åäº†è§£æŸ¥æ˜ï¼Œå»åšä¸€äº›äº‹æƒ…è®©å®ƒå˜çš„ä¸åƒåœ¾ã€‚å‘æœ€åˆå†™è¿™äº›ä»£ç çš„äººäº†è§£ï¼Œä¹Ÿè®¸ä»–ä»¬è¿™æ ·å†™ä»£ç æ˜¯æœ‰åŸå› çš„ã€‚å¸®åŠ©ä»–ä»¬ï¼Œè€Œä¸æ˜¯è¯‹æ¯ä»– ä»¬ã€‚</p>\n<p>ä¸‹ä¸€æ¬¡ï¼Œå½“æˆ‘å‘ç°ä»æ˜¾ç¤ºå™¨é‡Œé£˜å‡ºå¯ç–‘çš„å¼‚å‘³æ—¶ï¼Œæˆ‘ä¼šè½¬èº«é—®æˆ‘çš„åŒäº‹ï¼Œâ€œæˆ‘ä»¬å¦‚ä½•æ”¹è¿›è¿™æ®µå®ƒï¼Ÿâ€å› ä¸ºï¼Œæˆ‘ä»¬è¦é¢å¯¹å®ƒä»¬ï¼Œæœ‰æ—¶å€™ä»£ç ä¼šå¾ˆåƒåœ¾ï¼Œä½†è¿™ä¸æ„å‘³ç€æˆ‘ä»¬ä¹Ÿå»å˜æˆåƒåœ¾ã€‚</p>\n","categories":["Tucao"],"tags":["è½¬è½½"]},{"title":"ç¬¬å…­ç« ï¼š æ„å»ºåŸºç¡€","url":"https://pkaq.org/2013/09/06/2013-09-05-buildscriptbasics/","content":"<h4><span id=\"6-1-projects-he-tasks\">6.1 Projects å’Œ tasks</span><a href=\"#6-1-projects-he-tasks\" class=\"header-anchor\">#</a></h4><p>  Gradleä¸­æœ€é‡è¦çš„ä¸¤ä¸ªæ¦‚å¿µå°±æ˜¯ Projectså’Œtasks</p>\n<p> ä»»ä½•ä¸€ä¸ªGradleæ„å»ºéƒ½æ˜¯ç”±ä¸€ä¸ªæˆ–å¤šä¸ª projects ç»„æˆ.æ¯ä¸ªprojectåŒ…æ‹¬è®¸å¤šå¯æ„å»ºç»„æˆéƒ¨åˆ†.è¿™å®Œå…¨å–å†³äºä½ è¦æ„å»ºäº›ä»€ä¹ˆ.ä¸¾ä¸ªæ —å­.æ¯ä¸ªprojectæˆ–è®¸æ˜¯ä¸€ä¸ªjaråŒ…æˆ–è€…ä¸€ä¸ªwebåº”ç”¨,å®ƒä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªç”±è®¸å¤šå…¶ä»–é¡¹ç›®ä¸­äº§ç”Ÿçš„jaræ„æˆçš„zipå‹ç¼©åŒ….ä¸€ä¸ªprojectä¸å¿…æè¿°å®ƒåªèƒ½è¿›è¡Œæ„å»ºæ“ä½œ.å®ƒä¹Ÿå¯ä»¥éƒ¨ç½²ä½ çš„åº”ç”¨æˆ–æ­å»ºä½ çš„ç¯å¢ƒ.ä¸è¦æ‹…å¿ƒå®ƒåƒå¬ä¸Šå»çš„é‚£æ ·åºå¤§.Gradleçš„build-by-conventionå¯ä»¥è®©æ‚¨æ¥å…·ä½“å®šä¹‰ä¸€ä¸ªprojectåˆ°åº•è¯¥åšä»€ä¹ˆ.<br>  æ¯ä¸ªprojectéƒ½ç”±å¤šä¸ªtasksç»„æˆ.æ¯ä¸ªtaskéƒ½ä»£è¡¨äº†æ„å»ºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä¸€ä¸ªåŸå­æ€§æ“ä½œ.å¦‚ç¼–è¯‘,æ‰“åŒ…,ç”Ÿæˆjavadoc,å‘å¸ƒç­‰<br>  åˆ°ç›®å‰ä¸ºæ­¢,å¯ä»¥å‘ç°æˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªprojectä¸­å®šä¹‰ä¸€äº›ç®€å•ä»»åŠ¡,åç»­ç« èŠ‚å°†ä¼šé˜è¿°å¤šé¡¹ç›®æ„å»ºå’Œå¤šé¡¹ç›®å¤šä»»åŠ¡çš„å†…å®¹.</p>\n<h4><span id=\"6-2-hello-world\">6.2 Hello world</span><a href=\"#6-2-hello-world\" class=\"header-anchor\">#</a></h4><p>ä½ å¯ä»¥é€šè¿‡åœ¨å‘½ä»¤è¡Œè¿è¡Œgradleå‘½ä»¤æ¥æ‰§è¡Œæ„å»º,gradleå‘½ä»¤ä¼šä»å½“å‰ç›®å½•ä¸‹å¯»æ‰¾build.gradleæ–‡ä»¶æ¥æ‰§è¡Œæ„å»º.æˆ‘ä»¬ç§°build.gradleæ–‡ä»¶ä¸ºæ„å»ºè„šæœ¬.ä¸¥æ ¼æ¥è¯´è¿™å…¶å®æ˜¯ä¸€ä¸ªæ„å»ºé…ç½®è„šæœ¬,åé¢ä½ ä¼šäº†æ¥åˆ°è¿™ä¸ªæ„å»ºè„šæœ¬å®šä¹‰äº†ä¸€ä¸ªprojectå’Œä¸€äº›é»˜è®¤tasks<br>ä½ å¯ä»¥åˆ›å»ºå¦‚ä¸‹è„šæœ¬åˆ°build.gradleä¸­</p>\n<ul>\n<li>ä¾‹6.1 ç¬¬ä¸€ä¸ªæ„å»ºè„šæœ¬</li>\n</ul>\n<a id=\"more\"></a>\n\n<p>build.gradle </p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">task hello &#123;</span><br><span class=\"line\"> doLast &#123;</span><br><span class=\"line\">     println <span class=\"string\">&#x27;Hello world!&#x27;</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ç„¶ååœ¨è¯¥æ–‡ä»¶æ‰€åœ¨ç›®å½•æ‰§è¡Œ gradle -q hello</p>\n<ul>\n<li>ä¾‹6.2 æ‰§è¡Œè„šæœ¬</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> gradle -q hello</span></span><br><span class=\"line\">Hello world!</span><br></pre></td></tr></table></figure>\n<p>ä¸Šé¢çš„è„šæœ¬å®šä¹‰äº†ä¸€ä¸ªå«åš hello çš„ task,å¹¶ä¸”ç»™å®ƒæ·»åŠ äº†ä¸€ä¸ªåŠ¨ä½œ.å½“è¿è¡Œ gradle hello çš„æ—¶å€™,Graldeä¾¿ä¼šå»è°ƒç”¨ hello è¿™ä¸ªä»»åŠ¡æ¥æ‰§è¡Œç»™å®šæ“ä½œ.è¿™äº›æ“ä½œå…¶å®å°±æ˜¯ä¸€ä¸ªç”¨groovyä¹¦å†™çš„é—­åŒ…<br>å¦‚æœä½ è§‰å¾—å®ƒçœ‹ä¸Šå»è·ŸAntä¸­çš„targetså¾ˆåƒ,é‚£ä¹ˆæ˜¯å¯¹çš„.Gradleçš„taskså°±ç›¸å½“äºAntä¸­çš„targets.ä¸è¿‡ä½ ä¼šå‘ç°ä»–åŠŸèƒ½æ›´åŠ å¼ºå¤§.æˆ‘ä»¬åªæ˜¯æ¢äº†ä¸€ä¸ªæ¯”targetæ›´å½¢è±¡çš„å¦å¤–ä¸€ä¸ªæœ¯è¯­.ä¸å¹¸çš„æ˜¯è¿™æ°å·§ä¸Antä¸­çš„æœ¯è¯­æœ‰äº›å†²çª.ant å‘½ä»¤ä¸­æœ‰è¯¸å¦‚javacã€copyã€tasks.æ‰€ä»¥å½“è¯¥æ–‡æ¡£ä¸­æåŠtasksæ—¶,é™¤éç‰¹åˆ«æŒ‡æ˜ ant task ,å¦åˆ™æŒ‡çš„ä»…ä»…æ˜¯ä¸Gradleä¸­çš„tasks.</p>\n<p>æ³¨: -qå‚æ•°çš„ä½œç”¨?è¯¥æ–‡æ¡£çš„ç¤ºä¾‹ä¸­å¾ˆå¤šåœ°æ–¹åœ¨è°ƒç”¨gradleå‘½ä»¤æ—¶éƒ½åŠ äº†-qå‚æ•°.è¯¥å‚æ•°ç”¨æ¥æ§åˆ¶gradleçš„æ—¥å¿—çº§åˆ«,å¯ä»¥ä¿è¯åªè¾“å‡ºæˆ‘ä»¬éœ€è¦çš„å†…å®¹.å…·ä½“å¯å‚é˜…æœ¬æ–‡æ¡£ ç¬¬åå…«ç«  æ—¥å¿— æ¥äº†è§£æ›´å¤šå‚æ•°å’Œä¿¡æ¯.</p>\n<h4><span id=\"6-3-kuai-su-ding-yi-ren-wu\">6.3 å¿«é€Ÿå®šä¹‰ä»»åŠ¡</span><a href=\"#6-3-kuai-su-ding-yi-ren-wu\" class=\"header-anchor\">#</a></h4><ul>\n<li>ä¾‹6.3 å¿«é€Ÿå®šä¹‰ä»»åŠ¡</li>\n</ul>\n<p>build.gradle</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">task hello &lt;&lt;&#123;</span><br><span class=\"line\">   println &#x27;Hello ,world!&#x27;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä¸Šé¢çš„è„šæœ¬åˆä¸€æ¬¡é‡‡ç”¨é—­åŒ…æ¥å®šä¹‰äº†ä¸€ä¸ªå«åšhelloçš„ä»»åŠ¡,æœ¬æ–‡æ¡£åç»­ç« èŠ‚ä¸­æˆ‘ä»¬å°†ä¼šæ›´å¤šçš„é‡‡ç”¨è¿™ç§é£æ ¼æ¥å®šä¹‰ä»»åŠ¡.</p>\n<p>####6.4 ä»£ç å³è„šæœ¬</p>\n<p>Gradleè„šæœ¬é‡‡ç”¨Groovyä¹¦å†™,çœ‹ä¸‹é¢è¿™é“å¼€èƒƒèœ.</p>\n<ul>\n<li>ä¾‹6.4 åœ¨gradleä»»åŠ¡ä¸­é‡‡ç”¨groovy</li>\n</ul>\n<p>build.gradle</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">task upper &lt;&lt; &#123;</span><br><span class=\"line\">\tString someString = <span class=\"string\">&#x27;mY_NaMe&#x27;</span></span><br><span class=\"line\">\tprintln <span class=\"string\">&quot;Original : &quot;</span> +someString</span><br><span class=\"line\">\tprintln <span class=\"string\">&quot;Upper case : &quot;</span> + someString.toUpperCase()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\">gradle -q upper</span></span><br><span class=\"line\">Original : mY_NaMe</span><br><span class=\"line\">Upper case : MY_NAME</span><br></pre></td></tr></table></figure>\n<ul>\n<li>ä¾‹ 6.5 åœ¨gradleä»»åŠ¡ä¸­é‡‡ç”¨groovy</li>\n</ul>\n<p>build.gradle</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">task count &lt;&lt; &#123;</span><br><span class=\"line\">\t<span class=\"number\">4.</span>times &#123;</span><br><span class=\"line\">\t\tprint <span class=\"string\">&quot;$it&quot;</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\">gradle -q count</span></span><br><span class=\"line\">0 1 2 3</span><br></pre></td></tr></table></figure>\n\n<h3><span id=\"6-5-ren-wu-yi-lai\">6.5 ä»»åŠ¡ä¾èµ–</span><a href=\"#6-5-ren-wu-yi-lai\" class=\"header-anchor\">#</a></h3><p>ä½ å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼åˆ›å»ºä»»åŠ¡é—´çš„ä¾èµ–å…³ç³»</p>\n<p>*ä¾‹6.6</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">task hello &lt;&lt; &#123;</span><br><span class=\"line\">    println <span class=\"string\">&#x27;Hello world!&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">task intro(<span class=\"attr\">dependsOn:</span>hello) &lt;&lt; &#123;</span><br><span class=\"line\">    println <span class=\"string\">&quot;I&#x27;m Gradle&quot;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\">gradle -q intro</span></span><br><span class=\"line\">Hello world!</span><br><span class=\"line\">I&#x27;m Gradle</span><br></pre></td></tr></table></figure>","categories":["Build Tools"],"tags":["Gradle UserGuide"]},{"title":"","url":"https://pkaq.org/README.html","content":"","categories":[],"tags":[]},{"title":"404 Not Foundï¼šè¯¥é¡µæ— æ³•æ˜¾ç¤º","url":"https://pkaq.org//404.html","content":"<!DOCTYPE HTML>\n<html>\n<head>\n<meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\">\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\n<meta name=\"robots\" content=\"all\">\n<meta name=\"robots\" content=\"index,follow\">\n<title>å…¬ç›Š404é¡µé¢ // PKAQçš„åšå®¢ - å¦‚æ˜¯æˆ‘é—»</title>\n</head>\n<body>\n<script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homepageurl=\"http://xiaming.com.cn\" homepagename=\"å¦‚æ˜¯æˆ‘é—» - PKAQçš„åšå®¢\"></script>\n</body>\n</html>","categories":[],"tags":[]},{"title":"category","url":"https://pkaq.org/category/index.html","content":"","categories":[],"tags":[]},{"title":"about","url":"https://pkaq.org/about/index.html","content":"","categories":[],"tags":[]},{"title":"","url":"https://pkaq.org/css/fexo-theme.css","content":"/**é¦–é¡µèƒŒæ™¯**/\nhtml.page-home {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-image: url(background-cover.jpg);\n  background-color: #CCC;\n  background-size: cover;\n  background-position: center center;\n  background-repeat: no-repeat;\n  /*background: linear-gradient( #1abc9c, transparent), linear-gradient( 90deg, skyblue, transparent), linear-gradient( -90deg, coral, transparent);*/\n  /*background-blend-mode: screen;*/\n\n  /*background: linear-gradient(to left, #5f2c82, #49a09d);*/\n}\n\n/**é¦–é¡µå¯¼èˆªæ ·å¼**/\n.content-home .nav .item a {\n    display: block;\n    position: relative;\n    opacity: 0.8;\n    padding: 5px 10px;\n    border: 1px solid #FEFEFE;\n    border-radius: 8px;\n    font-size: 0.9em;\n    font-weight: bold;\n    letter-spacing: 1px;\n    text-shadow: none;\n    -webkit-font-smoothing: antialiased;\n     font-family:'Superrazor7f2b268e317b38';\n}\n\n/** é¦–é¡µé®ç½© **/\n.content-home {\n  z-index: 1;\n}\n\n.panel-cover--overlay {\n  display: block;\n  position: absolute;\n  z-index: 0;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n  background-color: rgba(68,68,68,0.6);\n  background-image: -webkit-linear-gradient(-410deg, rgba(68,68,68,0.6) 20%, rgba(0,0,0,0.9));\n  background-image: linear-gradient(140deg, rgba(68,68,68,0.6) 20%, rgba(0,0,0,0.9));\n}\n.cover-purple {\n  background-color: rgba(73,50,82,0.1);\n  background-image: -webkit-linear-gradient(-410deg, rgba(73,50,82,0.6) 20%, rgba(17,11,19,0.8));\n  background-image: linear-gradient(140deg, rgba(73,50,82,0.6) 20%, rgba(17,11,19,0.8));\n}\n/** åšå®¢èƒŒæ™¯ **/\n.page-archives {\n    background: url(bg-archives.jpg) repeat;\n}\n\n.canvas {\n  position: absolute;\n  z-index: -1;\n  top: 0px;\n  left: 0px;\n}\n\n.content content-archive{\n  position: absolute;\n  z-index: 1;\n}\n/** åšå®¢åˆ—è¡¨å¯¼èˆªæ°”æ³¡ **/\n.toolbox_color_0 {\n  background-color: #\n}\n\n.toolbox_color_0 {\n    background: #1abc9c;\n  }\n.toolbox_color_1 {\n    background: #3498db;\n  }\n.toolbox_color_2 {\n    background: #9b59b6;\n  }\n.toolbox_color_3 {\n    background: #e67e22;\n  }\n.toolbox_color_4 {\n    background: #e74c3c;\n}\n.toolbox_color_5 {\n    background: #B76EF2;\n  }\n.toolbox_color_6 {\n    background: #70B4F4;\n  }\n.toolbox_color_7 {\n    background: #70F4B4;\n}\n","categories":[],"tags":[]},{"title":"link","url":"https://pkaq.org/link/index.html","content":"","categories":[],"tags":[]},{"title":"tag","url":"https://pkaq.org/tag/index.html","content":"","categories":[],"tags":[]},{"title":"project","url":"https://pkaq.org/project/index.html","content":"","categories":[],"tags":[]},{"title":"search","url":"https://pkaq.org/search/index.html","content":"","categories":[],"tags":[]}]